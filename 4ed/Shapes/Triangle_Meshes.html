
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
        
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Triangle Meshes</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Shapes.html">Shapes</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Triangle Meshes</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Shapes/Disks.html">(Previous: Disks)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:triangle-mesh"></span><h2>6.5 Triangle Meshes</h2><p>



</p>
<p>The triangle is one of the most commonly used shapes in computer graphics;
complex scenes may be modeled using millions of triangles to achieve great
detail.  (Figure&nbsp;<a href="#fig:trimesh-ganesha">6.11</a> shows an image of a complex
triangle mesh of over four million triangles.)

</p>
<p></p>
<span class="anchor" id="fig:trimesh-ganesha"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>

<div class="card-img-top" style="display:block; width: 100%; padding-top: 100.000%; position:relative;">
<div id="ganesha.png17" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div></div>
<script>
Jeri.renderViewer(document.getElementById('ganesha.png17'), { image: 'ganesha.png' });
</script>
<button data-toggle="tooltip" data-placement="left" class="btn yojeri" title="This image is interactive. Click and drag to pan and use the mouse-wheel to zoom. After clicking on the image to select it, type '?' to see a summary of keyboard controls."><i class="fa fa-snowflake fa-border"></i></button><p>

</p>
<figcaption class="caption">Figure 6.11: Ganesha Model. <span class="legend"> This triangle mesh contains
over four million individual triangles. It was created from a real statue
using a 3D scanner that uses structured light to determine shapes of
objects.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>While a natural representation would be to have a <tt>Triangle</tt> shape
implementation where each triangle stored the positions of its three
vertices, a more memory-efficient representation is to separately store
entire triangle meshes with an array of vertex positions where each
individual triangle just stores three offsets into this array for its three
vertices.
To see why this is the case, consider the celebrated Euler&ndash;Poincar&eacute; formula,
which relates the number of vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 769.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper V</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="0" y="0"></use>
</g>
</svg>, edges <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 763.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper E</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D438" d="M763 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12s1 12 1 18c4 27 4 29 4 53c0 82 -30 111 -152 111h-141c-44 0 -45 -4 -54 -39l-60 -241h94c92 0 110 23 131 99c3 12 5 18 14 18c7 0 12 -5 12 -11l-57 -234c-4 -15 -7 -20 -15 -20c-9 0 -13 6 -13 11 c0 3 1 6 3 11c7 30 7 42 7 49c0 25 0 46 -85 46h-99l-68 -273c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h146c171 0 208 67 273 215c2 6 4 12 13 12c12 0 12 -11 12 -11s-3 -9 -5 -14l-92 -216c-7 -16 -8 -17 -31 -17h-519c-19 0 -28 0 -28 12 c0 19 11 19 28 19c79 0 81 8 91 47l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h505c25 0 30 0 27 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D438" x="0" y="0"></use>
</g>
</svg>, and faces <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.738ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 748.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D439" d="M748 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12c0 3 0 5 2 18c3 27 3 31 3 54c0 77 -23 110 -146 110h-132c-44 0 -45 -4 -54 -39l-64 -254h91c85 0 108 18 129 96c4 16 5 21 15 21s12 -11 12 -11c0 -3 0 -5 -3 -16l-55 -217c-5 -18 -5 -21 -15 -21 c-6 0 -12 4 -12 12c0 0 1 6 3 11c7 30 7 42 7 49c0 29 -8 45 -83 45h-97l-62 -249c-4 -15 -4 -23 -4 -23c0 -13 3 -17 32 -20c25 -2 30 -2 52 -2c23 0 25 0 28 -1c0 0 6 -3 6 -11c0 -19 -12 -19 -21 -19l-149 3l-132 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47 l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h490c25 0 30 0 27 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D439" x="0" y="0"></use>
</g>
</svg> on
closed discrete meshes as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.809ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9820.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper V minus upper E plus upper F equals 2 left-parenthesis 1 minus g right-parenthesis comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D438" d="M763 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12s1 12 1 18c4 27 4 29 4 53c0 82 -30 111 -152 111h-141c-44 0 -45 -4 -54 -39l-60 -241h94c92 0 110 23 131 99c3 12 5 18 14 18c7 0 12 -5 12 -11l-57 -234c-4 -15 -7 -20 -15 -20c-9 0 -13 6 -13 11 c0 3 1 6 3 11c7 30 7 42 7 49c0 25 0 46 -85 46h-99l-68 -273c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h146c171 0 208 67 273 215c2 6 4 12 13 12c12 0 12 -11 12 -11s-3 -9 -5 -14l-92 -216c-7 -16 -8 -17 -31 -17h-519c-19 0 -28 0 -28 12 c0 19 11 19 28 19c79 0 81 8 91 47l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h505c25 0 30 0 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D439" d="M748 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12c0 3 0 5 2 18c3 27 3 31 3 54c0 77 -23 110 -146 110h-132c-44 0 -45 -4 -54 -39l-64 -254h91c85 0 108 18 129 96c4 16 5 21 15 21s12 -11 12 -11c0 -3 0 -5 -3 -16l-55 -217c-5 -18 -5 -21 -15 -21 c-6 0 -12 4 -12 12c0 0 1 6 3 11c7 30 7 42 7 49c0 29 -8 45 -83 45h-97l-62 -249c-4 -15 -4 -23 -4 -23c0 -13 3 -17 32 -20c25 -2 30 -2 52 -2c23 0 25 0 28 -1c0 0 6 -3 6 -11c0 -19 -12 -19 -21 -19l-149 3l-132 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47 l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h490c25 0 30 0 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="991" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D438" x="1992" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2978" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D439" x="3978" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="5005" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="6061" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6561" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="6951" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="7674" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="8674" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="9541" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.041ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2601.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">g element-of bold upper N Superscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2208" d="M587 -23c0 -11 -9 -20 -20 -20h-193c-162 0 -293 131 -293 293s131 293 293 293h193c11 0 20 -9 20 -20s-9 -20 -20 -20h-193c-133 0 -242 -103 -252 -233h445c27 0 27 -40 0 -40h-445c10 -130 119 -233 252 -233h193c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40D" d="M860 639h-25c-28 0 -30 0 -54 -3c-28 -3 -29 -4 -29 -26v-578c0 -23 0 -32 -27 -32c-16 0 -17 1 -27 13l-498 586v-523c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563h-108v47h229 c21 0 22 -1 33 -13l398 -468v405c0 22 -1 23 -30 26c-18 2 -35 3 -53 3h-25v47c41 -3 93 -3 135 -3c39 0 96 0 134 3v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2208" x="755" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40D" x="1700" y="0"></use>
</g>
</svg> is the <em>genus</em> of the mesh. The genus is usually a
small number and can be interpreted as the number of &ldquo;handles&rdquo; in the mesh
(analogous to a handle of a teacup). On a triangle mesh, the number of edges and
vertices is furthermore related by the identity
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.256ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 3985.1 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper E equals three-halves upper F period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D438" d="M763 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12s1 12 1 18c4 27 4 29 4 53c0 82 -30 111 -152 111h-141c-44 0 -45 -4 -54 -39l-60 -241h94c92 0 110 23 131 99c3 12 5 18 14 18c7 0 12 -5 12 -11l-57 -234c-4 -15 -7 -20 -15 -20c-9 0 -13 6 -13 11 c0 3 1 6 3 11c7 30 7 42 7 49c0 25 0 46 -85 46h-99l-68 -273c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h146c171 0 208 67 273 215c2 6 4 12 13 12c12 0 12 -11 12 -11s-3 -9 -5 -14l-92 -216c-7 -16 -8 -17 -31 -17h-519c-19 0 -28 0 -28 12 c0 19 11 19 28 19c79 0 81 8 91 47l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h505c25 0 30 0 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D439" d="M748 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12c0 3 0 5 2 18c3 27 3 31 3 54c0 77 -23 110 -146 110h-132c-44 0 -45 -4 -54 -39l-64 -254h91c85 0 108 18 129 96c4 16 5 21 15 21s12 -11 12 -11c0 -3 0 -5 -3 -16l-55 -217c-5 -18 -5 -21 -15 -21 c-6 0 -12 4 -12 12c0 0 1 6 3 11c7 30 7 42 7 49c0 29 -8 45 -83 45h-97l-62 -249c-4 -15 -4 -23 -4 -23c0 -13 3 -17 32 -20c25 -2 30 -2 52 -2c23 0 25 0 28 -1c0 0 6 -3 6 -11c0 -19 -12 -19 -21 -19l-149 3l-132 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47 l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h490c25 0 30 0 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D438" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1041" y="0"></use>
<g transform="translate(1819,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D439" x="2958" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="3706" y="0"></use>
</g>
</svg>
</div>
<p>

This can be seen by dividing each edge into two parts associated with the two
adjacent triangles. There are <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.901ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1249 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3 upper F</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D439" d="M748 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12c0 3 0 5 2 18c3 27 3 31 3 54c0 77 -23 110 -146 110h-132c-44 0 -45 -4 -54 -39l-64 -254h91c85 0 108 18 129 96c4 16 5 21 15 21s12 -11 12 -11c0 -3 0 -5 -3 -16l-55 -217c-5 -18 -5 -21 -15 -21 c-6 0 -12 4 -12 12c0 0 1 6 3 11c7 30 7 42 7 49c0 29 -8 45 -83 45h-97l-62 -249c-4 -15 -4 -23 -4 -23c0 -13 3 -17 32 -20c25 -2 30 -2 52 -2c23 0 25 0 28 -1c0 0 6 -3 6 -11c0 -19 -12 -19 -21 -19l-149 3l-132 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47 l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h490c25 0 30 0 27 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D439" x="500" y="0"></use>
</g>
</svg> such half-edges, and all colocated pairs
constitute the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 763.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper E</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D438" d="M763 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12s1 12 1 18c4 27 4 29 4 53c0 82 -30 111 -152 111h-141c-44 0 -45 -4 -54 -39l-60 -241h94c92 0 110 23 131 99c3 12 5 18 14 18c7 0 12 -5 12 -11l-57 -234c-4 -15 -7 -20 -15 -20c-9 0 -13 6 -13 11 c0 3 1 6 3 11c7 30 7 42 7 49c0 25 0 46 -85 46h-99l-68 -273c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h146c171 0 208 67 273 215c2 6 4 12 13 12c12 0 12 -11 12 -11s-3 -9 -5 -14l-92 -216c-7 -16 -8 -17 -31 -17h-519c-19 0 -28 0 -28 12 c0 19 11 19 28 19c79 0 81 8 91 47l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h505c25 0 30 0 27 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D438" x="0" y="0"></use>
</g>
</svg> mesh edges. For large closed triangle meshes, the overall
effect of the genus usually becomes negligible and we can combine the previous
two equations (with <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.37ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2312.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">g equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="755" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1811" y="0"></use>
</g>
</svg>) to obtain
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.422ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3626.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper F almost-equals 2 upper V period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D439" d="M748 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12c0 3 0 5 2 18c3 27 3 31 3 54c0 77 -23 110 -146 110h-132c-44 0 -45 -4 -54 -39l-64 -254h91c85 0 108 18 129 96c4 16 5 21 15 21s12 -11 12 -11c0 -3 0 -5 -3 -16l-55 -217c-5 -18 -5 -21 -15 -21 c-6 0 -12 4 -12 12c0 0 1 6 3 11c7 30 7 42 7 49c0 29 -8 45 -83 45h-97l-62 -249c-4 -15 -4 -23 -4 -23c0 -13 3 -17 32 -20c25 -2 30 -2 52 -2c23 0 25 0 28 -1c0 0 6 -3 6 -11c0 -19 -12 -19 -21 -19l-149 3l-132 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47 l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h490c25 0 30 0 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D439" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="1026" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="2077" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="2578" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="3347" y="0"></use>
</g>
</svg>
</div>
<p>

In other words, there are approximately twice as many faces as vertices. Since
each face references three vertices, every vertex is (on average) referenced a
total of six times.
Thus, when vertices are shared, the total amortized storage
required per triangle will be 12 bytes of memory for the offsets (at 4
bytes for three 32-bit integer offsets) plus half of the storage for one
vertex&mdash;6 bytes, assuming three 4-byte floats are used to store the vertex
position&mdash;for a total of 18 bytes per triangle. This is much better than
the 36 bytes per triangle that storing the three positions directly would
require.  The relative storage savings are even better when there are
per-vertex surface normals or texture coordinates in a mesh.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#MeshRepresentationandStorage"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="MeshRepresentationandStorage"></span><h3>6.5.1  Mesh Representation and Storage</h3><p>


</p>
<p><tt>pbrt</tt> uses the <a href="#TriangleMesh"><tt>TriangleMesh</tt></a> class to store the shared information
about a triangle mesh.  It is defined in the files <a href="https://github.com/mmp/pbrt-v4/tree/master/src/pbrt/util/mesh.h"><tt>util/mesh.h</tt></a>
and <a href="https://github.com/mmp/pbrt-v4/tree/master/src/pbrt/util/mesh.cpp"><tt>util/mesh.cpp</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMeshDefinition-0"></span><div class="fragmentname">&lt;&lt;TriangleMesh Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="TriangleMesh"></span>TriangleMesh {
  public:
    &lt;&lt;<span class="fragmentname">TriangleMesh Public Methods</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-544" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-544"><i></i></a><div id="fragbit-544" class="collapse"><div class="fragmentcode">       TriangleMesh(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> &amp;renderFromObject, bool reverseOrientation,
                    std::vector&lt;int&gt; vertexIndices, std::vector&lt;<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>&gt; p,
                    std::vector&lt;<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>&gt; S, std::vector&lt;<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>&gt; N,
                    std::vector&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>&gt; uv, std::vector&lt;int&gt; faceIndices,
                    Allocator alloc);
       
       std::string ToString() const;
       
       bool WritePLY(std::string filename) const;
       
       static void Init(Allocator alloc);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-TriangleMeshPublicMembers-0">TriangleMesh Public Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-545" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-545"><i></i></a><div id="fragbit-545" class="collapse"><div class="fragmentcode">       int nTriangles, nVertices;
       const int *vertexIndices = nullptr;
       const <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> *p = nullptr;
       const <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> *n = nullptr;
       const <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> *s = nullptr;
       const <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> *uv = nullptr;
       bool reverseOrientation, transformSwapsHandedness;</div></div>
};</div><p>


</p>
<p>In addition to the mesh vertex positions and vertex indices, per-vertex
normals <tt>n</tt>, tangent vectors <tt>s</tt>, and texture coordinates
<tt>uv</tt> may be provided.  The corresponding vectors should be empty if there are no
such values or should be the same size as <tt>p</tt> otherwise.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMeshMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;TriangleMesh Method Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">TriangleMesh::TriangleMesh(
        const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> &amp;renderFromObject, bool reverseOrientation,
        std::vector&lt;int&gt; indices, std::vector&lt;<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>&gt; p,
        std::vector&lt;<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>&gt; s, std::vector&lt;<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>&gt; n,
        std::vector&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>&gt; uv, std::vector&lt;int&gt; faceIndices, Allocator alloc)
    : nTriangles(indices.size() / 3), nVertices(p.size()) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializemeshmonovertexIndices-0">Initialize mesh <tt>vertexIndices</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-546" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-546"><i></i></a><div id="fragbit-546" class="collapse"><div class="fragmentcode">       <a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a> = <a href="#intBufferCache" class="code">intBufferCache</a>-&gt;<a href="#BufferCache::LookupOrAdd" class="code">LookupOrAdd</a>(indices, alloc);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Transformmeshverticestorenderingspaceandinitializemeshmonop-0">Transform mesh vertices to rendering space and initialize mesh <tt>p</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-547" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-547"><i></i></a><div id="fragbit-547" class="collapse"><div class="fragmentcode">       for (<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> &amp;pt : <a href="#TriangleMesh::p" class="code">p</a>)
           pt = renderFromObject(pt);
       this-&gt;<a href="#TriangleMesh::p" class="code">p</a> = <a href="#point3BufferCache" class="code">point3BufferCache</a>-&gt;<a href="#BufferCache::LookupOrAdd" class="code">LookupOrAdd</a>(<a href="#TriangleMesh::p" class="code">p</a>, alloc);</div></div>
    &lt;&lt;<span class="fragmentname">Remainder of <tt>TriangleMesh</tt> constructor</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-548" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-548"><i></i></a><div id="fragbit-548" class="collapse"><div class="fragmentcode">       this-&gt;reverseOrientation = reverseOrientation;
       this-&gt;transformSwapsHandedness = renderFromObject.SwapsHandedness();
             
       if (!uv.empty()) {
           CHECK_EQ(nVertices, uv.size());
           this-&gt;uv = point2BufferCache-&gt;LookupOrAdd(uv, alloc);
       }
       if (!n.empty()) {
           CHECK_EQ(nVertices, n.size());
           for (<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> &amp;nn : n) {
               nn = renderFromObject(nn);
               if (reverseOrientation)
                   nn = -nn;
           }
           this-&gt;n = normal3BufferCache-&gt;LookupOrAdd(n, alloc);
       }
       if (!s.empty()) {
           CHECK_EQ(nVertices, s.size());
           for (<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> &amp;ss : s)
               ss = renderFromObject(ss);
           this-&gt;s = vector3BufferCache-&gt;LookupOrAdd(s, alloc);
       }
       
       if (!faceIndices.empty()) {
           CHECK_EQ(nTriangles, faceIndices.size());
           this-&gt;faceIndices = intBufferCache-&gt;LookupOrAdd(faceIndices, alloc);
       }
       
       // Make sure that we don't have too much stuff to be using integers to
       // index into things.
       CHECK_LE(p.size(), std::numeric_limits&lt;int&gt;::max());
       // We could be clever and check indices.size() / 3 if we were careful
       // to promote to a 64-bit int before multiplying by 3 when we look up
       // in the indices array...
       CHECK_LE(indices.size(), std::numeric_limits&lt;int&gt;::max());</div></div>
}</div><p>


</p>
<p>The mesh data is made available via public member variables; as with things
like coordinates of points or rays&rsquo; directions, there would be little benefit
and some bother from information hiding in this case.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMeshPublicMembers-0"></span><div class="fragmentname">&lt;&lt;TriangleMesh Public Members&gt;&gt;=&nbsp;<a href="#fragment-TriangleMeshPublicMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">int <span class="anchor" id="TriangleMesh::nTriangles"></span>nTriangles, <span class="anchor" id="TriangleMesh::nVertices"></span>nVertices;
const int *<span class="anchor" id="TriangleMesh::vertexIndices"></span>vertexIndices = nullptr;
const <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> *<span class="anchor" id="TriangleMesh::p"></span>p = nullptr;</div><p>


</p>
<p>Although its constructor takes <tt>std::vector</tt> parameters,
<tt>TriangleMesh</tt> stores plain pointers to its data arrays.  The
<tt>vertexIndices</tt> pointer points to <tt>3 * nTriangles</tt> values, and
the per-vertex pointers, if not <tt>nullptr</tt>, point to <tt>nVertices</tt>
values.

</p>
<p>
We chose this design so that different <tt>TriangleMesh</tt>es could
potentially point to the same arrays in memory in the case that they were
both given the same values for some or all of their parameters.  Although
<tt>pbrt</tt> offers capabilities for object instancing, where multiple copies of
the same geometry can be placed in the scene with different transformation
matrices (e.g., via the <a href="../Primitives_and_Intersection_Acceleration/Primitive_Interface_and_Geometric_Primitives.html#TransformedPrimitive"><tt>TransformedPrimitive</tt></a> that is described in
Section&nbsp;<a href="../Primitives_and_Intersection_Acceleration/Primitive_Interface_and_Geometric_Primitives.html#sec:prim-instance-animated">7.1.2</a>), the scenes provided to it do not
always make full use of this capability.  For example, with the landscape
scene in Figures&nbsp;<a href="../Cameras_and_Film/Projective_Camera_Models.html#fig:ecosys-dof">5.11</a> and&nbsp;<a href="../Primitives_and_Intersection_Acceleration/Primitive_Interface_and_Geometric_Primitives.html#fig:ecosys-instancing">7.2</a>, over
400&nbsp;MB is saved from detecting such redundant arrays.

</p>
<p>The <a href="#BufferCache"><tt>BufferCache</tt></a> class handles the details of storing a single unique
copy of each buffer provided to it.  Its <tt>LookupOrAdd()</tt> method, to be
defined shortly, takes a <tt>std::vector</tt> of the type it manages and
returns a pointer to memory that stores the same values.

</p>
<p></p>
<span class="anchor" id="fragment-InitializemeshmonovertexIndices-0"></span><div class="fragmentname">&lt;&lt;Initialize mesh <tt>vertexIndices</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a> = <a href="#intBufferCache" class="code">intBufferCache</a>-&gt;<a href="#BufferCache::LookupOrAdd" class="code">LookupOrAdd</a>(indices, alloc);</div><p>


</p>
<p>The <tt>BufferCache</tt>s are made available through global variables in the
<tt>pbrt</tt> namespace. Additional ones, not included here, handle normals,
tangent vectors, and texture coordinates.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCacheGlobalDeclarations-0"></span><div class="fragmentname">&lt;&lt;BufferCache Global Declarations&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">extern BufferCache&lt;int&gt; *<span class="anchor" id="intBufferCache"></span>intBufferCache;
extern BufferCache&lt;<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>&gt; *<span class="anchor" id="point3BufferCache"></span>point3BufferCache;
</div><p>


</p>
<p>

</p>
<p>The <tt>BufferCache</tt> class is templated based on the array element type
that it stores.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCacheDefinition-0"></span><div class="fragmentname">&lt;&lt;BufferCache Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">template &lt;typename T&gt; class <span class="anchor" id="BufferCache"></span>BufferCache {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-BufferCachePublicMethods-0">BufferCache Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-549" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-549"><i></i></a><div id="fragbit-549" class="collapse"><div class="fragmentcode">       const T *LookupOrAdd(pstd::span&lt;const T&gt; buf, Allocator alloc) {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnpointertodataifmonobufcontentsarealreadyinthecache-0">Return pointer to data if <tt>buf</tt> contents are already in the cache</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-550" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-550"><i></i></a><div id="fragbit-550" class="collapse"><div class="fragmentcode">              Buffer lookupBuffer(buf.data(), buf.size());
              int shardIndex = uint32_t(lookupBuffer.hash) &gt;&gt; (32 - logShards);
              mutex[shardIndex].lock_shared();
              if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
                  iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
                  const T *ptr = iter-&gt;ptr;
                  mutex[shardIndex].unlock_shared();
                  return ptr;
              }</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Addmonobufcontentstocacheandreturnpointertocachedcopy-0">Add <tt>buf</tt> contents to cache and return pointer to cached copy</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-551" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-551"><i></i></a><div id="fragbit-551" class="collapse"><div class="fragmentcode">              <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock_shared();
              T *ptr = alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::allocate_object" class="code">allocate_object</a>&lt;T&gt;(buf.size());
              std::copy(buf.begin(), buf.end(), ptr);
              <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].lock();
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Handlethecaseofanotherthreadaddingthebufferfirst-0">Handle the case of another thread adding the buffer first</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-552" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-552"><i></i></a><div id="fragbit-552" class="collapse"><div class="fragmentcode">                 if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
                     iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
                     const T *cachePtr = iter-&gt;<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>;
                     <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
                     alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::deallocate_object" class="code">deallocate_object</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, buf.size());
                     return cachePtr;
                 }</div></div>
              <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].insert(Buffer(ptr, buf.size()));
              <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
              return ptr;</div></div>
       }
       size_t BytesUsed() const { return bytesUsed; }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-BufferCache::BufferDefinition-0">BufferCache::Buffer Definition</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-553" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-553"><i></i></a><div id="fragbit-553" class="collapse"><div class="fragmentcode">       struct Buffer {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-BufferCache::BufferPublicMethods-0">BufferCache::Buffer Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-554" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-554"><i></i></a><div id="fragbit-554" class="collapse"><div class="fragmentcode">              Buffer(const T *<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, size_t <a href="#BufferCache::Buffer::size" class="code">size</a>) : <a href="#BufferCache::Buffer::ptr" class="code">ptr</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>), <a href="#BufferCache::Buffer::size" class="code">size</a>(<a href="#BufferCache::Buffer::size" class="code">size</a>) {
                  <a href="#BufferCache::Buffer::hash" class="code">hash</a> = <a href="../Utilities/Mathematical_Infrastructure.html#HashBuffer" class="code">HashBuffer</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, <a href="#BufferCache::Buffer::size" class="code">size</a>);
              }
              bool operator==(const Buffer &amp;b) const {
                  return <a href="#BufferCache::Buffer::size" class="code">size</a> == b.<a href="#BufferCache::Buffer::size" class="code">size</a> &amp;&amp; <a href="#BufferCache::Buffer::hash" class="code">hash</a> == b.<a href="#BufferCache::Buffer::hash" class="code">hash</a> &amp;&amp;
                         std::memcmp(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, b.<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, <a href="#BufferCache::Buffer::size" class="code">size</a> * sizeof(T)) == 0;
              }</div></div>
           const T *ptr = nullptr;
           size_t size = 0, hash;
       };</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-BufferCache::BufferHasherDefinition-0">BufferCache::BufferHasher Definition</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-555" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-555"><i></i></a><div id="fragbit-555" class="collapse"><div class="fragmentcode">       struct BufferHasher {
           size_t operator()(const Buffer &amp;b) const {
               return b.<a href="#BufferCache::Buffer::hash" class="code">hash</a>;
           }
       };</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-BufferCachePrivateMembers-0">BufferCache Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-556" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-556"><i></i></a><div id="fragbit-556" class="collapse"><div class="fragmentcode">       static constexpr int <a href="#BufferCache::logShards" class="code">logShards</a> = 6;
       static constexpr int <a href="#BufferCache::nShards" class="code">nShards</a> = 1 &lt;&lt; <a href="#BufferCache::logShards" class="code">logShards</a>;
       std::shared_mutex mutex[<a href="#BufferCache::nShards" class="code">nShards</a>];
       std::unordered_set&lt;Buffer, BufferHasher&gt; cache[<a href="#BufferCache::nShards" class="code">nShards</a>];
       </div></div>
};</div><p>


</p>
<p><tt>BufferCache</tt> allows concurrent use by multiple threads so that
multiple meshes can be added to the scene in parallel; the scene construction
code in Appendix&nbsp;<a href="../Processing_the_Scene_Description.html#chap:API">A</a> takes advantage of this capability.  While
a single mutex could be used to manage access to it, contention over that
mutex by multiple threads can inhibit concurrency, reducing the benefits of
multi-threading.  Therefore, the cache is broken into 64 independent
<em>shards</em>, each holding a subset of the entries.  Each shard has its
own mutex, allowing different threads to concurrently access different
shards.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCachePrivateMembers-0"></span><div class="fragmentname">&lt;&lt;BufferCache Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">static constexpr int <span class="anchor" id="BufferCache::logShards"></span><a href="#BufferCache::logShards" class="code">logShards</a> = 6;
static constexpr int <span class="anchor" id="BufferCache::nShards"></span><a href="#BufferCache::nShards" class="code">nShards</a> = 1 &lt;&lt; <a href="#BufferCache::logShards" class="code">logShards</a>;
std::shared_mutex <span class="anchor" id="BufferCache::mutex"></span>mutex[<a href="#BufferCache::nShards" class="code">nShards</a>];
std::unordered_set&lt;Buffer, BufferHasher&gt; <span class="anchor" id="BufferCache::cache"></span>cache[<a href="#BufferCache::nShards" class="code">nShards</a>];
</div><p>


</p>
<p><tt>Buffer</tt> is a small helper class that wraps an allocation managed by
the <tt>BufferCache</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCache::BufferDefinition-0"></span><div class="fragmentname">&lt;&lt;BufferCache::Buffer Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="BufferCache::Buffer"></span>Buffer {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-BufferCache::BufferPublicMethods-0">BufferCache::Buffer Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-557" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-557"><i></i></a><div id="fragbit-557" class="collapse"><div class="fragmentcode">       Buffer(const T *<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, size_t <a href="#BufferCache::Buffer::size" class="code">size</a>) : <a href="#BufferCache::Buffer::ptr" class="code">ptr</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>), <a href="#BufferCache::Buffer::size" class="code">size</a>(<a href="#BufferCache::Buffer::size" class="code">size</a>) {
           <a href="#BufferCache::Buffer::hash" class="code">hash</a> = <a href="../Utilities/Mathematical_Infrastructure.html#HashBuffer" class="code">HashBuffer</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, <a href="#BufferCache::Buffer::size" class="code">size</a>);
       }
       bool operator==(const Buffer &amp;b) const {
           return <a href="#BufferCache::Buffer::size" class="code">size</a> == b.<a href="#BufferCache::Buffer::size" class="code">size</a> &amp;&amp; <a href="#BufferCache::Buffer::hash" class="code">hash</a> == b.<a href="#BufferCache::Buffer::hash" class="code">hash</a> &amp;&amp;
                  std::memcmp(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, b.<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, <a href="#BufferCache::Buffer::size" class="code">size</a> * sizeof(T)) == 0;
       }</div></div>
    const T *<span class="anchor" id="BufferCache::Buffer::ptr"></span>ptr = nullptr;
    size_t <span class="anchor" id="BufferCache::Buffer::size"></span>size = 0, <span class="anchor" id="BufferCache::Buffer::hash"></span>hash;
};</div><p>


</p>
<p>The <tt>Buffer</tt> constructor computes the buffer&rsquo;s hash, which is stored
in a member variable.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCache::BufferPublicMethods-0"></span><div class="fragmentname">&lt;&lt;BufferCache::Buffer Public Methods&gt;&gt;=&nbsp;<a href="#fragment-BufferCache::BufferPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Buffer(const T *ptr, size_t size) : ptr(ptr), size(size) {
    <a href="#BufferCache::Buffer::hash" class="code">hash</a> = <a href="../Utilities/Mathematical_Infrastructure.html#HashBuffer" class="code">HashBuffer</a>(ptr, size);
}</div><p>


</p>
<p>An equality operator, which is required by the <tt>std::unordered_set</tt>,
only returns true if both buffers are the same size and store the same
values.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCache::BufferPublicMethods-1"></span><div class="fragmentname">&lt;&lt;BufferCache::Buffer Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-BufferCache::BufferPublicMethods-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">bool operator==(const Buffer &amp;b) const {
    return <a href="#BufferCache::Buffer::size" class="code">size</a> == b.<a href="#BufferCache::Buffer::size" class="code">size</a> &amp;&amp; <a href="#BufferCache::Buffer::hash" class="code">hash</a> == b.<a href="#BufferCache::Buffer::hash" class="code">hash</a> &amp;&amp;
           std::memcmp(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, b.<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, <a href="#BufferCache::Buffer::size" class="code">size</a> * sizeof(T)) == 0;
}</div><p>


</p>
<p><tt>BufferHasher</tt> is another helper class, used by
<tt>std::unordered_set</tt>.  It returns the buffer&rsquo;s already-computed
hash.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCache::BufferHasherDefinition-0"></span><div class="fragmentname">&lt;&lt;BufferCache::BufferHasher Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="BufferCache::BufferHasher"></span>BufferHasher {
    size_t operator()(const Buffer &amp;b) const {
        return b.<a href="#BufferCache::Buffer::hash" class="code">hash</a>;
    }
};</div><p>


</p>
<p>The <tt>BufferCache</tt> <tt>LookUpOrAdd()</tt> method checks to see if the
values stored by the provided buffer are already in the cache and returns a
pointer to them if so.  Otherwise, it allocates memory to store them and
returns a pointer to it.

</p>
<p></p>
<span class="anchor" id="fragment-BufferCachePublicMethods-0"></span><div class="fragmentname">&lt;&lt;BufferCache Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">const T *<span class="anchor" id="BufferCache::LookupOrAdd"></span>LookupOrAdd(pstd::span&lt;const T&gt; buf, Allocator alloc) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnpointertodataifmonobufcontentsarealreadyinthecache-0">Return pointer to data if <tt>buf</tt> contents are already in the cache</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-558" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-558"><i></i></a><div id="fragbit-558" class="collapse"><div class="fragmentcode">       Buffer lookupBuffer(buf.data(), buf.size());
       int shardIndex = uint32_t(lookupBuffer.hash) &gt;&gt; (32 - logShards);
       mutex[shardIndex].lock_shared();
       if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
           iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
           const T *ptr = iter-&gt;ptr;
           mutex[shardIndex].unlock_shared();
           return ptr;
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Addmonobufcontentstocacheandreturnpointertocachedcopy-0">Add <tt>buf</tt> contents to cache and return pointer to cached copy</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-559" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-559"><i></i></a><div id="fragbit-559" class="collapse"><div class="fragmentcode">       <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock_shared();
       T *ptr = alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::allocate_object" class="code">allocate_object</a>&lt;T&gt;(buf.size());
       std::copy(buf.begin(), buf.end(), ptr);
       <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].lock();
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Handlethecaseofanotherthreadaddingthebufferfirst-0">Handle the case of another thread adding the buffer first</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-560" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-560"><i></i></a><div id="fragbit-560" class="collapse"><div class="fragmentcode">          if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
              iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
              const T *cachePtr = iter-&gt;<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>;
              <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
              alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::deallocate_object" class="code">deallocate_object</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, buf.size());
              return cachePtr;
          }</div></div>
       <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].insert(Buffer(ptr, buf.size()));
       <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
       return ptr;</div></div>
}</div><p>


</p>
<p>The <tt>pstd::span</tt>&rsquo;s contents need to be wrapped in a <tt>Buffer</tt>
instance to be able to search for a matching buffer in the cache.  The
buffer&rsquo;s pointer is returned if it is already present.  Because the cache
is only read here and is not being modified, the <tt>lock_shared()</tt>
capability of <tt>std::shared_mutex</tt> is used here, allowing multiple
threads to read the hash table concurrently.

</p>
<p></p>
<span class="anchor" id="fragment-Returnpointertodataifmonobufcontentsarealreadyinthecache-0"></span><div class="fragmentname">&lt;&lt;Return pointer to data if <tt>buf</tt> contents are already in the cache&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Buffer lookupBuffer(buf.data(), buf.size());
int shardIndex = uint32_t(lookupBuffer.hash) &gt;&gt; (32 - logShards);
mutex[shardIndex].lock_shared();
if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
    iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
    const T *ptr = iter-&gt;ptr;
    mutex[shardIndex].unlock_shared();
    return ptr;
}</div><p>


</p>
<p>

</p>
<p>Otherwise, memory is allocated using the allocator to store the buffer, and
the values are copied from the provided span before the <tt>Buffer</tt> is added to
the cache.  An exclusive lock to the mutex must be held in order to modify
the cache; one is acquired by giving up the shared lock and then calling
the regular <tt>lock()</tt> method.

</p>
<p></p>
<span class="anchor" id="fragment-Addmonobufcontentstocacheandreturnpointertocachedcopy-0"></span><div class="fragmentname">&lt;&lt;Add <tt>buf</tt> contents to cache and return pointer to cached copy&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock_shared();
T *ptr = alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::allocate_object" class="code">allocate_object</a>&lt;T&gt;(buf.size());
std::copy(buf.begin(), buf.end(), ptr);
<a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].lock();
&lt;&lt;<span class="fragmentname"><a href="#fragment-Handlethecaseofanotherthreadaddingthebufferfirst-0">Handle the case of another thread adding the buffer first</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-561" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-561"><i></i></a><div id="fragbit-561" class="collapse"><div class="fragmentcode">   if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
       iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
       const T *cachePtr = iter-&gt;<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>;
       <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
       alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::deallocate_object" class="code">deallocate_object</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, buf.size());
       return cachePtr;
   }</div></div>
<a href="#BufferCache::cache" class="code">cache</a>[shardIndex].insert(Buffer(ptr, buf.size()));
<a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
return ptr;</div><p>


</p>
<p>It is possible that another thread may have added the buffer to the cache
before the current thread is able to; if the same buffer is being added by
multiple threads concurrently, then one will end up acquiring the exclusive
lock before the other.  In that rare case, a pointer to the already-added
buffer is returned and the memory allocated by this thread is released.

</p>
<p></p>
<span class="anchor" id="fragment-Handlethecaseofanotherthreadaddingthebufferfirst-0"></span><div class="fragmentname">&lt;&lt;Handle the case of another thread adding the buffer first&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (auto iter = <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].find(lookupBuffer);
    iter != <a href="#BufferCache::cache" class="code">cache</a>[shardIndex].end()) {
    const T *cachePtr = iter-&gt;<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>;
    <a href="#BufferCache::mutex" class="code">mutex</a>[shardIndex].unlock();
    alloc.<a href="../Introduction/Using_and_Understanding_the_Code.html#std::pmr::polymorphic_allocator::deallocate_object" class="code">deallocate_object</a>(<a href="#BufferCache::Buffer::ptr" class="code">ptr</a>, buf.size());
    return cachePtr;
}</div><p>


</p>
<p>

</p>
<p>Returning now to the <tt>TriangleMesh</tt> constructor, the vertex positions
are processed next.  Unlike the other shapes that leave the shape
description in object space and then transform incoming rays from rendering
space to object space, triangle meshes transform the shape into rendering
space and thus save the work of transforming incoming rays into object
space and the work of transforming the intersection&rsquo;s geometric
representation out to rendering space.  This is a good idea because this
operation can be performed once at startup, avoiding transforming rays
many times during rendering.  Using this approach with quadrics is more
complicated, although possible&mdash;see
Exercise&nbsp;<a href="../Shapes/Exercises.html#ex:shapes-exercise-quadrics">6.8.8</a> at the end of the chapter.

</p>
<p>The resulting points are also provided to the buffer cache, though after
the rendering from object transformation has been applied.  Because the
positions were transformed to rendering space, this cache lookup is rarely
successful.  The hit rate would likely be higher if positions were
left in object space, though doing so would require additional computation
to transform vertex positions when they were accessed.  Vertex indices and
<tt>uv</tt> texture coordinates fare better with the buffer cache, however.

</p>
<p></p>
<span class="anchor" id="fragment-Transformmeshverticestorenderingspaceandinitializemeshmonop-0"></span><div class="fragmentname">&lt;&lt;Transform mesh vertices to rendering space and initialize mesh <tt>p</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">for (<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> &amp;pt : <a href="#TriangleMesh::p" class="code">p</a>)
    pt = renderFromObject(pt);
this-&gt;<a href="#TriangleMesh::p" class="code">p</a> = <a href="#point3BufferCache" class="code">point3BufferCache</a>-&gt;<a href="#BufferCache::LookupOrAdd" class="code">LookupOrAdd</a>(<a href="#TriangleMesh::p" class="code">p</a>, alloc);</div><p>


</p>
<p>

</p>
<p>We will omit the remainder of the <a href="#TriangleMesh"><tt>TriangleMesh</tt></a> constructor, as
handling the other per-vertex buffer types is similar to how the
positions are processed.  The remainder of its member variables are below.
In addition to the remainder of the mesh vertex and face data, the
<tt>TriangleMesh</tt> records whether the normals should be flipped by way of
the values of <tt>reverseOrientation</tt> and
<tt>transformSwapsHandedness</tt>.  Because these two have the same value for
all triangles in a mesh, memory can be saved by storing them once with the
mesh itself rather than redundantly with each of the triangles. 

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMeshPublicMembers-1"></span><div class="fragmentname">&lt;&lt;TriangleMesh Public Members&gt;&gt;+=&nbsp;<a href="#fragment-TriangleMeshPublicMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">const <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> *<span class="anchor" id="TriangleMesh::n"></span>n = nullptr;
const <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> *<span class="anchor" id="TriangleMesh::s"></span>s = nullptr;
const <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> *<span class="anchor" id="TriangleMesh::uv"></span>uv = nullptr;
bool <span class="anchor" id="TriangleMesh::reverseOrientation"></span>reverseOrientation, <span class="anchor" id="TriangleMesh::transformSwapsHandedness"></span>transformSwapsHandedness;</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#TriangleClass"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="TriangleClass"></span><h3>6.5.2  Triangle Class</h3><p>


</p>
<p>The <a href="#Triangle"><tt>Triangle</tt></a> class actually implements the <a href="../Shapes/Basic_Shape_Interface.html#Shape"><tt>Shape</tt></a> interface.  It
represents a single triangle.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleDefinition-0"></span><div class="fragmentname">&lt;&lt;Triangle Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="Triangle"></span>Triangle {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-TrianglePublicMethods-0">Triangle Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-562" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-562"><i></i></a><div id="fragbit-562" class="collapse"><div class="fragmentcode">       static pstd::vector&lt;<a href="../Shapes/Basic_Shape_Interface.html#Shape" class="code">Shape</a>&gt; CreateTriangles(const <a href="#TriangleMesh" class="code">TriangleMesh</a> *mesh,
                                                        Allocator alloc);
       Triangle(int meshIndex, int triIndex)
           : meshIndex(meshIndex), triIndex(triIndex) {}
       static void Init(Allocator alloc);
       
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> Bounds() const;
       
       PBRT_CPU_GPU
       pstd::optional&lt;ShapeIntersection&gt; Intersect(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;ray,
                                                   Float tMax = Infinity) const;
       PBRT_CPU_GPU
       bool IntersectP(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;ray, Float tMax = Infinity) const;
       Float <a href="#Triangle::Area" class="code">Area</a>() const {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-563" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-563"><i></i></a><div id="fragbit-563" class="collapse"><div class="fragmentcode">              const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
              const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
           return 0.5f * <a href="../Geometry_and_Transformations/Vectors.html#Length" class="code">Length</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0));
       }
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a> NormalBounds() const;
       std::string ToString() const;
       static <a href="#TriangleMesh" class="code">TriangleMesh</a> *CreateMesh(const <a href="../Geometry_and_Transformations/Transformations.html#Transform" class="code">Transform</a> *renderFromObject,
                                       bool reverseOrientation,
                                       const ParameterDictionary &amp;parameters,
                                       const FileLoc *loc, Allocator alloc);
       Float <a href="#Triangle::SolidAngle" class="code">SolidAngle</a>(<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>) const {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-564" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-564"><i></i></a><div id="fragbit-564" class="collapse"><div class="fragmentcode">              const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
              const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
           return <a href="../Geometry_and_Transformations/Spherical_Geometry.html#SphericalTriangleArea" class="code">SphericalTriangleArea</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>),
                                        <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>));
       }
       static <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> InteractionFromIntersection(
               const <a href="#TriangleMesh" class="code">TriangleMesh</a> *mesh, int triIndex,
               <a href="#TriangleIntersection" class="code">TriangleIntersection</a> ti, Float time, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wo) {
           const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * triIndex];
           <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>[v[2]];
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computetrianglepartialderivatives-0">Compute triangle partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-565" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-565"><i></i></a><div id="fragbit-565" class="collapse"><div class="fragmentcode">              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computedeltasandmatrixdeterminantfortrianglepartialderivatives-0">Compute deltas and matrix determinant for triangle partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-566" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-566"><i></i></a><div id="fragbit-566" class="collapse"><div class="fragmentcode">                 &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-567" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-567"><i></i></a><div id="fragbit-567" class="collapse"><div class="fragmentcode">                    pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
                        mesh-&gt;uv
                            ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                                  {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
                            : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2], duv12 = uv[1] - uv[2];
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dp02 = p0 - p2, dp12 = p1 - p2;
                 Float determinant =
                     <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], duv12[1], duv02[1], duv12[0]);</div></div>
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu, dpdv;
              bool degenerateUV = std::abs(determinant) &lt; 1e-9f;
              if (!degenerateUV) {
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Computetriangledpduanddpdvviamatrixinversion-0">Compute triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg> via matrix inversion</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-568" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-568"><i></i></a><div id="fragbit-568" class="collapse"><div class="fragmentcode">                     Float invdet = 1 / determinant;
                     dpdu = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv12[1], dp02, duv02[1], dp12) * invdet;
                     dpdv = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], dp12, duv12[0], dp02) * invdet;</div></div>
              }
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Handledegeneratetriangleuvparameterizationorpartialderivatives-0">Handle degenerate triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parameterization or partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-569" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-569"><i></i></a><div id="fragbit-569" class="collapse"><div class="fragmentcode">                 if (degenerateUV || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv)) == 0) {
                     <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ng = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p2 - p0, p1 - p0);
                     if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ng) == 0)
                         ng = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(Vector3&lt;double&gt;(p2 - p0),
                                             Vector3&lt;double&gt;(p1 - p0)));
                     <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ng), &amp;dpdu, &amp;dpdv);
                 }</div></div></div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Interpolateuvparametriccoordinatesandhitpoint-0">Interpolate <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parametric coordinates and hit point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-570" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-570"><i></i></a><div id="fragbit-570" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * p0 + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * p1 + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * p2;
              <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvHit = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * uv[0] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * uv[1] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * uv[2];</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoSurfaceInteractionfortrianglehit-0">Return <tt>SurfaceInteraction</tt> for triangle hit</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-571" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-571"><i></i></a><div id="fragbit-571" class="collapse"><div class="fragmentcode">              bool flipNormal = mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>;
              &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorfortriangleintersection-0">Compute error bounds <tt>pError</tt> for triangle intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-572" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-572"><i></i></a><div id="fragbit-572" class="collapse"><div class="fragmentcode">                 <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * p1) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b1" class="code">b2</a> * p2);
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(7) * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pAbsSum);</div></div>
              <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> isect(Point3fi(pHit, pError), uvHit, wo, dpdu, dpdv,
                                       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(), <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(), time, flipNormal);
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Setfinalsurfacenormalandshadinggeometryfortriangle-0">Set final surface normal and shading geometry for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-573" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-573"><i></i></a><div id="fragbit-573" class="collapse"><div class="fragmentcode">                 &lt;&lt;<span class="fragmentname"><a href="#fragment-Overridesurfacenormalinmonoisectfortriangle-0">Override surface normal in <tt>isect</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-574" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-574"><i></i></a><div id="fragbit-574" class="collapse"><div class="fragmentcode">                    isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dp02, dp12)));
                    if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
                        isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = -isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
                 if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a> || mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
                     &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializemonoTriangleshadinggeometry-0">Initialize <tt>Triangle</tt> shading geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-575" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-575"><i></i></a><div id="fragbit-575" class="collapse"><div class="fragmentcode">                        &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingnormalmononsfortriangle-0">Compute shading normal <tt>ns</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-576" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-576"><i></i></a><div id="fragbit-576" class="collapse"><div class="fragmentcode">                           <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns;
                           if (mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>) {
                               ns = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[2]];
                               ns = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ns) &gt; 0 ? <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ns) : isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;
                           } else
                               ns = isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
                        &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingtangentmonossfortriangle-0">Compute shading tangent <tt>ss</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-577" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-577"><i></i></a><div id="fragbit-577" class="collapse"><div class="fragmentcode">                           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ss;
                           if (mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
                               ss = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[2]];
                               if (LengthSquared(ss) == 0)
                                   ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;
                           } else
                               ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;</div></div>
                        &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingbitangentmonotsfortriangleandadjustmonoss-0">Compute shading bitangent <tt>ts</tt> for triangle and adjust <tt>ss</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-578" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-578"><i></i></a><div id="fragbit-578" class="collapse"><div class="fragmentcode">                           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ts = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ns, ss);
                           if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ts) &gt; 0)
                               ss = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ts, ns);
                           else
                               <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(ns, &amp;ss, &amp;ts);</div></div>
                        &lt;&lt;<span class="fragmentname">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> for triangle shading geometry</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-579" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-579"><i></i></a><div id="fragbit-579" class="collapse"><div class="fragmentcode">                           <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu, dndv;
                           if (mesh-&gt;n) {
                               // Compute deltas for triangle partial derivatives of normal
                               <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2];
                               <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv12 = uv[1] - uv[2];
                               <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn1 = mesh-&gt;n[v[0]] - mesh-&gt;n[v[2]];
                               <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn2 = mesh-&gt;n[v[1]] - mesh-&gt;n[v[2]];
                           
                               Float determinant =
                                   DifferenceOfProducts(duv02[0], duv12[1], duv02[1], duv12[0]);
                               bool degenerateUV = std::abs(determinant) &lt; 1e-9;
                               if (degenerateUV) {
                                   // We can still compute dndu and dndv, with respect to the
                                   // same arbitrary coordinate system we use to compute dpdu
                                   // and dpdv when this happens. It's important to do this
                                   // (rather than giving up) so that ray differentials for
                                   // rays reflected from triangles with degenerate
                                   // parameterizations are still reasonable.
                                   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dn = Cross(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[2]] - mesh-&gt;n[v[0]]),
                                                       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[1]] - mesh-&gt;n[v[0]]));
                           
                                   if (LengthSquared(dn) == 0)
                                       dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);
                                   else {
                                       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dnu, dnv;
                                       CoordinateSystem(dn, &amp;dnu, &amp;dnv);
                                       dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnu);
                                       dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnv);
                                   }
                               } else {
                                   Float invDet = 1 / determinant;
                                   dndu = DifferenceOfProducts(duv12[1], dn1, duv02[1], dn2) * invDet;
                                   dndv = DifferenceOfProducts(duv02[0], dn2, duv12[0], dn1) * invDet;
                               }
                           } else
                               dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);</div></div>
                        isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::SetShadingGeometry" class="code">SetShadingGeometry</a>(ns, ss, ts, dndu, dndv, true);</div></div>
                 }</div></div>
              return isect;</div></div>
       }
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-580" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-580"><i></i></a><div id="fragbit-580" class="collapse"><div class="fragmentcode">              const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
              const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Samplepointontriangleuniformlybyarea-0">Sample point on triangle uniformly by area</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-581" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-581"><i></i></a><div id="fragbit-581" class="collapse"><div class="fragmentcode">              pstd::array&lt;Float, 3&gt; b = <a href="#SampleUniformTriangle" class="code">SampleUniformTriangle</a>(u);
              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = b[0] * p0 + b[1] * p1 + b[2] * p2;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesurfacenormalforsampledpointontriangle-0">Compute surface normal for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-582" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-582"><i></i></a><div id="fragbit-582" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
              if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
                  <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(b[0] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + b[1] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] +
                              (1 - b[0] - b[1]) * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
                  <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
              } else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
                  <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeuvforsampledpointontriangle-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-583" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-583"><i></i></a><div id="fragbit-583" class="collapse"><div class="fragmentcode">              &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-584" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-584"><i></i></a><div id="fragbit-584" class="collapse"><div class="fragmentcode">                 pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
                     mesh-&gt;uv
                         ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                               {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
                         : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
              <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvSample = b[0] * uv[0] + b[1] * uv[1] + b[2] * uv[2];</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorforsampledpointontriangle-0">Compute error bounds <tt>pError</tt> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-585" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-585"><i></i></a><div id="fragbit-585" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[0] * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[1] * p1) +
                                <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>((1 - b[0] - b[1]) * p2);
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(6) * pAbsSum);</div></div>
           return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(Point3fi(<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>, pError), n, uvSample),
                              1 / <a href="#Triangle::Area" class="code">Area</a>()};
       }
       Float PDF(const <a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a> &amp;) const { return 1 / <a href="#Triangle::Area" class="code">Area</a>(); }
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; Sample(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx,
                                          <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-586" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-586"><i></i></a><div id="fragbit-586" class="collapse"><div class="fragmentcode">              const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
              const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Useuniformareasamplingfornumericallyunstablecases-0">Use uniform area sampling for numerically unstable cases</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-587" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-587"><i></i></a><div id="fragbit-587" class="collapse"><div class="fragmentcode">              Float solidAngle = <a href="#Triangle::SolidAngle" class="code">SolidAngle</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>());
              if (solidAngle &lt; <a href="#Triangle::MinSphericalSampleArea" class="code">MinSphericalSampleArea</a> ||
                  solidAngle &gt; <a href="#Triangle::MaxSphericalSampleArea" class="code">MaxSphericalSampleArea</a>) {
                  &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Sampleshapebyareaandcomputeincidentdirectionmonowi-0">Sample shape by area and compute incident direction <tt>wi</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-588" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-588"><i></i></a><div id="fragbit-588" class="collapse"><div class="fragmentcode">                     pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; ss = Sample(u);
                     ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a> = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>;
                     <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi = ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>() - ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
                     if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(wi) == 0) return {};
                     wi = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(wi);</div></div>
                  &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ConvertareasamplingPDFinmonosstosolidanglemeasure-0">Convert area sampling PDF in <tt>ss</tt> to solid angle measure</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-589" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-589"><i></i></a><div id="fragbit-589" class="collapse"><div class="fragmentcode">                     ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a> /= <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                                <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>());
                     if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a>))
                         return {};</div></div>
                  return ss;
              }</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Samplesphericaltrianglefromreferencepoint-0">Sample spherical triangle from reference point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-590" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-590"><i></i></a><div id="fragbit-590" class="collapse"><div class="fragmentcode">              &lt;&lt;<span class="fragmentname"><a href="#fragment-Applywarpproductsamplingforcosinefactoratreferencepoint-0">Apply warp product sampling for cosine factor at reference point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-591" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-591"><i></i></a><div id="fragbit-591" class="collapse"><div class="fragmentcode">                 Float pdf = 1;
                 if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
                     &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-592" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-592"><i></i></a><div id="fragbit-592" class="collapse"><div class="fragmentcode">                        <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
                        <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                                          <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
                        pstd::array&lt;Float, 4&gt; w =
                            pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                                  std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                                  std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                                  std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
                     u = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#SampleBilinear" class="code">SampleBilinear</a>(u, w);
                     pdf = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
                 }</div></div>
              Float triPDF;
              pstd::array&lt;Float, 3&gt; b =
                  <a href="#SampleSphericalTriangle" class="code">SampleSphericalTriangle</a>({p0, p1, p2}, ctx.p(), u, &amp;triPDF);
              if (triPDF == 0) return {};
              pdf *= triPDF;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorforsampledpointontriangle-0">Compute error bounds <tt>pError</tt> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-593" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-593"><i></i></a><div id="fragbit-593" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[0] * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[1] * p1) +
                                <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>((1 - b[0] - b[1]) * p2);
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(6) * pAbsSum);</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoShapeSampleforsolidanglesampledpointontriangle-0">Return <tt>ShapeSample</tt> for solid angle sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-594" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-594"><i></i></a><div id="fragbit-594" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = b[0] * p0 + b[1] * p1 + b[2] * p2;
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesurfacenormalforsampledpointontriangle-0">Compute surface normal for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-595" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-595"><i></i></a><div id="fragbit-595" class="collapse"><div class="fragmentcode">                 <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
                 if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
                     <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(b[0] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + b[1] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] +
                                 (1 - b[0] - b[1]) * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
                     <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
                 } else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
                     <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div></div>
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeuvforsampledpointontriangle-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-596" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-596"><i></i></a><div id="fragbit-596" class="collapse"><div class="fragmentcode">                 &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-597" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-597"><i></i></a><div id="fragbit-597" class="collapse"><div class="fragmentcode">                    pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
                        mesh-&gt;uv
                            ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                                  {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
                            : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
                 <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvSample = b[0] * uv[0] + b[1] * uv[1] + b[2] * uv[2];</div></div>
              return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(Point3fi(p, pError), n, ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>, uvSample),
                                 pdf};</div></div>
       }
       Float PDF(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi) const {
           Float solidAngle = <a href="#Triangle::SolidAngle" class="code">SolidAngle</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>());
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnPDFbasedonuniformareasamplingforchallengingtriangles-0">Return PDF based on uniform area sampling for challenging triangles</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-598" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-598"><i></i></a><div id="fragbit-598" class="collapse"><div class="fragmentcode">              if (solidAngle &lt; <a href="#Triangle::MinSphericalSampleArea" class="code">MinSphericalSampleArea</a> ||
                  solidAngle &gt; <a href="#Triangle::MaxSphericalSampleArea" class="code">MaxSphericalSampleArea</a>) {
                  &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Intersectsampleraywithshapegeometry-0">Intersect sample ray with shape geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-599" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-599"><i></i></a><div id="fragbit-599" class="collapse"><div class="fragmentcode">                     <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> ray = ctx.<a href="../Shapes/Managing_Rounding_Error.html#ShapeSampleContext::SpawnRay" class="code">SpawnRay</a>(wi);
                     pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; isect = <a href="../Shapes/Spheres.html#Sphere::Intersect" class="code">Intersect</a>(ray);
                     if (!isect) return 0;</div></div>
                  &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ComputePDFinsolidanglemeasurefromshapeintersectionpoint-0">Compute PDF in solid angle measure from shape intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-600" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-600"><i></i></a><div id="fragbit-600" class="collapse"><div class="fragmentcode">                     Float pdf = (1 / <a href="../Shapes/Spheres.html#Sphere::Area" class="code">Area</a>()) / (<a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                                                 <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>()));
                     if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(pdf)) pdf = 0;</div></div>
                  return pdf;
              }</div></div>
           Float pdf = 1 / solidAngle;
           &lt;&lt;<span class="fragmentname"><a href="#fragment-AdjustPDFforwarpproductsamplingoftrianglecosthetafactor-0">Adjust PDF for warp product sampling of triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-601" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-601"><i></i></a><div id="fragbit-601" class="collapse"><div class="fragmentcode">              if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-602" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-602"><i></i></a><div id="fragbit-602" class="collapse"><div class="fragmentcode">                     const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
                     const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
                     <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
                  <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u = <a href="#InvertSphericalTriangleSample" class="code">InvertSphericalTriangleSample</a>({p0, p1, p2}, ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>(), wi);
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-603" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-603"><i></i></a><div id="fragbit-603" class="collapse"><div class="fragmentcode">                     <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
                     <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                                       <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
                     pstd::array&lt;Float, 4&gt; w =
                         pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                               std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                               std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                               std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
                  pdf *= <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
              }</div></div>
           return pdf;
       }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-TrianglePrivateMethods-0">Triangle Private Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-604" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-604"><i></i></a><div id="fragbit-604" class="collapse"><div class="fragmentcode">       const <a href="#TriangleMesh" class="code">TriangleMesh</a> *GetMesh() const {
           return (*allMeshes)[meshIndex];
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-TrianglePrivateMembers-0">Triangle Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-605" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-605"><i></i></a><div id="fragbit-605" class="collapse"><div class="fragmentcode">       int meshIndex = -1, triIndex = -1;
       static pstd::vector&lt;const <a href="#TriangleMesh" class="code">TriangleMesh</a> *&gt; *allMeshes;
       static constexpr Float MinSphericalSampleArea = 3e-4;
       static constexpr Float MaxSphericalSampleArea = 6.22;</div></div>
};</div><p>


</p>
<p>

</p>
<p>Because complex scenes may have billions of triangles, it is important to
minimize the amount of memory that each triangle uses.  <tt>pbrt</tt> stores
pointers to all the <a href="#TriangleMesh"><tt>TriangleMesh</tt></a>es for the scene in a vector,
which allows each triangle to be represented using just two integers: one
to record which mesh it is a part of and another to record which triangle
in the mesh it represents.  With 4-byte <tt>int</tt>s, each <tt>Triangle</tt> uses
just 8 bytes of memory.

</p>
<p>Given this compact representation of triangles,
recall the discussion in Section&nbsp;<a href="../Introduction/Using_and_Understanding_the_Code.html#sec:dynamic-dispatch">1.5.7</a> about the
memory cost of classes with virtual functions: if <tt>Triangle</tt> inherited
from an abstract <tt>Shape</tt> base class that defined pure virtual
functions, the virtual function pointer with each <tt>Triangle</tt> alone
would double its size, assuming a 64-bit architecture with 8-byte pointers.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-0"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;=&nbsp;<a href="#fragment-TrianglePublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Triangle(int meshIndex, int triIndex)
    : meshIndex(meshIndex), triIndex(triIndex) {}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-TrianglePrivateMembers-0"></span><div class="fragmentname">&lt;&lt;Triangle Private Members&gt;&gt;=&nbsp;<a href="#fragment-TrianglePrivateMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">int <span class="anchor" id="Triangle::meshIndex"></span>meshIndex = -1, <span class="anchor" id="Triangle::triIndex"></span>triIndex = -1;
static pstd::vector&lt;const <a href="#TriangleMesh" class="code">TriangleMesh</a> *&gt; *<span class="anchor" id="Triangle::allMeshes"></span>allMeshes;</div><p>


</p>
<p>

</p>
<p>The bounding box of a triangle is easily found by computing a bounding box
that encompasses its three vertices.  Because the vertices have already
been transformed to rendering space, no transformation of the bounds is
necessary.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;Triangle Method Definitions&gt;&gt;=&nbsp;<a href="#fragment-TriangleMethodDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a> <span class="anchor" id="Triangle::Bounds"></span>Triangle::Bounds() const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-606" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-606"><i></i></a><div id="fragbit-606" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    return <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3::Union" class="code">Union</a>(<a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds3f" class="code">Bounds3f</a>(p0, p1), p2);
}</div><p>


</p>
<p>Finding the positions of the three triangle vertices requires some
indirection: first the mesh pointer must be found; then the indices of the
three triangle vertices can be found given the triangle&rsquo;s index in the
mesh; finally, the positions can be read from the mesh&rsquo;s <tt>p</tt> array.
We will reuse this fragment repeatedly in the following, as the vertex
positions are needed in many of the <tt>Triangle</tt> methods.

</p>
<p></p>
<span class="anchor" id="fragment-Gettriangleverticesinmonop0monop1andmonop2-0"></span><div class="fragmentname">&lt;&lt;Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div><p>


</p>
<p>The <tt>GetMesh()</tt> method encapsulates the indexing operation to get the
mesh&rsquo;s pointer.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePrivateMethods-0"></span><div class="fragmentname">&lt;&lt;Triangle Private Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">const <a href="#TriangleMesh" class="code">TriangleMesh</a> *<span class="anchor" id="Triangle::GetMesh"></span>GetMesh() const {
    return (*allMeshes)[meshIndex];
}</div><p>


</p>
<p>Using the fact that the area of a parallelogram is given by the length of
the cross product of the two vectors along its sides, the <tt>Area()</tt>
method computes the triangle area as half the area of the parallelogram
formed by two of its edge vectors (see Figure&nbsp;<a href="#fig:triangle-area">6.13</a>).

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-1"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TrianglePublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Triangle::Area"></span>Area() const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-607" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-607"><i></i></a><div id="fragbit-607" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    return 0.5f * <a href="../Geometry_and_Transformations/Vectors.html#Length" class="code">Length</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0));
}</div><p>


</p>
<p>

</p>
<p>Bounding the triangle&rsquo;s normal should be trivial: a cross product of
appropriate edges gives its single normal vector direction.  However, two
subtleties that affect the orientation of the normal must be handled before
the bounds are returned.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMethodDefinitions-1"></span><div class="fragmentname">&lt;&lt;Triangle Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-TriangleMethodDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TriangleMethodDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a> <span class="anchor" id="Triangle::NormalBounds"></span>Triangle::NormalBounds() const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-608" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-608"><i></i></a><div id="fragbit-608" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> n = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Ensurecorrectorientationofgeometricnormalfornormalbounds-0">Ensure correct orientation of geometric normal for normal bounds</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-609" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-609"><i></i></a><div id="fragbit-609" class="collapse"><div class="fragmentcode">       if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
           <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] + mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
           <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
       } else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
           <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div></div>
    return <a href="../Geometry_and_Transformations/Spherical_Geometry.html#DirectionCone" class="code">DirectionCone</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(n));
}</div><p>


</p>
<p>The first issue with the returned normal comes from the presence of
per-vertex normals, even though it is a bound on geometric normals that
<tt>NormalBounds()</tt> is supposed to return.  <tt>pbrt</tt> requires that both the
geometric normal and the interpolated per-vertex normal lie on the same
side of the surface.  If the two of them are on different sides, then
<tt>pbrt</tt> follows the convention that the geometric normal is the one that
should be flipped.

</p>
<p>Furthermore, if there are not per-vertex normals, then&mdash;as with earlier
shapes&mdash;the normal is flipped if either <tt>ReverseOrientation</tt> was
specified in the scene description or the rendering to object
transformation swaps the coordinate system handedness, but not both.  Both
of these considerations must be accounted for in the normal returned for the normal
bounds.

</p>
<p></p>
<span class="anchor" id="fragment-Ensurecorrectorientationofgeometricnormalfornormalbounds-0"></span><div class="fragmentname">&lt;&lt;Ensure correct orientation of geometric normal for normal bounds&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] + mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
    <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
} else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
    <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div><p>


</p>
<p>

</p>
<p>Although it is not required by the <tt>Shape</tt> interface, we will find it
useful to be able to compute the solid angle that a triangle subtends from
a reference point.  The previously defined <a href="../Geometry_and_Transformations/Spherical_Geometry.html#SphericalTriangleArea"><tt>SphericalTriangleArea()</tt></a>
function takes care of this directly.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-2"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TrianglePublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Triangle::SolidAngle"></span>SolidAngle(<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-610" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-610"><i></i></a><div id="fragbit-610" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    return <a href="../Geometry_and_Transformations/Spherical_Geometry.html#SphericalTriangleArea" class="code">SphericalTriangleArea</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - p), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - p),
                                 <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - p));
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#RayndashTriangleIntersection"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:ray-triangle"></span><span id="RayndashTriangleIntersection"></span><h3>6.5.3  Ray&ndash;Triangle Intersection</h3><p>



</p>
<p>

</p>
<p>Unlike the other shapes so far, <tt>pbrt</tt> provides a stand-alone triangle
intersection function that takes a ray and the three triangle vertices
directly.  Having this functionality available without needing to
instantiate both a <tt>Triangle</tt> and a <a href="#TriangleMesh"><tt>TriangleMesh</tt></a> in order to do
a ray&ndash;triangle intersection test is helpful in a few other parts of the
system.  The <a href="#Triangle"><tt>Triangle</tt></a> class intersection methods, described next, use this
function in their implementations.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleFunctions-0"></span><div class="fragmentname">&lt;&lt;Triangle Functions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">pstd::optional&lt;<a href="#TriangleIntersection" class="code">TriangleIntersection</a>&gt;
<span class="anchor" id="IntersectTriangle"></span>IntersectTriangle(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;ray, Float tMax, <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0, <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p1,
                  <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p2) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnnointersectioniftriangleisdegenerate-0">Return no intersection if triangle is degenerate</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-611" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-611"><i></i></a><div id="fragbit-611" class="collapse"><div class="fragmentcode">       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p2 - p0, p1 - p0)) == 0)
           return {};</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Transformtriangleverticestoraycoordinatespace-0">Transform triangle vertices to ray coordinate space</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-612" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-612"><i></i></a><div id="fragbit-612" class="collapse"><div class="fragmentcode">       &lt;&lt;<span class="fragmentname"><a href="#fragment-Translateverticesbasedonrayorigin-0">Translate vertices based on ray origin</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-613" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-613"><i></i></a><div id="fragbit-613" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0t = p0 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);
          <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p1t = p1 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);
          <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p2t = p2 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Permutecomponentsoftriangleverticesandraydirection-0">Permute components of triangle vertices and ray direction</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-614" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-614"><i></i></a><div id="fragbit-614" class="collapse"><div class="fragmentcode">          int kz = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentIndex" class="code">MaxComponentIndex</a>(Abs(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>));
          int kx = kz + 1; if (kx == 3) kx = 0;
          int ky = kx + 1; if (ky == 3) ky = 0;
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a> = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>, {kx, ky, kz});
          p0t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p0t, {kx, ky, kz});
          p1t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p1t, {kx, ky, kz});
          p2t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p2t, {kx, ky, kz});</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Applysheartransformationtotranslatedvertexpositions-0">Apply shear transformation to translated vertex positions</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-615" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-615"><i></i></a><div id="fragbit-615" class="collapse"><div class="fragmentcode">          Float Sx = -d.x / d.z;
          Float Sy = -d.y / d.z;
          Float Sz = 1 / d.z;
          p0t.x += Sx * p0t.z;
          p0t.y += Sy * p0t.z;
          p1t.x += Sx * p1t.z;
          p1t.y += Sy * p1t.z;
          p2t.x += Sx * p2t.z;
          p2t.y += Sy * p2t.z;</div></div></div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeedgefunctioncoefficientsmonoe0monoe1andmonoe2-0">Compute edge function coefficients <tt>e0</tt>, <tt>e1</tt>, and <tt>e2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-616" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-616"><i></i></a><div id="fragbit-616" class="collapse"><div class="fragmentcode">       Float e0 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(p1t.x, p2t.y, p1t.y, p2t.x);
       Float e1 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(p2t.x, p0t.y, p2t.y, p0t.x);
       Float e2 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(p0t.x, p1t.y, p0t.y, p1t.x);</div></div>
    &lt;&lt;<span class="fragmentname">Fall back to double-precision test at triangle edges</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-617" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-617"><i></i></a><div id="fragbit-617" class="collapse"><div class="fragmentcode">       if (sizeof(Float) == sizeof(float) &amp;&amp;
           (e0 == 0.0f || e1 == 0.0f || e2 == 0.0f)) {
           double p2txp1ty = (double)p2t.x * (double)p1t.y;
           double p2typ1tx = (double)p2t.y * (double)p1t.x;
           e0 = (float)(p2typ1tx - p2txp1ty);
           double p0txp2ty = (double)p0t.x * (double)p2t.y;
           double p0typ2tx = (double)p0t.y * (double)p2t.x;
           e1 = (float)(p0typ2tx - p0txp2ty);
           double p1txp0ty = (double)p1t.x * (double)p0t.y;
           double p1typ0tx = (double)p1t.y * (double)p0t.x;
           e2 = (float)(p1typ0tx - p1txp0ty);
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Performtriangleedgeanddeterminanttests-0">Perform triangle edge and determinant tests</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-618" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-618"><i></i></a><div id="fragbit-618" class="collapse"><div class="fragmentcode">       if ((e0 &lt; 0 || e1 &lt; 0 || e2 &lt; 0) &amp;&amp; (e0 &gt; 0 || e1 &gt; 0 || e2 &gt; 0))
           return {};
       Float det = e0 + e1 + e2;
       if (det == 0)
           return {};</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computescaledhitdistancetotriangleandtestagainstraytrange-0">Compute scaled hit distance to triangle and test against ray <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> range</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-619" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-619"><i></i></a><div id="fragbit-619" class="collapse"><div class="fragmentcode">       p0t.z *= Sz;
       p1t.z *= Sz;
       p2t.z *= Sz;
       Float tScaled = e0 * p0t.z + e1 * p1t.z + e2 * p2t.z;
       if (det &lt; 0 &amp;&amp; (tScaled &gt;= 0 || tScaled &lt; tMax * det))
           return {};
       else if (det &gt; 0 &amp;&amp; (tScaled &lt;= 0 || tScaled &gt; tMax * det))
           return {};</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computebarycentriccoordinatesandtvaluefortriangleintersection-0">Compute barycentric coordinates and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value for triangle intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-620" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-620"><i></i></a><div id="fragbit-620" class="collapse"><div class="fragmentcode">       Float invDet = 1 / det;
       Float b0 = e0 * invDet, b1 = e1 * invDet, b2 = e2 * invDet;
       Float t = tScaled * invDet;
       </div></div>
    &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Ensurethatcomputedtriangletisconservativelygreaterthanzero-0">Ensure that computed triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> is conservatively greater than zero</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-621" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-621"><i></i></a><div id="fragbit-621" class="collapse"><div class="fragmentcode">       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computedelta_ztermfortriangleterrorbounds-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.032ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 875.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">delta Subscript z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FF" d="M452 667c0 -6 -2 -12 -5 -18c-7 -13 -22 -22 -36 -22c-3 0 -7 1 -11 2c-38 16 -66 48 -111 50c-11 0 -21 -1 -32 -6c-9 -5 -17 -14 -22 -23c-3 -5 -4 -11 -4 -17c0 -45 63 -124 107 -181c28 -35 49 -75 58 -122c2 -15 3 -30 3 -46c0 -33 -5 -68 -14 -102 c-24 -98 -96 -193 -184 -193c-56 0 -103 26 -130 68c-19 29 -28 63 -28 100c0 20 2 40 8 61c14 58 48 115 98 158c35 30 75 51 116 60c-30 56 -61 120 -61 173c0 19 3 36 12 51c7 14 18 26 31 34c14 9 29 13 43 16c8 1 17 2 26 2c36 0 78 -10 115 -19c13 -3 21 -13 21 -26z M330 244c0 17 -1 34 -5 50c-8 42 -26 80 -46 116l-3 5c-31 -9 -62 -29 -86 -55c-40 -42 -60 -95 -73 -147c-7 -28 -13 -57 -13 -84c0 -22 4 -43 12 -61c15 -34 45 -57 86 -57c63 0 99 79 118 152c7 27 10 55 10 81Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="628" y="-213"></use>
</g>
</svg> term for triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> error bounds</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-622" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-622"><i></i></a><div id="fragbit-622" class="collapse"><div class="fragmentcode">          Float maxZt = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentValue" class="code">MaxComponentValue</a>(<a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(p0t.z, p1t.z, p2t.z)));
          Float deltaZ = gamma(3) * maxZt;</div></div>
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computedelta_xanddelta_ytermsfortriangleterrorbounds-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.205ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 949.3 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">delta Subscript x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FF" d="M452 667c0 -6 -2 -12 -5 -18c-7 -13 -22 -22 -36 -22c-3 0 -7 1 -11 2c-38 16 -66 48 -111 50c-11 0 -21 -1 -32 -6c-9 -5 -17 -14 -22 -23c-3 -5 -4 -11 -4 -17c0 -45 63 -124 107 -181c28 -35 49 -75 58 -122c2 -15 3 -30 3 -46c0 -33 -5 -68 -14 -102 c-24 -98 -96 -193 -184 -193c-56 0 -103 26 -130 68c-19 29 -28 63 -28 100c0 20 2 40 8 61c14 58 48 115 98 158c35 30 75 51 116 60c-30 56 -61 120 -61 173c0 19 3 36 12 51c7 14 18 26 31 34c14 9 29 13 43 16c8 1 17 2 26 2c36 0 78 -10 115 -19c13 -3 21 -13 21 -26z M330 244c0 17 -1 34 -5 50c-8 42 -26 80 -46 116l-3 5c-31 -9 -62 -29 -86 -55c-40 -42 -60 -95 -73 -147c-7 -28 -13 -57 -13 -84c0 -22 4 -43 12 -61c15 -34 45 -57 86 -57c63 0 99 79 118 152c7 27 10 55 10 81Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="628" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.07ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 891.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">delta Subscript y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FF" d="M452 667c0 -6 -2 -12 -5 -18c-7 -13 -22 -22 -36 -22c-3 0 -7 1 -11 2c-38 16 -66 48 -111 50c-11 0 -21 -1 -32 -6c-9 -5 -17 -14 -22 -23c-3 -5 -4 -11 -4 -17c0 -45 63 -124 107 -181c28 -35 49 -75 58 -122c2 -15 3 -30 3 -46c0 -33 -5 -68 -14 -102 c-24 -98 -96 -193 -184 -193c-56 0 -103 26 -130 68c-19 29 -28 63 -28 100c0 20 2 40 8 61c14 58 48 115 98 158c35 30 75 51 116 60c-30 56 -61 120 -61 173c0 19 3 36 12 51c7 14 18 26 31 34c14 9 29 13 43 16c8 1 17 2 26 2c36 0 78 -10 115 -19c13 -3 21 -13 21 -26z M330 244c0 17 -1 34 -5 50c-8 42 -26 80 -46 116l-3 5c-31 -9 -62 -29 -86 -55c-40 -42 -60 -95 -73 -147c-7 -28 -13 -57 -13 -84c0 -22 4 -43 12 -61c15 -34 45 -57 86 -57c63 0 99 79 118 152c7 27 10 55 10 81Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="628" y="-213"></use>
</g>
</svg> terms for triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> error bounds</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-623" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-623"><i></i></a><div id="fragbit-623" class="collapse"><div class="fragmentcode">          Float maxXt = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentValue" class="code">MaxComponentValue</a>(<a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(p0t.x, p1t.x, p2t.x)));
          Float maxYt = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentValue" class="code">MaxComponentValue</a>(<a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(p0t.y, p1t.y, p2t.y)));
          Float deltaX = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(5) * (maxXt + maxZt);
          Float deltaY = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(5) * (maxYt + maxZt);</div></div>
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computedelta_etermfortriangleterrorbounds-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.031ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 874.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">delta Subscript e</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FF" d="M452 667c0 -6 -2 -12 -5 -18c-7 -13 -22 -22 -36 -22c-3 0 -7 1 -11 2c-38 16 -66 48 -111 50c-11 0 -21 -1 -32 -6c-9 -5 -17 -14 -22 -23c-3 -5 -4 -11 -4 -17c0 -45 63 -124 107 -181c28 -35 49 -75 58 -122c2 -15 3 -30 3 -46c0 -33 -5 -68 -14 -102 c-24 -98 -96 -193 -184 -193c-56 0 -103 26 -130 68c-19 29 -28 63 -28 100c0 20 2 40 8 61c14 58 48 115 98 158c35 30 75 51 116 60c-30 56 -61 120 -61 173c0 19 3 36 12 51c7 14 18 26 31 34c14 9 29 13 43 16c8 1 17 2 26 2c36 0 78 -10 115 -19c13 -3 21 -13 21 -26z M330 244c0 17 -1 34 -5 50c-8 42 -26 80 -46 116l-3 5c-31 -9 -62 -29 -86 -55c-40 -42 -60 -95 -73 -147c-7 -28 -13 -57 -13 -84c0 -22 4 -43 12 -61c15 -34 45 -57 86 -57c63 0 99 79 118 152c7 27 10 55 10 81Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D452" x="628" y="-213"></use>
</g>
</svg> term for triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> error bounds</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-624" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-624"><i></i></a><div id="fragbit-624" class="collapse"><div class="fragmentcode">          Float deltaE = 2 * (<a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(2) * maxXt * maxYt + deltaY * maxXt +
                              deltaX * maxYt);</div></div>
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-Computedelta_ttermfortriangleterrorboundsandcheckmonot-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.858ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 800.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">delta Subscript t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FF" d="M452 667c0 -6 -2 -12 -5 -18c-7 -13 -22 -22 -36 -22c-3 0 -7 1 -11 2c-38 16 -66 48 -111 50c-11 0 -21 -1 -32 -6c-9 -5 -17 -14 -22 -23c-3 -5 -4 -11 -4 -17c0 -45 63 -124 107 -181c28 -35 49 -75 58 -122c2 -15 3 -30 3 -46c0 -33 -5 -68 -14 -102 c-24 -98 -96 -193 -184 -193c-56 0 -103 26 -130 68c-19 29 -28 63 -28 100c0 20 2 40 8 61c14 58 48 115 98 158c35 30 75 51 116 60c-30 56 -61 120 -61 173c0 19 3 36 12 51c7 14 18 26 31 34c14 9 29 13 43 16c8 1 17 2 26 2c36 0 78 -10 115 -19c13 -3 21 -13 21 -26z M330 244c0 17 -1 34 -5 50c-8 42 -26 80 -46 116l-3 5c-31 -9 -62 -29 -86 -55c-40 -42 -60 -95 -73 -147c-7 -28 -13 -57 -13 -84c0 -22 4 -43 12 -61c15 -34 45 -57 86 -57c63 0 99 79 118 152c7 27 10 55 10 81Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D461" x="628" y="-213"></use>
</g>
</svg> term for triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> error bounds and check <tt>t</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-625" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-625"><i></i></a><div id="fragbit-625" class="collapse"><div class="fragmentcode">          Float maxE = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentValue" class="code">MaxComponentValue</a>(<a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(e0, e1, e2)));
          Float deltaT = 3 * (<a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(3) * maxE * maxZt + deltaE * maxZt +
                              deltaZ * maxE) * std::abs(invDet);
          if (t &lt;= deltaT)
              return {};</div></div></div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoTriangleIntersectionforintersection-0">Return <tt>TriangleIntersection</tt> for intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-626" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-626"><i></i></a><div id="fragbit-626" class="collapse"><div class="fragmentcode">       return TriangleIntersection{b0, b1, b2, t};</div></div>
}</div><p>


</p>
<p><tt>pbrt</tt>&rsquo;s ray&ndash;triangle intersection test is based on first computing an
affine transformation that transforms the ray such that its origin is at
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg> in the transformed coordinate system and such that its direction
is along the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.894ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1246 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="778" y="0"></use>
</g>
</svg> axis.  Triangle vertices are also transformed into this
coordinate system before the intersection test is performed. In the
following, we will see that applying this coordinate system transformation
simplifies the intersection test logic since, for example, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>
coordinates of any intersection point must be zero.  Later, in 
Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:robust-ray-tri">6.8.4</a>, we will see that this transformation makes
it possible to have a <em>watertight</em> ray&ndash;triangle intersection
algorithm, such that intersections with tricky rays like those that hit the
triangle right on the edge are never incorrectly reported as misses. 

</p>
<p>One side effect of the transformation that we will apply to the vertices is
that, due to floating-point round-off error, a degenerate triangle
may be transformed into a non-degenerate triangle.  If an intersection
is reported with a degenerate triangle, then later code that tries to
compute the geometric properties of the intersection will be unable to
compute valid results.  Therefore, this function starts with testing for a
degenerate triangle and returning immediately if one was provided.

</p>
<p></p>
<span class="anchor" id="fragment-Returnnointersectioniftriangleisdegenerate-0"></span><div class="fragmentname">&lt;&lt;Return no intersection if triangle is degenerate&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p2 - p0, p1 - p0)) == 0)
    return {};</div><p>


</p>
<p>There are three steps to computing the transformation from rendering space
to the ray&ndash;triangle intersection coordinate space: a translation
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.859ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 800.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
</g>
</svg>, a coordinate permutation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 786.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper P</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40F" d="M721 491c0 -117 -116 -189 -255 -189h-177v-255h108v-47c-38 3 -136 3 -179 3s-141 0 -179 -3v47h108v592h-108v47h417c166 0 265 -85 265 -195zM568 491c0 72 0 148 -150 148h-135v-296h134c151 0 151 77 151 148Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40F" x="0" y="0"></use>
</g>
</svg>, and a shear
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
</g>
</svg>. Rather than computing explicit transformation matrices for
each of these and then computing an aggregate transformation matrix
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.807ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 4653.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper M equals bold upper S bold upper P bold upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40C" d="M1051 0c-36 3 -130 3 -171 3s-134 0 -170 -3v47h108v592h-1l-279 -615c-4 -9 -12 -24 -32 -24c-11 0 -23 5 -32 25l-272 601h-1v-550c0 -22 1 -23 30 -26c18 -2 35 -3 53 -3h25v-47c-41 3 -93 3 -135 3c-39 0 -96 0 -134 -3v47h25c28 0 30 0 54 3c28 3 29 4 29 26v563 h-108v47h222c22 0 33 0 44 -25l240 -529l240 529c11 25 22 25 44 25h221v-47h-108v-592h108v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40F" d="M721 491c0 -117 -116 -189 -255 -189h-177v-255h108v-47c-38 3 -136 3 -179 3s-141 0 -179 -3v47h108v592h-108v47h417c166 0 265 -85 265 -195zM568 491c0 72 0 148 -150 148h-135v-296h134c151 0 151 77 151 148Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1370" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="2426" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40F" x="3066" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="3852" y="0"></use>
</g>
</svg> to transform vertices to the
coordinate space, the following implementation applies each step of the
transformation directly, which ends up being a more efficient approach.

</p>
<p></p>
<span class="anchor" id="fragment-Transformtriangleverticestoraycoordinatespace-0"></span><div class="fragmentname">&lt;&lt;Transform triangle vertices to ray coordinate space&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname"><a href="#fragment-Translateverticesbasedonrayorigin-0">Translate vertices based on ray origin</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-627" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-627"><i></i></a><div id="fragbit-627" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0t = p0 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);
   <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p1t = p1 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);
   <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p2t = p2 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Permutecomponentsoftriangleverticesandraydirection-0">Permute components of triangle vertices and ray direction</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-628" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-628"><i></i></a><div id="fragbit-628" class="collapse"><div class="fragmentcode">   int kz = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentIndex" class="code">MaxComponentIndex</a>(Abs(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>));
   int kx = kz + 1; if (kx == 3) kx = 0;
   int ky = kx + 1; if (ky == 3) ky = 0;
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a> = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>, {kx, ky, kz});
   p0t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p0t, {kx, ky, kz});
   p1t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p1t, {kx, ky, kz});
   p2t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p2t, {kx, ky, kz});</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Applysheartransformationtotranslatedvertexpositions-0">Apply shear transformation to translated vertex positions</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-629" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-629"><i></i></a><div id="fragbit-629" class="collapse"><div class="fragmentcode">   Float Sx = -d.x / d.z;
   Float Sy = -d.y / d.z;
   Float Sz = 1 / d.z;
   p0t.x += Sx * p0t.z;
   p0t.y += Sy * p0t.z;
   p1t.x += Sx * p1t.z;
   p1t.y += Sy * p1t.z;
   p2t.x += Sx * p2t.z;
   p2t.y += Sy * p2t.z;</div></div></div><p>


</p>
<p>The translation that places the ray origin at the origin of
the coordinate system&nbsp;is:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.021ex" height="12.843ex" style="vertical-align: -5.838ex;" viewBox="0 -3015.9 10772.9 5529.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper T equals Start 4 By 4 Matrix 1st Row 1st Column 1 2nd Column 0 3rd Column 0 4th Column minus normal o Subscript x Baseline 2nd Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column minus normal o Subscript y Baseline 3rd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column minus normal o Subscript z Baseline 4th Row 1st Column 0 2nd Column 0 3rd Column 0 4th Column 1 EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D413" d="M757 434h-47c-10 114 -20 194 -163 194h-76v-581h153v-47c-54 3 -165 3 -224 3s-170 0 -224 -3v47h153v581h-77c-144 0 -154 -81 -163 -194h-47l21 241h673Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D413" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1078" y="0"></use>
<g transform="translate(2134,0)">
<g transform="translate(0,2897)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-3843.8606689305802) scale(1,4.803327993848858)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-5295"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="2097"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="697"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-798"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2198"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2097"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="697"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-798"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2198"></use>
</g>
<g transform="translate(2990,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2097"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="697"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-798"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2198"></use>
</g>
<g transform="translate(4491,0)">
<g transform="translate(0,2097)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="707" y="-213"></use>
</g>
</g>
<g transform="translate(28,697)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="707" y="-213"></use>
</g>
</g>
<g transform="translate(37,-798)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="707" y="-213"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="641" y="-2198"></use>
</g>
</g>
<g transform="translate(7484,2897)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-3843.8606689305802) scale(1,4.803327993848858)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-5295"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="10494" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>This transformation does not need to be explicitly applied to the ray
origin, but we will apply it to the three triangle vertices.
 
</p>
<span class="anchor" id="fragment-Translateverticesbasedonrayorigin-0"></span><div class="fragmentname">&lt;&lt;Translate vertices based on ray origin&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0t = p0 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);
<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p1t = p1 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);
<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p2t = p2 - <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::o" class="code">o</a>);</div><p>


</p>
<p>Next, the three dimensions of the space are permuted so that the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> dimension
is the one where the absolute value of the ray&rsquo;s direction is largest.  The
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> dimensions are arbitrarily assigned to the other two
dimensions.  This step ensures that if, for example, the original ray&rsquo;s
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> direction is zero, then a dimension with nonzero magnitude is mapped
to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.894ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1246 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="778" y="0"></use>
</g>
</svg>.

</p>
<p>For example, if the ray&rsquo;s direction had the largest magnitude in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, the
permutation would&nbsp;be:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.008ex" height="12.509ex" style="vertical-align: -5.671ex;" viewBox="0 -2944.1 9475.6 5385.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper P equals Start 4 By 4 Matrix 1st Row 1st Column 0 2nd Column 1 3rd Column 0 4th Column 0 2nd Row 1st Column 0 2nd Column 0 3rd Column 1 4th Column 0 3rd Row 1st Column 1 2nd Column 0 3rd Column 0 4th Column 0 4th Row 1st Column 0 2nd Column 0 3rd Column 0 4th Column 1 EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D40F" d="M721 491c0 -117 -116 -189 -255 -189h-177v-255h108v-47c-38 3 -136 3 -179 3s-141 0 -179 -3v47h108v592h-108v47h417c166 0 265 -85 265 -195zM568 491c0 72 0 148 -150 148h-135v-296h134c151 0 151 77 151 148Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D40F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1064" y="0"></use>
<g transform="translate(2120,0)">
<g transform="translate(0,2850)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-3748.388) scale(1,4.612)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-5199"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2050"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="650"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-750"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2150"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="2050"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="650"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-750"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2150"></use>
</g>
<g transform="translate(2990,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2050"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="650"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-750"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2150"></use>
</g>
<g transform="translate(4491,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2050"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="650"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-750"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-2150"></use>
</g>
</g>
<g transform="translate(6201,2850)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-3748.388) scale(1,4.612)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-5199"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="9197" y="0"></use>
</g>
</svg>
</div>
<p>

As before, it is easiest to permute the dimensions of the ray direction
and the translated triangle vertices directly.

</p>
<p></p>
<span class="anchor" id="fragment-Permutecomponentsoftriangleverticesandraydirection-0"></span><div class="fragmentname">&lt;&lt;Permute components of triangle vertices and ray direction&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">int kz = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::MaxComponentIndex" class="code">MaxComponentIndex</a>(Abs(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>));
int kx = kz + 1; if (kx == 3) kx = 0;
int ky = kx + 1; if (ky == 3) ky = 0;
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> <a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a> = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>, {kx, ky, kz});
p0t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p0t, {kx, ky, kz});
p1t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p1t, {kx, ky, kz});
p2t = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Permute" class="code">Permute</a>(p2t, {kx, ky, kz});</div><p>


</p>
<p>Finally, a shear transformation aligns the ray direction with the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.894ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1246 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="778" y="0"></use>
</g>
</svg>
axis:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.618ex" height="13.176ex" style="vertical-align: -6.005ex;" viewBox="0 -3087.6 12321.5 5673" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper S equals Start 4 By 4 Matrix 1st Row 1st Column 1 2nd Column 0 3rd Column minus bold d Subscript x Baseline slash bold d Subscript z Baseline 4th Column 0 2nd Row 1st Column 0 2nd Column 1 3rd Column minus bold d Subscript y Baseline slash bold d Subscript z Baseline 4th Column 0 3rd Row 1st Column 0 2nd Column 0 3rd Column 1 slash bold d Subscript z Baseline 4th Column 0 4th Row 1st Column 0 2nd Column 0 3rd Column 0 4th Column 1 EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D412" d="M574 203c0 -101 -62 -214 -227 -214c-41 0 -134 6 -200 55l-46 -46c-8 -7 -10 -9 -19 -9c-18 0 -18 9 -18 28v182c0 23 0 29 24 29c22 0 22 -5 23 -23c8 -149 160 -169 236 -169c104 0 130 69 130 117c0 46 -25 72 -40 87c-22 21 -39 24 -127 43c-109 24 -143 31 -192 80 c-21 22 -54 68 -54 133c0 105 72 201 224 201c48 0 113 -9 171 -55l45 44c11 10 12 11 20 11c18 0 18 -9 18 -28v-183c0 -23 0 -28 -24 -28c-21 0 -21 2 -25 26c-23 136 -124 170 -204 170c-100 0 -128 -62 -128 -105c0 -61 56 -95 96 -104l145 -31 c91 -19 172 -100 172 -211Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41D" d="M601 0l-183 -6v49c-31 -25 -79 -49 -140 -49c-148 0 -240 95 -240 227c0 141 105 229 251 229c33 0 85 -6 135 -45v195c0 39 -7 39 -69 39v47l177 8v-608c0 -39 7 -39 69 -39v-47zM418 103v250c-22 29 -62 61 -119 61c-31 0 -78 -10 -107 -52c-26 -39 -26 -93 -26 -141 c0 -70 0 -191 122 -191c76 0 117 55 130 73Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D412" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="917" y="0"></use>
<g transform="translate(1973,0)">
<g transform="translate(0,2948)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-3945.65666893058) scale(1,5.0073279938488575)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-5397"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="2148"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="697"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-798"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2249"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2148"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="697"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-798"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-2249"></use>
</g>
<g transform="translate(2990,0)">
<g transform="translate(0,2148)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="904" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1922" y="0"></use>
<g transform="translate(2423,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="904" y="-213"></use>
</g>
</g>
<g transform="translate(28,697)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="904" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1864" y="0"></use>
<g transform="translate(2365,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="904" y="-213"></use>
</g>
</g>
<g transform="translate(711,-798)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
<g transform="translate(1001,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="904" y="-213"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1496" y="-2249"></use>
</g>
<g transform="translate(7483,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="2148"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="697"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-798"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-2249"></use>
</g>
</g>
<g transform="translate(9193,2948)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-3945.65666893058) scale(1,5.0073279938488575)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-5397"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="12042" y="0"></use>
</g>
</svg>
</div>
<p>

To see how this transformation works, consider its operation on the ray
direction vector <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.673ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 5456.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket bold d Subscript x Baseline bold d Subscript y Baseline bold d Subscript z Baseline 0 right-bracket Superscript upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41D" d="M601 0l-183 -6v49c-31 -25 -79 -49 -140 -49c-148 0 -240 95 -240 227c0 141 105 229 251 229c33 0 85 -6 135 -45v195c0 39 -7 39 -69 39v47l177 8v-608c0 -39 7 -39 69 -39v-47zM418 103v250c-22 29 -62 61 -119 61c-31 0 -78 -10 -107 -52c-26 -39 -26 -93 -26 -141 c0 -70 0 -191 122 -191c76 0 117 55 130 73Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="904" y="-213"></use>
</g>
<g transform="translate(1589,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="904" y="-213"></use>
</g>
<g transform="translate(2842,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="904" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="4079" y="0"></use>
<g transform="translate(4579,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="513"></use>
</g>
</g>
</svg>.

</p>
<p>For now, only the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> dimensions are sheared; we can wait and shear
the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> dimension only if the ray intersects the triangle.

</p>
<p></p>
<span class="anchor" id="fragment-Applysheartransformationtotranslatedvertexpositions-0"></span><div class="fragmentname">&lt;&lt;Apply shear transformation to translated vertex positions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float Sx = -d.x / d.z;
Float Sy = -d.y / d.z;
Float Sz = 1 / d.z;
p0t.x += Sx * p0t.z;
p0t.y += Sy * p0t.z;
p1t.x += Sx * p1t.z;
p1t.y += Sy * p1t.z;
p2t.x += Sx * p2t.z;
p2t.y += Sy * p2t.z;</div><p>


</p>
<p>Note that the calculations for the coordinate permutation and the shear
coefficients only depend on the given ray; they are independent of the
triangle.  In a high-performance ray tracer, it may be worthwhile to
compute these values once and store them in the <tt>Ray</tt> class, rather
than recomputing them for each triangle the ray is intersected with.

</p>
<p>With the triangle vertices transformed to this coordinate system, our task
now is to find whether the ray starting from the origin and traveling along the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.894ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1246 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="778" y="0"></use>
</g>
</svg> axis intersects the transformed triangle. Because of the way the
coordinate system was constructed, this problem is equivalent to the 2D
problem of determining if the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> coordinates <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg> are inside the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> projection of the triangle (Figure&nbsp;<a href="#fig:tri-intersect-2d">6.12</a>).

</p>
<p></p>
<span class="anchor" id="fig:tri-intersect-2d"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f12.svg" title=""><img src="pha06f12.svg" width=390 height=197 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.12: <span class="legend"> 
In the ray&ndash;triangle intersection coordinate system, the ray starts at the
origin and goes along the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.894ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1246 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="778" y="0"></use>
</g>
</svg> axis.  The intersection test can be
performed by considering only the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> projection of the ray and the
triangle vertices, which in turn reduces to determining if the 2D point
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg> is within the triangle. 
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>To understand how the intersection algorithm works, first recall from
Figure&nbsp;<a href="../Geometry_and_Transformations/Vectors.html#fig:parallelogram-area">3.6</a> that the length of the cross product of two vectors
gives the area of the parallelogram that they define.  In 2D, with vectors
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg>, the area is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.477ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 5802.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a Subscript x Baseline bold b Subscript y Baseline minus bold b Subscript x Baseline bold a Subscript y Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="791" y="-213"></use>
<g transform="translate(1064,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="904" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2372" y="0"></use>
<g transform="translate(3373,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="904" y="-213"></use>
</g>
<g transform="translate(4517,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="791" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="5524" y="0"></use>
</g>
</svg>
</div>
<p>

Half of this area is the area of the triangle that they define.  Thus, we
can see that in 2D, the area of a triangle with vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
</g>
</svg>,
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</svg> is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.217ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 23343.3 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">one-half left-parenthesis left-parenthesis normal p 1 Subscript x Baseline minus normal p 0 Subscript x Baseline right-parenthesis left-parenthesis normal p 2 Subscript y Baseline minus normal p 0 Subscript y Baseline right-parenthesis minus left-parenthesis normal p 2 Subscript x Baseline minus normal p 0 Subscript x Baseline right-parenthesis left-parenthesis normal p 1 Subscript y Baseline minus normal p 0 Subscript y Baseline right-parenthesis right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-28" d="M395 -336c0 -6 -5 -11 -11 -11c-3 0 -5 1 -7 2c-127 96 -246 330 -246 531v128c0 201 119 435 246 531c2 1 4 2 7 2c6 0 11 -5 11 -11c0 -4 -2 -7 -4 -9c-120 -90 -202 -324 -202 -513v-128c0 -189 82 -423 202 -513c2 -2 4 -5 4 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-29" d="M327 186c0 -201 -119 -435 -246 -531c-2 -1 -4 -2 -7 -2c-6 0 -11 5 -11 11c0 4 2 7 4 9c120 90 202 324 202 513v128c0 189 -82 423 -202 513c-2 2 -4 5 -4 9c0 6 5 11 11 11c3 0 5 -1 7 -2c127 -96 246 -330 246 -531v-128Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="60" y="-687"></use>
</g>
<g transform="translate(860,0)">
 <use xlink:href="#E1-LATINMODERNSIZE2-28"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="458" y="0"></use>
<g transform="translate(848,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2585" y="0"></use>
<g transform="translate(3586,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5101" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5490" y="0"></use>
<g transform="translate(5880,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="7559" y="0"></use>
<g transform="translate(8560,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10017" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10629" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="11630" y="0"></use>
<g transform="translate(12019,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="13757" y="0"></use>
<g transform="translate(14757,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="16273" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="16662" y="0"></use>
<g transform="translate(17052,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="18731" y="0"></use>
<g transform="translate(19732,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="21189" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE2-29" x="21579" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="23064" y="0"></use>
</g>
</svg>
</div>
<p>

Figure&nbsp;<a href="#fig:triangle-area">6.13</a> visualizes this idea geometrically.

</p>
<p></p>
<span class="anchor" id="fig:triangle-area"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f13.svg" title=""><img src="pha06f13.svg" width=444 height=292 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.13: <span class="legend"> The area of a triangle with two edges given
by vectors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.465ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1061.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="859" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.465ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1061.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="-213"></use>
</g>
</svg> is one-half of the area of the parallelogram
shown here.  The
parallelogram area is given by the length of the cross product of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.465ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1061.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="859" y="-213"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.465ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1061.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold v 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42F" d="M580 397c-64 0 -68 -7 -74 -21l-166 -356c-10 -21 -20 -24 -37 -24c-13 0 -26 0 -38 25l-175 376h-64v47l114 -3l124 3v-47h-54l127 -273l116 250c5 10 5 12 5 12c0 8 -29 11 -48 11v47l91 -3c25 0 54 1 79 3v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="859" y="-213"></use>
</g>
</svg>.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>We will use this expression of triangle area to define a signed <em>edge
function</em>: given two triangle vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
</g>
</svg>, we can
define the directed edge function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.083ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 466.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
</g>
</svg> as the function that gives twice the area
of the triangle given by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
</g>
</svg>, and a given third point
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:edge-function"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.877ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 23627.3 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e left-parenthesis normal p Subscript Baseline right-parenthesis equals left-parenthesis normal p 1 Subscript x Baseline minus normal p 0 Subscript x Baseline right-parenthesis left-parenthesis normal p Subscript Baseline Subscript y Baseline minus normal p 0 Subscript y Baseline right-parenthesis minus left-parenthesis normal p Subscript Baseline Subscript x Baseline minus normal p 0 Subscript x Baseline right-parenthesis left-parenthesis normal p 1 Subscript y Baseline minus normal p 0 Subscript y Baseline right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="466" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="856" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1412" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2079" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3136" y="0"></use>
<g transform="translate(3525,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5263" y="0"></use>
<g transform="translate(6263,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8168" y="0"></use>
<g transform="translate(8557,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="9783" y="0"></use>
<g transform="translate(10784,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="12241" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="12853" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="13853" y="0"></use>
<g transform="translate(14243,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="15526" y="0"></use>
<g transform="translate(16527,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="18042" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="18432" y="0"></use>
<g transform="translate(18821,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="20501" y="0"></use>
<g transform="translate(21502,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="22959" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="23348" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:edge-function">6.5</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

(See Figure&nbsp;<a href="#fig:tri-edge-function">6.14</a>.)

</p>
<p></p>
<span class="anchor" id="fig:tri-edge-function"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f14.svg" title=""><img src="pha06f14.svg" width=295 height=336 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.14: <span class="legend"> The edge function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.185ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1802 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e left-parenthesis normal p Subscript Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="466" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="856" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1412" y="0"></use>
</g>
</svg> characterizes points with
respect to an oriented line between two points <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
</g>
</svg>.
The value of the edge function is positive for points <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> to the right of the line,
zero for points on the line, and negative for points to the left of the
line.  The ray&ndash;triangle intersection algorithm uses an edge function that
is twice the signed area of the triangle formed by the three points.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The edge function gives a positive value for points to the left of the
line, and a negative value for points to the right.  Thus, if a point has
edge function values of the same sign for all three edges of a triangle, it
must be on the same side of all three edges and thus must be inside the
triangle.

</p>
<p>Thanks to the coordinate system transformation, the point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> that we
are testing has coordinates <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>.  This simplifies the edge function
expressions.  For example, for the edge <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.138ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 920.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
</g>
</svg> from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</svg>, we
have:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:edge-function-00"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="56.035ex" height="11.176ex" style="vertical-align: -5.005ex;" viewBox="0 -2657.1 24126.3 4811.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column e 0 left-parenthesis normal p Subscript Baseline right-parenthesis 2nd Column equals left-parenthesis normal p 2 Subscript x Baseline minus normal p 1 Subscript x Baseline right-parenthesis left-parenthesis normal p Subscript Baseline Subscript y Baseline minus normal p 1 Subscript y Baseline right-parenthesis minus left-parenthesis normal p Subscript Baseline Subscript x Baseline minus normal p 1 Subscript x Baseline right-parenthesis left-parenthesis normal p 2 Subscript y Baseline minus normal p 1 Subscript y Baseline right-parenthesis 2nd Row 1st Column Blank 2nd Column equals left-parenthesis normal p 2 Subscript x Baseline minus normal p 1 Subscript x Baseline right-parenthesis left-parenthesis minus normal p 1 Subscript y Baseline right-parenthesis minus left-parenthesis minus normal p 1 Subscript x Baseline right-parenthesis left-parenthesis normal p 2 Subscript y Baseline minus normal p 1 Subscript y Baseline right-parenthesis 3rd Row 1st Column Blank 2nd Column equals normal p 1 Subscript x Baseline normal p 2 Subscript y Baseline minus normal p 2 Subscript x Baseline normal p 1 Subscript y Baseline period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1714)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="920" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1309" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1866" y="0"></use>
</g>
</g>
<g transform="translate(2523,0)">
<g transform="translate(0,1714)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
<g transform="translate(1445,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3183" y="0"></use>
<g transform="translate(4183,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5699" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6088" y="0"></use>
<g transform="translate(6478,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="7703" y="0"></use>
<g transform="translate(8704,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10161" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10773" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="11774" y="0"></use>
<g transform="translate(12163,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="787" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="13447" y="0"></use>
<g transform="translate(14447,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15963" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="16352" y="0"></use>
<g transform="translate(16742,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="18421" y="0"></use>
<g transform="translate(19422,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="20879" y="0"></use>
</g>
<g transform="translate(0,38)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1056" y="0"></use>
<g transform="translate(1445,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3183" y="0"></use>
<g transform="translate(4183,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5699" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6088" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="6478" y="0"></use>
<g transform="translate(7256,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8713" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="9325" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10326" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10715" y="0"></use>
<g transform="translate(11494,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="13009" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="13399" y="0"></use>
<g transform="translate(13788,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="15468" y="0"></use>
<g transform="translate(16468,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="17926" y="0"></use>
</g>
<g transform="translate(0,-1639)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
<g transform="translate(2738,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4417" y="0"></use>
<g transform="translate(5418,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1428" y="-326"></use>
</g>
<g transform="translate(7100,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1428" y="-326"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="8557" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:edge-function-00">6.6</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>


</p>
<p>In the following, we will use the indexing scheme that the edge function
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.883ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 810.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="659" y="-213"></use>
</g>
</svg> corresponds to the directed edge from vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.173ex" height="2.509ex" style="vertical-align: -1.171ex;" viewBox="0 -576.1 4380.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript Baseline Subscript left-parenthesis i plus 1 right-parenthesis normal m normal o normal d 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
<g transform="translate(556,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="734" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1513" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-29" x="2014" y="0"></use>
<g transform="translate(1866,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-64" x="1334" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="4765" y="0"></use>
</g>
</g>
</svg>
to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.173ex" height="2.509ex" style="vertical-align: -1.171ex;" viewBox="0 -576.1 4380.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript Baseline Subscript left-parenthesis i plus 2 right-parenthesis normal m normal o normal d 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
<g transform="translate(556,-231)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="734" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="1513" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-29" x="2014" y="0"></use>
<g transform="translate(1866,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-64" x="1334" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="4765" y="0"></use>
</g>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-Computeedgefunctioncoefficientsmonoe0monoe1andmonoe2-0"></span><div class="fragmentname">&lt;&lt;Compute edge function coefficients <tt>e0</tt>, <tt>e1</tt>, and <tt>e2</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float e0 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(p1t.x, p2t.y, p1t.y, p2t.x);
Float e1 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(p2t.x, p0t.y, p2t.y, p0t.x);
Float e2 = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(p0t.x, p1t.y, p0t.y, p1t.x);</div><p>


</p>
<p>In the rare case that any of the edge function values is exactly zero, it
is not possible to be sure if the ray hits the triangle or not, and the
edge equations are reevaluated using double-precision floating-point
arithmetic. (Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:robust-ray-tri">6.8.4</a> discusses the need for this
step in more detail.)  The fragment that implements this computation,
&lt;&lt;<span class="fragmentname">Fall back to double-precision test at triangle edges</span>&gt;&gt;, is just a
reimplementation of &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeedgefunctioncoefficientsmonoe0monoe1andmonoe2-0">Compute edge function coefficients <tt>e0</tt>,
<tt>e1</tt>, and <tt>e2</tt></a></span>&gt;&gt; using <tt>double</tt>s and so is not included here.

</p>
<p>

</p>
<p>Given the values of the three edge functions, we have our first
two opportunities to determine that there is no intersection. First, if the
signs of the edge function values differ, then the point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg> is not on
the same side of all three edges and therefore is outside the triangle.
Second, if the sum of the three edge function values is zero, then the ray
is approaching the triangle edge-on, and we report no intersection.  (For a
closed triangle mesh, the ray will hit a neighboring triangle
instead.)
 
</p>
<span class="anchor" id="fragment-Performtriangleedgeanddeterminanttests-0"></span><div class="fragmentname">&lt;&lt;Perform triangle edge and determinant tests&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if ((e0 &lt; 0 || e1 &lt; 0 || e2 &lt; 0) &amp;&amp; (e0 &gt; 0 || e1 &gt; 0 || e2 &gt; 0))
    return {};
Float det = e0 + e1 + e2;
if (det == 0)
    return {};</div><p>


</p>
<p>Because the ray starts at the origin, has unit length, and is along the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.894ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1246 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="778" y="0"></use>
</g>
</svg> axis, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> coordinate value of the intersection point is equal
to the intersection&rsquo;s parametric <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value.  To compute this <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> value, we
first need to go ahead and apply the shear transformation to the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>
coordinates of the triangle vertices.  Given these <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> values, the
<em>barycentric coordinates</em> of the intersection point in the triangle
can be used to interpolate them across the triangle.  They are given by
dividing each edge function value by the sum of edge function values:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.473ex" height="5.009ex" style="vertical-align: -2.171ex;" viewBox="0 -1221.9 7953.5 2156.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b Subscript i Baseline equals StartFraction e Subscript i Baseline Over e 0 plus e 1 plus e 2 EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="607" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1051" y="0"></use>
<g transform="translate(1830,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5327" height="60" x="0" y="220"></rect>
<g transform="translate(2258,677)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="659" y="-213"></use>
</g>
<g transform="translate(60,-686)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1142" y="0"></use>
<g transform="translate(2143,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3285" y="0"></use>
<g transform="translate(4286,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="659" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="7674" y="0"></use>
</g>
</svg>
</div>
<p>

Thus, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.797ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 773.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="607" y="-213"></use>
</g>
</svg> sum to one.

</p>
<p>The interpolated <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> value is given by
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.073ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 9934.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z equals b 0 z 0 plus b 1 z 1 plus b 2 z 2 comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="745" y="0"></use>
<g transform="translate(1801,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="607" y="-213"></use>
</g>
<g transform="translate(2684,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3826" y="0"></use>
<g transform="translate(4827,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="607" y="-213"></use>
</g>
<g transform="translate(5710,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6852" y="0"></use>
<g transform="translate(7853,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="607" y="-213"></use>
</g>
<g transform="translate(8736,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="9655" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.881ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 809.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="658" y="-213"></use>
</g>
</svg> are the coordinates of the three vertices
in the ray&ndash;triangle intersection coordinate system.

</p>
<p>To save the cost of the floating-point division to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.797ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 773.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="607" y="-213"></use>
</g>
</svg>
in cases where the final <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value is out of the range of valid <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> values,
the implementation here first computes <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> by interpolating <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.881ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 809.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="658" y="-213"></use>
</g>
</svg> with
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.883ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 810.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="659" y="-213"></use>
</g>
</svg> (in other words, not yet performing the division by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.401ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 7061.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d equals e 0 plus e 1 plus e 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="798" y="0"></use>
<g transform="translate(1854,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2997" y="0"></use>
<g transform="translate(3997,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5140" y="0"></use>
<g transform="translate(6141,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="659" y="-213"></use>
</g>
</g>
</svg>). If the sign of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg> and the sign of the interpolated <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value are
different, then the final <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value will certainly be negative and thus
not a valid intersection.

</p>
<p>Along similar lines, the check <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.069ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 3474 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t less-than t Subscript normal m normal a normal x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="639" y="0"></use>
<g transform="translate(1695,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
<g transform="translate(361,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
</g>
</svg> can be equivalently performed in
two ways:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.23ex" height="11.509ex" style="vertical-align: -5.171ex;" viewBox="0 -2728.8 22057.1 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column sigma-summation Underscript i Endscripts e Subscript i Baseline z Subscript i Baseline less-than t Subscript normal m normal a normal x Baseline left-parenthesis e 0 plus e 1 plus e 2 right-parenthesis 2nd Column if e 0 plus e 1 plus e 2 greater-than 0 2nd Row 1st Column sigma-summation Underscript i Endscripts e Subscript i Baseline z Subscript i Baseline greater-than t Subscript normal m normal a normal x Baseline left-parenthesis e 0 plus e 1 plus e 2 right-parenthesis 2nd Column otherwise period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D452" d="M430 107c0 -12 -84 -118 -227 -118c-98 0 -157 79 -157 181c0 175 151 272 262 272c69 0 107 -41 107 -85c0 -14 -5 -73 -75 -103c-50 -21 -124 -23 -153 -23h-53c-15 -61 -16 -92 -16 -104c0 -32 9 -116 87 -116c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13z M382 357c0 34 -27 63 -74 63c-26 0 -129 -15 -168 -167h41c41 0 201 0 201 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-66" d="M357 635c0 -24 -15 -44 -44 -44c-27 0 -43 20 -43 43c0 25 18 38 30 42c-15 7 -30 7 -33 7c-44 0 -92 -48 -92 -136v-116h117v-31h-114v-322c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v324h-79v31h79v115c0 106 85 159 155 159 c53 0 90 -33 90 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3E" d="M688 230l-581 -275c-25 -11 -42 25 -18 36l548 259l-548 259c-24 11 -7 47 18 36l581 -275c17 -8 17 -32 0 -40Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-77" d="M703 400c-35 -1 -66 -14 -84 -64l-117 -328c-4 -10 -7 -19 -20 -19s-16 8 -20 19l-102 284l-101 -283c-5 -14 -7 -20 -20 -20s-16 8 -21 22l-126 354c-12 32 -24 35 -74 35v31l93 -3l109 3v-31c-20 0 -59 0 -59 -27c0 -4 0 -6 5 -18l95 -267l86 242c-7 19 -18 49 -23 55 c-10 13 -26 15 -63 15v31c30 -2 59 -3 89 -3l104 3v-31c-20 0 -59 0 -59 -27c0 -5 1 -7 5 -19l99 -279l91 256c5 13 5 15 5 21c0 29 -22 47 -58 48v31l93 -3c22 0 51 1 73 3v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1694)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="848" y="-1536"></use>
<g transform="translate(1611,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="659" y="-213"></use>
</g>
<g transform="translate(2421,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="3509" y="0"></use>
<g transform="translate(4565,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
<g transform="translate(361,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6344" y="0"></use>
<g transform="translate(6733,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7876" y="0"></use>
<g transform="translate(8877,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10019" y="0"></use>
<g transform="translate(11020,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11940" y="0"></use>
</g>
<g transform="translate(0,-951)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="848" y="-1536"></use>
<g transform="translate(1611,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="659" y="-213"></use>
</g>
<g transform="translate(2421,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3E" x="3509" y="0"></use>
<g transform="translate(4565,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
<g transform="translate(361,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6344" y="0"></use>
<g transform="translate(6733,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7876" y="0"></use>
<g transform="translate(8877,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10019" y="0"></use>
<g transform="translate(11020,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11940" y="0"></use>
</g>
</g>
<g transform="translate(13764,0)">
<g transform="translate(0,1694)">
 <use xlink:href="#E1-LATINMODERNMAIN-69"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-66" x="278" y="0"></use>
<g transform="translate(917,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2059" y="0"></use>
<g transform="translate(3060,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4202" y="0"></use>
<g transform="translate(5203,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D452" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="659" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3E" x="6401" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="7458" y="0"></use>
</g>
<g transform="translate(0,-951)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-68" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1446" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="1891" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-77" x="2283" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="3006" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="3284" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="3679" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="4123" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-Computescaledhitdistancetotriangleandtestagainstraytrange-0"></span><div class="fragmentname">&lt;&lt;Compute scaled hit distance to triangle and test against ray <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> range&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">p0t.z *= Sz;
p1t.z *= Sz;
p2t.z *= Sz;
Float tScaled = e0 * p0t.z + e1 * p1t.z + e2 * p2t.z;
if (det &lt; 0 &amp;&amp; (tScaled &gt;= 0 || tScaled &lt; tMax * det))
    return {};
else if (det &gt; 0 &amp;&amp; (tScaled &lt;= 0 || tScaled &gt; tMax * det))
    return {};</div><p>


</p>
<p>Given a valid intersection, the actual barycentric coordinates and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg>
value for the intersection are found.

</p>
<p></p>
<span class="anchor" id="fragment-Computebarycentriccoordinatesandtvaluefortriangleintersection-0"></span><div class="fragmentname">&lt;&lt;Compute barycentric coordinates and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value for triangle intersection&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float invDet = 1 / det;
Float b0 = e0 * invDet, b1 = e1 * invDet, b2 = e2 * invDet;
Float t = tScaled * invDet;
</div><p>


</p>
<p>After a final test on the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value that will be discussed in
Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:avoid-negative-t-intersections">6.8.7</a>, a
<tt>TriangleIntersection</tt> object that represents the intersection can be
returned.

</p>
<p></p>
<span class="anchor" id="fragment-ReturnmonoTriangleIntersectionforintersection-0"></span><div class="fragmentname">&lt;&lt;Return <tt>TriangleIntersection</tt> for intersection&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">return TriangleIntersection{b0, b1, b2, t};</div><p>


</p>
<p><tt>TriangleIntersection</tt> just records the barycentric coordinates and
the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">t</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="0" y="0"></use>
</g>
</svg> value along the ray where the intersection occurred.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleIntersectionDefinition-0"></span><div class="fragmentname">&lt;&lt;TriangleIntersection Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="TriangleIntersection"></span>TriangleIntersection {
    Float <span class="anchor" id="TriangleIntersection::b0"></span>b0, <span class="anchor" id="TriangleIntersection::b1"></span>b1, <span class="anchor" id="TriangleIntersection::b2"></span>b2;
    Float <span class="anchor" id="TriangleIntersection::t"></span>t;
};</div><p>


</p>
<p>The structure of the <tt>Triangle::Intersect()</tt> method follows the
form of earlier intersection test methods.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleMethodDefinitions-2"></span><div class="fragmentname">&lt;&lt;Triangle Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-TriangleMethodDefinitions-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; <span class="anchor" id="Triangle::Intersect"></span>Triangle::Intersect(const <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> &amp;ray,
                                                      Float tMax) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-630" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-630"><i></i></a><div id="fragbit-630" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    pstd::optional&lt;<a href="#TriangleIntersection" class="code">TriangleIntersection</a>&gt; triIsect =
        <a href="#IntersectTriangle" class="code">IntersectTriangle</a>(ray, tMax, p0, p1, p2);
    if (!triIsect) return {};
    <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> intr = <a href="#Triangle::InteractionFromIntersection" class="code">InteractionFromIntersection</a>(
        mesh, <a href="#Triangle::triIndex" class="code">triIndex</a>, *triIsect, ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::time" class="code">time</a>, -ray.<a href="../Geometry_and_Transformations/Rays.html#Ray::d" class="code">d</a>);
    return <a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>{intr, triIsect-&gt;<a href="#TriangleIntersection::t" class="code">t</a>};
}</div><p>


</p>
<p>We will not include the
<tt>Triangle::IntersectP()</tt><span class="anchor" id="Triangle::IntersectP"></span> method
here, as it is just based on calling <tt>IntersectTriangle()</tt>.

</p>
<p>

</p>
<p>The <tt>InteractionFromIntersection()</tt> method is different than the
corresponding methods in the quadrics in that it is a stand-alone function
rather than a regular member function.  Because a call to it is thus not
associated with a specific <tt>Triangle</tt> instance, it takes a
<a href="#TriangleMesh"><tt>TriangleMesh</tt></a> and the index of a triangle in the mesh as parameters.
In the context of its usage in the <tt>Intersect()</tt> method, this may seem
gratuitous&mdash;why pass that information as parameters rather than access it
directly in a non-<tt>static</tt> method?

</p>
<p>We have designed the interface in this way so that we are able to use this method in
<tt>pbrt</tt>&rsquo;s GPU rendering path, where the <tt>Triangle</tt> class is not used.
There, the representation of triangles in the scene is abstracted by a ray
intersection API and the geometric ray&ndash;triangle intersection test is
performed using specialized hardware.  Given an intersection, it provides the triangle index, a
pointer to the mesh that the triangle is a part of, and the barycentric coordinates
of the intersection.  That information is sufficient to call this method,
which then allows us to find the <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a> for such
intersections using the same code as executes on the CPU.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-3"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TrianglePublicMethods-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> <span class="anchor" id="Triangle::InteractionFromIntersection"></span>InteractionFromIntersection(
        const <a href="#TriangleMesh" class="code">TriangleMesh</a> *mesh, int triIndex,
        <a href="#TriangleIntersection" class="code">TriangleIntersection</a> ti, Float time, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wo) {
    const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * triIndex];
    <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computetrianglepartialderivatives-0">Compute triangle partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-631" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-631"><i></i></a><div id="fragbit-631" class="collapse"><div class="fragmentcode">       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computedeltasandmatrixdeterminantfortrianglepartialderivatives-0">Compute deltas and matrix determinant for triangle partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-632" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-632"><i></i></a><div id="fragbit-632" class="collapse"><div class="fragmentcode">          &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-633" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-633"><i></i></a><div id="fragbit-633" class="collapse"><div class="fragmentcode">             pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
                 mesh-&gt;uv
                     ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                           {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
                     : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
          <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2], duv12 = uv[1] - uv[2];
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dp02 = p0 - p2, dp12 = p1 - p2;
          Float determinant =
              <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], duv12[1], duv02[1], duv12[0]);</div></div>
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu, dpdv;
       bool degenerateUV = std::abs(determinant) &lt; 1e-9f;
       if (!degenerateUV) {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computetriangledpduanddpdvviamatrixinversion-0">Compute triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg> via matrix inversion</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-634" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-634"><i></i></a><div id="fragbit-634" class="collapse"><div class="fragmentcode">              Float invdet = 1 / determinant;
              dpdu = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv12[1], dp02, duv02[1], dp12) * invdet;
              dpdv = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], dp12, duv12[0], dp02) * invdet;</div></div>
       }
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Handledegeneratetriangleuvparameterizationorpartialderivatives-0">Handle degenerate triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parameterization or partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-635" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-635"><i></i></a><div id="fragbit-635" class="collapse"><div class="fragmentcode">          if (degenerateUV || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv)) == 0) {
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ng = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p2 - p0, p1 - p0);
              if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ng) == 0)
                  ng = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(Vector3&lt;double&gt;(p2 - p0),
                                      Vector3&lt;double&gt;(p1 - p0)));
              <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ng), &amp;dpdu, &amp;dpdv);
          }</div></div></div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Interpolateuvparametriccoordinatesandhitpoint-0">Interpolate <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parametric coordinates and hit point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-636" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-636"><i></i></a><div id="fragbit-636" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * p0 + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * p1 + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * p2;
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvHit = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * uv[0] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * uv[1] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * uv[2];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoSurfaceInteractionfortrianglehit-0">Return <tt>SurfaceInteraction</tt> for triangle hit</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-637" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-637"><i></i></a><div id="fragbit-637" class="collapse"><div class="fragmentcode">       bool flipNormal = mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>;
       &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorfortriangleintersection-0">Compute error bounds <tt>pError</tt> for triangle intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-638" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-638"><i></i></a><div id="fragbit-638" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * p1) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b1" class="code">b2</a> * p2);
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(7) * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pAbsSum);</div></div>
       <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> isect(Point3fi(pHit, pError), uvHit, wo, dpdu, dpdv,
                                <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(), <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(), time, flipNormal);
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Setfinalsurfacenormalandshadinggeometryfortriangle-0">Set final surface normal and shading geometry for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-639" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-639"><i></i></a><div id="fragbit-639" class="collapse"><div class="fragmentcode">          &lt;&lt;<span class="fragmentname"><a href="#fragment-Overridesurfacenormalinmonoisectfortriangle-0">Override surface normal in <tt>isect</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-640" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-640"><i></i></a><div id="fragbit-640" class="collapse"><div class="fragmentcode">             isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dp02, dp12)));
             if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
                 isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = -isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
          if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a> || mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
              &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializemonoTriangleshadinggeometry-0">Initialize <tt>Triangle</tt> shading geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-641" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-641"><i></i></a><div id="fragbit-641" class="collapse"><div class="fragmentcode">                 &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingnormalmononsfortriangle-0">Compute shading normal <tt>ns</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-642" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-642"><i></i></a><div id="fragbit-642" class="collapse"><div class="fragmentcode">                    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns;
                    if (mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>) {
                        ns = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[2]];
                        ns = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ns) &gt; 0 ? <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ns) : isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;
                    } else
                        ns = isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
                 &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingtangentmonossfortriangle-0">Compute shading tangent <tt>ss</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-643" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-643"><i></i></a><div id="fragbit-643" class="collapse"><div class="fragmentcode">                    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ss;
                    if (mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
                        ss = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[2]];
                        if (LengthSquared(ss) == 0)
                            ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;
                    } else
                        ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;</div></div>
                 &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingbitangentmonotsfortriangleandadjustmonoss-0">Compute shading bitangent <tt>ts</tt> for triangle and adjust <tt>ss</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-644" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-644"><i></i></a><div id="fragbit-644" class="collapse"><div class="fragmentcode">                    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ts = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ns, ss);
                    if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ts) &gt; 0)
                        ss = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ts, ns);
                    else
                        <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(ns, &amp;ss, &amp;ts);</div></div>
                 &lt;&lt;<span class="fragmentname">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> for triangle shading geometry</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-645" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-645"><i></i></a><div id="fragbit-645" class="collapse"><div class="fragmentcode">                    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu, dndv;
                    if (mesh-&gt;n) {
                        // Compute deltas for triangle partial derivatives of normal
                        <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2];
                        <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv12 = uv[1] - uv[2];
                        <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn1 = mesh-&gt;n[v[0]] - mesh-&gt;n[v[2]];
                        <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn2 = mesh-&gt;n[v[1]] - mesh-&gt;n[v[2]];
                    
                        Float determinant =
                            DifferenceOfProducts(duv02[0], duv12[1], duv02[1], duv12[0]);
                        bool degenerateUV = std::abs(determinant) &lt; 1e-9;
                        if (degenerateUV) {
                            // We can still compute dndu and dndv, with respect to the
                            // same arbitrary coordinate system we use to compute dpdu
                            // and dpdv when this happens. It's important to do this
                            // (rather than giving up) so that ray differentials for
                            // rays reflected from triangles with degenerate
                            // parameterizations are still reasonable.
                            <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dn = Cross(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[2]] - mesh-&gt;n[v[0]]),
                                                <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[1]] - mesh-&gt;n[v[0]]));
                    
                            if (LengthSquared(dn) == 0)
                                dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);
                            else {
                                <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dnu, dnv;
                                CoordinateSystem(dn, &amp;dnu, &amp;dnv);
                                dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnu);
                                dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnv);
                            }
                        } else {
                            Float invDet = 1 / determinant;
                            dndu = DifferenceOfProducts(duv12[1], dn1, duv02[1], dn2) * invDet;
                            dndv = DifferenceOfProducts(duv02[0], dn2, duv12[0], dn1) * invDet;
                        }
                    } else
                        dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);</div></div>
                 isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::SetShadingGeometry" class="code">SetShadingGeometry</a>(ns, ss, ts, dndu, dndv, true);</div></div>
          }</div></div>
       return isect;</div></div>
}</div><p>


</p>
<p>To generate consistent tangent vectors over triangle meshes, it is
necessary to compute the partial derivatives <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg> using the
parametric <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> values at the triangle vertices, if provided.  Although
the partial derivatives are the same at all points on the triangle, the
implementation here recomputes them each time an intersection is
found.  Although this results in redundant computation, the storage savings
for large triangle meshes can be significant.

</p>
<p>A triangle can be described by the set of points
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.151ex" height="5.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1508.9 7814.8 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript normal o Baseline plus u StartFraction partial-differential normal p Over partial-differential u EndFraction plus v StartFraction partial-differential normal p Over partial-differential v EndFraction comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1232" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2233" y="0"></use>
<g transform="translate(2805,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1279" height="60" x="0" y="220"></rect>
<g transform="translate(68,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
</g>
<g transform="translate(60,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="586" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4547" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="5547" y="0"></use>
<g transform="translate(6033,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1263" height="60" x="0" y="220"></rect>
<g transform="translate(60,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
</g>
<g transform="translate(95,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="586" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="7536" y="0"></use>
</g>
</svg>
</div>
<p>

for some <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.347ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1010.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript normal o</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="787" y="-213"></use>
</g>
</svg>, where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 485.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
</g>
</svg> range over the parametric coordinates of
the triangle.  We also know the three vertex positions <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.982ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 853.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="787" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.998ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 4735.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i equals 0 comma 1 comma 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="623" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1679" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2180" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2957" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3457" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="4234" y="0"></use>
</g>
</svg>,
and the texture coordinates <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.9ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2970.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u Subscript i Baseline comma v Subscript i Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1306" y="0"></use>
<g transform="translate(1751,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2581" y="0"></use>
</g>
</svg> at each vertex.  From this it
follows that the partial derivatives of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> must satisfy
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.831ex" height="5.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1508.9 10690.9 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript i Baseline equals normal p Subscript normal o Baseline plus u Subscript i Baseline StartFraction partial-differential normal p Over partial-differential u EndFraction plus v Subscript i Baseline StartFraction partial-differential normal p Over partial-differential v EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1131" y="0"></use>
<g transform="translate(2187,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="787" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3420" y="0"></use>
<g transform="translate(4420,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="809" y="-213"></use>
</g>
<g transform="translate(5337,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1279" height="60" x="0" y="220"></rect>
<g transform="translate(68,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
</g>
<g transform="translate(60,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="586" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7078" y="0"></use>
<g transform="translate(8079,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
<g transform="translate(8909,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1263" height="60" x="0" y="220"></rect>
<g transform="translate(60,714)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
</g>
<g transform="translate(95,-737)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="586" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="10412" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>

</p>
<p>In other words, there is a unique affine mapping from the 2D
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> space to points on the triangle. (Such a mapping exists even though
the triangle is specified in 3D because the triangle is planar.)  To&nbsp;compute
expressions for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg>, we start by computing the differences
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.534ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 3243.8 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 0 minus normal p 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1232" y="0"></use>
<g transform="translate(2233,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.534ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 3243.8 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p 1 minus normal p 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1232" y="0"></use>
<g transform="translate(2233,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</g>
</svg>, giving the matrix equation
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.215ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 20759.3 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 2 By 2 Matrix 1st Row 1st Column u 0 minus u 2 2nd Column v 0 minus v 2 2nd Row 1st Column u 1 minus u 2 2nd Column v 1 minus v 2 EndMatrix StartBinomialOrMatrix partial-differential normal p slash partial-differential u Choose partial-differential normal p slash partial-differential v EndBinomialOrMatrix equals StartBinomialOrMatrix normal p 0 minus normal p 2 Choose normal p 1 minus normal p 2 EndBinomialOrMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-28" d="M682 -928c0 -10 -8 -18 -18 -18c-4 0 -8 2 -11 4c-222 167 -427 613 -427 1006v372c0 393 205 839 427 1006c3 2 7 4 11 4c10 0 18 -8 18 -18c0 -6 -3 -11 -7 -14c-213 -160 -361 -603 -361 -978v-372c0 -375 148 -818 361 -978c4 -3 7 -8 7 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-29" d="M510 64c0 -393 -205 -839 -427 -1006c-3 -2 -7 -4 -11 -4c-10 0 -18 8 -18 18c0 6 3 11 7 14c213 160 361 603 361 978v372c0 375 -148 818 -361 978c-4 3 -7 8 -7 14c0 10 8 18 18 18c4 0 8 -2 11 -4c222 -167 427 -613 427 -1006v-372Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(4265,0)">
<g transform="translate(0,650)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="686" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="686" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="8437" y="0"></use>
<g transform="translate(9340,0)">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,701)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
<g transform="translate(43,-750)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="3862" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="14217" y="0"></use>
<g transform="translate(15273,0)">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1232" y="0"></use>
<g transform="translate(2233,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1232" y="0"></use>
<g transform="translate(2233,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="4303" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="20480" y="0"></use>
</g>
</svg>
</div>
<p>

Thus,
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.548ex" height="6.509ex" style="vertical-align: -2.505ex;" viewBox="0 -1724.2 21763.7 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartBinomialOrMatrix partial-differential normal p slash partial-differential u Choose partial-differential normal p slash partial-differential v EndBinomialOrMatrix equals Start 2 By 2 Matrix 1st Row 1st Column u 0 minus u 2 2nd Column v 0 minus v 2 2nd Row 1st Column u 1 minus u 2 2nd Column v 1 minus v 2 EndMatrix Superscript negative 1 Baseline StartBinomialOrMatrix normal p 0 minus normal p 2 Choose normal p 1 minus normal p 2 EndBinomialOrMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-28" d="M682 -928c0 -10 -8 -18 -18 -18c-4 0 -8 2 -11 4c-222 167 -427 613 -427 1006v372c0 393 205 839 427 1006c3 2 7 4 11 4c10 0 18 -8 18 -18c0 -6 -3 -11 -7 -14c-213 -160 -361 -603 -361 -978v-372c0 -375 148 -818 361 -978c4 -3 7 -8 7 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-29" d="M510 64c0 -393 -205 -839 -427 -1006c-3 -2 -7 -4 -11 -4c-10 0 -18 8 -18 18c0 6 3 11 7 14c213 160 361 603 361 978v372c0 375 -148 818 -361 978c-4 3 -7 8 -7 14c0 10 8 18 18 18c4 0 8 -2 11 -4c222 -167 427 -613 427 -1006v-372Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,701)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
<g transform="translate(43,-750)">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="3862" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="4876" y="0"></use>
<g transform="translate(5933,0)">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(4265,0)">
<g transform="translate(0,650)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="686" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="686" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="8437" y="0"></use>
<g transform="translate(9174,1176)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(16278,0)">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1232" y="0"></use>
<g transform="translate(2233,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="787" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1232" y="0"></use>
<g transform="translate(2233,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="787" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="4303" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="21485" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>Inverting a 2<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.509ex" style="vertical-align: 0.019ex; margin-bottom: -0.19ex;" viewBox="0 -576.1 778.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="0" y="0"></use>
</g>
</svg>2 matrix is straightforward. The inverse of the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> differences matrix is 
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:tri-inverse-uv-diffs"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.115ex" height="6.343ex" style="vertical-align: -2.671ex;" viewBox="0 -1580.7 30188.2 2730.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartFraction 1 Over left-parenthesis u 0 minus u 2 right-parenthesis left-parenthesis v 1 minus v 2 right-parenthesis minus left-parenthesis v 0 minus v 2 right-parenthesis left-parenthesis u 1 minus u 2 right-parenthesis EndFraction Start 2 By 2 Matrix 1st Row 1st Column v 1 minus v 2 2nd Column minus left-parenthesis v 0 minus v 2 right-parenthesis 2nd Row 1st Column minus left-parenthesis u 1 minus u 2 right-parenthesis 2nd Column u 0 minus u 2 EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-28" d="M682 -928c0 -10 -8 -18 -18 -18c-4 0 -8 2 -11 4c-222 167 -427 613 -427 1006v372c0 393 205 839 427 1006c3 2 7 4 11 4c10 0 18 -8 18 -18c0 -6 -3 -11 -7 -14c-213 -160 -361 -603 -361 -978v-372c0 -375 148 -818 361 -978c4 -3 7 -8 7 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-29" d="M510 64c0 -393 -205 -839 -427 -1006c-3 -2 -7 -4 -11 -4c-10 0 -18 8 -18 18c0 6 3 11 7 14c213 160 361 603 361 978v372c0 375 -148 818 -361 978c-4 3 -7 8 -7 14c0 10 8 18 18 18c4 0 8 -2 11 -4c222 -167 427 -613 427 -1006v-372Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="17213" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="8356" y="676"></use>
<g transform="translate(60,-769)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1638" y="0"></use>
<g transform="translate(2638,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3665" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4054" y="0"></use>
<g transform="translate(4444,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5605" y="0"></use>
<g transform="translate(6606,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7546" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="8157" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="9158" y="0"></use>
<g transform="translate(9547,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10709" y="0"></use>
<g transform="translate(11710,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="12649" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="13039" y="0"></use>
<g transform="translate(13428,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="14677" y="0"></use>
<g transform="translate(15678,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="16704" y="0"></use>
</g>
</g>
<g transform="translate(17453,0)">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(903,0)">
<g transform="translate(-11,0)">
<g transform="translate(865,699)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="686" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="778" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2416" y="0"></use>
<g transform="translate(3417,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4443" y="0"></use>
</g>
</g>
<g transform="translate(5822,0)">
<g transform="translate(0,699)">
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="778" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2329" y="0"></use>
<g transform="translate(3330,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4269" y="0"></use>
</g>
<g transform="translate(691,-750)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1248" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="11552" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="29909" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:tri-inverse-uv-diffs">6.7</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>


</p>
<p>This computation is performed by the &lt;&lt;<span class="fragmentname"><a href="#fragment-Computetrianglepartialderivatives-0">Compute triangle partial
derivatives</a></span>&gt;&gt; fragment, with handling for various additional corner cases.

</p>
<p></p>
<span class="anchor" id="fragment-Computetrianglepartialderivatives-0"></span><div class="fragmentname">&lt;&lt;Compute triangle partial derivatives&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname"><a href="#fragment-Computedeltasandmatrixdeterminantfortrianglepartialderivatives-0">Compute deltas and matrix determinant for triangle partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-646" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-646"><i></i></a><div id="fragbit-646" class="collapse"><div class="fragmentcode">   &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-647" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-647"><i></i></a><div id="fragbit-647" class="collapse"><div class="fragmentcode">      pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
          mesh-&gt;uv
              ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                    {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
              : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
   <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2], duv12 = uv[1] - uv[2];
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dp02 = p0 - p2, dp12 = p1 - p2;
   Float determinant =
       <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], duv12[1], duv02[1], duv12[0]);</div></div>
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dpdu, dpdv;
bool degenerateUV = std::abs(determinant) &lt; 1e-9f;
if (!degenerateUV) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computetriangledpduanddpdvviamatrixinversion-0">Compute triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg> via matrix inversion</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-648" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-648"><i></i></a><div id="fragbit-648" class="collapse"><div class="fragmentcode">       Float invdet = 1 / determinant;
       dpdu = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv12[1], dp02, duv02[1], dp12) * invdet;
       dpdv = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], dp12, duv12[0], dp02) * invdet;</div></div>
}
&lt;&lt;<span class="fragmentname"><a href="#fragment-Handledegeneratetriangleuvparameterizationorpartialderivatives-0">Handle degenerate triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parameterization or partial derivatives</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-649" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-649"><i></i></a><div id="fragbit-649" class="collapse"><div class="fragmentcode">   if (degenerateUV || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv)) == 0) {
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ng = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p2 - p0, p1 - p0);
       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ng) == 0)
           ng = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(Vector3&lt;double&gt;(p2 - p0),
                               Vector3&lt;double&gt;(p1 - p0)));
       <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ng), &amp;dpdu, &amp;dpdv);
   }</div></div></div><p>


</p>
<p>The triangle&rsquo;s <tt>uv</tt> coordinates are found by indexing into the
<a href="#TriangleMesh::uv"><tt>TriangleMesh::uv</tt></a> array, if present.  Otherwise, a default
parameterization is used.  We will not include the
fragment that initializes <tt>uv</tt> here.

</p>
<p></p>
<span class="anchor" id="fragment-Computedeltasandmatrixdeterminantfortrianglepartialderivatives-0"></span><div class="fragmentname">&lt;&lt;Compute deltas and matrix determinant for triangle partial derivatives&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-650" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-650"><i></i></a><div id="fragbit-650" class="collapse"><div class="fragmentcode">   pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
       mesh-&gt;uv
           ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                 {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
           : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2], duv12 = uv[1] - uv[2];
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dp02 = p0 - p2, dp12 = p1 - p2;
Float determinant =
    <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], duv12[1], duv02[1], duv12[0]);</div><p>


</p>
<p>

</p>
<p>In the usual case, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 times 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1723" y="0"></use>
</g>
</svg> matrix is non-degenerate, and the
partial derivatives are computed using
Equation&nbsp;(<a href="#eq:tri-inverse-uv-diffs">6.7</a>).

</p>
<p></p>
<span class="anchor" id="fragment-Computetriangledpduanddpdvviamatrixinversion-0"></span><div class="fragmentname">&lt;&lt;Compute triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg> via matrix inversion&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float invdet = 1 / determinant;
dpdu = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv12[1], dp02, duv02[1], dp12) * invdet;
dpdv = <a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(duv02[0], dp12, duv12[0], dp02) * invdet;</div><p>


</p>
<p>However, there are a number of rare additional cases that must be handled.
For example, the user may have provided <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> coordinates that specify a
degenerate parameterization, such as the same <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> at all three
vertices.  Alternatively, the computed <tt>dpdu</tt> and <tt>dpdv</tt> values
may have a degenerate cross product due to rounding error.  In such cases
we fall back to computing <tt>dpdu</tt> and <tt>dpdv</tt> that at least give
the correct normal vector.

</p>
<p></p>
<span class="anchor" id="fragment-Handledegeneratetriangleuvparameterizationorpartialderivatives-0"></span><div class="fragmentname">&lt;&lt;Handle degenerate triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parameterization or partial derivatives&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (degenerateUV || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dpdu, dpdv)) == 0) {
    <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ng = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p2 - p0, p1 - p0);
    if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ng) == 0)
        ng = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(Vector3&lt;double&gt;(p2 - p0),
                            Vector3&lt;double&gt;(p1 - p0)));
    <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ng), &amp;dpdu, &amp;dpdv);
}</div><p>


</p>
<p>To compute the intersection point and the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parametric coordinates at
the hit point, the barycentric interpolation formula is applied to the
vertex positions and the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> coordinates at the vertices. As we will see
in Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:bounding-intersection-error">6.8.5</a>, this gives a more accurate
result for the intersection point than evaluating the parametric ray
equation using <tt>t</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-Interpolateuvparametriccoordinatesandhitpoint-0"></span><div class="fragmentname">&lt;&lt;Interpolate <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> parametric coordinates and hit point&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pHit = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * p0 + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * p1 + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * p2;
<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvHit = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * uv[0] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * uv[1] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * uv[2];</div><p>


</p>
<p>Unlike with the shapes we have seen so far, it is not necessary to
transform the <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a> here to rendering space, since the
geometric per-vertex values are already in rendering space.  Like the disk,
the partial derivatives of the triangle&rsquo;s normal are also both <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>,
since it is flat.

</p>
<p></p>
<span class="anchor" id="fragment-ReturnmonoSurfaceInteractionfortrianglehit-0"></span><div class="fragmentname">&lt;&lt;Return <tt>SurfaceInteraction</tt> for triangle hit&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">bool flipNormal = mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>;
&lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorfortriangleintersection-0">Compute error bounds <tt>pError</tt> for triangle intersection</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-651" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-651"><i></i></a><div id="fragbit-651" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * p1) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(ti.<a href="#TriangleIntersection::b1" class="code">b2</a> * p2);
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(7) * <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(pAbsSum);</div></div>
<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction" class="code">SurfaceInteraction</a> isect(Point3fi(pHit, pError), uvHit, wo, dpdu, dpdv,
                         <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(), <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(), time, flipNormal);
&lt;&lt;<span class="fragmentname"><a href="#fragment-Setfinalsurfacenormalandshadinggeometryfortriangle-0">Set final surface normal and shading geometry for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-652" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-652"><i></i></a><div id="fragbit-652" class="collapse"><div class="fragmentcode">   &lt;&lt;<span class="fragmentname"><a href="#fragment-Overridesurfacenormalinmonoisectfortriangle-0">Override surface normal in <tt>isect</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-653" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-653"><i></i></a><div id="fragbit-653" class="collapse"><div class="fragmentcode">      isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dp02, dp12)));
      if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
          isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = -isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
   if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a> || mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
       &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializemonoTriangleshadinggeometry-0">Initialize <tt>Triangle</tt> shading geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-654" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-654"><i></i></a><div id="fragbit-654" class="collapse"><div class="fragmentcode">          &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingnormalmononsfortriangle-0">Compute shading normal <tt>ns</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-655" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-655"><i></i></a><div id="fragbit-655" class="collapse"><div class="fragmentcode">             <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns;
             if (mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>) {
                 ns = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[2]];
                 ns = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ns) &gt; 0 ? <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ns) : isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;
             } else
                 ns = isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
          &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingtangentmonossfortriangle-0">Compute shading tangent <tt>ss</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-656" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-656"><i></i></a><div id="fragbit-656" class="collapse"><div class="fragmentcode">             <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ss;
             if (mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
                 ss = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[2]];
                 if (LengthSquared(ss) == 0)
                     ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;
             } else
                 ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;</div></div>
          &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingbitangentmonotsfortriangleandadjustmonoss-0">Compute shading bitangent <tt>ts</tt> for triangle and adjust <tt>ss</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-657" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-657"><i></i></a><div id="fragbit-657" class="collapse"><div class="fragmentcode">             <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ts = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ns, ss);
             if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ts) &gt; 0)
                 ss = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ts, ns);
             else
                 <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(ns, &amp;ss, &amp;ts);</div></div>
          &lt;&lt;<span class="fragmentname">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> for triangle shading geometry</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-658" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-658"><i></i></a><div id="fragbit-658" class="collapse"><div class="fragmentcode">             <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu, dndv;
             if (mesh-&gt;n) {
                 // Compute deltas for triangle partial derivatives of normal
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2];
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv12 = uv[1] - uv[2];
                 <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn1 = mesh-&gt;n[v[0]] - mesh-&gt;n[v[2]];
                 <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn2 = mesh-&gt;n[v[1]] - mesh-&gt;n[v[2]];
             
                 Float determinant =
                     DifferenceOfProducts(duv02[0], duv12[1], duv02[1], duv12[0]);
                 bool degenerateUV = std::abs(determinant) &lt; 1e-9;
                 if (degenerateUV) {
                     // We can still compute dndu and dndv, with respect to the
                     // same arbitrary coordinate system we use to compute dpdu
                     // and dpdv when this happens. It's important to do this
                     // (rather than giving up) so that ray differentials for
                     // rays reflected from triangles with degenerate
                     // parameterizations are still reasonable.
                     <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dn = Cross(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[2]] - mesh-&gt;n[v[0]]),
                                         <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[1]] - mesh-&gt;n[v[0]]));
             
                     if (LengthSquared(dn) == 0)
                         dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);
                     else {
                         <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dnu, dnv;
                         CoordinateSystem(dn, &amp;dnu, &amp;dnv);
                         dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnu);
                         dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnv);
                     }
                 } else {
                     Float invDet = 1 / determinant;
                     dndu = DifferenceOfProducts(duv12[1], dn1, duv02[1], dn2) * invDet;
                     dndv = DifferenceOfProducts(duv02[0], dn2, duv12[0], dn1) * invDet;
                 }
             } else
                 dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);</div></div>
          isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::SetShadingGeometry" class="code">SetShadingGeometry</a>(ns, ss, ts, dndu, dndv, true);</div></div>
   }</div></div>
return isect;</div><p>


</p>
<p>Before the <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a> is returned, some final details related
to its surface normal and shading geometry must be taken care of.

</p>
<p></p>
<span class="anchor" id="fragment-Setfinalsurfacenormalandshadinggeometryfortriangle-0"></span><div class="fragmentname">&lt;&lt;Set final surface normal and shading geometry for triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname"><a href="#fragment-Overridesurfacenormalinmonoisectfortriangle-0">Override surface normal in <tt>isect</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-659" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-659"><i></i></a><div id="fragbit-659" class="collapse"><div class="fragmentcode">   isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dp02, dp12)));
   if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
       isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = -isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a> || mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializemonoTriangleshadinggeometry-0">Initialize <tt>Triangle</tt> shading geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-660" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-660"><i></i></a><div id="fragbit-660" class="collapse"><div class="fragmentcode">       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingnormalmononsfortriangle-0">Compute shading normal <tt>ns</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-661" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-661"><i></i></a><div id="fragbit-661" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns;
          if (mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>) {
              ns = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[2]];
              ns = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ns) &gt; 0 ? <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ns) : isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;
          } else
              ns = isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingtangentmonossfortriangle-0">Compute shading tangent <tt>ss</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-662" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-662"><i></i></a><div id="fragbit-662" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ss;
          if (mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
              ss = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[2]];
              if (LengthSquared(ss) == 0)
                  ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;
          } else
              ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingbitangentmonotsfortriangleandadjustmonoss-0">Compute shading bitangent <tt>ts</tt> for triangle and adjust <tt>ss</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-663" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-663"><i></i></a><div id="fragbit-663" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ts = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ns, ss);
          if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ts) &gt; 0)
              ss = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ts, ns);
          else
              <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(ns, &amp;ss, &amp;ts);</div></div>
       &lt;&lt;<span class="fragmentname">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> for triangle shading geometry</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-664" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-664"><i></i></a><div id="fragbit-664" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu, dndv;
          if (mesh-&gt;n) {
              // Compute deltas for triangle partial derivatives of normal
              <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2];
              <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv12 = uv[1] - uv[2];
              <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn1 = mesh-&gt;n[v[0]] - mesh-&gt;n[v[2]];
              <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn2 = mesh-&gt;n[v[1]] - mesh-&gt;n[v[2]];
          
              Float determinant =
                  DifferenceOfProducts(duv02[0], duv12[1], duv02[1], duv12[0]);
              bool degenerateUV = std::abs(determinant) &lt; 1e-9;
              if (degenerateUV) {
                  // We can still compute dndu and dndv, with respect to the
                  // same arbitrary coordinate system we use to compute dpdu
                  // and dpdv when this happens. It's important to do this
                  // (rather than giving up) so that ray differentials for
                  // rays reflected from triangles with degenerate
                  // parameterizations are still reasonable.
                  <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dn = Cross(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[2]] - mesh-&gt;n[v[0]]),
                                      <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[1]] - mesh-&gt;n[v[0]]));
          
                  if (LengthSquared(dn) == 0)
                      dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);
                  else {
                      <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dnu, dnv;
                      CoordinateSystem(dn, &amp;dnu, &amp;dnv);
                      dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnu);
                      dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnv);
                  }
              } else {
                  Float invDet = 1 / determinant;
                  dndu = DifferenceOfProducts(duv12[1], dn1, duv02[1], dn2) * invDet;
                  dndv = DifferenceOfProducts(duv02[0], dn2, duv12[0], dn1) * invDet;
              }
          } else
              dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);</div></div>
       isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::SetShadingGeometry" class="code">SetShadingGeometry</a>(ns, ss, ts, dndu, dndv, true);</div></div>
}</div><p>


</p>
<p>The <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a> constructor initializes the
geometric normal <tt>n</tt> as the normalized cross product of <tt>dpdu</tt>
and <tt>dpdv</tt>.  This works well for most shapes, but in the case of
triangle meshes it is preferable to rely on an initialization that does not
depend on the underlying texture coordinates: it is fairly common to
encounter meshes with bad parameterizations that do not preserve the
orientation of the mesh, in which case the geometric normal would have an
incorrect orientation.

</p>
<p>We therefore initialize the geometric normal using the normalized cross
product of the edge vectors <tt>dp02</tt> and <tt>dp12</tt>, which results in
the same normal up to a potential sign difference that depends on the exact
order of triangle vertices (also known as the triangle&rsquo;s <em>winding
order</em>).<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="This computation implicitly assumes a counterclockwise
vertex ordering.">
      <sup>&dagger;</sup>
    </button>
		  3D modeling packages generally try to ensure that
triangles in a mesh have consistent winding orders, which makes this
approach more robust.

</p>
<p></p>
<span class="anchor" id="fragment-Overridesurfacenormalinmonoisectfortriangle-0"></span><div class="fragmentname">&lt;&lt;Override surface normal in <tt>isect</tt> for triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(dp02, dp12)));
if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
    isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = isect.shading.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a> = -isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div><p>


</p>
<p>With <tt>Triangle</tt>s, the user can provide normal vectors and tangent
vectors at the vertices of the mesh that are interpolated to give normals
and tangents at points on the faces of triangles.  Shading geometry with
interpolated normals can make otherwise faceted triangle meshes appear to
be smoother than they geometrically are.  If either shading normals or
shading tangents have been provided, they are used to initialize the
shading geometry in the <a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction"><tt>SurfaceInteraction</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-InitializemonoTriangleshadinggeometry-0"></span><div class="fragmentname">&lt;&lt;Initialize <tt>Triangle</tt> shading geometry&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingnormalmononsfortriangle-0">Compute shading normal <tt>ns</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-665" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-665"><i></i></a><div id="fragbit-665" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns;
   if (mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>) {
       ns = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[2]];
       ns = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ns) &gt; 0 ? <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ns) : isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;
   } else
       ns = isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingtangentmonossfortriangle-0">Compute shading tangent <tt>ss</tt> for triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-666" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-666"><i></i></a><div id="fragbit-666" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ss;
   if (mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
       ss = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[2]];
       if (LengthSquared(ss) == 0)
           ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;
   } else
       ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computeshadingbitangentmonotsfortriangleandadjustmonoss-0">Compute shading bitangent <tt>ts</tt> for triangle and adjust <tt>ss</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-667" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-667"><i></i></a><div id="fragbit-667" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ts = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ns, ss);
   if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ts) &gt; 0)
       ss = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ts, ns);
   else
       <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(ns, &amp;ss, &amp;ts);</div></div>
&lt;&lt;<span class="fragmentname">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> for triangle shading geometry</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-668" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-668"><i></i></a><div id="fragbit-668" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dndu, dndv;
   if (mesh-&gt;n) {
       // Compute deltas for triangle partial derivatives of normal
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv02 = uv[0] - uv[2];
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> duv12 = uv[1] - uv[2];
       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn1 = mesh-&gt;n[v[0]] - mesh-&gt;n[v[2]];
       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> dn2 = mesh-&gt;n[v[1]] - mesh-&gt;n[v[2]];
   
       Float determinant =
           DifferenceOfProducts(duv02[0], duv12[1], duv02[1], duv12[0]);
       bool degenerateUV = std::abs(determinant) &lt; 1e-9;
       if (degenerateUV) {
           // We can still compute dndu and dndv, with respect to the
           // same arbitrary coordinate system we use to compute dpdu
           // and dpdv when this happens. It's important to do this
           // (rather than giving up) so that ray differentials for
           // rays reflected from triangles with degenerate
           // parameterizations are still reasonable.
           <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dn = Cross(<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[2]] - mesh-&gt;n[v[0]]),
                               <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(mesh-&gt;n[v[1]] - mesh-&gt;n[v[0]]));
   
           if (LengthSquared(dn) == 0)
               dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);
           else {
               <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> dnu, dnv;
               CoordinateSystem(dn, &amp;dnu, &amp;dnv);
               dndu = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnu);
               dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(dnv);
           }
       } else {
           Float invDet = 1 / determinant;
           dndu = DifferenceOfProducts(duv12[1], dn1, duv02[1], dn2) * invDet;
           dndv = DifferenceOfProducts(duv02[0], dn2, duv12[0], dn1) * invDet;
       }
   } else
       dndu = dndv = <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0);</div></div>
isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::SetShadingGeometry" class="code">SetShadingGeometry</a>(ns, ss, ts, dndu, dndv, true);</div><p>


</p>
<p>Given the barycentric coordinates of the intersection point, it is
easy to compute the shading normal by interpolating among the
appropriate vertex normals, if present.

</p>
<p></p>
<span class="anchor" id="fragment-Computeshadingnormalmononsfortriangle-0"></span><div class="fragmentname">&lt;&lt;Compute shading normal <tt>ns</tt> for triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns;
if (mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>) {
    ns = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>[v[2]];
    ns = <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ns) &gt; 0 ? <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(ns) : isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;
} else
    ns = isect.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>;</div><p>


</p>
<p>The shading tangent is computed similarly.

</p>
<p></p>
<span class="anchor" id="fragment-Computeshadingtangentmonossfortriangle-0"></span><div class="fragmentname">&lt;&lt;Compute shading tangent <tt>ss</tt> for triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ss;
if (mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>) {
    ss = ti.<a href="#TriangleIntersection::b0" class="code">b0</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[0]] + ti.<a href="#TriangleIntersection::b1" class="code">b1</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[1]] + ti.<a href="#TriangleIntersection::b2" class="code">b2</a> * mesh-&gt;<a href="#TriangleMesh::s" class="code">s</a>[v[2]];
    if (LengthSquared(ss) == 0)
        ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;
} else
    ss = isect.<a href="../Geometry_and_Transformations/Interactions.html#SurfaceInteraction::dpdu" class="code">dpdu</a>;</div><p>


</p>
<p>The bitangent vector <tt>ts</tt> is found using the cross product of
<tt>ns</tt> and <tt>ss</tt>, giving a vector orthogonal to the two of them.
Next, <tt>ss</tt> is overwritten with the cross product of <tt>ts</tt> and
<tt>ns</tt>; this ensures that the cross product of <tt>ss</tt> and <tt>ts</tt>
gives <tt>ns</tt>.  Thus, if per-vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 639.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.056ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 454.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold s</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42C" d="M415 140c0 -146 -154 -146 -185 -146c-20 0 -72 0 -118 32l-26 -17c-21 -15 -23 -15 -30 -15c-18 0 -18 9 -18 28v109c0 23 0 29 24 29c14 0 19 0 24 -14c12 -43 38 -116 144 -116c22 0 114 0 114 75c0 59 -75 72 -111 78c-77 14 -115 20 -155 55c-20 17 -40 44 -40 84 c0 131 154 131 184 131c40 0 75 -6 101 -19c39 19 41 19 45 19c18 0 18 -9 18 -28v-80c0 -23 0 -28 -24 -28c-21 0 -22 5 -23 20c-5 55 -43 84 -118 84c-19 0 -112 0 -112 -62c0 -47 65 -58 102 -65c78 -13 110 -19 149 -48c35 -28 55 -63 55 -106Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42C" x="0" y="0"></use>
</g>
</svg> values are
provided and if the interpolated <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 639.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.056ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 454.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold s</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42C" d="M415 140c0 -146 -154 -146 -185 -146c-20 0 -72 0 -118 32l-26 -17c-21 -15 -23 -15 -30 -15c-18 0 -18 9 -18 28v109c0 23 0 29 24 29c14 0 19 0 24 -14c12 -43 38 -116 144 -116c22 0 114 0 114 75c0 59 -75 72 -111 78c-77 14 -115 20 -155 55c-20 17 -40 44 -40 84 c0 131 154 131 184 131c40 0 75 -6 101 -19c39 19 41 19 45 19c18 0 18 -9 18 -28v-80c0 -23 0 -28 -24 -28c-21 0 -22 5 -23 20c-5 55 -43 84 -118 84c-19 0 -112 0 -112 -62c0 -47 65 -58 102 -65c78 -13 110 -19 149 -48c35 -28 55 -63 55 -106Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42C" x="0" y="0"></use>
</g>
</svg> values are not
perfectly orthogonal, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 639.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
</g>
</svg> will be preserved and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.056ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 454.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold s</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D42C" d="M415 140c0 -146 -154 -146 -185 -146c-20 0 -72 0 -118 32l-26 -17c-21 -15 -23 -15 -30 -15c-18 0 -18 9 -18 28v109c0 23 0 29 24 29c14 0 19 0 24 -14c12 -43 38 -116 144 -116c22 0 114 0 114 75c0 59 -75 72 -111 78c-77 14 -115 20 -155 55c-20 17 -40 44 -40 84 c0 131 154 131 184 131c40 0 75 -6 101 -19c39 19 41 19 45 19c18 0 18 -9 18 -28v-80c0 -23 0 -28 -24 -28c-21 0 -22 5 -23 20c-5 55 -43 84 -118 84c-19 0 -112 0 -112 -62c0 -47 65 -58 102 -65c78 -13 110 -19 149 -48c35 -28 55 -63 55 -106Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D42C" x="0" y="0"></use>
</g>
</svg> will be
modified so that the coordinate system is orthogonal.

</p>
<p></p>
<span class="anchor" id="fragment-Computeshadingbitangentmonotsfortriangleandadjustmonoss-0"></span><div class="fragmentname">&lt;&lt;Compute shading bitangent <tt>ts</tt> for triangle and adjust <tt>ss</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> ts = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ns, ss);
if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(ts) &gt; 0)
    ss = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(ts, ns);
else
    <a href="../Geometry_and_Transformations/Vectors.html#CoordinateSystem" class="code">CoordinateSystem</a>(ns, &amp;ss, &amp;ts);</div><p>


</p>
<p>The code to compute the partial derivatives <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.702ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2885.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2313" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.5ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2798.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential bold n Subscript slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D427" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1226" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1726" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2313" y="0"></use>
</g>
</svg> of the
shading normal is almost identical to the code to compute the partial
derivatives <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.509ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2802.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential u</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="2230" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2715.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">partial-differential normal p slash partial-differential v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2202" d="M515 457c36 -143 15 -479 -223 -479c-140 0 -212 116 -228 178c-8 31 -24 124 38 207c59 78 120 94 181 94c78 0 133 -56 158 -118c2 81 -5 132 -14 171c-33 129 -116 181 -189 181c-29 0 -98 -6 -124 -80c16 0 47 0 56 -35c6 -23 -8 -53 -41 -53c-30 0 -43 21 -46 35 c-7 28 6 158 151 158c123 0 241 -100 281 -259zM432 303c-5 20 -35 132 -144 132c-62 0 -103 -32 -128 -89c-26 -60 -16 -200 -10 -227c3 -10 29 -113 139 -113c154 0 161 225 143 297Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="586" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2202" x="1643" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="2230" y="0"></use>
</g>
</svg>.  Therefore, it has been elided from the
text here.

</p>
<p>

</p>
<p>

</p>
<p>
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Sampling"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:triangle-sampling"></span><span id="Sampling"></span><h3>6.5.4  Sampling<button data-toggle="tooltip" data-placement="right" class="btn difficult-button"
title="This section contains advanced content and may be skipped on a first reading.">
<i class="fas fa-exclamation-triangle midredtext"></i></button>
</h3><p>




</p>
<p>The uniform area triangle sampling method is based on mapping the provided
random sample <tt>u</tt> to barycentric coordinates that are uniformly
distributed over the triangle.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-4"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TrianglePublicMethods-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; <span class="anchor" id="Triangle::Sample"></span>Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-669" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-669"><i></i></a><div id="fragbit-669" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Samplepointontriangleuniformlybyarea-0">Sample point on triangle uniformly by area</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-670" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-670"><i></i></a><div id="fragbit-670" class="collapse"><div class="fragmentcode">       pstd::array&lt;Float, 3&gt; b = <a href="#SampleUniformTriangle" class="code">SampleUniformTriangle</a>(u);
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = b[0] * p0 + b[1] * p1 + b[2] * p2;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesurfacenormalforsampledpointontriangle-0">Compute surface normal for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-671" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-671"><i></i></a><div id="fragbit-671" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
       if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
           <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(b[0] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + b[1] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] +
                       (1 - b[0] - b[1]) * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
           <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
       } else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
           <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeuvforsampledpointontriangle-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-672" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-672"><i></i></a><div id="fragbit-672" class="collapse"><div class="fragmentcode">       &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-673" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-673"><i></i></a><div id="fragbit-673" class="collapse"><div class="fragmentcode">          pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
              mesh-&gt;uv
                  ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                        {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
                  : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvSample = b[0] * uv[0] + b[1] * uv[1] + b[2] * uv[2];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorforsampledpointontriangle-0">Compute error bounds <tt>pError</tt> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-674" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-674"><i></i></a><div id="fragbit-674" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[0] * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[1] * p1) +
                         <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>((1 - b[0] - b[1]) * p2);
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(6) * pAbsSum);</div></div>
    return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(Point3fi(p, pError), n, uvSample),
                       1 / <a href="#Triangle::Area" class="code">Area</a>()};
}</div><p>


</p>
<p>Uniform barycentric sampling is provided via a stand-alone utility function
(to be described shortly), which makes it easier to reuse this
functionality elsewhere.

</p>
<p></p>
<span class="anchor" id="fragment-Samplepointontriangleuniformlybyarea-0"></span><div class="fragmentname">&lt;&lt;Sample point on triangle uniformly by area&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">pstd::array&lt;Float, 3&gt; b = <a href="#SampleUniformTriangle" class="code">SampleUniformTriangle</a>(u);
<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = b[0] * p0 + b[1] * p1 + b[2] * p2;</div><p>


</p>
<p>As with <a href="#Triangle::NormalBounds"><tt>Triangle::NormalBounds()</tt></a>, the surface normal of the sampled
point is affected by the orientation of the shading normal, if present.

</p>
<p></p>
<span class="anchor" id="fragment-Computesurfacenormalforsampledpointontriangle-0"></span><div class="fragmentname">&lt;&lt;Compute surface normal for sampled point on triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
    <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(b[0] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + b[1] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] +
                (1 - b[0] - b[1]) * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
    <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
} else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
    <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div><p>


</p>
<p>The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> coordinates for the sampled point are also found with
barycentric interpolation.

</p>
<p></p>
<span class="anchor" id="fragment-Computeuvforsampledpointontriangle-0"></span><div class="fragmentname">&lt;&lt;Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> for sampled point on triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-675" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-675"><i></i></a><div id="fragbit-675" class="collapse"><div class="fragmentcode">   pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
       mesh-&gt;uv
           ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                 {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
           : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvSample = b[0] * uv[0] + b[1] * uv[1] + b[2] * uv[2];</div><p>


</p>
<p>Because barycentric interpolation is linear, it can be shown that if we can
find barycentric coordinates that uniformly sample a specific triangle,
then those barycentrics can be used to uniformly sample any triangle.  To
derive the sampling algorithm, we
will therefore consider the case of uniformly sampling a unit right
triangle.  Given a uniform sample in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.965ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2568.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg> that we would like to map to
the triangle, the task can also be considered as finding an area-preserving
mapping from the unit square to the unit triangle.

</p>
<p> </p>
<span class="anchor" id="fig:square-to-triangle-via-reflection"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f15.svg" title=""><img src="pha06f15.svg" width=169 height=169 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.15: <span class="legend">
Samples from the unit square can be mapped to the unit right
triangle by reflecting across the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.57ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 4120.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x plus y equals 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="794" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1795" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2563" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3620" y="0"></use>
</g>
</svg> diagonal, though doing so causes
far away samples on the square to map to nearby points on the triangle.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>A straightforward approach is suggested by
Figure&nbsp;<a href="#fig:square-to-triangle-via-reflection">6.15</a>: the unit
square could be folded over onto itself, such that samples that are on the
side of the diagonal that places them outside the triangle are reflected
across the diagonal to be inside it.  While this would provide a valid
sampling technique, it is undesirable since it causes samples that were
originally far away in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.965ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2568.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg> to be close together on the triangle.  (For example, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.112ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4784.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.01 comma 0.01 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4394" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.112ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4784.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.99 comma 0.99 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-39" d="M457 329c0 -215 -122 -351 -251 -351c-85 0 -139 41 -139 108c0 39 30 48 46 48c22 0 46 -15 46 -46c0 -17 -8 -46 -52 -46c27 -34 81 -36 98 -36c58 0 162 46 162 280v32c-23 -58 -64 -100 -125 -100c-112 0 -200 98 -200 223c0 75 23 117 64 162c43 45 92 63 147 63 c89 0 204 -68 204 -337zM365 421c0 46 -4 109 -16 141c-17 45 -50 79 -96 79c-35 0 -73 -13 -100 -63c-21 -37 -21 -84 -21 -138c0 -49 0 -99 18 -136c31 -63 77 -63 93 -63c88 0 122 97 122 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-39" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-39" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4394" y="0"></use>
</g>
</svg> in the unit square would both map to the same point in the
triangle.)  The effect would be that sampling techniques that generate
well-distributed uniform samples such as those discussed in
Chapter&nbsp;<a href="../Sampling_and_Reconstruction.html#chap:sampling-reconstruction">8</a> were less effective at reducing
error.

</p>
<p>A better mapping translates points along the diagonal by a varying
amount that brings the two opposite sides of the unit square to the
triangle&rsquo;s diagonal.
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="59.314ex" height="5.509ex" style="vertical-align: -2.171ex;" viewBox="0 -1437.2 25538.1 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis xi 1 comma xi 2 right-parenthesis equals left-parenthesis xi 1 minus delta comma xi 2 minus delta right-parenthesis comma normal w normal h normal e normal r normal e delta equals StartLayout Enlarged left-brace 1st Row 1st Column xi 1 slash 2 2nd Column xi 1 less-than xi 2 2nd Row 1st Column xi 2 slash 2 2nd Column otherwise period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FF" d="M452 667c0 -6 -2 -12 -5 -18c-7 -13 -22 -22 -36 -22c-3 0 -7 1 -11 2c-38 16 -66 48 -111 50c-11 0 -21 -1 -32 -6c-9 -5 -17 -14 -22 -23c-3 -5 -4 -11 -4 -17c0 -45 63 -124 107 -181c28 -35 49 -75 58 -122c2 -15 3 -30 3 -46c0 -33 -5 -68 -14 -102 c-24 -98 -96 -193 -184 -193c-56 0 -103 26 -130 68c-19 29 -28 63 -28 100c0 20 2 40 8 61c14 58 48 115 98 158c35 30 75 51 116 60c-30 56 -61 120 -61 173c0 19 3 36 12 51c7 14 18 26 31 34c14 9 29 13 43 16c8 1 17 2 26 2c36 0 78 -10 115 -19c13 -3 21 -13 21 -26z M330 244c0 17 -1 34 -5 50c-8 42 -26 80 -46 116l-3 5c-31 -9 -62 -29 -86 -55c-40 -42 -60 -95 -73 -147c-7 -28 -13 -57 -13 -84c0 -22 4 -43 12 -61c15 -34 45 -57 86 -57c63 0 99 79 118 152c7 27 10 55 10 81Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-77" d="M703 400c-35 -1 -66 -14 -84 -64l-117 -328c-4 -10 -7 -19 -20 -19s-16 8 -20 19l-102 284l-101 -283c-5 -14 -7 -20 -20 -20s-16 8 -21 22l-126 354c-12 32 -24 35 -74 35v31l93 -3l109 3v-31c-20 0 -59 0 -59 -27c0 -4 0 -6 5 -18l95 -267l86 242c-7 19 -18 49 -23 55 c-10 13 -26 15 -63 15v31c30 -2 59 -3 89 -3l104 3v-31c-20 0 -59 0 -59 -27c0 -5 1 -7 5 -19l99 -279l91 256c5 13 5 15 5 21c0 29 -22 47 -58 48v31l93 -3c22 0 51 1 73 3v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-7B" d="M608 -780c0 -11 -9 -20 -20 -20c-2 0 -3 0 -5 1c-145 37 -273 148 -273 261v526c0 99 -81 213 -195 243c-9 2 -15 10 -15 19s6 17 15 19c114 30 195 144 195 243v526c0 113 128 224 273 261c2 1 3 1 5 1c11 0 20 -9 20 -20c0 -9 -6 -17 -15 -19 c-114 -29 -195 -134 -195 -223v-526c0 -108 -96 -212 -215 -262c119 -50 215 -154 215 -262v-526c0 -89 81 -194 195 -223c9 -2 15 -10 15 -19Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
<g transform="translate(942,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="620" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1834" y="0"></use>
<g transform="translate(2279,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="620" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3171" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3839" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4895" y="0"></use>
<g transform="translate(5285,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="620" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="6399" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="7400" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="7852" y="0"></use>
<g transform="translate(8298,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="620" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="9412" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="10413" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10865" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="11255" y="0"></use>
<g transform="translate(11867,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-77" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-68" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="2116" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FF" x="14761" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="15491" y="0"></use>
<g transform="translate(16547,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-7B"></use>
<g transform="translate(874,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,551)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="620" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="892" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1392" y="0"></use>
</g>
<g transform="translate(0,-600)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="620" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="892" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1392" y="0"></use>
</g>
</g>
<g transform="translate(2882,0)">
<g transform="translate(0,551)">
<g transform="translate(332,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="620" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="1170" y="0"></use>
<g transform="translate(2226,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="620" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(0,-600)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="332" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-68" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="2223" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-77" x="2615" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="3338" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="3616" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="4011" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="4455" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

The determinant of the Jacobian matrix for this mapping is a constant and
therefore this mapping is area preserving and uniformly distributed samples
in the unit square are uniform in the triangle.
(Recall Section&nbsp;<a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#sec:mc-transform-multiple-dimensions">2.4.1</a>, which presented the
mathematics of transforming samples from one domain to the other; there it
was shown that if the Jacobian of the transformation is constant, the
mapping is area-preserving.)

</p>
<p></p>
<span class="anchor" id="fragment-SamplingInlineFunctions-11"></span><div class="fragmentname">&lt;&lt;Sampling Inline Functions&gt;&gt;+=&nbsp;<a href="../Cameras_and_Film/Film_and_Imaging.html#fragment-SamplingInlineFunctions-10"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="../Sampling_Algorithms/Sampling_1D_Functions.html#fragment-SamplingInlineFunctions-12"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::array&lt;Float, 3&gt; <span class="anchor" id="SampleUniformTriangle"></span>SampleUniformTriangle(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) {
    Float b0, b1;
    if (u[0] &lt; u[1]) {
        b0 = u[0] / 2;
        b1 = u[1] - b0;
    } else {
        b1 = u[1] / 2;
        b0 = u[0] - b1;
    }
    return {b0, b1, 1 - b0 - b1};
}</div><p>


</p>
<p>

</p>
<p>The usual normalization constraint gives the PDF in terms of the triangle&rsquo;s
surface area.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-5"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-4"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TrianglePublicMethods-6"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Triangle::PDF"></span>PDF(const <a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a> &amp;) const { return 1 / <a href="#Triangle::Area" class="code">Area</a>(); }</div><p>


</p>
<p>In order to sample points on spheres with respect to solid angle from a
reference point, we derived a specialized sampling method that only sampled
from the potentially visible region of the sphere.  For the cylinder and
disk, we just sampled uniformly by area and rescaled the PDF to
account for the change of measure from area to solid angle.  It is tempting
to do the same for triangles (and, indeed, all three previous editions of
this book did so), but going through the work to apply a solid angle
sampling approach can lead to much better results.

</p>
<p>To see why, consider a simplified form of the reflection integral from the
scattering equation, (<a href="../Radiometry,_Spectra,_and_Color/Surface_Reflection.html#eq:scattering-equation">4.14</a>):
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.253ex" height="5.676ex" style="vertical-align: -2.338ex;" viewBox="0 -1437.2 10872.8 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">integral Underscript script upper S squared Endscripts rho upper L Subscript normal i Superscript Baseline left-parenthesis normal p Subscript Baseline comma omega Subscript normal i Baseline right-parenthesis StartAbsoluteValue cosine theta Subscript normal i Baseline EndAbsoluteValue normal d omega Subscript normal i Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-53" d="M499 186c0 -110 -80 -208 -197 -208c-89 0 -153 36 -184 70c-33 -53 -36 -57 -36 -57c-7 -11 -8 -13 -15 -13c-11 0 -11 7 -11 24v200c0 18 0 25 13 25c3 0 11 0 12 -10c1 -36 4 -100 62 -154c53 -49 129 -54 158 -54c84 0 134 72 134 143c0 33 -10 66 -31 92 c-28 37 -58 44 -85 51c-70 17 -121 29 -132 33c-78 27 -131 100 -131 183c0 106 84 194 195 194c89 0 130 -41 160 -70l35 57c7 12 8 13 15 13c11 0 11 -7 11 -24v-201c0 -19 0 -24 -13 -24c-11 0 -11 6 -12 12c-6 45 -28 209 -195 209c-78 0 -132 -61 -132 -131 c0 -58 39 -112 101 -127l128 -31c84 -20 150 -102 150 -202Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70C" d="M502 279c0 -149 -129 -290 -246 -290c-47 0 -79 27 -99 67c-27 -108 -59 -242 -64 -251c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l98 393c30 122 135 222 232 222c73 0 139 -57 139 -163zM430 322c0 69 -32 98 -69 98c-31 0 -81 -22 -124 -95 c-22 -40 -32 -76 -60 -188c-3 -13 -8 -33 -8 -37c0 -9 16 -89 86 -89c38 0 86 32 119 95c27 49 56 161 56 216Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43F" d="M643 247c0 0 0 -3 -4 -14l-79 -216c-6 -17 -7 -17 -31 -17h-463c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 12 20 19 20l133 -3l148 3c5 0 16 0 16 -12 c0 -19 -8 -19 -38 -19c-94 0 -97 -11 -106 -47l-135 -540c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h94c173 0 217 114 251 206c7 16 8 21 17 21s12 -7 12 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
<g transform="translate(574,-898)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-53" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="685" y="483"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70C" x="1592" y="0"></use>
<g transform="translate(2276,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="963" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="978" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1367" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1924" y="0"></use>
<g transform="translate(2369,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3289" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="6122" y="0"></use>
<g transform="translate(6400,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(7906,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="663" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="8673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="9118" y="0"></use>
<g transform="translate(9674,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="10594" y="0"></use>
</g>
</svg>
</div>
<p>

where the BRDF <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.283ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 552.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
</g>
</svg> has been replaced with a constant <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.202ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 517.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">rho</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70C" d="M502 279c0 -149 -129 -290 -246 -290c-47 0 -79 27 -99 67c-27 -108 -59 -242 -64 -251c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l98 393c30 122 135 222 232 222c73 0 139 -57 139 -163zM430 322c0 69 -32 98 -69 98c-31 0 -81 -22 -124 -95 c-22 -40 -32 -76 -60 -188c-3 -13 -8 -33 -8 -37c0 -9 16 -89 86 -89c38 0 86 32 119 95c27 49 56 161 56 216Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70C" x="0" y="0"></use>
</g>
</svg>, which
corresponds to a diffuse surface.  If we consider the case of incident
radiance only coming from a triangular light source
that emits uniform diffuse radiance <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.545ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1095.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper L Subscript normal e</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43F" d="M643 247c0 0 0 -3 -4 -14l-79 -216c-6 -17 -7 -17 -31 -17h-463c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 12 20 19 20l133 -3l148 3c5 0 16 0 16 -12 c0 -19 -8 -19 -38 -19c-94 0 -97 -11 -106 -47l-135 -540c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h94c173 0 217 114 251 206c7 16 8 21 17 21s12 -7 12 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-65" x="963" y="-213"></use>
</g>
</svg>, then we can rewrite this
integral as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.313ex" height="5.676ex" style="vertical-align: -2.338ex;" viewBox="0 -1437.2 11759.6 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">rho upper L Subscript normal e Baseline integral Underscript script upper S squared Endscripts upper V left-parenthesis normal p Subscript Baseline comma omega Subscript normal i Baseline right-parenthesis StartAbsoluteValue cosine theta Subscript normal i Baseline EndAbsoluteValue normal d omega Subscript normal i Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70C" d="M502 279c0 -149 -129 -290 -246 -290c-47 0 -79 27 -99 67c-27 -108 -59 -242 -64 -251c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l98 393c30 122 135 222 232 222c73 0 139 -57 139 -163zM430 322c0 69 -32 98 -69 98c-31 0 -81 -22 -124 -95 c-22 -40 -32 -76 -60 -188c-3 -13 -8 -33 -8 -37c0 -9 16 -89 86 -89c38 0 86 32 119 95c27 49 56 161 56 216Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43F" d="M643 247c0 0 0 -3 -4 -14l-79 -216c-6 -17 -7 -17 -31 -17h-463c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 12 20 19 20l133 -3l148 3c5 0 16 0 16 -12 c0 -19 -8 -19 -38 -19c-94 0 -97 -11 -106 -47l-135 -540c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h94c173 0 217 114 251 206c7 16 8 21 17 21s12 -7 12 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-53" d="M499 186c0 -110 -80 -208 -197 -208c-89 0 -153 36 -184 70c-33 -53 -36 -57 -36 -57c-7 -11 -8 -13 -15 -13c-11 0 -11 7 -11 24v200c0 18 0 25 13 25c3 0 11 0 12 -10c1 -36 4 -100 62 -154c53 -49 129 -54 158 -54c84 0 134 72 134 143c0 33 -10 66 -31 92 c-28 37 -58 44 -85 51c-70 17 -121 29 -132 33c-78 27 -131 100 -131 183c0 106 84 194 195 194c89 0 130 -41 160 -70l35 57c7 12 8 13 15 13c11 0 11 -7 11 -24v-201c0 -19 0 -24 -13 -24c-11 0 -11 6 -12 12c-6 45 -28 209 -195 209c-78 0 -132 -61 -132 -131 c0 -58 39 -112 101 -127l128 -31c84 -20 150 -102 150 -202Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70C" x="0" y="0"></use>
<g transform="translate(517,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-65" x="963" y="-213"></use>
</g>
<g transform="translate(1779,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
<g transform="translate(574,-898)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-53" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="685" y="483"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="3372" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4142" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="4531" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5088" y="0"></use>
<g transform="translate(5533,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6452" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="7008" y="0"></use>
<g transform="translate(7287,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(8793,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="663" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="9560" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="10005" y="0"></use>
<g transform="translate(10561,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="11481" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 769.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper V</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="0" y="0"></use>
</g>
</svg> is a visibility function that is 1 if the ray from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.293ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 556.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
</g>
</svg> in
direction <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.135ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 919.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript normal i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
</svg> hits the light source and 0 if it misses or is occluded by
another object. 
If we sample the triangle uniformly within the solid angle that it subtends
from the reference point, we end up with the estimator
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.474ex" height="6.176ex" style="vertical-align: -2.671ex;" viewBox="0 -1508.9 10967.8 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartFraction rho upper L Subscript normal e Baseline Over 1 slash upper A Subscript normal s normal o normal l normal i normal d Baseline EndFraction left-parenthesis upper V left-parenthesis normal p Subscript Baseline comma omega Subscript normal i Baseline right-parenthesis StartAbsoluteValue cosine theta prime EndAbsoluteValue right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70C" d="M502 279c0 -149 -129 -290 -246 -290c-47 0 -79 27 -99 67c-27 -108 -59 -242 -64 -251c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l98 393c30 122 135 222 232 222c73 0 139 -57 139 -163zM430 322c0 69 -32 98 -69 98c-31 0 -81 -22 -124 -95 c-22 -40 -32 -76 -60 -188c-3 -13 -8 -33 -8 -37c0 -9 16 -89 86 -89c38 0 86 32 119 95c27 49 56 161 56 216Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43F" d="M643 247c0 0 0 -3 -4 -14l-79 -216c-6 -17 -7 -17 -31 -17h-463c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 12 20 19 20l133 -3l148 3c5 0 16 0 16 -12 c0 -19 -8 -19 -38 -19c-94 0 -97 -11 -106 -47l-135 -540c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h94c173 0 217 114 251 206c7 16 8 21 17 21s12 -7 12 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="3391" height="60" x="0" y="220"></rect>
<g transform="translate(889,736)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70C" x="0" y="0"></use>
<g transform="translate(517,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-65" x="963" y="-213"></use>
</g>
</g>
<g transform="translate(60,-771)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
<g transform="translate(1001,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
<g transform="translate(750,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-73" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="394" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6C" x="894" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="1173" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-64" x="1452" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(3631,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-28"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1159" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="1548" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2105" y="0"></use>
<g transform="translate(2550,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="880" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3469" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="4025" y="0"></use>
<g transform="translate(4304,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(5810,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="6668" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6946" y="0"></use>
</g>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.274ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2270.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A Subscript normal s normal o normal l normal i normal d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
<g transform="translate(750,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-73" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6F" x="394" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6C" x="894" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-69" x="1173" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-64" x="1452" y="0"></use>
</g>
</g>
</svg> is the subtended solid angle.
The constant values have been
pulled out, leaving just the two factors in parentheses that vary based on
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.194ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 944.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
</svg>.  They are the only source of variance in estimates of the integral.

</p>
<p>As an alternative, consider a Monte Carlo estimate of this function where a point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.194ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 944.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
</svg>
has been uniformly sampled on the surface of the triangle.  If the
triangle&rsquo;s area is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
</g>
</svg>, then the PDF is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.412ex" height="2.843ex" style="vertical-align: -0.838ex; margin-left: -0.073ex;" viewBox="-31.5 -863.1 5344.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">p left-parenthesis normal p prime right-parenthesis equals 1 slash upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="503" y="0"></use>
<g transform="translate(893,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1837" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2504" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3561" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="4061" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="4562" y="0"></use>
</g>
</svg>.  Applying the
standard Monte Carlo estimator and defining a new visibility function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 769.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper V</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="0" y="0"></use>
</g>
</svg>
that is between two points, we end up with
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.716ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 14947 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartFraction rho upper L Subscript normal e Baseline Over 1 slash upper A EndFraction left-parenthesis upper V left-parenthesis normal p Subscript Baseline comma normal p Superscript prime Baseline right-parenthesis StartAbsoluteValue cosine theta Superscript prime Baseline EndAbsoluteValue StartFraction StartAbsoluteValue cosine theta Subscript normal l Baseline EndAbsoluteValue Over double-vertical-bar normal p prime minus normal p Subscript Baseline double-vertical-bar squared EndFraction right-parenthesis comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D70C" d="M502 279c0 -149 -129 -290 -246 -290c-47 0 -79 27 -99 67c-27 -108 -59 -242 -64 -251c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l98 393c30 122 135 222 232 222c73 0 139 -57 139 -163zM430 322c0 69 -32 98 -69 98c-31 0 -81 -22 -124 -95 c-22 -40 -32 -76 -60 -188c-3 -13 -8 -33 -8 -37c0 -9 16 -89 86 -89c38 0 86 32 119 95c27 49 56 161 56 216Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D43F" d="M643 247c0 0 0 -3 -4 -14l-79 -216c-6 -17 -7 -17 -31 -17h-463c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 12 20 19 20l133 -3l148 3c5 0 16 0 16 -12 c0 -19 -8 -19 -38 -19c-94 0 -97 -11 -106 -47l-135 -540c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h94c173 0 217 114 251 206c7 16 8 21 17 21s12 -7 12 -11Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E2-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSIZE6-28" d="M682 -928c0 -10 -8 -18 -18 -18c-4 0 -8 2 -11 4c-222 167 -427 613 -427 1006v372c0 393 205 839 427 1006c3 2 7 4 11 4c10 0 18 -8 18 -18c0 -6 -3 -11 -7 -14c-213 -160 -361 -603 -361 -978v-372c0 -375 148 -818 361 -978c4 -3 7 -8 7 -14Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSIZE6-29" d="M510 64c0 -393 -205 -839 -427 -1006c-3 -2 -7 -4 -11 -4c-10 0 -18 8 -18 18c0 6 3 11 7 14c213 160 361 603 361 978v372c0 375 -148 818 -361 978c-4 3 -7 8 -7 14c0 10 8 18 18 18c4 0 8 -2 11 -4c222 -167 427 -613 427 -1006v-372Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="1871" height="60" x="0" y="220"></rect>
<g transform="translate(129,736)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D70C" x="0" y="0"></use>
<g transform="translate(517,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D43F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-65" x="963" y="-213"></use>
</g>
</g>
<g transform="translate(60,-771)">
 <use xlink:href="#E2-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D434" x="1001" y="0"></use>
</g>
</g>
<g transform="translate(2111,0)">
 <use xlink:href="#E2-LATINMODERNSIZE6-28"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D449" x="736" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="1506" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-70" x="1895" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="2452" y="0"></use>
<g transform="translate(2897,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNVARIANTS-2032" x="787" y="583"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="3841" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="4397" y="0"></use>
<g transform="translate(4676,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(6182,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNVARIANTS-2032" x="663" y="583"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="7040" y="0"></use>
<g transform="translate(7318,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="4094" height="60" x="0" y="220"></rect>
<g transform="translate(549,770)">
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(1784,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-6C" x="235" y="0"></use>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-7C" x="2717" y="0"></use>
</g>
<g transform="translate(60,-780)">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
<g transform="translate(398,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNVARIANTS-2032" x="787" y="408"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2212" x="1166" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-70" x="2167" y="0"></use>
</g>
<g transform="translate(3122,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-32" x="563" y="408"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNSIZE6-29" x="11653" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="14668" y="0"></use>
</g>
</svg>
</div>
<p>

where the last factor accounts for the change of variables and where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.665ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2439.3 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta Subscript normal l</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6C" x="235" y="0"></use>
</g>
</g>
</g>
</svg> is the angle between the light source&rsquo;s surface normal
and the vector between the two points.
The values of the four factors inside the parentheses in this estimator all
depend on the choice of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.194ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 944.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
</svg>.

</p>
<p>With area sampling, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.959ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2996.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartAbsoluteValue cosine theta Subscript normal l Baseline EndAbsoluteValue</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(1784,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-6C" x="235" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="2717" y="0"></use>
</g>
</svg> factor adds some
additional variance, though not too much, since it is between&nbsp;0 and&nbsp;1.
However, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.557ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 4976 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1 slash double-vertical-bar normal p prime minus normal p Subscript Baseline double-vertical-bar squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E2-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="1001" y="0"></use>
<g transform="translate(1399,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2212" x="1166" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-70" x="2167" y="0"></use>
</g>
<g transform="translate(4123,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-32" x="563" y="513"></use>
</g>
</g>
</svg> can have unbounded variation over the
surface of the triangle, which can lead to high variance in the estimator
since the method used to sample <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.194ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 944.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
</svg> does not account for it at all.
This variance increases the larger the triangle is and the closer the
reference point is to it.
Figure&nbsp;<a href="#fig:solid-angle-triangle-sampling-win">6.16</a> shows a scene where
solid angle sampling significantly reduces error.

</p>
<p> </p>
<span class="anchor" id="fig:solid-angle-triangle-sampling-win"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="tri-sample-image.png" style="max-width: 100%; height: auto;" width=1366 height=1024>
</div>
<p>

</p>
<figcaption class="caption">Figure 6.16: A Scene Where Solid Angle Triangle Sampling Is Beneficial. <span class="legend">
When points on triangles are sampled using uniform area sampling,
error is high at points on the ground close to the emitter.
If points are sampled on the triangle by uniformly sampling the solid
angle the triangle subtends, then the remaining non-constant factors in the estimator
are both between 0 and 1, which results in much lower error.  For this
scene, mean squared error (MSE) is reduced by a factor of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.134ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1780 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3.86</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="1279" y="0"></use>
</g>
</svg>.
<em>(Dragon model courtesy of the Stanford Computer Graphics Laboratory.)</em>
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The <tt>Triangle::Sample()</tt> method that takes a reference point therefore
samples a point according to solid angle.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-6"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-5"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TrianglePublicMethods-7"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; Sample(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx,
                                   <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-676" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-676"><i></i></a><div id="fragbit-676" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Useuniformareasamplingfornumericallyunstablecases-0">Use uniform area sampling for numerically unstable cases</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-677" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-677"><i></i></a><div id="fragbit-677" class="collapse"><div class="fragmentcode">       Float solidAngle = <a href="#Triangle::SolidAngle" class="code">SolidAngle</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>());
       if (solidAngle &lt; <a href="#Triangle::MinSphericalSampleArea" class="code">MinSphericalSampleArea</a> ||
           solidAngle &gt; <a href="#Triangle::MaxSphericalSampleArea" class="code">MaxSphericalSampleArea</a>) {
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Sampleshapebyareaandcomputeincidentdirectionmonowi-0">Sample shape by area and compute incident direction <tt>wi</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-678" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-678"><i></i></a><div id="fragbit-678" class="collapse"><div class="fragmentcode">              pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; ss = Sample(u);
              ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a> = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>;
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi = ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>() - ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
              if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(wi) == 0) return {};
              wi = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(wi);</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ConvertareasamplingPDFinmonosstosolidanglemeasure-0">Convert area sampling PDF in <tt>ss</tt> to solid angle measure</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-679" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-679"><i></i></a><div id="fragbit-679" class="collapse"><div class="fragmentcode">              ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a> /= <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                         <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>());
              if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a>))
                  return {};</div></div>
           return ss;
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Samplesphericaltrianglefromreferencepoint-0">Sample spherical triangle from reference point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-680" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-680"><i></i></a><div id="fragbit-680" class="collapse"><div class="fragmentcode">       &lt;&lt;<span class="fragmentname"><a href="#fragment-Applywarpproductsamplingforcosinefactoratreferencepoint-0">Apply warp product sampling for cosine factor at reference point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-681" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-681"><i></i></a><div id="fragbit-681" class="collapse"><div class="fragmentcode">          Float pdf = 1;
          if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-682" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-682"><i></i></a><div id="fragbit-682" class="collapse"><div class="fragmentcode">                 <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
                 <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                                   <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
                 pstd::array&lt;Float, 4&gt; w =
                     pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                           std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                           std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                           std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
              u = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#SampleBilinear" class="code">SampleBilinear</a>(u, w);
              pdf = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
          }</div></div>
       Float triPDF;
       pstd::array&lt;Float, 3&gt; b =
           <a href="#SampleSphericalTriangle" class="code">SampleSphericalTriangle</a>({p0, p1, p2}, ctx.p(), u, &amp;triPDF);
       if (triPDF == 0) return {};
       pdf *= triPDF;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Managing_Rounding_Error.html#fragment-ComputeerrorboundsmonopErrorforsampledpointontriangle-0">Compute error bounds <tt>pError</tt> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-683" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-683"><i></i></a><div id="fragbit-683" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> pAbsSum = <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[0] * p0) + <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>(b[1] * p1) +
                         <a href="../Geometry_and_Transformations/n-Tuple_Base_Classes.html#Tuple3::Abs" class="code">Abs</a>((1 - b[0] - b[1]) * p2);
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> pError = <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a>(<a href="../Shapes/Managing_Rounding_Error.html#gamma" class="code">gamma</a>(6) * pAbsSum);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnmonoShapeSampleforsolidanglesampledpointontriangle-0">Return <tt>ShapeSample</tt> for solid angle sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-684" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-684"><i></i></a><div id="fragbit-684" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = b[0] * p0 + b[1] * p1 + b[2] * p2;
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesurfacenormalforsampledpointontriangle-0">Compute surface normal for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-685" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-685"><i></i></a><div id="fragbit-685" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
          if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
              <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(b[0] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + b[1] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] +
                          (1 - b[0] - b[1]) * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
              <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
          } else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
              <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeuvforsampledpointontriangle-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-686" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-686"><i></i></a><div id="fragbit-686" class="collapse"><div class="fragmentcode">          &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-687" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-687"><i></i></a><div id="fragbit-687" class="collapse"><div class="fragmentcode">             pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
                 mesh-&gt;uv
                     ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                           {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
                     : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
          <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvSample = b[0] * uv[0] + b[1] * uv[1] + b[2] * uv[2];</div></div>
       return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(Point3fi(p, pError), n, ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>, uvSample),
                          pdf};</div></div>
}</div><p>


</p>
<p>Triangles that subtend a very small solid angle as well as ones that cover
nearly the whole hemisphere can encounter problems with floating-point
accuracy in the following solid angle sampling approach.  The sampling
method falls back to uniform area sampling in those cases, which does not
hurt results in practice: for very small triangles, the various additional
factors tend not to vary as much over the triangle&rsquo;s area.  <tt>pbrt</tt> also
samples the BSDF as part of the direct lighting calculation, which is an
effective strategy for large triangles, so uniform area sampling is fine in
that case as well.

</p>
<p></p>
<span class="anchor" id="fragment-Useuniformareasamplingfornumericallyunstablecases-0"></span><div class="fragmentname">&lt;&lt;Use uniform area sampling for numerically unstable cases&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float solidAngle = <a href="#Triangle::SolidAngle" class="code">SolidAngle</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>());
if (solidAngle &lt; <a href="#Triangle::MinSphericalSampleArea" class="code">MinSphericalSampleArea</a> ||
    solidAngle &gt; <a href="#Triangle::MaxSphericalSampleArea" class="code">MaxSphericalSampleArea</a>) {
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Sampleshapebyareaandcomputeincidentdirectionmonowi-0">Sample shape by area and compute incident direction <tt>wi</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-688" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-688"><i></i></a><div id="fragbit-688" class="collapse"><div class="fragmentcode">       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>&gt; ss = Sample(u);
       ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a> = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>;
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi = ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>() - ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(wi) == 0) return {};
       wi = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(wi);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ConvertareasamplingPDFinmonosstosolidanglemeasure-0">Convert area sampling PDF in <tt>ss</tt> to solid angle measure</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-689" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-689"><i></i></a><div id="fragbit-689" class="collapse"><div class="fragmentcode">       ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a> /= <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                  <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>());
       if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(ss-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeSample::pdf" class="code">pdf</a>))
           return {};</div></div>
    return ss;
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-TrianglePrivateMembers-1"></span><div class="fragmentname">&lt;&lt;Triangle Private Members&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePrivateMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static constexpr Float <span class="anchor" id="Triangle::MinSphericalSampleArea"></span>MinSphericalSampleArea = 3e-4;
static constexpr Float <span class="anchor" id="Triangle::MaxSphericalSampleArea"></span>MaxSphericalSampleArea = 6.22;</div><p>


</p>
<p><tt>pbrt</tt> also includes an approximation to the effect of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.784ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2920.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartAbsoluteValue cosine theta prime EndAbsoluteValue</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(1784,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="663" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="2642" y="0"></use>
</g>
</svg> factor in its triangle sampling algorithm, which leaves
visibility and error in that approximation as the only sources of variance.
We will defer discussion of the fragment that handles that, &lt;&lt;<span class="fragmentname"><a href="#fragment-Applywarpproductsamplingforcosinefactoratreferencepoint-0">Apply
warp product sampling for cosine factor at reference point</a></span>&gt;&gt;, until after we
have discussed the uniform solid angle sampling algorithm.  For now we will
note that it affects the final sampling PDF, which turns out to be the
product of the PDF for uniform solid angle sampling of the triangle and a
correction factor.

</p>
<p>Uniform sampling of the solid angle that a triangle subtends is equivalent
to uniformly sampling the spherical triangle that results from its
projection on the unit sphere (recall
Section&nbsp;<a href="../Geometry_and_Transformations/Spherical_Geometry.html#sec:spherical-polygons">3.8.2</a>).  Spherical triangle sampling is
implemented in a separate function described shortly, <a href="#SampleSphericalTriangle"><tt>SampleSphericalTriangle()</tt></a>, that
returns the barycentric coordinates for the sampled point.

</p>
<p></p>
<span class="anchor" id="fragment-Samplesphericaltrianglefromreferencepoint-0"></span><div class="fragmentname">&lt;&lt;Sample spherical triangle from reference point&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">&lt;&lt;<span class="fragmentname"><a href="#fragment-Applywarpproductsamplingforcosinefactoratreferencepoint-0">Apply warp product sampling for cosine factor at reference point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-690" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-690"><i></i></a><div id="fragbit-690" class="collapse"><div class="fragmentcode">   Float pdf = 1;
   if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-691" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-691"><i></i></a><div id="fragbit-691" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                            <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
          pstd::array&lt;Float, 4&gt; w =
              pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                    std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                    std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                    std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
       u = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#SampleBilinear" class="code">SampleBilinear</a>(u, w);
       pdf = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
   }</div></div>
Float triPDF;
pstd::array&lt;Float, 3&gt; b =
    <a href="#SampleSphericalTriangle" class="code">SampleSphericalTriangle</a>({p0, p1, p2}, ctx.p(), u, &amp;triPDF);
if (triPDF == 0) return {};
pdf *= triPDF;</div><p>


</p>
<p>Given the barycentric coordinates, it is simple to compute the sampled
point.  With that as well as the surface normal, computed by reusing a
fragment from the other triangle sampling method, we have everything
necessary to return a <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample"><tt>ShapeSample</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-ReturnmonoShapeSampleforsolidanglesampledpointontriangle-0"></span><div class="fragmentname">&lt;&lt;Return <tt>ShapeSample</tt> for solid angle sampled point on triangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p = b[0] * p0 + b[1] * p1 + b[2] * p2;
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computesurfacenormalforsampledpointontriangle-0">Compute surface normal for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-692" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-692"><i></i></a><div id="fragbit-692" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(p1 - p0, p2 - p0)));
   if (mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>) {
       <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a> ns(b[0] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[0]] + b[1] * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[1]] +
                   (1 - b[0] - b[1]) * mesh-&gt;<a href="#TriangleMesh::n" class="code">n</a>[v[2]]);
       <a href="#TriangleMesh::n" class="code">n</a> = <a href="../Geometry_and_Transformations/Normals.html#FaceForward" class="code">FaceForward</a>(<a href="#TriangleMesh::n" class="code">n</a>, ns);
   } else if (mesh-&gt;<a href="#TriangleMesh::reverseOrientation" class="code">reverseOrientation</a> ^ mesh-&gt;<a href="#TriangleMesh::transformSwapsHandedness" class="code">transformSwapsHandedness</a>)
       <a href="#TriangleMesh::n" class="code">n</a> *= -1;</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Computeuvforsampledpointontriangle-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.301ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2282.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis u comma v right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D462" d="M543 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-43 0 -78 26 -89 67c-17 -22 -53 -67 -119 -67c-54 0 -123 25 -123 120c0 49 21 111 58 210c6 15 17 44 17 68c0 32 -16 33 -25 33c-38 0 -76 -37 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -17 -63c-26 -69 -54 -148 -54 -204c0 -37 10 -82 62 -82c73 0 113 80 114 84l75 301c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104 c0 -33 10 -46 31 -46c42 0 61 68 75 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D462" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1892" y="0"></use>
</g>
</svg> for sampled point on triangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-693" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-693"><i></i></a><div id="fragbit-693" class="collapse"><div class="fragmentcode">   &lt;&lt;<span class="fragmentname">Get triangle texture coordinates in <tt>uv</tt> array</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-694" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-694"><i></i></a><div id="fragbit-694" class="collapse"><div class="fragmentcode">      pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt; uv =
          mesh-&gt;uv
              ? pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;(
                    {mesh-&gt;uv[v[0]], mesh-&gt;uv[v[1]], mesh-&gt;uv[v[2]]})
              : pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>, 3&gt;({<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 0), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(1, 1)});</div></div>
   <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> uvSample = b[0] * uv[0] + b[1] * uv[1] + b[2] * uv[2];</div></div>
return <a href="../Shapes/Basic_Shape_Interface.html#ShapeSample" class="code">ShapeSample</a>{<a href="../Geometry_and_Transformations/Interactions.html#Interaction" class="code">Interaction</a>(Point3fi(p, pError), n, ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::time" class="code">time</a>, uvSample),
                   pdf};</div><p>


</p>
<p>

</p>
<p>








</p>
<p></p>
<span class="anchor" id="fig:spherical-triangle-setting"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f17.svg" title=""><img src="pha06f17.svg" width=700 height=264 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.17: Geometric Setting for Spherical Triangles. <span class="legend">
Given vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>, the respective opposite
edges are labeled <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="2.009ex" style="vertical-align: -0.016ex; margin-bottom: -0.322ex;" viewBox="0 -719.6 559.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a overbar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="29" y="-27"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 639.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b overbar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="2.009ex" style="vertical-align: -0.016ex; margin-bottom: -0.322ex;" viewBox="0 -719.6 511.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c overbar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="5" y="-27"></use>
</g>
</svg> and the interior
angles are labeled with Greek letters <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.334ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 574.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
</g>
</svg>.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The spherical triangle sampling function takes three triangle vertices
<tt>v</tt>, a reference point <tt>p</tt>, and a uniform sample <tt>u</tt>.  The
value of the PDF for the sampled point is optionally returned via
<tt>pdf</tt>, if it is not <tt>nullptr</tt>.
Figure&nbsp;<a href="#fig:spherical-triangle-setting">6.17</a> shows the geometric setting.

</p>
<p></p>
<span class="anchor" id="fragment-SamplingFunctionDefinitions-0"></span><div class="fragmentname">&lt;&lt;Sampling Function Definitions&gt;&gt;=&nbsp;<a href="#fragment-SamplingFunctionDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">pstd::array&lt;Float, 3&gt; <span class="anchor" id="SampleSphericalTriangle"></span>SampleSphericalTriangle(
      const pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>, 3&gt; &amp;v, <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u, Float *pdf) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computevectorsmonoamonobandmonoctosphericaltrianglevertices-0">Compute vectors <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> to spherical triangle vertices</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-695" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-695"><i></i></a><div id="fragbit-695" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> a(v[0] - p), b(v[1] - p), c(v[2] - p);
       a = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(a);
       b = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(b);
       c = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(c);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computenormalizedcrossproductsofalldirectionpairs-0">Compute normalized cross products of all direction pairs</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-696" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-696"><i></i></a><div id="fragbit-696" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n_ab = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(a, b), n_bc = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(b, c), n_ca = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(c, a);
       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_ab) == 0 || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_bc) == 0 ||
           <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_ca) == 0)
           return {};
       n_ab = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_ab);
       n_bc = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_bc);
       n_ca = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_ca);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Findanglesalphabetaandgammaatsphericaltrianglevertices-0">Find angles <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.334ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 574.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
</g>
</svg> at spherical triangle vertices</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-697" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-697"><i></i></a><div id="fragbit-697" class="collapse"><div class="fragmentcode">       Float alpha = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ab, -n_ca);
       Float beta  = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_bc, -n_ab);
       Float gamma = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ca, -n_bc);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-UniformlysampletriangleareaAtocomputeA-0">Uniformly sample triangle area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
</g>
</svg> to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-698" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-698"><i></i></a><div id="fragbit-698" class="collapse"><div class="fragmentcode">       Float A_pi = alpha + beta + gamma;
       Float Ap_pi = <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[0], <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>, A_pi);
       if (pdf) {
           Float A = A_pi - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;
           *pdf = (A &lt;= 0) ? 0 : 1 / A;
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Findcosbetaforpointalongmonobforsampledarea-0">Find <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.74ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 2471.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</g>
</svg> for point along <tt>b</tt> for sampled area</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-699" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-699"><i></i></a><div id="fragbit-699" class="collapse"><div class="fragmentcode">       Float cosAlpha = std::cos(alpha), sinAlpha = std::sin(alpha);
       Float sinPhi = std::sin(Ap_pi) * cosAlpha - std::cos(Ap_pi) * sinAlpha;
       Float cosPhi = std::cos(Ap_pi) * cosAlpha + std::sin(Ap_pi) * sinAlpha;
       Float k1 = cosPhi + cosAlpha;
       Float k2 = sinPhi - sinAlpha * <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(a, b) /* cos c */;
       Float cosBp =
           (k2 + (<a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(k2, cosPhi, k1, sinPhi)) * cosAlpha) /
           ((<a href="../Utilities/Mathematical_Infrastructure.html#SumOfProducts" class="code">SumOfProducts</a>(k2, sinPhi, k1, cosPhi)) * sinAlpha);
       cosBp = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(cosBp, -1, 1);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Samplecalongthearcbetweenbanda-0">Sample <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.908ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 821.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="613" y="513"></use>
</g>
</svg> along the arc between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.899ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 817.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="607" y="513"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-700" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-700"><i></i></a><div id="fragbit-700" class="collapse"><div class="fragmentcode">       Float sinBp = <a href="../Utilities/Mathematical_Infrastructure.html#SafeSqrt" class="code">SafeSqrt</a>(1 - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(cosBp));
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> cp = cosBp * a + sinBp * <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#GramSchmidt" class="code">GramSchmidt</a>(c, a));</div></div> 
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesampledsphericaltriangledirectionandreturnbarycentrics-0">Compute sampled spherical triangle direction and return barycentrics</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-701" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-701"><i></i></a><div id="fragbit-701" class="collapse"><div class="fragmentcode">       Float cosTheta = 1 - u[1] * (1 - <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(cp, b));
       Float sinTheta = <a href="../Utilities/Mathematical_Infrastructure.html#SafeSqrt" class="code">SafeSqrt</a>(1 - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(cosTheta));
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> w = cosTheta * b + sinTheta * <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#GramSchmidt" class="code">GramSchmidt</a>(cp, b));
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Findbarycentriccoordinatesforsampleddirectionmonow-0">Find barycentric coordinates for sampled direction <tt>w</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-702" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-702"><i></i></a><div id="fragbit-702" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> e1 = v[1] - v[0], e2 = v[2] - v[0];
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> s1 = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(w, e2);
          Float divisor = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(s1, e1);
          Float invDivisor = 1 / divisor;
          <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> s = p - v[0];
          Float b1 = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(s, s1) * invDivisor;
          Float b2 = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(w, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(s, e1)) * invDivisor;</div></div>
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnclampedbarycentricsforsampleddirection-0">Return clamped barycentrics for sampled direction</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-703" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-703"><i></i></a><div id="fragbit-703" class="collapse"><div class="fragmentcode">          b1 = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(b1, 0, 1);
          b2 = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(b2, 0, 1);
          if (b1 + b2 &gt; 1) {
              b1 /= b1 + b2;
              b2 /= b1 + b2;
          }
          return {Float(1 - b1 - b2), Float(b1), Float(b2)};</div></div></div></div>
}</div><p>


</p>
<p>Given the reference point, it is easy to project the vertices on the unit
sphere to find the spherical triangle vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg>, and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-Computevectorsmonoamonobandmonoctosphericaltrianglevertices-0"></span><div class="fragmentname">&lt;&lt;Compute vectors <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> to spherical triangle vertices&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> a(v[0] - p), b(v[1] - p), c(v[2] - p);
a = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(a);
b = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(b);
c = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(c);</div><p>


</p>
<p>Because the plane containing an edge also passes through the origin, we can
compute the plane normal for an edge from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.479ex" height="6.176ex" style="vertical-align: -2.671ex;" viewBox="0 -1508.9 6234 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold n Subscript normal a normal b Baseline equals StartFraction bold a times bold b Over double-vertical-bar bold a times bold b double-vertical-bar EndFraction comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D427" d="M615 0l-126 3l-126 -3v47h69v270c0 76 -21 97 -55 97c-63 0 -149 -49 -149 -158v-209h69v-47l-126 3l-126 -3v47h69v309c0 39 -7 39 -69 39v47l172 8v-108c26 51 79 108 175 108c100 0 154 -39 154 -144v-259h69v-47Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-62" d="M521 216c0 -129 -104 -227 -223 -227c-74 0 -116 50 -131 73l-36 -62h-25v596c0 49 -8 56 -78 56v31l144 11v-317c16 18 59 65 137 65c114 0 212 -99 212 -226zM438 217c0 41 -3 98 -29 139c-24 38 -60 64 -105 64c-24 0 -79 -8 -118 -64c-11 -16 -11 -17 -11 -36v-206 c0 -18 0 -21 14 -42c24 -37 60 -61 105 -61c54 0 92 33 113 64c29 45 31 105 31 142Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D427" x="0" y="0"></use>
<g transform="translate(639,-150)">
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-61" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-62" x="500" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-3D" x="1764" y="0"></use>
<g transform="translate(2543,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="2894" height="60" x="0" y="220"></rect>
<g transform="translate(458,676)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-D7" x="559" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D41B" x="1338" y="0"></use>
</g>
<g transform="translate(60,-771)">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
<g transform="translate(398,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-D7" x="559" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D41B" x="1338" y="0"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="2376" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="5955" y="0"></use>
</g>
</svg>
</div>
<p>

and similarly for the other edges. If any of these normals are degenerate,
then the triangle has zero area.

</p>
<p></p>
<span class="anchor" id="fragment-Computenormalizedcrossproductsofalldirectionpairs-0"></span><div class="fragmentname">&lt;&lt;Compute normalized cross products of all direction pairs&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n_ab = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(a, b), n_bc = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(b, c), n_ca = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(c, a);
if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_ab) == 0 || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_bc) == 0 ||
    <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_ca) == 0)
    return {};
n_ab = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_ab);
n_bc = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_bc);
n_ca = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_ca);</div><p>


</p>
<p>Given the pairs of plane normals, <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween"><tt>AngleBetween()</tt></a> gives the angles
between them.  In computing these angles, we can take advantage of the fact
that the plane normal for the edge between two vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> is the negation of the plane normal for the edge from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg>
to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-Findanglesalphabetaandgammaatsphericaltrianglevertices-0"></span><div class="fragmentname">&lt;&lt;Find angles <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.334ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 574.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
</g>
</svg> at spherical triangle vertices&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float alpha = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ab, -n_ca);
Float beta  = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_bc, -n_ab);
Float gamma = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ca, -n_bc);</div><p>


</p>
<p>The spherical triangle sampling algorithm operates in two stages.  The
first step uniformly samples a new triangle with
area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg> between&nbsp;0 and the area of the original spherical triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
</g>
</svg> using the
first sample: <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.559ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 4115.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime equals xi 0 upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1416" y="0"></use>
<g transform="translate(2472,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="620" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="3365" y="0"></use>
</g>
</svg>.  This triangle is defined by finding a
new vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> along the arc between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg> such
that the resulting triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.874ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2098.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold b bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="559" y="0"></use>
<g transform="translate(1199,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</g>
</svg> has area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg> (see
Figure&nbsp;<a href="#fig:spherical-triangle-sampling">6.18</a>(a)).

</p>
<p> </p>
<span class="anchor" id="fig:spherical-triangle-sampling"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f18.svg" title=""><img src="pha06f18.svg" width=988 height=241 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.18: <span class="legend">
(a)&nbsp;After sampling a triangle area, the first step of the sampling algorithm finds the
vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> that gives a spherical triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.874ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2098.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold b bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="559" y="0"></use>
<g transform="translate(1199,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</g>
</svg>
with that area. The vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and the edge
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="2.009ex" style="vertical-align: -0.016ex; margin-bottom: -0.322ex;" viewBox="0 -719.6 511.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c overbar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="5" y="-27"></use>
</g>
</svg> are shared with the original triangle.
(b)&nbsp;Given <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>, a direction <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> is sampled along the arc between
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>In the second step, a vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> is sampled along the arc between
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> with sampling density that is relatively lower
near <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and higher near <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>; the result is a uniform
distribution of points inside the spherical triangle
(Figure&nbsp;<a href="#fig:spherical-triangle-sampling">6.18</a>(b)).
(The need for a nonuniform density along the arc can be understood by
considering the arcs <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.575ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1539.1 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
<g transform="translate(639,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</g>
</svg> as <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> sweeps from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg>
to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>: the velocity of a point on the arc increases the farther away
from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and so the density of sampled points along a given arc must
be adjusted accordingly.)

</p>
<p>Our implementation makes a small modification to the algorithm as described
so far: rather than computing the triangle&rsquo;s spherical area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
</g>
</svg> and then
sampling an area uniformly between&nbsp;0 and&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
</g>
</svg>, it instead starts by
computing its area plus <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg>, which we will denote by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-213"></use>
</g>
</svg>.  Doing so
lets us avoid the subtraction of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg> from the sum of the interior angles
that is present in the spherical triangle area equation,
(<a href="../Geometry_and_Transformations/Spherical_Geometry.html#eq:girards-theorem">3.5</a>).  For very small triangles, where
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.177ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 6103.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha plus beta plus gamma almost-equals pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="862" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="1863" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2660" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="3660" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="4482" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="5533" y="0"></use>
</g>
</svg>, the subtraction of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg> can cause a
significant loss of floating-point accuracy.  The remainder of the
algorithm&rsquo;s implementation is then adjusted to be based on <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
</svg> in
order to avoid needing to perform the subtraction.

</p>
<p>Given <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-213"></use>
</g>
</svg>, the sampled area-plus-<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg> <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
</svg> is easily computed by
uniformly sampling between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-213"></use>
</g>
</svg>.  

</p>
<p>The returned PDF value can be initialized at this point; because the
algorithm samples uniformly in the triangle&rsquo;s solid angle, the probability
density function takes the constant value of one over the solid angle the
triangle subtends, which is its spherical area.  (For that, the value of
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg> must be subtracted.)

</p>
<p></p>
<span class="anchor" id="fragment-UniformlysampletriangleareaAtocomputeA-0"></span><div class="fragmentname">&lt;&lt;Uniformly sample triangle area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
</g>
</svg> to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float A_pi = alpha + beta + gamma;
Float Ap_pi = <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[0], <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>, A_pi);
if (pdf) {
    Float A = A_pi - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;
    *pdf = (A &lt;= 0) ? 0 : 1 / A;
}</div><p>


</p>
<p>At this point, we need to determine more values related to the sampled
triangle.  We have the vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg>, the edge
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="2.009ex" style="vertical-align: -0.016ex; margin-bottom: -0.322ex;" viewBox="0 -719.6 511.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c overbar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="5" y="-27"></use>
</g>
</svg>, and the angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
</g>
</svg> all unchanged from the given
triangle.  The area-plus-<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.325ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 570.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
</g>
</svg> of the sampled triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
</svg> is known,
but we do not have the vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>, the edges <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.387ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 1027.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
</svg> or
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.201ex" height="2.343ex" style="vertical-align: -0.016ex; margin-bottom: -0.322ex;" viewBox="0 -863.1 947.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="29" y="-27"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="791" y="513"></use>
</g>
</svg>, or the angles <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.242ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 965.1 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</svg> or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.181ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 939.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="513"></use>
</g>
</svg>.

</p>
<p>To find the vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>, it is sufficient to find the length
of the arc <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.387ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 1027.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
</svg>. In this case, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.885ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 2533.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
</g>
</svg> will do, since <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.071ex" height="3.009ex" style="vertical-align: -0.505ex;" viewBox="0 -1078.4 4766.8 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0 less-than-or-equal-to bold b overbar prime less-than pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2264" d="M691 75c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259zM702 -99c0 -11 -9 -20 -20 -20h-586c-11 0 -20 9 -20 20s9 20 20 20h586c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2264" x="778" y="0"></use>
<g transform="translate(1834,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="3139" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="4196" y="0"></use>
</g>
</svg>. 
The first step is to apply one of the spherical cosine laws, which gives the
equality
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:spherical-tri-cos-betap"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.387ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 18249.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine beta Superscript prime Baseline equals minus cosine gamma Superscript prime Baseline cosine alpha plus sine gamma Superscript prime Baseline sine alpha cosine bold b overbar Superscript prime Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2749" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3805" y="0"></use>
<g transform="translate(4750,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(6256,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="583"></use>
</g>
<g transform="translate(7362,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="8868" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9731" y="0"></use>
<g transform="translate(10732,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(12128,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="583"></use>
</g>
<g transform="translate(13234,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="14630" y="0"></use>
<g transform="translate(15437,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(16943,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="17971" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:spherical-tri-cos-betap">6.8</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

Although we do not know <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.181ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 939.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="513"></use>
</g>
</svg>, we can apply the definition of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.912ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1253.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime Subscript pi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
</svg>,
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.249ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 7857.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime Subscript pi Baseline equals alpha plus beta prime plus gamma Superscript prime Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1531" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="2587" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3450" y="0"></use>
<g transform="translate(4451,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5638" y="0"></use>
<g transform="translate(6639,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="7578" y="0"></use>
</g>
</svg>
</div>
<p>

to express <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.181ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 939.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="513"></use>
</g>
</svg> in terms of quantities that are either known or are <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.242ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 965.1 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.249ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 7857.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma prime equals upper A prime Subscript pi Baseline minus alpha minus beta Superscript prime Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="583"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1216" y="0"></use>
<g transform="translate(2273,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3749" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="4750" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5612" y="0"></use>
<g transform="translate(6613,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="7578" y="0"></use>
</g>
</svg>
</div>
<p>

Substituting this equality in Equation&nbsp;(<a href="#eq:spherical-tri-cos-betap">6.8</a>)
and solving for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.885ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 2533.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
</g>
</svg> gives
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.662ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 17937.8 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar Superscript prime Baseline equals StartFraction cosine beta Superscript prime Baseline plus cosine left-parenthesis upper A prime Subscript pi Baseline minus alpha minus beta Superscript prime Baseline right-parenthesis cosine alpha Over sine left-parenthesis upper A prime Subscript pi Baseline minus alpha minus beta Superscript prime Baseline right-parenthesis sine alpha EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2811" y="0"></use>
<g transform="translate(3590,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="13551" height="60" x="0" y="220"></rect>
<g transform="translate(60,768)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2693" y="0"></use>
<g transform="translate(3694,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5033" y="0"></use>
<g transform="translate(5423,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="6899" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="7900" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="8762" y="0"></use>
<g transform="translate(9763,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10728" y="0"></use>
<g transform="translate(11284,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="12790" y="0"></use>
</g>
<g transform="translate(2017,-769)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1229" y="0"></use>
<g transform="translate(1619,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3095" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="4095" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4958" y="0"></use>
<g transform="translate(5959,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="408"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6924" y="0"></use>
<g transform="translate(7480,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="8876" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="17659" y="0"></use>
</g>
</svg>
</div>
<p>

Defining <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 5047.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">phi equals upper A prime Subscript pi Baseline minus alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="874" y="0"></use>
<g transform="translate(1930,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="392"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1061" y="-200"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3406" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="4407" y="0"></use>
</g>
</svg> to simplify notation, we have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.807ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 15416.9 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar Superscript prime Baseline equals StartFraction cosine beta Superscript prime Baseline plus cosine left-parenthesis phi minus beta Superscript prime Baseline right-parenthesis cosine alpha Over sine left-parenthesis phi minus beta Superscript prime Baseline right-parenthesis sine alpha EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2811" y="0"></use>
<g transform="translate(3590,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="11030" height="60" x="0" y="220"></rect>
<g transform="translate(60,768)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2693" y="0"></use>
<g transform="translate(3694,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5033" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="5423" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="6241" y="0"></use>
<g transform="translate(7242,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8207" y="0"></use>
<g transform="translate(8763,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="10270" y="0"></use>
</g>
<g transform="translate(2017,-769)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1229" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="1619" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="2437" y="0"></use>
<g transform="translate(3438,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="408"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4403" y="0"></use>
<g transform="translate(4959,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="6355" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="15138" y="0"></use>
</g>
</svg>
</div>
<p>

The cosine and sine sum identities then give
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:sph-tri-cos-bbar"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.579ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 21777 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar Superscript prime Baseline equals StartFraction cosine beta Superscript prime Baseline plus left-parenthesis cosine phi cosine beta Superscript prime Baseline plus sine phi sine beta Superscript prime Baseline right-parenthesis cosine alpha Over left-parenthesis sine phi cosine beta Superscript prime Baseline minus cosine phi sine beta Superscript prime Baseline right-parenthesis sine alpha EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2811" y="0"></use>
<g transform="translate(3590,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="17390" height="60" x="0" y="220"></rect>
<g transform="translate(60,768)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2693" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3694" y="0"></use>
<g transform="translate(4083,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="5589" y="0"></use>
<g transform="translate(6353,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(7859,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9046" y="0"></use>
<g transform="translate(10047,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="11443" y="0"></use>
<g transform="translate(12206,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(13602,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="14567" y="0"></use>
<g transform="translate(15124,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="16630" y="0"></use>
</g>
<g transform="translate(1962,-769)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="1785" y="0"></use>
<g transform="translate(2548,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(4055,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="408"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5242" y="0"></use>
<g transform="translate(6243,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="7749" y="0"></use>
<g transform="translate(8512,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(9908,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="408"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10873" y="0"></use>
<g transform="translate(11429,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="12825" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="21498" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:sph-tri-cos-bbar">6.9</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

The only remaining unknowns on the right hand side are the sines and
cosines of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.242ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 965.1 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</svg>.

</p>
<p>To find <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.484ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 2361.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sine beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
<g transform="translate(1396,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.74ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 2471.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</g>
</svg>, we can use another spherical cosine
law, which gives the equality
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.248ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 17759.6 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine gamma Superscript prime Baseline equals minus cosine beta Superscript prime Baseline cosine alpha plus sine beta Superscript prime Baseline sine alpha cosine bold c overbar period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3779" y="0"></use>
<g transform="translate(4724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(6230,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
<g transform="translate(7362,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="8868" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9731" y="0"></use>
<g transform="translate(10732,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(12128,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
<g transform="translate(13260,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="14656" y="0"></use>
<g transform="translate(15463,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(16969,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="5" y="-27"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="17481" y="0"></use>
</g>
</svg>
</div>
<p>


It can be simplified in a similar manner to find the equation
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="53.347ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 22968.7 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0 equals left-parenthesis cosine phi plus cosine alpha right-parenthesis cosine beta Superscript prime Baseline plus left-parenthesis sine phi minus sine alpha cosine bold c overbar right-parenthesis sine beta Superscript prime Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1834" y="0"></use>
<g transform="translate(2224,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="3730" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4548" y="0"></use>
<g transform="translate(5549,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="7055" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7696" y="0"></use>
<g transform="translate(8252,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(9758,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="11946" y="0"></use>
<g transform="translate(12336,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="13732" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="14551" y="0"></use>
<g transform="translate(15551,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="16947" y="0"></use>
<g transform="translate(17755,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(19261,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="5" y="-27"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="19772" y="0"></use>
<g transform="translate(20328,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(21725,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="22690" y="0"></use>
</g>
</svg>
</div>
<p>

The terms in parentheses are all known.  We will denote them by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.074ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 7781.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">k 1 equals cosine phi plus cosine alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1253" y="0"></use>
<g transform="translate(2309,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="3815" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4634" y="0"></use>
<g transform="translate(5635,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="7141" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.636ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 9746.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">k 2 equals sine phi minus sine alpha cosine bold c overbar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1253" y="0"></use>
<g transform="translate(2309,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="3705" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4524" y="0"></use>
<g transform="translate(5525,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="6921" y="0"></use>
<g transform="translate(7728,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(9234,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="5" y="-27"></use>
</g>
</g>
</svg>. It is then easy to see that solutions to the equation
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.63ex" height="2.843ex" style="vertical-align: -0.671ex;" viewBox="0 -934.9 10174.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0 equals k 1 cosine beta Superscript prime Baseline plus k 2 sine beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="778" y="0"></use>
<g transform="translate(1834,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-213"></use>
</g>
<g transform="translate(2976,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
<g transform="translate(4482,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5670" y="0"></use>
<g transform="translate(6670,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-213"></use>
</g>
<g transform="translate(7812,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(9209,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
</g>
</svg>
</div>
<p>

are given by
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="52.555ex" height="8.176ex" style="vertical-align: -4.671ex;" viewBox="0 -1508.9 22627.8 3520.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine beta Superscript prime Baseline equals StartFraction plus-or-minus k 2 Over StartRoot k 1 squared plus k 2 squared EndRoot EndFraction and sine beta Superscript prime Baseline equals StartFraction minus-or-plus k 1 Over StartRoot k 1 squared plus k 2 squared EndRoot EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-B1" d="M722 -64c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-221A" d="M1020 1130c0 0 0 -5 -5 -20l-549 -1736c-8 -24 -9 -24 -42 -24l-230 802l-68 -80l-16 15l139 163l215 -750l513 1624c4 13 8 26 23 26c12 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2213" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2749" y="0"></use>
<g transform="translate(3527,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4294" height="60" x="0" y="220"></rect>
<g transform="translate(1270,676)">
 <use xlink:href="#E1-LATINMODERNMAIN-B1" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-213"></use>
</g>
</g>
<g transform="translate(60,-1242)">
 <use xlink:href="#E1-LATINMODERNSIZE2-221A" x="0" y="10"></use>
<rect stroke="none" width="3173" height="60" x="1000" y="1101"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-435"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1197" y="0"></use>
<g transform="translate(2198,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-435"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(10339,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-61"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="1057" y="0"></use>
</g>
<g transform="translate(14119,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
<g transform="translate(15515,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="16758" y="0"></use>
<g transform="translate(17537,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4294" height="60" x="0" y="220"></rect>
<g transform="translate(1270,676)">
 <use xlink:href="#E1-LATINMODERNMAIN-2213" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-213"></use>
</g>
</g>
<g transform="translate(60,-1242)">
 <use xlink:href="#E1-LATINMODERNSIZE2-221A" x="0" y="10"></use>
<rect stroke="none" width="3173" height="60" x="1000" y="1101"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-435"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1197" y="0"></use>
<g transform="translate(2198,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-435"></use>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="22349" y="0"></use>
</g>
</svg>
</div>
<p>

Substituting these into Equation&nbsp;(<a href="#eq:sph-tri-cos-bbar">6.9</a>), taking the
solution with a positive cosine, and simplifying gives
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="40.412ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 17399.5 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar Superscript prime Baseline equals StartFraction k 2 plus left-parenthesis k 2 cosine phi minus k 1 sine phi right-parenthesis cosine alpha Over left-parenthesis k 2 sine phi plus k 1 cosine phi right-parenthesis sine alpha EndFraction comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D458" d="M508 379c0 -39 -29 -61 -55 -61c-27 0 -38 19 -38 35c0 12 9 51 57 54c-2 2 -2 3 -4 4c-8 6 -9 6 -21 8c-2 1 -3 1 -9 1c-49 0 -95 -43 -143 -96c-23 -24 -55 -56 -86 -74c85 -11 148 -40 148 -105c0 -10 0 -14 -4 -31c-4 -16 -8 -39 -8 -56c0 -36 13 -47 32 -47 c44 0 67 51 87 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -11 -57 -36 -101c-22 -37 -49 -53 -79 -53c-52 0 -92 40 -92 99c0 11 2 23 4 35c3 10 3 14 3 21c0 66 -82 82 -116 85c-6 -25 -51 -210 -56 -219c-6 -12 -21 -21 -34 -21c-9 0 -29 5 -29 28c0 6 0 8 4 22l145 576 l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-104 -422c38 15 77 55 111 93c72 80 118 88 146 88c45 0 68 -33 68 -63Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2811" y="0"></use>
<g transform="translate(3590,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="13013" height="60" x="0" y="220"></rect>
<g transform="translate(60,768)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1197" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2198" y="0"></use>
<g transform="translate(2587,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-213"></use>
</g>
<g transform="translate(3729,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="5236" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="6054" y="0"></use>
<g transform="translate(7055,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-213"></use>
</g>
<g transform="translate(8197,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="9593" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10190" y="0"></use>
<g transform="translate(10746,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="12252" y="0"></use>
</g>
<g transform="translate(1214,-769)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="737" y="-213"></use>
</g>
<g transform="translate(1531,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="2927" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3746" y="0"></use>
<g transform="translate(4747,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D458" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="737" y="-213"></use>
</g>
<g transform="translate(5889,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="7395" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7991" y="0"></use>
<g transform="translate(8548,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="9944" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="17120" y="0"></use>
</g>
</svg>
</div>
<p>

which finally has only known values on the right hand side.

</p>
<p>The code to compute this cosine follows directly from this solution.  In
it, we have also applied trigonometric identities to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.628ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1992.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sine phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="1396" y="0"></use>
</g>
</svg>
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.884ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2102.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine phi</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D719" d="M573 262c0 -134 -145 -269 -306 -274l-38 -149c-3 -14 -9 -38 -11 -40c-3 -3 -5 -4 -10 -4s-12 1 -12 11c0 3 10 41 22 88l23 94c-122 7 -192 86 -192 181c0 136 147 269 306 274l58 231c4 17 5 20 15 20c12 0 12 -10 12 -10l-3 -14l-56 -227c139 -10 192 -102 192 -181z M349 421c-149 -13 -235 -153 -235 -273c0 -100 72 -135 132 -138zM508 283c0 88 -57 134 -133 138l-103 -411c150 12 236 155 236 273Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D719" x="1506" y="0"></use>
</g>
</svg> in terms of other sines and cosines.  

</p>
<p></p>
<span class="anchor" id="fragment-Findcosbetaforpointalongmonobforsampledarea-0"></span><div class="fragmentname">&lt;&lt;Find <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.74ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 2471.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine beta prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="815" y="513"></use>
</g>
</g>
</svg> for point along <tt>b</tt> for sampled area&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float cosAlpha = std::cos(alpha), sinAlpha = std::sin(alpha);
Float sinPhi = std::sin(Ap_pi) * cosAlpha - std::cos(Ap_pi) * sinAlpha;
Float cosPhi = std::cos(Ap_pi) * cosAlpha + std::sin(Ap_pi) * sinAlpha;
Float k1 = cosPhi + cosAlpha;
Float k2 = sinPhi - sinAlpha * <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(a, b) /* cos c */;
Float cosBp =
    (k2 + (<a href="../Utilities/Mathematical_Infrastructure.html#DifferenceOfProducts" class="code">DifferenceOfProducts</a>(k2, cosPhi, k1, sinPhi)) * cosAlpha) /
    ((<a href="../Utilities/Mathematical_Infrastructure.html#SumOfProducts" class="code">SumOfProducts</a>(k2, sinPhi, k1, cosPhi)) * sinAlpha);
cosBp = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(cosBp, -1, 1);</div><p>


</p>
<p>The arc of the great circle between the two points <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>
can be parameterized by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.761ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 6785.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta bold a plus sine theta bold c Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="1975" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="2757" y="0"></use>
<g transform="translate(3758,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="5154" y="0"></use>
<g transform="translate(5623,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="723" y="-213"></use>
</g>
</g>
</svg>,
where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.699ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1162 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c Subscript up-tack</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22A5" d="M722 20c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v624c0 11 9 20 20 20s20 -9 20 -20v-624h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-22A5" x="723" y="-213"></use>
</g>
</svg> is the normalized perpendicular component of
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg> with respect to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg>.  This vector is given by the
<a href="../Geometry_and_Transformations/Vectors.html#GramSchmidt"><tt>GramSchmidt()</tt></a> function introduced earlier, which makes the
computation of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> straightforward.  In this case, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.63ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 2423.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sine bold b overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
<g transform="translate(1396,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
</g>
</svg> can then be found using <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.885ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 2533.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine bold b overbar prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-AF" d="M431 589h-361v31h361v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
<g transform="translate(1506,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-AF" x="69" y="214"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="904" y="795"></use>
</g>
</g>
</svg> with the
Pythagorean identity, since we know that it must be nonnegative.

</p>
<p></p>
<span class="anchor" id="fragment-Samplecalongthearcbetweenbanda-0"></span><div class="fragmentname">&lt;&lt;Sample <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.908ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 821.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="613" y="513"></use>
</g>
</svg> along the arc between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.899ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 817.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="607" y="513"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float sinBp = <a href="../Utilities/Mathematical_Infrastructure.html#SafeSqrt" class="code">SafeSqrt</a>(1 - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(cosBp));
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> cp = cosBp * a + sinBp * <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#GramSchmidt" class="code">GramSchmidt</a>(c, a));</div><p>


</p>
<p>For the sample points to be uniformly distributed in the spherical
triangle, it can be shown that if the edge from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> is
parameterized using <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="0" y="0"></use>
</g>
</svg> in the same way as was used for the edge from
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>, then <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> should be sampled as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:spherical-triangle-arc-sample"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.285ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 11747.6 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta equals 1 minus xi 1 left-parenthesis 1 minus left-parenthesis bold c prime dot bold b right-parenthesis right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D709" d="M446 592c0 -31 -64 -31 -89 -31c-23 0 -46 0 -64 22c-75 -37 -111 -114 -111 -170c0 -19 4 -52 30 -78c37 12 66 12 84 12c39 0 82 -2 82 -27c0 -31 -63 -31 -93 -31c-21 0 -51 0 -88 13c-84 -42 -123 -129 -123 -170c0 -42 30 -71 75 -89l60 -24c21 -7 41 -15 61 -23 l61 -23c11 -5 48 -23 48 -71c0 -49 -42 -107 -104 -107c-56 0 -109 36 -109 48c0 4 2 11 10 11c4 0 5 -1 11 -5c11 -8 44 -32 88 -32c31 0 49 30 49 53c0 29 -20 36 -35 43c-59 23 -61 23 -121 47c-75 28 -84 32 -116 65c-2 3 -29 31 -29 79c0 36 22 130 131 202l13 10 c-47 27 -65 69 -65 106c0 77 68 157 175 187c-1 4 -7 19 -7 39c0 3 0 49 18 49c7 0 12 -5 12 -13c0 0 -5 -23 -5 -37c0 -17 2 -24 5 -33c26 5 50 5 63 5c39 0 83 -1 83 -27zM420 591c-18 5 -22 6 -56 6c-11 0 -32 0 -48 -5c11 -9 23 -9 42 -9c44 0 54 5 62 8zM352 319 c-18 5 -22 6 -57 6c-12 0 -34 0 -57 -6c18 -8 27 -8 50 -8c46 0 56 4 64 8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3309" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4032" y="0"></use>
<g transform="translate(5033,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D709" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="620" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5925" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="6315" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="7037" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8038" y="0"></use>
<g transform="translate(8428,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22C5" x="9549" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="10050" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10690" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11079" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="11469" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:spherical-triangle-arc-sample">6.10</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

(The &ldquo;Further Reading&rdquo; section has pointers to the details.)

</p>
<p>With that, we can compute the final sampled direction <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg>.  The 
remaining step is to compute the barycentric coordinates for the sampled
direction.

</p>
<p></p>
<span class="anchor" id="fragment-Computesampledsphericaltriangledirectionandreturnbarycentrics-0"></span><div class="fragmentname">&lt;&lt;Compute sampled spherical triangle direction and return barycentrics&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float cosTheta = 1 - u[1] * (1 - <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(cp, b));
Float sinTheta = <a href="../Utilities/Mathematical_Infrastructure.html#SafeSqrt" class="code">SafeSqrt</a>(1 - <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(cosTheta));
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> w = cosTheta * b + sinTheta * <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#GramSchmidt" class="code">GramSchmidt</a>(cp, b));
&lt;&lt;<span class="fragmentname"><a href="#fragment-Findbarycentriccoordinatesforsampleddirectionmonow-0">Find barycentric coordinates for sampled direction <tt>w</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-704" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-704"><i></i></a><div id="fragbit-704" class="collapse"><div class="fragmentcode">   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> e1 = v[1] - v[0], e2 = v[2] - v[0];
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> s1 = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(w, e2);
   Float divisor = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(s1, e1);
   Float invDivisor = 1 / divisor;
   <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> s = p - v[0];
   Float b1 = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(s, s1) * invDivisor;
   Float b2 = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(w, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(s, e1)) * invDivisor;</div></div>
&lt;&lt;<span class="fragmentname"><a href="#fragment-Returnclampedbarycentricsforsampleddirection-0">Return clamped barycentrics for sampled direction</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-705" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-705"><i></i></a><div id="fragbit-705" class="collapse"><div class="fragmentcode">   b1 = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(b1, 0, 1);
   b2 = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(b2, 0, 1);
   if (b1 + b2 &gt; 1) {
       b1 /= b1 + b2;
       b2 /= b1 + b2;
   }
   return {Float(1 - b1 - b2), Float(b1), Float(b2)};</div></div></div><p>


</p>
<p>The barycentric coordinates of the corresponding point in the planar
triangle can be found using part of a ray&ndash;triangle intersection algorithm
that finds the barycentrics along the way (<a href="Further_Reading.html#cite:Moller97">M&ouml;ller and Trumbore 1997</a>).  It starts
with equating the parametric form of the ray with the barycentric
interpolation of the triangle&rsquo;s vertices <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.027ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 872.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal v Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-76" d="M508 400c-66 -1 -83 -44 -92 -67l-131 -325c-4 -10 -8 -19 -21 -19s-15 5 -21 19l-144 355c-13 31 -17 37 -80 37v31c30 -2 70 -3 97 -3l109 3v-31c-18 0 -57 0 -57 -26c0 0 0 -4 6 -17l112 -279l102 255c4 11 6 15 6 24c0 19 -11 42 -48 43v31l87 -3c23 0 52 1 75 3v-31 Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="747" y="-213"></use>
</g>
</svg>,
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.459ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 16989.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal o plus t bold d equals left-parenthesis 1 minus b 0 minus b 1 right-parenthesis normal v 0 plus b 1 normal v 1 plus b 2 normal v 2 comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D461" d="M330 420c0 -20 -10 -20 -30 -20h-94l-74 -295c-4 -17 -6 -24 -6 -48c0 -33 10 -46 31 -46c34 0 87 24 130 128c5 11 6 14 15 14c4 0 12 0 12 -10c0 -8 -57 -154 -159 -154c-54 0 -92 38 -92 92c0 18 4 35 76 319h-88c-20 0 -28 0 -28 12c0 19 10 19 30 19h94l39 159 c9 35 37 36 40 36c17 0 29 -10 29 -27c0 -6 -5 -26 -41 -168h88c18 0 28 0 28 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41D" d="M601 0l-183 -6v49c-31 -25 -79 -49 -140 -49c-148 0 -240 95 -240 227c0 141 105 229 251 229c33 0 85 -6 135 -45v195c0 39 -7 39 -69 39v47l177 8v-608c0 -39 7 -39 69 -39v-47zM418 103v250c-22 29 -62 61 -119 61c-31 0 -78 -10 -107 -52c-26 -39 -26 -93 -26 -141 c0 -70 0 -191 122 -191c76 0 117 55 130 73Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-76" d="M508 400c-66 -1 -83 -44 -92 -67l-131 -325c-4 -10 -8 -19 -21 -19s-15 5 -21 19l-144 355c-13 31 -17 37 -80 37v31c30 -2 70 -3 97 -3l109 3v-31c-18 0 -57 0 -57 -26c0 0 0 -4 6 -17l112 -279l102 255c4 11 6 15 6 24c0 19 -11 42 -48 43v31l87 -3c23 0 52 1 75 3v-31 Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D461" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41D" x="2084" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3002" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4058" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="4448" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="5170" y="0"></use>
<g transform="translate(6171,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="607" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="7277" y="0"></use>
<g transform="translate(8277,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="607" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9161" y="0"></use>
<g transform="translate(9550,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="747" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="10755" y="0"></use>
<g transform="translate(11756,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="607" y="-213"></use>
</g>
<g transform="translate(12639,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="747" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="13844" y="0"></use>
<g transform="translate(14844,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="607" y="-213"></use>
</g>
<g transform="translate(15728,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="747" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="16710" y="0"></use>
</g>
</svg>
</div>
<p>

expressing this as a matrix equation, and solving the resulting linear
system for the barycentrics.  The solution is implemented in the following
fragment, which includes the result of factoring out various common
subexpressions.

</p>
<p></p>
<span class="anchor" id="fragment-Findbarycentriccoordinatesforsampleddirectionmonow-0"></span><div class="fragmentname">&lt;&lt;Find barycentric coordinates for sampled direction <tt>w</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> e1 = v[1] - v[0], e2 = v[2] - v[0];
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> s1 = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(w, e2);
Float divisor = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(s1, e1);
Float invDivisor = 1 / divisor;
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> s = p - v[0];
Float b1 = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(s, s1) * invDivisor;
Float b2 = <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(w, <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(s, e1)) * invDivisor;</div><p>


</p>
<p>The computed barycentrics may be invalid for very small and very large
triangles.  This happens rarely, but to protect against it, they are
clamped to be within the triangle before they are returned.

</p>
<p></p>
<span class="anchor" id="fragment-Returnclampedbarycentricsforsampleddirection-0"></span><div class="fragmentname">&lt;&lt;Return clamped barycentrics for sampled direction&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">b1 = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(b1, 0, 1);
b2 = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(b2, 0, 1);
if (b1 + b2 &gt; 1) {
    b1 /= b1 + b2;
    b2 /= b1 + b2;
}
return {Float(1 - b1 - b2), Float(b1), Float(b2)};</div><p>


</p>
<p>As noted earlier, uniform solid angle sampling does not account for the
incident cosine factor at the reference point.  Indeed, there is no known
analytic method to do so.  However, it is possible to apply a warping
function to the uniform samples <tt>u</tt> that approximately accounts for
this factor.

</p>
<p>To understand the idea, first note that <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> varies
smoothly over the spherical triangle.  Because the spherical triangle
sampling algorithm that we have just defined maintains a continuous
relationship between sample values and points in the triangle, then if we
consider the image of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> function back in the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg>
sampling domain, as would be found by mapping it through the inverse of the
spherical triangle sampling algorithm, the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> function is smoothly varying
there as well.  (See Figure&nbsp;<a href="#fig:spherical-triangle-cos-theta">6.19</a>.)

</p>
<p></p>
<span class="anchor" id="fig:spherical-triangle-cos-theta"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f19.svg" title=""><img src="pha06f19.svg" width=761 height=301 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.19: <span class="legend">
(a)&nbsp;The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor varies smoothly over the area of a
spherical triangle.
(b)&nbsp;If it is mapped back to the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> sampling domain, it also varies
smoothly there, thanks to the sampling algorithm not introducing any
discontinuities or excessive distortion.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>It can be shown through simple application of the chain rule that a
suitable transformation of uniform <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> sample points can account for
the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor.  Specifically, if transformed points are
distributed according to the distribution of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> in
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> and then used with the spherical triangle sampling algorithm, then
the distribution of directions on the sphere will include the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor.

</p>
<p>The true function has no convenient analytic form, but because it is
smoothly varying, here we will approximate it with a bilinear
function.  Each corner of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> sampling domain maps to one of
the three vertices of the spherical triangle, and so we set the
bilinear function&rsquo;s value at each corner according to the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>
factor computed at the associated triangle vertex.

</p>
<p>Sampling a point in the triangle then proceeds by using the initial uniform
sample to sample the bilinear distribution and to use the resulting
nonuniform point in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> with the triangle sampling algorithm.  (See
Figure&nbsp;<a href="#fig:spherical-triangle-approx-cos">6.20</a>.)

</p>
<p> </p>
<span class="anchor" id="fig:spherical-triangle-approx-cos"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f20.svg" title=""><img src="pha06f20.svg" width=994 height=304 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.20: <span class="legend">
If (a)&nbsp;uniform sample points are warped to (b)&nbsp;approximate the
distribution of the incident cosine factor in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> before being used
with the spherical triangle sampling algorithm, then (c)&nbsp;the resulting points
in the triangle are approximately cosine-distributed.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Applying the principles of transforming between distributions that were
introduced in Section&nbsp;<a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#sec:mc-transform-multiple-dimensions">2.4.1</a>, we can
find that the overall PDF of such a sample is given by the product of the
PDF for the bilinear sample and the PDF of the spherical triangle sample.

</p>
<p>This technique is only applied for reference points on surfaces.  For
points in scattering media, the surface normal <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns"><tt>ShapeSampleContext::ns</tt></a>
is degenerate and no sample warping is applied.

</p>
<p></p>
<span class="anchor" id="fragment-Applywarpproductsamplingforcosinefactoratreferencepoint-0"></span><div class="fragmentname">&lt;&lt;Apply warp product sampling for cosine factor at reference point&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float pdf = 1;
if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-706" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-706"><i></i></a><div id="fragbit-706" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                         <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
       pstd::array&lt;Float, 4&gt; w =
           pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                 std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                 std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                 std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
    u = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#SampleBilinear" class="code">SampleBilinear</a>(u, w);
    pdf = <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
}</div><p>


</p>
<p>For the spherical triangle sampling algorithm, the vertex
<tt>v0</tt> corresponds to the sample <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>, <tt>v1</tt> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg> (and the line in between), and <tt>v2</tt> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>.  Therefore, 
the sampling weights at the corners of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg> domain are computed
using the cosine of the direction to the corresponding vertex.

</p>
<p></p>
<span class="anchor" id="fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0"></span><div class="fragmentname">&lt;&lt;Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
<a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                  <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
pstd::array&lt;Float, 4&gt; w =
    pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                          std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                          std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                          std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div><p>


</p>
<p>The associated <tt>PDF()</tt> method is thankfully much simpler than the
sampling routine.

</p>
<p></p>
<span class="anchor" id="fragment-TrianglePublicMethods-7"></span><div class="fragmentname">&lt;&lt;Triangle Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TrianglePublicMethods-6"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float PDF(const <a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext" class="code">ShapeSampleContext</a> &amp;ctx, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi) const {
    Float solidAngle = <a href="#Triangle::SolidAngle" class="code">SolidAngle</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>());
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnPDFbasedonuniformareasamplingforchallengingtriangles-0">Return PDF based on uniform area sampling for challenging triangles</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-707" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-707"><i></i></a><div id="fragbit-707" class="collapse"><div class="fragmentcode">       if (solidAngle &lt; <a href="#Triangle::MinSphericalSampleArea" class="code">MinSphericalSampleArea</a> ||
           solidAngle &gt; <a href="#Triangle::MaxSphericalSampleArea" class="code">MaxSphericalSampleArea</a>) {
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Intersectsampleraywithshapegeometry-0">Intersect sample ray with shape geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-708" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-708"><i></i></a><div id="fragbit-708" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> ray = ctx.<a href="../Shapes/Managing_Rounding_Error.html#ShapeSampleContext::SpawnRay" class="code">SpawnRay</a>(wi);
              pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; isect = <a href="../Shapes/Spheres.html#Sphere::Intersect" class="code">Intersect</a>(ray);
              if (!isect) return 0;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ComputePDFinsolidanglemeasurefromshapeintersectionpoint-0">Compute PDF in solid angle measure from shape intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-709" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-709"><i></i></a><div id="fragbit-709" class="collapse"><div class="fragmentcode">              Float pdf = (1 / <a href="../Shapes/Spheres.html#Sphere::Area" class="code">Area</a>()) / (<a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                                          <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>()));
              if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(pdf)) pdf = 0;</div></div>
           return pdf;
       }</div></div>
    Float pdf = 1 / solidAngle;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-AdjustPDFforwarpproductsamplingoftrianglecosthetafactor-0">Adjust PDF for warp product sampling of triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-710" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-710"><i></i></a><div id="fragbit-710" class="collapse"><div class="fragmentcode">       if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-711" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-711"><i></i></a><div id="fragbit-711" class="collapse"><div class="fragmentcode">              const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
              const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u = <a href="#InvertSphericalTriangleSample" class="code">InvertSphericalTriangleSample</a>({p0, p1, p2}, ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>(), wi);
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-712" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-712"><i></i></a><div id="fragbit-712" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                                <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
              pstd::array&lt;Float, 4&gt; w =
                  pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                        std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                        std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                        std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
           pdf *= <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
       }</div></div>
    return pdf;
}</div><p>


</p>
<p>It is important that the <tt>PDF()</tt> method makes exactly the same
decisions about which technique is used to sample the triangle as the
<tt>Sample()</tt> method does.  This method therefore starts with the same
check for very small and very large triangles to determine whether it
should fall back to returning the PDF based on uniform area sampling.
  
</p>
<span class="anchor" id="fragment-ReturnPDFbasedonuniformareasamplingforchallengingtriangles-0"></span><div class="fragmentname">&lt;&lt;Return PDF based on uniform area sampling for challenging triangles&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (solidAngle &lt; <a href="#Triangle::MinSphericalSampleArea" class="code">MinSphericalSampleArea</a> ||
    solidAngle &gt; <a href="#Triangle::MaxSphericalSampleArea" class="code">MaxSphericalSampleArea</a>) {
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-Intersectsampleraywithshapegeometry-0">Intersect sample ray with shape geometry</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-713" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-713"><i></i></a><div id="fragbit-713" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Rays.html#Ray" class="code">Ray</a> ray = ctx.<a href="../Shapes/Managing_Rounding_Error.html#ShapeSampleContext::SpawnRay" class="code">SpawnRay</a>(wi);
       pstd::optional&lt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection" class="code">ShapeIntersection</a>&gt; isect = <a href="../Shapes/Spheres.html#Sphere::Intersect" class="code">Intersect</a>(ray);
       if (!isect) return 0;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="Spheres.html#fragment-ComputePDFinsolidanglemeasurefromshapeintersectionpoint-0">Compute PDF in solid angle measure from shape intersection point</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-714" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-714"><i></i></a><div id="fragbit-714" class="collapse"><div class="fragmentcode">       Float pdf = (1 / <a href="../Shapes/Spheres.html#Sphere::Area" class="code">Area</a>()) / (<a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::n" class="code">n</a>, -wi) /
                                   <a href="../Geometry_and_Transformations/Points.html#DistanceSquared" class="code">DistanceSquared</a>(ctx.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>(), isect-&gt;<a href="../Shapes/Basic_Shape_Interface.html#ShapeIntersection::intr" class="code">intr</a>.<a href="../Geometry_and_Transformations/Interactions.html#Interaction::p" class="code">p</a>()));
       if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(pdf)) pdf = 0;</div></div>
    return pdf;
}</div><p>


</p>
<p>If <tt>Sample()</tt> would have warped the initial uniform random sample to
account for the incident <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor, it is necessary to
incorporate the corresponding change of variables factor in the returned
PDF here.  To do so, we need to be able to invert the spherical triangle
sampling algorithm in order to determine the sample value <tt>u</tt> that
samples a point on the triangle that gives the incident direction <tt>wi</tt>
at the reference point.  The <a href="#InvertSphericalTriangleSample"><tt>InvertSphericalTriangleSample()</tt></a> function
performs this computation.

</p>
<p></p>
<span class="anchor" id="fragment-AdjustPDFforwarpproductsamplingoftrianglecosthetafactor-0"></span><div class="fragmentname">&lt;&lt;Adjust PDF for warp product sampling of triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg> factor&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a> != <a href="../Geometry_and_Transformations/Normals.html#Normal3f" class="code">Normal3f</a>(0, 0, 0)) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Gettriangleverticesinmonop0monop1andmonop2-0">Get triangle vertices in <tt>p0</tt>, <tt>p1</tt>, and <tt>p2</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-715" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-715"><i></i></a><div id="fragbit-715" class="collapse"><div class="fragmentcode">       const TriangleMesh *mesh = <a href="#Triangle::GetMesh" class="code">GetMesh</a>();
       const int *v = &amp;mesh-&gt;<a href="#TriangleMesh::vertexIndices" class="code">vertexIndices</a>[3 * <a href="#Triangle::triIndex" class="code">triIndex</a>];
       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p0 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[0]], p1 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[1]], p2 = mesh-&gt;<a href="#TriangleMesh::p" class="code">p</a>[v[2]];</div></div>
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u = <a href="#InvertSphericalTriangleSample" class="code">InvertSphericalTriangleSample</a>({p0, p1, p2}, ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>(), wi);
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computecostheta-basedweightsmonowatsampledomaincorners-0">Compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.589ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1975.7 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">cosine theta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D703" d="M455 500c0 -224 -152 -511 -293 -511c-91 0 -120 111 -120 205c0 229 154 511 293 511c102 0 120 -139 120 -205zM389 562c0 57 -6 121 -55 121c-45 0 -82 -56 -109 -105c-40 -71 -60 -151 -77 -215h209c24 99 32 150 32 199zM348 331h-208c-26 -98 -32 -156 -32 -198 c0 -93 21 -122 54 -122c43 0 81 49 116 117c38 72 59 157 70 203Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-63"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D703" x="1506" y="0"></use>
</g>
</svg>-based weights <tt>w</tt> at sample domain corners</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-716" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-716"><i></i></a><div id="fragbit-716" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> rp = ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::p" class="code">p</a>();
       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> wi[3] = {<a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p0 - rp), <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p1 - rp),
                         <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(p2 - rp)};
       pstd::array&lt;Float, 4&gt; w =
           pstd::array&lt;Float, 4&gt;{std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                 std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[1])),
                                 std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[0])),
                                 std::max&lt;Float&gt;(0.01, <a href="../Geometry_and_Transformations/Vectors.html#AbsDot" class="code">AbsDot</a>(ctx.<a href="../Shapes/Basic_Shape_Interface.html#ShapeSampleContext::ns" class="code">ns</a>, wi[2]))};</div></div>
    pdf *= <a href="../Monte_Carlo_Integration/Transforming_between_Distributions.html#BilinearPDF" class="code">BilinearPDF</a>(u, w);
}</div><p>


</p>
<p>

</p>
<p>The pair of sample values that give a sampled direction <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> can be found
by inverting each of the sampling operations individually.  The function
that performs this computation starts out with a few reused fragments to
compute the angles at the three vertices of the spherical triangle. 
 
</p>
<span class="anchor" id="fragment-SamplingFunctionDefinitions-1"></span><div class="fragmentname">&lt;&lt;Sampling Function Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SamplingFunctionDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="../Volume_Scattering/Phase_Functions.html#fragment-SamplingFunctionDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="InvertSphericalTriangleSample"></span>InvertSphericalTriangleSample(const pstd::array&lt;<a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a>, 3&gt; &amp;v,
                                      <a href="../Geometry_and_Transformations/Points.html#Point3f" class="code">Point3f</a> p, <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> w) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computevectorsmonoamonobandmonoctosphericaltrianglevertices-0">Compute vectors <tt>a</tt>, <tt>b</tt>, and <tt>c</tt> to spherical triangle vertices</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-717" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-717"><i></i></a><div id="fragbit-717" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> a(v[0] - p), b(v[1] - p), c(v[2] - p);
       a = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(a);
       b = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(b);
       c = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(c);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computenormalizedcrossproductsofalldirectionpairs-0">Compute normalized cross products of all direction pairs</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-718" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-718"><i></i></a><div id="fragbit-718" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n_ab = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(a, b), n_bc = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(b, c), n_ca = <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(c, a);
       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_ab) == 0 || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_bc) == 0 ||
           <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_ca) == 0)
           return {};
       n_ab = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_ab);
       n_bc = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_bc);
       n_ca = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_ca);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Findanglesalphabetaandgammaatsphericaltrianglevertices-0">Find angles <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">alpha</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FC" d="M602 383c0 0 -21 -117 -115 -235c-10 -12 -10 -14 -10 -35c0 -24 0 -102 31 -102c0 0 38 0 56 49c3 7 6 10 13 10c6 0 12 -3 12 -10c0 -16 -31 -71 -84 -71c-45 0 -78 31 -91 84c-76 -61 -148 -84 -211 -84c-102 0 -162 76 -162 169c0 141 132 284 269 284 c74 0 167 -49 167 -206v-62c47 59 80 135 98 198c5 18 5 21 15 21c11 0 12 -10 12 -10zM410 99c-2 17 -2 75 -2 112c0 78 0 209 -99 209c-35 0 -89 -19 -136 -92c-32 -51 -58 -159 -58 -208c0 -64 30 -109 90 -109c40 0 117 11 205 88Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FC" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.334ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 574.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">beta</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FD" d="M574 574c0 -12 -2 -24 -5 -37c-11 -45 -41 -86 -81 -116c-10 -8 -20 -14 -30 -20c17 -11 31 -26 43 -43c20 -31 30 -68 30 -108c0 -20 -3 -42 -8 -64c-14 -53 -51 -104 -99 -140c-52 -38 -113 -57 -170 -57c-68 0 -114 40 -131 98l-68 -274c-1 -4 -5 -7 -10 -7h-5 c-6 0 -10 4 -10 12l154 615c34 136 125 273 245 273c47 0 89 -18 116 -50c18 -22 29 -51 29 -82zM518 592c0 19 -3 36 -12 51c-16 26 -44 40 -78 40c-110 0 -188 -129 -220 -255l-60 -242c-4 -17 -6 -33 -6 -49c0 -71 41 -126 113 -126c44 0 91 19 129 52 c39 35 61 82 73 128c7 29 12 59 12 87c0 25 -4 48 -14 69c-7 16 -17 29 -30 39c-25 -9 -50 -13 -75 -13c-35 0 -76 0 -76 24c0 0 0 5 1 7c7 27 49 27 85 27c24 0 47 -5 67 -13c9 5 18 12 26 19c31 29 49 67 58 105c5 17 7 34 7 50zM395 403c-11 3 -23 5 -36 5 c-24 0 -57 0 -60 -9c-1 -4 30 -4 52 -4c14 0 29 3 44 8Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FD" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
</g>
</svg> at spherical triangle vertices</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-719" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-719"><i></i></a><div id="fragbit-719" class="collapse"><div class="fragmentcode">       Float alpha = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ab, -n_ca);
       Float beta  = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_bc, -n_ab);
       Float gamma = <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ca, -n_bc);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FindvertexVECcalongVECaVECcarcforw-0">Find vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> along <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.487ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 1071 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="559" y="0"></use>
</g>
</svg> arc for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-720" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-720"><i></i></a><div id="fragbit-720" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> cp = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(b, w), <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(c, a)));
       if (<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(cp, a + c) &lt; 0)
           cp = -cp;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Invertuniformareasamplingtofindmonou0-0">Invert uniform area sampling to find <tt>u0</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-721" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-721"><i></i></a><div id="fragbit-721" class="collapse"><div class="fragmentcode">       Float u0;
       if (<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(a, cp) &gt; 0.99999847691f /* 0.1 degrees */)
           u0 = 0;
       else {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeareaAofsubtriangle-0">Compute area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg> of subtriangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-722" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-722"><i></i></a><div id="fragbit-722" class="collapse"><div class="fragmentcode">              <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n_cpb = Cross(cp, b), n_acp = Cross(a, cp);
              if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_cpb) == 0 || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_acp) == 0)
                  return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0.5, 0.5);
              n_cpb = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_cpb);
              n_acp = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_acp);
              Float Ap =
                  alpha + <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ab, n_cpb) + <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_acp, -n_cpb) - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesamplemonou0thatgivestheareaA-0">Compute sample <tt>u0</tt> that gives the area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-723" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-723"><i></i></a><div id="fragbit-723" class="collapse"><div class="fragmentcode">              Float A = alpha + beta + gamma - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;
              u0 = Ap / A;</div></div>
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Invertarcsamplingtofindmonou1andreturnresult-0">Invert arc sampling to find <tt>u1</tt> and return result</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-724" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-724"><i></i></a><div id="fragbit-724" class="collapse"><div class="fragmentcode">       Float u1 = (1 - <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(w, b)) / (1 - <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(cp, b));
       return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u0, 0, 1), <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u1, 0, 1));</div></div>
}</div><p>


</p>
<p>Next, it finds the vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> along the arc between <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg> that defines the subtriangle that would have been sampled when
sampling <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg>.  This vertex can be found by computing the intersection of
the great circle defined by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> and the great circle
defined by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>; see
Figure&nbsp;<a href="#fig:invert-sphtri-find-cprimed">6.21</a>.

</p>
<p> </p>
<span class="anchor" id="fig:invert-sphtri-find-cprimed"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha06f21.svg" title=""><img src="pha06f21.svg" width=710 height=302 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 6.21: <span class="legend">
Given a spherical triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.973ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1710.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold b bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="559" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="1199" y="0"></use>
</g>
</svg> and a direction
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> that is inside it, the vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> along the edge from
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg> can be found from the intersection of the great
circle that passes through <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> and the great circle that
passes through <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Recall from Section&nbsp;<a href="../Geometry_and_Transformations/Spherical_Geometry.html#sec:spherical-polygons">3.8.2</a> that the great circle
passing through two points on the sphere is given by the intersection of
the sphere with a plane passing through the origin and those two points.
Therefore, we can find the intersection between the two corresponding
planes, which is a line.  In 3D, the cross product of the plane normals
gives this line&rsquo;s direction.  This line intersects the sphere at two points
and so it is necessary to choose the one of them that is between
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-FindvertexVECcalongVECaVECcarcforw-0"></span><div class="fragmentname">&lt;&lt;Find vertex <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> along <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.487ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 1071 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="559" y="0"></use>
</g>
</svg> arc for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> cp = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(<a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(b, w), <a href="../Geometry_and_Transformations/Vectors.html#Cross" class="code">Cross</a>(c, a)));
if (<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(cp, a + c) &lt; 0)
    cp = -cp;</div><p>


</p>
<p>Given <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>, it is easy to compute the area of the triangle
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.874ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2098.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold b bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="559" y="0"></use>
<g transform="translate(1199,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</g>
</svg>; the ratio of that area to the original area gives
the first sample value <tt>u0</tt>.  However, it is necessary to be aware of
the case where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.299ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 559.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg> are nearly coincident; in that
case, computation of the angle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.181ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 939.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">gamma prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D6FE" d="M543 421c0 -4 -12 -26 -19 -38c-40 -79 -104 -228 -136 -327c-4 -13 -6 -26 -8 -39c-4 -31 -14 -88 -37 -172c-11 -38 -19 -60 -32 -60c-8 0 -13 7 -13 18c0 26 30 142 52 215c7 20 12 37 12 98c0 79 -11 254 -162 254c-11 0 -120 -1 -159 -116l-4 -5c-10 0 -19 0 -19 10 c0 31 70 183 195 183c69 0 109 -49 133 -110c39 -97 40 -173 41 -204c40 101 80 201 132 296c3 7 9 7 12 7c0 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D6FE" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="779" y="513"></use>
</g>
</svg> may have high error, sometimes to
the point that the subtriangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.874ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2098.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold b bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="559" y="0"></use>
<g transform="translate(1199,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</g>
</svg> seems to have
larger area than the original triangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.973ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1710.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold a bold b bold c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41A" d="M553 24c0 -24 -12 -24 -32 -24h-48c-104 0 -104 46 -104 77c-22 -42 -69 -83 -149 -83c-69 0 -193 18 -193 114c0 145 254 154 325 157v34c0 76 -35 118 -110 118c-12 0 -44 -1 -72 -7c3 -2 22 -19 22 -49c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 88 122 92 179 92 c149 0 220 -65 220 -154v-215c0 -23 0 -36 61 -37c13 0 26 0 26 -23zM352 139v95c-50 -3 -208 -17 -208 -125c0 -44 40 -79 91 -79c25 0 117 13 117 109Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="559" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="1199" y="0"></use>
</g>
</svg>.  That
case is caught with a dot product test.

</p>
<p></p>
<span class="anchor" id="fragment-Invertuniformareasamplingtofindmonou0-0"></span><div class="fragmentname">&lt;&lt;Invert uniform area sampling to find <tt>u0</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float u0;
if (<a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(a, cp) &gt; 0.99999847691f /* 0.1 degrees */)
    u0 = 0;
else {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeareaAofsubtriangle-0">Compute area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg> of subtriangle</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-725" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-725"><i></i></a><div id="fragbit-725" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n_cpb = Cross(cp, b), n_acp = Cross(a, cp);
       if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_cpb) == 0 || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_acp) == 0)
           return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0.5, 0.5);
       n_cpb = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_cpb);
       n_acp = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_acp);
       Float Ap =
           alpha + <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ab, n_cpb) + <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_acp, -n_cpb) - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesamplemonou0thatgivestheareaA-0">Compute sample <tt>u0</tt> that gives the area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-726" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-726"><i></i></a><div id="fragbit-726" class="collapse"><div class="fragmentcode">       Float A = alpha + beta + gamma - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;
       u0 = Ap / A;</div></div>
}</div><p>


</p>
<p>Otherwise, the area of the subtriangle <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg> is computed using
Girard&rsquo;s theorem.

</p>
<p></p>
<span class="anchor" id="fragment-ComputeareaAofsubtriangle-0"></span><div class="fragmentname">&lt;&lt;Compute area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg> of subtriangle&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector3f" class="code">Vector3f</a> n_cpb = Cross(cp, b), n_acp = Cross(a, cp);
if (<a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_cpb) == 0 || <a href="../Geometry_and_Transformations/Vectors.html#LengthSquared" class="code">LengthSquared</a>(n_acp) == 0)
    return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(0.5, 0.5);
n_cpb = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_cpb);
n_acp = <a href="../Geometry_and_Transformations/Vectors.html#Normalize" class="code">Normalize</a>(n_acp);
Float Ap =
    alpha + <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_ab, n_cpb) + <a href="../Geometry_and_Transformations/Vectors.html#AngleBetween" class="code">AngleBetween</a>(n_acp, -n_cpb) - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;</div><p>


</p>
<p>The first sample value is then easily found given these two areas.

</p>
<p></p>
<span class="anchor" id="fragment-Computesamplemonou0thatgivestheareaA-0"></span><div class="fragmentname">&lt;&lt;Compute sample <tt>u0</tt> that gives the area <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.645ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1138.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper A prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D434" d="M721 20c0 -20 -12 -20 -18 -20c-25 0 -88 3 -113 3c-41 0 -84 -3 -125 -3c0 0 -14 0 -14 11c0 20 10 20 24 20c20 0 72 3 72 33c0 10 -14 146 -16 167h-251c-68 -116 -69 -116 -76 -128c-8 -14 -14 -25 -14 -37c0 -25 24 -33 47 -35c7 0 16 -1 16 -12 c0 -19 -13 -19 -19 -19c-32 0 -67 3 -100 3c-28 0 -59 -3 -86 -3c-8 0 -13 5 -13 11c0 19 9 19 21 20c44 3 83 17 123 84l348 584c6 10 10 17 26 17c17 0 17 -4 19 -24l61 -625c3 -29 3 -36 65 -36c13 0 23 0 23 -11zM528 262l-32 330l-197 -330h229Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D434" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="1061" y="513"></use>
</g>
</svg>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float A = alpha + beta + gamma - <a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a>;
u0 = Ap / A;</div><p>


</p>
<p>The sampling method for choosing <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.446ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 622.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">omega Subscript</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D714" d="M604 372c0 -40 -12 -90 -23 -133c-30 -121 -93 -250 -197 -250c-67 0 -102 44 -113 106c-38 -62 -90 -106 -153 -106c-76 0 -105 62 -105 143c0 35 5 74 15 112c16 63 41 127 82 184c5 6 12 9 18 9c3 0 6 0 9 -2c5 -3 9 -8 9 -14c0 -4 -2 -9 -5 -13 c-38 -53 -74 -109 -89 -169c-5 -22 -8 -45 -8 -65c0 -63 26 -113 87 -113c55 0 103 39 136 93c1 29 5 59 13 90c5 22 15 47 34 47c14 0 19 -11 19 -26c0 -8 -2 -17 -4 -26c-7 -30 -17 -60 -30 -88c9 -52 42 -90 98 -90c79 0 137 92 160 183c3 12 4 25 4 37 c0 35 -13 66 -38 88c-7 7 -11 15 -11 25c0 11 5 22 14 32c10 10 23 16 35 16c9 0 17 -3 23 -9c15 -13 20 -35 20 -61Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D714" x="0" y="0"></use>
</g>
</svg> along the arc through <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.485ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 639.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41B" d="M600 223c0 -139 -103 -229 -252 -229c-89 0 -138 54 -146 62c-16 -19 -33 -37 -49 -56h-47v600c0 39 -7 39 -69 39v47l177 8v-293c24 20 74 49 147 49c145 0 239 -94 239 -227zM472 223c0 70 0 191 -122 191c-55 0 -103 -29 -130 -64v-251c10 -15 49 -69 119 -69 c32 0 78 11 107 52c26 39 26 94 26 141Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41B" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.09ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 899.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold c prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D41C" d="M478 117c0 -7 -30 -123 -192 -123c-154 0 -248 95 -248 228c0 116 74 231 253 231c58 0 174 -6 174 -92c0 -42 -32 -63 -63 -63c-27 0 -62 19 -62 63c0 9 2 30 20 46c-13 3 -30 6 -65 6c-129 0 -129 -130 -129 -186c0 -46 0 -193 139 -193c51 0 99 19 125 82 c5 13 6 15 24 15c10 0 24 0 24 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D41C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="723" y="513"></use>
</g>
</svg>, Equation&nbsp;(<a href="#eq:spherical-triangle-arc-sample">6.10</a>), is also
easily inverted.

</p>
<p></p>
<span class="anchor" id="fragment-Invertarcsamplingtofindmonou1andreturnresult-0"></span><div class="fragmentname">&lt;&lt;Invert arc sampling to find <tt>u1</tt> and return result&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float u1 = (1 - <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(w, b)) / (1 - <a href="../Geometry_and_Transformations/Vectors.html#Dot" class="code">Dot</a>(cp, b));
return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u0, 0, 1), <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u1, 0, 1));</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Shapes/Bilinear_Patches.html">Shapes / Bilinear Patches</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
