
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
        
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Sobol&rsquo; Samplers</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Sampling_and_Reconstruction.html">Sampling and Reconstruction</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Sobol&rsquo; Samplers</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Sampling_and_Reconstruction/Halton_Sampler.html">(Previous: Halton Sampler)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:sobol-sampler"></span><h2>8.7 Sobol&rsquo; Samplers<button data-toggle="tooltip" data-placement="right" class="btn difficult-button"
title="This section contains advanced content and may be skipped on a first reading.">
<i class="fas fa-exclamation-triangle midredtext"></i></button>
</h2><p>



</p>
<p>While the Halton sequence is effective for Monte Carlo integration,
each radical inverse computation requires one integer division for each
digit.  The integer division instruction is one of the slowest ones on most
processors, which can affect overall rendering performance, especially in
highly optimized renderers.  Therefore, in this section we will describe
three <tt>Sampler</tt>s that are based on the Sobol&rsquo; sequence, a
low-discrepancy sequence that is defined entirely in base 2, which leads to
efficient implementations.

</p>
<p>The base-2 radical inverse can be computed more
efficiently than the way that the base-agnostic <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RadicalInverse"><tt>RadicalInverse()</tt></a>
function computes it.  The key is to take advantage of the fact that
numbers are already represented in base&nbsp;2 on digital
computers. If <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> is a 64-bit value, then from
Equation&nbsp;(<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#eq:rad-inv-num-val">8.18</a>),
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.828ex" height="7.343ex" style="vertical-align: -3.005ex;" viewBox="0 -1867.7 7675.7 3161.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a equals sigma-summation Underscript i equals 1 Overscript 64 Endscripts d Subscript i Baseline left-parenthesis a right-parenthesis 2 Superscript i minus 1 Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="807" y="0"></use>
<g transform="translate(1863,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
<g transform="translate(368,1151)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
</g>
</g>
<g transform="translate(3474,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4339" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="4729" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5258" y="0"></use>
<g transform="translate(5648,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="7397" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.048ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2173.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i Baseline left-parenthesis a right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="864" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1254" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1783" y="0"></use>
</g>
</svg> are its bits.  First, consider reversing its bits, still
represented as an integer value, which gives
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.321ex" height="7.343ex" style="vertical-align: -3.005ex;" viewBox="0 -1867.7 6166.1 3161.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sigma-summation Underscript i equals 1 Overscript 64 Endscripts d Subscript i Baseline left-parenthesis a right-parenthesis 2 Superscript 64 minus i Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
<g transform="translate(368,1151)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
</g>
<g transform="translate(1611,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2475" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="2865" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3394" y="0"></use>
<g transform="translate(3784,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="1779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="5887" y="0"></use>
</g>
</svg>
</div>
<p>

If we then divide this value by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1308.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript 64</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
</g>
</g>
</svg>, we have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.677ex" height="7.343ex" style="vertical-align: -3.005ex;" viewBox="0 -1867.7 5458.3 3161.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sigma-summation Underscript i equals 1 Overscript 64 Endscripts d Subscript i Baseline left-parenthesis a right-parenthesis 2 Superscript negative i Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
<g transform="translate(368,1151)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
</g>
<g transform="translate(1611,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2475" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="2865" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3394" y="0"></use>
<g transform="translate(3784,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5179" y="0"></use>
</g>
</svg>
</div>
<p>

which equals <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.771ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2484.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal upper Phi 2 left-parenthesis a right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-3A6" d="M665 341c0 -101 -111 -194 -266 -206v-56c0 -35 0 -48 95 -48h33v-31c-36 3 -129 3 -170 3s-133 0 -169 -3v31h33c95 0 95 14 95 48v56c-149 15 -260 104 -260 207c0 99 107 191 260 206v56c0 35 0 48 -95 48h-33v31c36 -3 129 -3 170 -3s133 0 169 3v-31h-33 c-95 0 -95 -14 -95 -48v-56c152 -12 266 -103 266 -207zM316 158v367c-150 -20 -160 -132 -160 -184c0 -62 18 -164 160 -183zM565 342c0 76 -28 168 -166 184v-369c151 18 166 125 166 185Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-3A6" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="1021" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1176" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1565" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2095" y="0"></use>
</g>
</svg> (recall Equation&nbsp;(<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#eq:radical-inverse">8.19</a>)).
Thus, the base-2 radical inverse can equivalently
be computed using a bit reverse and a power-of-two division.  The division
can be replaced with multiplication by the corresponding inverse
power-of-two, which gives the same result with IEEE floating point.
Some processors provide a native instruction that directly reverses the bits in a
register; otherwise it can be done in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.39ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4043.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis log Subscript 2 Baseline n right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6C" d="M255 0l-111 3l-111 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-618c0 -45 11 -45 78 -45v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-67" d="M485 404c0 -23 -19 -30 -29 -30c-16 0 -29 12 -29 29c0 12 5 23 16 27c-3 1 -10 1 -10 1c-18 0 -54 -5 -90 -39c25 -23 41 -60 41 -97c0 -77 -69 -146 -162 -146c-19 0 -60 3 -99 31c-17 -20 -17 -43 -17 -47c0 -32 21 -63 53 -67c7 -1 50 -1 75 -1c61 0 119 0 172 -28 c51 -28 65 -79 65 -114c0 -78 -104 -129 -222 -129c-122 0 -221 55 -221 127c0 40 32 83 92 100c-31 20 -44 58 -44 89c0 35 18 68 31 83c-25 21 -47 59 -47 103c0 77 69 146 162 146c22 0 64 -3 106 -36c42 41 86 47 106 47c39 0 51 -32 51 -49zM309 296 c0 23 0 123 -87 123c-40 0 -63 -28 -71 -40c-15 -25 -16 -57 -16 -84c0 -23 0 -123 87 -123c40 0 63 28 71 40c15 25 16 57 16 84zM419 -79c0 86 -112 86 -198 86h-59c-44 -3 -82 -40 -82 -86c0 -53 69 -104 170 -104c98 0 169 50 169 104Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
<g transform="translate(1153,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6C"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-67" x="779" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="1809" y="-343"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="3053" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3653" y="0"></use>
</g>
</svg> operations, where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg>
is the number of bits.  (See the implementation of <a href="../Utilities/Mathematical_Infrastructure.html#ReverseBits32"><tt>ReverseBits32()</tt></a> in
Section&nbsp;<a href="../Utilities/Mathematical_Infrastructure.html#sec:bit-ops">B.2.7</a>.)

</p>
<p>While the implementation of a function that generates Halton points could
be optimized by taking advantage of this for the first dimension where
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.258ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2264.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b equals 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="707" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1763" y="0"></use>
</g>
</svg>, performance would not improve for any of the remaining dimensions, so
the overall benefit would be low.  The Sobol&rsquo; sequence uses <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.258ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2264.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b equals 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="707" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1763" y="0"></use>
</g>
</svg> for all
dimensions, which allows it to benefit in all cases from computers&rsquo; use of
base&nbsp;2 internally.  So that each dimension has a different set of sample values,
it uses a different <em>generator matrix</em> for each dimension, where the
generator matrices are carefully chosen so that the resulting sequence has
low discrepancy.

</p>
<p>To see how generator matrices are used, consider an <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg>-digit number <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> in
base <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg>, where the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th digit of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.048ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2173.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i Baseline left-parenthesis a right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="864" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1254" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1783" y="0"></use>
</g>
</svg> and where we have an <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.63ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 2423.9 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n times n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="1823" y="0"></use>
</g>
</svg>
generator matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg>. Then the corresponding sample point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.183ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4384.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript a Baseline element-of left-bracket 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2208" d="M587 -23c0 -11 -9 -20 -20 -20h-193c-162 0 -293 131 -293 293s131 293 293 293h193c11 0 20 -9 20 -20s-9 -20 -20 -20h-193c-133 0 -242 -103 -252 -233h445c27 0 27 -40 0 -40h-445c10 -130 119 -233 252 -233h193c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2208" x="1324" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="2269" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2548" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3048" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3494" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3994" y="0"></use>
</g>
</svg> is defined by
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:generator-matrix-sample"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.982ex" height="13.176ex" style="vertical-align: -6.005ex;" viewBox="0 -3087.6 23672.8 5673" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript a Baseline equals left-bracket b Superscript negative 1 Baseline b Superscript negative 2 Baseline midline-horizontal-ellipsis b Superscript negative n Baseline right-bracket Start 4 By 4 Matrix 1st Row 1st Column c Subscript 1 comma 1 Baseline 2nd Column c Subscript 1 comma 2 Baseline 3rd Column midline-horizontal-ellipsis 4th Column c Subscript 1 comma n Baseline 2nd Row 1st Column c Subscript 2 comma 1 Baseline 2nd Column down-right-diagonal-ellipsis 3rd Column Blank 4th Column c Subscript 2 comma n Baseline 3rd Row 1st Column vertical-ellipsis 2nd Column Blank 3rd Column down-right-diagonal-ellipsis 4th Column vertical-ellipsis 4th Row 1st Column c Subscript n comma 1 Baseline 2nd Column midline-horizontal-ellipsis 3rd Column midline-horizontal-ellipsis 4th Column c Subscript n comma n Baseline EndMatrix Start 4 By 1 Matrix 1st Row  d 1 left-parenthesis a right-parenthesis 2nd Row  d 2 left-parenthesis a right-parenthesis 3rd Row  vertical-ellipsis 4th Row  d Subscript n Baseline left-parenthesis a right-parenthesis EndMatrix comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22EF" d="M162 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM441 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM720 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22F1" d="M360 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM163 447c0 -29 -24 -53 -53 -53c-30 0 -53 24 -53 53c0 30 23 53 53 53c29 0 53 -23 53 -53zM557 53c0 -30 -23 -53 -53 -53c-29 0 -53 23 -53 53c0 29 24 53 53 53c30 0 53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22EE" d="M162 -29c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM162 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM162 529c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1324" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="2380" y="0"></use>
<g transform="translate(2659,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(4260,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="6027" y="0"></use>
<g transform="translate(7137,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="8641" y="0"></use>
<g transform="translate(9086,0)">
<g transform="translate(0,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5461"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
</g>
</g>
<g transform="translate(35,693)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="645" y="-794"></use>
<g transform="translate(0,-2194)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="600" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="879" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2498,0)">
<g transform="translate(0,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22F1" x="412" y="693"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="330" y="-2194"></use>
</g>
<g transform="translate(4936,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="0" y="2180"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22F1" x="81" y="-794"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="0" y="-2194"></use>
</g>
<g transform="translate(6713,0)">
<g transform="translate(35,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="779" y="0"></use>
</g>
</g>
<g transform="translate(35,693)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="680" y="-794"></use>
<g transform="translate(0,-2194)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="600" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="879" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(9294,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5461"></use>
</g>
</g>
<g transform="translate(19215,0)">
<g transform="translate(0,2923)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-3892.561876247505) scale(1,2.43812375249501)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5346"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2123)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1893" y="0"></use>
</g>
<g transform="translate(35,674)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1893" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="1067" y="-775"></use>
<g transform="translate(0,-2175)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1045" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1434" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1964" y="0"></use>
</g>
</g>
</g>
<g transform="translate(3344,2923)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-3892.561876247505) scale(1,2.43812375249501)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5346"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="23394" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:generator-matrix-sample">8.22</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where all arithmetic is performed in the ring <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.572ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1107.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper Z Subscript b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D419" d="M645 284l-18 -284h-531c-22 0 -32 0 -32 26c0 11 0 14 8 26l400 587h-130c-140 0 -207 -61 -215 -194h-47l12 241h514c21 0 32 0 32 -25c0 -11 0 -12 -8 -24l-399 -586h140c205 0 219 122 227 233h47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D419" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="994" y="-213"></use>
</g>
</svg> (in other
words, when all operations are performed modulo <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg>).  This
construction gives a
total of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.216ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 954.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b Superscript n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="607" y="513"></use>
</g>
</svg> points as <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> ranges from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
</g>
</svg> to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.219ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2677.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b Superscript n Baseline minus 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="607" y="513"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1176" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2177" y="0"></use>
</g>
</svg>.  If the
generator matrix is the identity matrix, then this definition corresponds
to the regular radical inverse, base <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg>.  (It is worth pausing to make sure
you see this connection between Equations&nbsp;(<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#eq:radical-inverse">8.19</a>)
and&nbsp;(<a href="#eq:generator-matrix-sample">8.22</a>) before continuing.)

</p>
<p>In this section, we will exclusively use <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.258ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2264.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b equals 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="707" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1763" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.818ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2935.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n equals 32</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="878" y="0"></use>
<g transform="translate(1934,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg>. While
introducing a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.49ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3224.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">32 times 32</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="1223" y="0"></use>
<g transform="translate(2223,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg> matrix to each dimension of the sample
generation algorithm may not seem like a step toward better performance, we
will see that in the end the sampling code can be mapped to an
implementation that uses a small number of bit operations that perform this
computation in an extremely efficient manner.

</p>
<p>The first step toward high performance comes from the fact that we are
working in base 2; as such, all entries of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg> are either&nbsp;0 or&nbsp;1
and thus we can represent either each row or each column of the matrix with
a single unsigned 32-bit integer.  We will choose to represent columns of the
matrix as <tt>uint32_t</tt>s; this choice leads to an efficient
algorithm for multiplying the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.009ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 864.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
</svg> column vector by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg>.

</p>
<p>Now consider the task of computing the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.662ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 4160 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C left-bracket d Subscript i Baseline left-parenthesis a right-parenthesis right-bracket Superscript upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="831" y="0"></use>
<g transform="translate(1110,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="2364" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2893" y="0"></use>
<g transform="translate(3283,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="513"></use>
</g>
</g>
</svg> matrix-vector
product; using the definition of matrix-vector multiplication, we have:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:generator-add-cols"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="69.448ex" height="13.176ex" style="vertical-align: -6.005ex;" viewBox="0 -3087.6 29900.9 5673" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 4 By 4 Matrix 1st Row 1st Column c Subscript 1 comma 1 Baseline 2nd Column c Subscript 1 comma 2 Baseline 3rd Column midline-horizontal-ellipsis 4th Column c Subscript 1 comma n Baseline 2nd Row 1st Column c Subscript 2 comma 1 Baseline 2nd Column down-right-diagonal-ellipsis 3rd Column Blank 4th Column c Subscript 2 comma n Baseline 3rd Row 1st Column vertical-ellipsis 2nd Column Blank 3rd Column down-right-diagonal-ellipsis 4th Column vertical-ellipsis 4th Row 1st Column c Subscript n comma 1 Baseline 2nd Column midline-horizontal-ellipsis 3rd Column midline-horizontal-ellipsis 4th Column c Subscript n comma n Baseline EndMatrix Start 4 By 1 Matrix 1st Row  d 1 left-parenthesis a right-parenthesis 2nd Row  d 2 left-parenthesis a right-parenthesis 3rd Row  vertical-ellipsis 4th Row  d Subscript n Baseline left-parenthesis a right-parenthesis EndMatrix equals d 1 Start 4 By 1 Matrix 1st Row  c Subscript 1 comma 1 Baseline 2nd Row  c Subscript 2 comma 1 Baseline 3rd Row  vertical-ellipsis 4th Row  c Subscript n comma 1 Baseline EndMatrix plus midline-horizontal-ellipsis plus d Subscript n Baseline Start 4 By 1 Matrix 1st Row  c Subscript 1 comma n Baseline 2nd Row  c Subscript 2 comma n Baseline 3rd Row  vertical-ellipsis 4th Row  c Subscript n comma n Baseline EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22EF" d="M162 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM441 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM720 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22F1" d="M360 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM163 447c0 -29 -24 -53 -53 -53c-30 0 -53 24 -53 53c0 30 23 53 53 53c29 0 53 -23 53 -53zM557 53c0 -30 -23 -53 -53 -53c-29 0 -53 23 -53 53c0 29 24 53 53 53c30 0 53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22EE" d="M162 -29c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM162 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM162 529c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5461"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
</g>
</g>
<g transform="translate(35,693)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="645" y="-794"></use>
<g transform="translate(0,-2194)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="600" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="879" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2498,0)">
<g transform="translate(0,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22F1" x="412" y="693"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="330" y="-2194"></use>
</g>
<g transform="translate(4936,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="0" y="2180"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22F1" x="81" y="-794"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="0" y="-2194"></use>
</g>
<g transform="translate(6713,0)">
<g transform="translate(35,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="779" y="0"></use>
</g>
</g>
<g transform="translate(35,693)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="680" y="-794"></use>
<g transform="translate(0,-2194)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="600" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="879" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(9294,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5461"></use>
</g>
<g transform="translate(10128,0)">
<g transform="translate(0,2923)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-3892.561876247505) scale(1,2.43812375249501)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5346"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2123)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1893" y="0"></use>
</g>
<g transform="translate(35,674)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1363" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1893" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="1067" y="-775"></use>
<g transform="translate(0,-2175)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1045" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1434" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1964" y="0"></use>
</g>
</g>
</g>
<g transform="translate(3344,2923)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-3892.561876247505) scale(1,2.43812375249501)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5346"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="14418" y="0"></use>
<g transform="translate(15474,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="736" y="-213"></use>
</g>
<g transform="translate(16615,0)">
<g transform="translate(0,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5461"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
</g>
</g>
<g transform="translate(35,693)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="645" y="-794"></use>
<g transform="translate(0,-2194)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="600" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="879" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(2500,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5461"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="20005" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="21006" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="22005" y="0"></use>
<g transform="translate(23005,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="736" y="-213"></use>
</g>
<g transform="translate(24217,0)">
<g transform="translate(0,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5461"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2180)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="779" y="0"></use>
</g>
</g>
<g transform="translate(35,693)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="680" y="-794"></use>
<g transform="translate(0,-2194)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
<g transform="translate(433,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="600" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="879" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(2570,2980)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-4006.983715366489) scale(1,2.5524312840824064)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5461"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="27622" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:generator-add-cols">8.23</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

In other words, for each digit of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.009ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 864.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
</svg> that has a value of&nbsp;1, the
corresponding column of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg> should be summed.  This addition can in
turn be performed efficiently in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.688ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1157.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper Z 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D419" d="M645 284l-18 -284h-531c-22 0 -32 0 -32 26c0 11 0 14 8 26l400 587h-130c-140 0 -207 -61 -215 -194h-47l12 241h514c21 0 32 0 32 -25c0 -11 0 -12 -8 -24l-399 -586h140c205 0 219 122 227 233h47Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D419" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="994" y="-213"></use>
</g>
</svg>: in that setting,
addition corresponds to the bitwise exclusive
<span style="font-variant: small-caps;">or</span> operation.  (Consider the
combinations of the two possible operand values&mdash;0 and 1&mdash;and the result
of adding them <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.328ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2724.3 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal m normal o normal d 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(166,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="833" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="1334" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="2223" y="0"></use>
</g>
</svg>, and compare to the values computed by exclusive
<span style="font-variant: small-caps;">or</span>
with the same operand values.)  Thus, the multiplication <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.662ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 4160 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C left-bracket d Subscript i Baseline left-parenthesis a right-parenthesis right-bracket Superscript upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="831" y="0"></use>
<g transform="translate(1110,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="2364" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2893" y="0"></use>
<g transform="translate(3283,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="513"></use>
</g>
</g>
</svg> is just a matter of exclusive <span style="font-variant: small-caps;">or</span>ing together the columns <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>
of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg> where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.048ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2173.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i Baseline left-parenthesis a right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="864" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="1254" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1783" y="0"></use>
</g>
</svg>&rsquo;s bit is 1.  This computation is implemented
in the <tt>MultiplyGenerator()</tt> function.

</p>
<p></p>
<span class="anchor" id="fragment-LowDiscrepancyInlineFunctions-4"></span><div class="fragmentname">&lt;&lt;Low Discrepancy Inline Functions&gt;&gt;+=&nbsp;<a href="Halton_Sampler.html#fragment-LowDiscrepancyInlineFunctions-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-LowDiscrepancyInlineFunctions-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">uint32_t <span class="anchor" id="MultiplyGenerator"></span>MultiplyGenerator(pstd::span&lt;const uint32_t&gt; C, uint32_t a) {
    uint32_t v = 0;
    for (int i = 0; a != 0; ++i, a &gt;&gt;= 1)
        if (a &amp; 1)
            v ^= C[i];
    return v;
}</div><p>


</p>
<p>Going back to Equation&nbsp;(<a href="#eq:generator-matrix-sample">8.22</a>), if we denote
the column vector from the product <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.888ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 5979.5 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v equals bold upper C left-bracket d Subscript i Baseline left-parenthesis a right-parenthesis right-bracket Superscript upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="1819" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="2651" y="0"></use>
<g transform="translate(2929,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3794" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="4183" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4713" y="0"></use>
<g transform="translate(5102,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="513"></use>
</g>
</g>
</svg>, then consider the
vector product
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:generator-base-scale"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.099ex" height="12.509ex" style="vertical-align: -5.671ex;" viewBox="0 -2944.1 17695.3 5385.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript a Baseline equals left-bracket 2 Superscript negative 1 Baseline 2 Superscript negative 2 Baseline midline-horizontal-ellipsis 2 Superscript negative n Baseline right-bracket Start 4 By 1 Matrix 1st Row  v 1 2nd Row  v 2 3rd Row  vertical-ellipsis 4th Row  v Subscript n Baseline EndMatrix equals sigma-summation Underscript i equals 1 Overscript 32 Endscripts 2 Superscript negative i Baseline v Subscript i Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22EF" d="M162 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM441 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM720 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-5B" d="M383 -327c0 -13 -10 -23 -23 -23h-143v1200h143c13 0 23 -10 23 -23s-10 -23 -23 -23h-97v-1108h97c13 0 23 -10 23 -23Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE2-5D" d="M200 850v-1200h-143c-13 0 -23 10 -23 23s10 23 23 23h97v1108h-97c-13 0 -23 10 -23 23s10 23 23 23h143Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-22EE" d="M162 -29c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM162 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM162 529c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1324" y="0"></use>
<g transform="translate(2380,0)">
 <use xlink:href="#E1-LATINMODERNSIZE2-5B"></use>
<g transform="translate(417,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(2089,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EF" x="3927" y="0"></use>
<g transform="translate(5037,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="778" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE2-5D" x="6612" y="0"></use>
</g>
<g transform="translate(9577,0)">
<g transform="translate(0,2850)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-3745.7085828343315) scale(1,2.291417165668663)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-5199"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2050)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="686" y="-213"></use>
</g>
<g transform="translate(35,650)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-22EE" x="395" y="-750"></use>
<g transform="translate(0,-2150)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="686" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2001,2850)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-3745.7085828343315) scale(1,2.291417165668663)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-5199"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="12524" y="0"></use>
<g transform="translate(13580,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
<g transform="translate(368,1151)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
</g>
<g transform="translate(15191,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="778" y="0"></use>
</g>
</g>
<g transform="translate(16587,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="17416" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:generator-base-scale">8.24</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

Applying the same ideas as we did before to derive an efficient base-2
radical inverse algorithm, this value can also be computed by reversing the
bits of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 485.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
</g>
</svg> and dividing by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1308.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript 32</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg>.  To save the small cost of reversing
the bits, we can equivalently reverse the bits in all the columns of the
generator matrix before passing it to
<a href="#MultiplyGenerator"><tt>MultiplyGenerator()</tt></a>. We will use that convention in what follows.

</p>
<p>We will not discuss how the Sobol&rsquo; matrices are derived in a way that leads
to a low-discrepancy sequence; the &ldquo;Further Reading&rdquo; section has pointers
to more
details.  However, the first few Sobol&rsquo; generator matrices are shown in
Figure&nbsp;<a href="#fig:sobol-4-matrices">8.34</a>.  Note that the first is the identity,
corresponding to the van der Corput sequence.  Subsequent dimensions have
various fractal-like structures to their entries.

</p>
<p></p>
<span class="anchor" id="fig:sobol-4-matrices"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f34.svg" title=""><img src="pha08f34.svg" width=784 height=785 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.34: <span class="legend"> Generator matrices for the first four dimensions of the
Sobol&rsquo; sequence. Note their regular structure.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#StratificationoverElementaryIntervals"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:elementary-intervals"></span><span id="StratificationoverElementaryIntervals"></span><h3>8.7.1  Stratification over Elementary Intervals</h3><p>



</p>
<p>The first two dimensions of the Sobol&rsquo; sequence are stratified in a very
general way that makes them particularly effective in integration.  For
example, the first 16 samples satisfy the stratification constraint from
stratified sampling in Section&nbsp;<a href="../Sampling_and_Reconstruction/Stratified_Sampler.html#sec:stratified-sampling">8.5</a>, meaning there
is just one sample in each of the boxes of extent <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.159ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 2652 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis one-fourth comma one-fourth right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="84" y="-600"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1103" y="0"></use>
<g transform="translate(1381,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-34" x="84" y="-600"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2262" y="0"></use>
</g>
</svg>.  However, they are also stratified over all the boxes of
extent <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.486ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 2792.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis one-sixteenth comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="335" y="629"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1457" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1902" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2402" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.486ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 2792.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma one-sixteenth right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
<g transform="translate(1168,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="335" y="629"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2402" y="0"></use>
</g>
</svg>.  Furthermore, there is
only one sample in each of the boxes of extent <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.159ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 2652 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis one-half comma one-eighth right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1103" y="0"></use>
<g transform="translate(1381,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-38" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2262" y="0"></use>
</g>
</svg>
and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.159ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 2652 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis one-eighth comma one-half right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-38" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1103" y="0"></use>
<g transform="translate(1381,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2262" y="0"></use>
</g>
</svg>.
Figure&nbsp;<a href="#fig:elementary-intervals">8.35</a> shows all the possibilities for
dividing the domain into regions where the first 16 Sobol&rsquo; samples
satisfy these stratification properties.

</p>
<p> </p>
<span class="anchor" id="fig:elementary-intervals"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f35.svg" title=""><img src="pha08f35.svg" width=992 height=649 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.35: <span class="legend"> A sampling pattern that has a
single sample in all the base-2 elementary intervals.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Not only are corresponding stratification constraints obeyed by any
power-of-2 set of samples starting from the beginning of the sequence, but
subsequent power-of-2-sized sets of samples fulfill them as well.
More formally, any sequence of length <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.317ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2289.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript l 1 plus l 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D459" d="M258 683l-144 -578c-5 -19 -6 -24 -6 -48c0 -14 0 -46 30 -46c40 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -12 -60 -30 -98c-17 -36 -42 -56 -75 -56c-47 0 -91 35 -91 92c0 16 2 23 5 34l126 500l3 20c0 8 -1 17 -49 17c-15 0 -25 0 -25 11 c0 19 11 20 19 21c26 2 99 10 122 10c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-31" x="367" y="-243"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="804" y="0"></use>
<g transform="translate(1119,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="367" y="-243"></use>
</g>
</g>
</g>
</svg> (where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.493ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 642.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">l Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D459" d="M258 683l-144 -578c-5 -19 -6 -24 -6 -48c0 -14 0 -46 30 -46c40 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -12 -60 -30 -98c-17 -36 -42 -56 -75 -56c-47 0 -91 35 -91 92c0 16 2 23 5 34l126 500l3 20c0 8 -1 17 -49 17c-15 0 -25 0 -25 11 c0 19 11 20 19 21c26 2 99 10 122 10c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="422" y="-213"></use>
</g>
</svg> is a
nonnegative integer) satisfies this general
stratification constraint.  The set of <em>elementary intervals</em> in two
dimensions, base&nbsp;2, is defined&nbsp;as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="40.854ex" height="5.676ex" style="vertical-align: -2.338ex;" viewBox="0 -1437.2 17589.9 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper E equals StartSet left-bracket StartFraction a 1 Over 2 Superscript l 1 Baseline EndFraction comma StartFraction a 1 plus 1 Over 2 Superscript l 1 Baseline EndFraction right-parenthesis times left-bracket StartFraction a 2 Over 2 Superscript l 2 Baseline EndFraction comma StartFraction a 2 plus 1 Over 2 Superscript l 2 Baseline EndFraction right-parenthesis EndSet comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D438" d="M763 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12s1 12 1 18c4 27 4 29 4 53c0 82 -30 111 -152 111h-141c-44 0 -45 -4 -54 -39l-60 -241h94c92 0 110 23 131 99c3 12 5 18 14 18c7 0 12 -5 12 -11l-57 -234c-4 -15 -7 -20 -15 -20c-9 0 -13 6 -13 11 c0 3 1 6 3 11c7 30 7 42 7 49c0 25 0 46 -85 46h-99l-68 -273c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h146c171 0 208 67 273 215c2 6 4 12 13 12c12 0 12 -11 12 -11s-3 -9 -5 -14l-92 -216c-7 -16 -8 -17 -31 -17h-519c-19 0 -28 0 -28 12 c0 19 11 19 28 19c79 0 81 8 91 47l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h505c25 0 30 0 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D459" d="M258 683l-144 -578c-5 -19 -6 -24 -6 -48c0 -14 0 -46 30 -46c40 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -12 -60 -30 -98c-17 -36 -42 -56 -75 -56c-47 0 -91 35 -91 92c0 16 2 23 5 34l126 500l3 20c0 8 -1 17 -49 17c-15 0 -25 0 -25 11 c0 19 11 20 19 21c26 2 99 10 122 10c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-5B" d="M478 -773c0 -15 -12 -27 -27 -27h-221v2100h221c15 0 27 -12 27 -27s-12 -27 -27 -27h-167v-1992h167c15 0 27 -12 27 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-29" d="M462 100c0 -348 -182 -743 -382 -893c-2 -2 -6 -3 -9 -3c-9 0 -16 7 -16 16c0 5 2 10 6 13c190 142 323 535 323 867v300c0 332 -133 725 -323 867c-4 3 -6 8 -6 13c0 9 7 16 16 16c3 0 7 -1 9 -3c200 -150 382 -545 382 -893v-300Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7D" d="M425 250c0 -7 -5 -12 -12 -12c-75 0 -130 -55 -130 -113v-250c0 -73 -91 -125 -196 -125c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 49 130 101v250c0 58 48 104 115 125c-67 21 -115 67 -115 125v250c0 52 -55 101 -130 101c-7 0 -12 5 -12 12s5 12 12 12 c105 0 196 -52 196 -125v-250c0 -58 55 -113 130 -113c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-7B" d="M608 -780c0 -11 -9 -20 -20 -20c-2 0 -3 0 -5 1c-145 37 -273 148 -273 261v526c0 99 -81 213 -195 243c-9 2 -15 10 -15 19s6 17 15 19c114 30 195 144 195 243v526c0 113 128 224 273 261c2 1 3 1 5 1c11 0 20 -9 20 -20c0 -9 -6 -17 -15 -19 c-114 -29 -195 -134 -195 -223v-526c0 -108 -96 -212 -215 -262c119 -50 215 -154 215 -262v-526c0 -89 81 -194 195 -223c9 -2 15 -10 15 -19Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-7D" d="M607 250c0 -9 -6 -17 -15 -19c-114 -30 -195 -144 -195 -243v-526c0 -113 -128 -224 -273 -261c-1 -1 -3 -1 -5 -1c-11 0 -20 9 -20 20c0 9 7 17 15 19c114 29 195 134 195 223v526c0 108 97 212 216 262c-119 50 -216 154 -216 262v526c0 89 -81 194 -195 223 c-8 2 -15 10 -15 19c0 11 9 20 20 20c2 0 4 0 5 -1c145 -37 273 -148 273 -261v-526c0 -99 81 -213 195 -243c9 -2 15 -10 15 -19Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D438" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-7B"></use>
<g transform="translate(707,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-5B"></use>
<g transform="translate(499,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1289" height="60" x="0" y="220"></rect>
<g transform="translate(153,676)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="748" y="-213"></use>
</g>
<g transform="translate(60,-905)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-31" x="367" y="-243"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2029" y="0"></use>
<g transform="translate(2307,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="2826" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="748" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1205" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2206" y="0"></use>
</g>
<g transform="translate(828,-905)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-31" x="367" y="-243"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE5-29" x="5541" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="7134" y="0"></use>
<g transform="translate(8135,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-5B"></use>
<g transform="translate(499,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1289" height="60" x="0" y="220"></rect>
<g transform="translate(153,676)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="748" y="-213"></use>
</g>
<g transform="translate(60,-905)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="367" y="-243"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2029" y="0"></use>
<g transform="translate(2307,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="2826" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="748" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1205" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2206" y="0"></use>
</g>
<g transform="translate(828,-905)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="367" y="-243"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE5-29" x="5541" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE5-7D" x="14339" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="17311" y="0"></use>
</g>
</svg>
</div>
<p>

where the integer <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.792ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 10243.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a Subscript i Baseline equals 0 comma 1 comma 2 comma 3 comma ellipsis comma 2 Superscript l Super Subscript i Superscript Baseline minus 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2026" d="M193 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM472 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53zM751 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D459" d="M258 683l-144 -578c-5 -19 -6 -24 -6 -48c0 -14 0 -46 30 -46c40 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -12 -60 -30 -98c-17 -36 -42 -56 -75 -56c-47 0 -91 35 -91 92c0 16 2 23 5 34l126 500l3 20c0 8 -1 17 -49 17c-15 0 -25 0 -25 11 c0 19 11 20 19 21c26 2 99 10 122 10c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="748" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1151" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2207" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2708" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3153" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3654" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="4099" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4599" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="5044" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5545" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2026" x="5990" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="6994" y="0"></use>
<g transform="translate(7439,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="367" y="-238"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="8742" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="9743" y="0"></use>
</g>
</svg>.  One sample
from each of the first <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.317ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2289.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript l 1 plus l 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D459" d="M258 683l-144 -578c-5 -19 -6 -24 -6 -48c0 -14 0 -46 30 -46c40 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -12 -60 -30 -98c-17 -36 -42 -56 -75 -56c-47 0 -91 35 -91 92c0 16 2 23 5 34l126 500l3 20c0 8 -1 17 -49 17c-15 0 -25 0 -25 11 c0 19 11 20 19 21c26 2 99 10 122 10c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-31" x="367" y="-243"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="804" y="0"></use>
<g transform="translate(1119,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="367" y="-243"></use>
</g>
</g>
</g>
</svg> values in the sequence will be in each
of the elementary intervals.  Furthermore, the same property is true for
each subsequent set of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.317ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2289.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript l 1 plus l 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D459" d="M258 683l-144 -578c-5 -19 -6 -24 -6 -48c0 -14 0 -46 30 -46c40 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -12 -60 -30 -98c-17 -36 -42 -56 -75 -56c-47 0 -91 35 -91 92c0 16 2 23 5 34l126 500l3 20c0 8 -1 17 -49 17c-15 0 -25 0 -25 11 c0 19 11 20 19 21c26 2 99 10 122 10c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-31" x="367" y="-243"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2B" x="804" y="0"></use>
<g transform="translate(1119,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D459" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="367" y="-243"></use>
</g>
</g>
</g>
</svg> values.
Such a sequence is called a <em><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>-sequence</em>.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#RandomizationandScrambling"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:sobol-scrambling"></span><span id="RandomizationandScrambling"></span><h3>8.7.2  Randomization and Scrambling</h3><p>



</p>
<p>For the same reasons as were discussed in
Section&nbsp;<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#sec:halton-scrambling">8.6.2</a> in the context of the Halton sequence,
it is also useful to be able to scramble the Sobol&rsquo; sequence.  We will
now define a few small classes that scramble a given sample value using
various approaches.  As with the generation of Sobol&rsquo; samples, scrambling
algorithms for them can also take advantage of their base-2 representation
to improve their efficiency.

</p>
<p>All the following randomization classes take an unsigned 32-bit integer that they
should interpret as a fixed-point number with 0&nbsp;digits before and 32 digits
after the radix point.  Put another way, after randomization, this value
will be divided by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1308.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript 32</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg> to yield the final sample value in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2114.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1724" y="0"></use>
</g>
</svg>.

</p>
<p>The simplest approach is not to randomize the sample at all.  In that
case, the value is returned unchanged; this is implemented by
<tt>NoRandomizer</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-NoRandomizerDefinition-0"></span><div class="fragmentname">&lt;&lt;NoRandomizer Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="NoRandomizer"></span>NoRandomizer {
    uint32_t operator()(uint32_t v) const { return v; }
};</div><p>


</p>
<p>Alternatively, random permutations can be applied to the digits, such as
was done using the <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#DigitPermutation"><tt>DigitPermutation</tt></a> class with the Halton sampler.
In base&nbsp;2, however, a random permutation of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.684ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2447.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartSet 0 comma 1 EndSet</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7D" d="M425 250c0 -7 -5 -12 -12 -12c-75 0 -130 -55 -130 -113v-250c0 -73 -91 -125 -196 -125c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 49 130 101v250c0 58 48 104 115 125c-67 21 -115 67 -115 125v250c0 52 -55 101 -130 101c-7 0 -12 5 -12 12s5 12 12 12 c105 0 196 -52 196 -125v-250c0 -58 55 -113 130 -113c7 0 12 -5 12 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1001" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1446" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7D" x="1946" y="0"></use>
</g>
</svg> can be represented
with a single bit, as there are only two unique permutations.  If the
permutation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.684ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2447.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartSet 1 comma 0 EndSet</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7D" d="M425 250c0 -7 -5 -12 -12 -12c-75 0 -130 -55 -130 -113v-250c0 -73 -91 -125 -196 -125c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 49 130 101v250c0 58 48 104 115 125c-67 21 -115 67 -115 125v250c0 52 -55 101 -130 101c-7 0 -12 5 -12 12s5 12 12 12 c105 0 196 -52 196 -125v-250c0 -58 55 -113 130 -113c7 0 12 -5 12 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1001" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1446" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7D" x="1946" y="0"></use>
</g>
</svg> is denoted by a bit with value&nbsp;1 and the permutation
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.684ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2447.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartSet 0 comma 1 EndSet</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7D" d="M425 250c0 -7 -5 -12 -12 -12c-75 0 -130 -55 -130 -113v-250c0 -73 -91 -125 -196 -125c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 49 130 101v250c0 58 48 104 115 125c-67 21 -115 67 -115 125v250c0 52 -55 101 -130 101c-7 0 -12 5 -12 12s5 12 12 12 c105 0 196 -52 196 -125v-250c0 -58 55 -113 130 -113c7 0 12 -5 12 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1001" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1446" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7D" x="1946" y="0"></use>
</g>
</svg> is denoted by&nbsp;0, then the permutation can be applied by computing
the exclusive <span style="font-variant: small-caps;">or</span> of the permutation bit with a digit&rsquo;s bit.  Therefore, the
permutation for all 32 bits can be represented by a 32-bit integer and all
of the permutations can be applied in a single operation by computing the
exclusive <span style="font-variant: small-caps;">or</span> of the provided value with the permutation.

</p>
<p></p>
<span class="anchor" id="fragment-BinaryPermuteScramblerDefinition-0"></span><div class="fragmentname">&lt;&lt;BinaryPermuteScrambler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="BinaryPermuteScrambler"></span>BinaryPermuteScrambler {
    BinaryPermuteScrambler(uint32_t perm) : <a href="#BinaryPermuteScrambler::permutation" class="code">permutation</a>(perm) {}
    uint32_t operator()(uint32_t v) const { return <a href="#BinaryPermuteScrambler::permutation" class="code">permutation</a> ^ v; }
    uint32_t <span class="anchor" id="BinaryPermuteScrambler::permutation"></span><a href="#BinaryPermuteScrambler::permutation" class="code">permutation</a>;
};</div><p>


</p>
<p>Owen scrambling is also effective with Sobol&rsquo; points.  <tt>pbrt</tt> provides
two implementations of it, both of which take advantage of their base-2
representation.  <tt>FastOwenScrambler</tt> implements a highly efficient
approach, though the spectral properties of the resulting points are not
quite as good as a true Owen scramble.

</p>
<p></p>
<span class="anchor" id="fragment-FastOwenScramblerDefinition-0"></span><div class="fragmentname">&lt;&lt;FastOwenScrambler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="FastOwenScrambler"></span>FastOwenScrambler {
    FastOwenScrambler(uint32_t seed) : seed(seed) {}
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FastOwenScramblerPublicMethods-0">FastOwenScrambler Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1158" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1158"><i></i></a><div id="fragbit-1158" class="collapse"><div class="fragmentcode">       uint32_t operator()(uint32_t v) const {
           v = <a href="../Utilities/Mathematical_Infrastructure.html#ReverseBits32" class="code">ReverseBits32</a>(v);
           v ^= v * 0x3d20adea;
           v += <a href="#FastOwenScrambler::seed" class="code">seed</a>;
           v *= (<a href="#FastOwenScrambler::seed" class="code">seed</a> &gt;&gt; 16) | 1;
           v ^= v * 0x05526c56;
           v ^= v * 0x53a22864;
           return <a href="../Utilities/Mathematical_Infrastructure.html#ReverseBits32" class="code">ReverseBits32</a>(v);
       }</div></div>
    uint32_t <span class="anchor" id="FastOwenScrambler::seed"></span>seed;
};</div><p>


</p>
<p>Its implementation
builds on the fact that in base 2, if a number is multiplied by an
even value, then the value of any particular bit in it only affects the
bits above it in the result.  Equivalently, for any bit in the result, it
is only affected by the bits below it and the even multiplicand.  One way
to see why this is so is to consider long multiplication (as taught in
grade school) applied to binary numbers.  Given two <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg>-digit binary numbers <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg> where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.815ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2073.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i Baseline left-parenthesis b right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="864" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1254" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1683" y="0"></use>
</g>
</svg> is the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th digit of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg>, then using
Equation&nbsp;(<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#eq:rad-inv-num-val">8.18</a>), we have
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:binary-mult-even"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.984ex" height="5.509ex" style="vertical-align: -3.005ex;" viewBox="0 -1078.4 9034.7 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a b equals sigma-summation Underscript i equals 1 Endscripts a d Subscript i Baseline left-parenthesis b right-parenthesis 2 Superscript i minus 1 Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="696" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1403" y="0"></use>
<g transform="translate(2459,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="4070" y="0"></use>
<g transform="translate(4767,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5631" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="6021" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6450" y="0"></use>
<g transform="translate(7007,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,412)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="8756" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:binary-mult-even">8.25</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

Thus, for any digit <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.063ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2180.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i greater-than 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3E" d="M688 230l-581 -275c-25 -11 -42 25 -18 36l548 259l-548 259c-24 11 -7 47 18 36l581 -275c17 -8 17 -32 0 -40Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3E" x="623" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1679" y="0"></use>
</g>
</svg> where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.815ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2073.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d Subscript i Baseline left-parenthesis b right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="864" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1254" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1683" y="0"></use>
</g>
</svg> is one, the value of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg> is
shifted <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.805ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2068.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i minus 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="567" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1568" y="0"></use>
</g>
</svg> bits to the left and added to the final result and so any
digit of the result only depends on lower digits of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg>.

</p>
<p>The bits in the value provided to the randomization class must be reversed
so that the low bit corresponds to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1501.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1 slash 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1001" y="0"></use>
</g>
</svg> in the final sample value.  Then, 
the properties illustrated in Equation&nbsp;(<a href="#eq:binary-mult-even">8.25</a>) can be
applied: the product of an even value with the sample value <tt>v</tt> can be
interpreted as a bitwise permutation as was done in the
<a href="#BinaryPermuteScrambler"><tt>BinaryPermuteScrambler</tt></a>, allowing the use of an exclusive
<span style="font-variant: small-caps;">or</span> to
permute all the bits.  After a few rounds of this and a few operations
to mix the seed value in, the bits are reversed again before being returned.

</p>
<p></p>
<span class="anchor" id="fragment-FastOwenScramblerPublicMethods-0"></span><div class="fragmentname">&lt;&lt;FastOwenScrambler Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint32_t <span class="anchor" id="FastOpenScrambler::operator"></span>operator()(uint32_t v) const {
    v = <a href="../Utilities/Mathematical_Infrastructure.html#ReverseBits32" class="code">ReverseBits32</a>(v);
    v ^= v * 0x3d20adea;
    v += <a href="#FastOwenScrambler::seed" class="code">seed</a>;
    v *= (<a href="#FastOwenScrambler::seed" class="code">seed</a> &gt;&gt; 16) | 1;
    v ^= v * 0x05526c56;
    v ^= v * 0x53a22864;
    return <a href="../Utilities/Mathematical_Infrastructure.html#ReverseBits32" class="code">ReverseBits32</a>(v);
}</div><p>


</p>
<p>The <tt>OwenScrambler</tt> class implements a full Owen scramble, operating
on each bit in turn.

</p>
<p></p>
<span class="anchor" id="fragment-OwenScramblerDefinition-0"></span><div class="fragmentname">&lt;&lt;OwenScrambler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="OwenScrambler"></span>OwenScrambler {
    OwenScrambler(uint32_t seed) : seed(seed) {}
    &lt;&lt;<span class="fragmentname"><a href="#fragment-OwenScramblerPublicMethods-0">OwenScrambler Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1159" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1159"><i></i></a><div id="fragbit-1159" class="collapse"><div class="fragmentcode">       uint32_t operator()(uint32_t v) const {
           if (<a href="#OwenScrambler::seed" class="code">seed</a> &amp; 1)
               v ^= 1u &lt;&lt; 31;
           for (int b = 1; b &lt; 32; ++b) {
               &lt;&lt;<span class="fragmentname"><a href="#fragment-ApplyOwenscramblingtobinarydigitmonobinmonov-0">Apply Owen scrambling to binary digit <tt>b</tt> in <tt>v</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1160" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1160"><i></i></a><div id="fragbit-1160" class="collapse"><div class="fragmentcode">                  uint32_t mask = (~0u) &lt;&lt; (32 - b);
                  if ((uint32_t)<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>((v &amp; mask) ^ <a href="#OwenScrambler::seed" class="code">seed</a>) &amp; (1u &lt;&lt; b))
                      v ^= 1u &lt;&lt; (31 - b);</div></div> 
           }
           return v;
       }</div></div>
    uint32_t <span class="anchor" id="OwenScrambler::seed"></span>seed;
};</div><p>


</p>
<p>The first bit (corresponding to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1501.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1 slash 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1001" y="0"></use>
</g>
</svg> in the final sample value) is handled
specially, since there are no bits that precede it to affect its
randomization.  It is randomly flipped according to the seed value provided
to the constructor.

</p>
<p></p>
<span class="anchor" id="fragment-OwenScramblerPublicMethods-0"></span><div class="fragmentname">&lt;&lt;OwenScrambler Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint32_t <span class="anchor" id="OwenScrambler::operator"></span>operator()(uint32_t v) const {
    if (<a href="#OwenScrambler::seed" class="code">seed</a> &amp; 1)
        v ^= 1u &lt;&lt; 31;
    for (int b = 1; b &lt; 32; ++b) {
        &lt;&lt;<span class="fragmentname"><a href="#fragment-ApplyOwenscramblingtobinarydigitmonobinmonov-0">Apply Owen scrambling to binary digit <tt>b</tt> in <tt>v</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1161" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1161"><i></i></a><div id="fragbit-1161" class="collapse"><div class="fragmentcode">           uint32_t mask = (~0u) &lt;&lt; (32 - b);
           if ((uint32_t)<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>((v &amp; mask) ^ <a href="#OwenScrambler::seed" class="code">seed</a>) &amp; (1u &lt;&lt; b))
               v ^= 1u &lt;&lt; (31 - b);</div></div> 
    }
    return v;
}</div><p>


</p>
<p>For all the following bits, a bit mask is computed such that the bitwise
<span style="font-variant: small-caps;">and</span> of the mask with the value gives the bits above <tt>b</tt>&mdash;the values of
which should determine the permutation that is used for the current bit.
Those are run through <tt>MixBits()</tt> to get a hashed value that is then
used to determine whether or not to flip the current bit.

</p>
<p></p>
<span class="anchor" id="fragment-ApplyOwenscramblingtobinarydigitmonobinmonov-0"></span><div class="fragmentname">&lt;&lt;Apply Owen scrambling to binary digit <tt>b</tt> in <tt>v</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint32_t mask = (~0u) &lt;&lt; (32 - b);
if ((uint32_t)<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>((v &amp; mask) ^ <a href="#OwenScrambler::seed" class="code">seed</a>) &amp; (1u &lt;&lt; b))
    v ^= 1u &lt;&lt; (31 - b);</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#SobolrsquoSampleGeneration"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="SobolrsquoSampleGeneration"></span><h3>8.7.3  Sobol&rsquo; Sample Generation</h3><p>


</p>
<p>We now have the pieces needed to implement functions that generate Sobol&rsquo;
samples.  The <tt>SobolSample()</tt> function performs this task for a given
sample index <tt>a</tt> and dimension, applying the provided randomizer to
the sample before returning it.

</p>
<p>Because this function is templated on the type of the
randomizer, a specialized instance of it will be compiled using the
provided randomizer, leading to the randomization algorithm being expanded
inline in the function.  For <tt>pbrt</tt>&rsquo;s purposes, there is no need for a more
general mechanism for sample randomization, so the small performance
benefit is worth taking in this implementation approach.

</p>
<p></p>
<span class="anchor" id="fragment-LowDiscrepancyInlineFunctions-5"></span><div class="fragmentname">&lt;&lt;Low Discrepancy Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-LowDiscrepancyInlineFunctions-4"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">template &lt;typename R&gt;
Float <span class="anchor" id="SobolSample"></span>SobolSample(int64_t a, int dimension, R randomizer) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputeinitialSobolsamplemonovusinggeneratormatrices-0">Compute initial Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample <tt>v</tt> using generator matrices</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1162" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1162"><i></i></a><div id="fragbit-1162" class="collapse"><div class="fragmentcode">       uint32_t v = 0;
       for (int i = dimension * <a href="#SobolMatrixSize" class="code">SobolMatrixSize</a>; a != 0; a &gt;&gt;= 1, i++)
           if (a &amp; 1)
               v ^= <a href="#SobolMatrices32" class="code">SobolMatrices32</a>[i];</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RandomizeSobolsampleandreturnfloating-pointvalue-0">Randomize Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample and return floating-point value</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1163" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1163"><i></i></a><div id="fragbit-1163" class="collapse"><div class="fragmentcode">       v = randomizer(v);
       return std::min(v * 0x1p-32f, <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#FloatOneMinusEpsilon" class="code">FloatOneMinusEpsilon</a>);</div></div>
}</div><p>


</p>
<p>Samples are computed using the Sobol&rsquo; generator matrices, following the
approach described by Equation&nbsp;(<a href="#eq:generator-add-cols">8.23</a>).  All the
generator matrices are stored consecutively in the <tt>SobolMatrices32</tt>
array.  Each one has <tt>SobolMatrixSize</tt> columns, so scaling the
dimension by <tt>SobolMatrixSize</tt> brings us to
the first column of the matrix for the given dimension.

</p>
<p></p>
<span class="anchor" id="fragment-ComputeinitialSobolsamplemonovusinggeneratormatrices-0"></span><div class="fragmentname">&lt;&lt;Compute initial Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample <tt>v</tt> using generator matrices&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint32_t v = 0;
for (int i = dimension * <a href="#SobolMatrixSize" class="code">SobolMatrixSize</a>; a != 0; a &gt;&gt;= 1, i++)
    if (a &amp; 1)
        v ^= <a href="#SobolMatrices32" class="code">SobolMatrices32</a>[i];</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-SobolMatrixDeclarations-0"></span><div class="fragmentname">&lt;&lt;Sobol Matrix Declarations&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">static constexpr int <span class="anchor" id="NSobolDimensions"></span>NSobolDimensions = 1024;
static constexpr int <span class="anchor" id="SobolMatrixSize"></span>SobolMatrixSize = 52;
PBRT_CONST uint32_t <span class="anchor" id="SobolMatrices32"></span>SobolMatrices32[NSobolDimensions * SobolMatrixSize];</div><p>


</p>
<p>The value is then randomized with the given randomizer before being
rescaled to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2114.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1724" y="0"></use>
</g>
</svg>.  (The constant <tt>0x1p-32</tt> is <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.317ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1858.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript negative 32</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(550,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
</svg>, expressed
as a hexadecimal floating-point number.)

</p>
<p></p>
<span class="anchor" id="fragment-RandomizeSobolsampleandreturnfloating-pointvalue-0"></span><div class="fragmentname">&lt;&lt;Randomize Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample and return floating-point value&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">v = randomizer(v);
return std::min(v * 0x1p-32f, <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#FloatOneMinusEpsilon" class="code">FloatOneMinusEpsilon</a>);</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#GlobalSobolrsquoSampler"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:global-sobol-sampler"></span><span id="GlobalSobolrsquoSampler"></span><h3>8.7.4  Global Sobol&rsquo; Sampler</h3><p>



</p>
<p>
The <tt>SobolSampler</tt> generates samples by direct evaluation of the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg>-dimensional Sobol&rsquo; sequence.  Like the <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#HaltonSampler"><tt>HaltonSampler</tt></a>, it scales
the first two dimensions of the sequence to cover a range of image pixels.
Thus, in a similar fashion, nearby pixels have well-distributed
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg>-dimensional sample points not just individually but also with respect
to nearby pixels.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerDefinition-0"></span><div class="fragmentname">&lt;&lt;SobolSampler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="SobolSampler"></span>SobolSampler {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-SobolSamplerPublicMethods-0">SobolSampler Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1164" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1164"><i></i></a><div id="fragbit-1164" class="collapse"><div class="fragmentcode">       SobolSampler(int <a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> fullResolution,
                    <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <a href="#SobolSampler::randomize" class="code">randomize</a>, int <a href="#SobolSampler::seed" class="code">seed</a> = 0)
           : <a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>(<a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>), <a href="#SobolSampler::seed" class="code">seed</a>(<a href="#SobolSampler::seed" class="code">seed</a>), <a href="#SobolSampler::randomize" class="code">randomize</a>(<a href="#SobolSampler::randomize" class="code">randomize</a>) {
           <a href="#SobolSampler::scale" class="code">scale</a> = <a href="../Utilities/Mathematical_Infrastructure.html#RoundUpPow2" class="code">RoundUpPow2</a>(std::max(fullResolution.x, fullResolution.y));
       }
       PBRT_CPU_GPU
       static constexpr const char *Name() { return "SobolSampler"; }
       static SobolSampler *Create(const ParameterDictionary &amp;parameters,
                                   <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> fullResolution, const FileLoc *loc,
                                   Allocator alloc);
       
       PBRT_CPU_GPU
       int SamplesPerPixel() const { return <a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>; }
       void StartPixelSample(<a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> p, int sampleIndex, int dim) {
           <a href="#SobolSampler::pixel" class="code">pixel</a> = p;
           <a href="#SobolSampler::dimension" class="code">dimension</a> = std::max(2, dim);
           <a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a> = <a href="#SobolIntervalToIndex" class="code">SobolIntervalToIndex</a>(Log2Int(<a href="#SobolSampler::scale" class="code">scale</a>), sampleIndex, <a href="#SobolSampler::pixel" class="code">pixel</a>);
       }
       Float Get1D() {
           if (<a href="#SobolSampler::dimension" class="code">dimension</a> &gt;= <a href="#NSobolDimensions" class="code">NSobolDimensions</a>)
               <a href="#SobolSampler::dimension" class="code">dimension</a> = 2;
           return <a href="#SobolSampler::SampleDimension" class="code">SampleDimension</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>++);
       }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> Get2D() {
           if (<a href="#SobolSampler::dimension" class="code">dimension</a> + 1 &gt;= <a href="#NSobolDimensions" class="code">NSobolDimensions</a>)
               <a href="#SobolSampler::dimension" class="code">dimension</a> = 2;
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u(<a href="#SobolSampler::SampleDimension" class="code">SampleDimension</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>), <a href="#SobolSampler::SampleDimension" class="code">SampleDimension</a>(<a href="#SobolSampler::dimension" class="code">dimension</a> + 1));
           <a href="#SobolSampler::dimension" class="code">dimension</a> += 2;
           return u;
       }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> GetPixel2D() {
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u(<a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, 0, <a href="#NoRandomizer" class="code">NoRandomizer</a>()),
                     <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, 1, <a href="#NoRandomizer" class="code">NoRandomizer</a>()));
           &lt;&lt;<span class="fragmentname"><a href="#fragment-RemapSoboldimensionsusedforpixelsamples-0">Remap Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> dimensions used for pixel samples</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1165" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1165"><i></i></a><div id="fragbit-1165" class="collapse"><div class="fragmentcode">              for (int dim = 0; dim &lt; 2; ++dim)
                  u[dim] = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u[dim] * <a href="#SobolSampler::scale" class="code">scale</a> - <a href="#SobolSampler::pixel" class="code">pixel</a>[dim], 0, <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#OneMinusEpsilon" class="code">OneMinusEpsilon</a>);
              </div></div>
           return u;
       }
       <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler" class="code">Sampler</a> Clone(Allocator alloc);
       std::string ToString() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-SobolSamplerPrivateMethods-0">SobolSampler Private Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1166" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1166"><i></i></a><div id="fragbit-1166" class="collapse"><div class="fragmentcode">       Float SampleDimension(int dimension) const {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnun-randomizedSobolsampleifappropriate-0">Return un-randomized Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample if appropriate</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1167" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1167"><i></i></a><div id="fragbit-1167" class="collapse"><div class="fragmentcode">              if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::None" class="code">RandomizeStrategy</a>::None)
                  return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, dimension, <a href="#NoRandomizer" class="code">NoRandomizer</a>());</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnrandomizedSobolsampleusingmonorandomize-0">Return randomized Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample using <tt>randomize</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1168" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1168"><i></i></a><div id="fragbit-1168" class="collapse"><div class="fragmentcode">              uint32_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>, <a href="#SobolSampler::seed" class="code">seed</a>);
              if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::PermuteDigits)
                  return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, BinaryPermuteScrambler(hash));
              else if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::FastOwen)
                  return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, FastOwenScrambler(hash));
              else
                  return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, OwenScrambler(hash));</div></div>
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-SobolSamplerPrivateMembers-0">SobolSampler Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1169" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1169"><i></i></a><div id="fragbit-1169" class="collapse"><div class="fragmentcode">       int samplesPerPixel, scale, seed;
       <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> randomize;
       <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> pixel;
       int dimension;
       int64_t sobolIndex;</div></div>
};</div><p>


</p>
<p>
The <tt>SobolSampler</tt> uniformly scales the first two dimensions by the
smallest power of&nbsp;2 that causes the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.965ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2568.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg> sample domain to cover the
image area to be sampled.  As with the <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#HaltonSampler"><tt>HaltonSampler</tt></a>, this
specific scaling scheme is chosen in order to make it easier to compute the
reverse mapping from pixel coordinates to the sample indices that land
in each pixel.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPublicMethods-0"></span><div class="fragmentname">&lt;&lt;SobolSampler Public Methods&gt;&gt;=&nbsp;<a href="#fragment-SobolSamplerPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">SobolSampler(int <a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> fullResolution,
             <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <a href="#SobolSampler::randomize" class="code">randomize</a>, int <a href="#SobolSampler::seed" class="code">seed</a> = 0)
    : <a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>(<a href="#SobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>), <a href="#SobolSampler::seed" class="code">seed</a>(<a href="#SobolSampler::seed" class="code">seed</a>), <a href="#SobolSampler::randomize" class="code">randomize</a>(<a href="#SobolSampler::randomize" class="code">randomize</a>) {
    <a href="#SobolSampler::scale" class="code">scale</a> = <a href="../Utilities/Mathematical_Infrastructure.html#RoundUpPow2" class="code">RoundUpPow2</a>(std::max(fullResolution.x, fullResolution.y));
}</div><p>


</p>
<p>All four of the randomization approaches from
Section&nbsp;<a href="#sec:sobol-scrambling">8.7.2</a> are supported by the
<tt>SobolSampler</tt>; <tt>randomize</tt> encodes which one to apply.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;SobolSampler Private Members&gt;&gt;=&nbsp;<a href="#fragment-SobolSamplerPrivateMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">int <span class="anchor" id="SobolSampler::samplesPerPixel"></span>samplesPerPixel, <span class="anchor" id="SobolSampler::scale"></span>scale, <span class="anchor" id="SobolSampler::seed"></span>seed;
<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <span class="anchor" id="SobolSampler::randomize"></span>randomize;</div><p>


</p>
<p>

</p>
<p>The sampler needs to record the current pixel for use in its
<tt>GetPixel2D()</tt> method and, like other samplers, tracks the current
dimension in its <tt>dimension</tt> member variable.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPublicMethods-1"></span><div class="fragmentname">&lt;&lt;SobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SobolSamplerPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SobolSamplerPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="SobolSampler::StartPixelSample"></span>StartPixelSample(<a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> p, int sampleIndex, int dim) {
    <a href="#SobolSampler::pixel" class="code">pixel</a> = p;
    <a href="#SobolSampler::dimension" class="code">dimension</a> = std::max(2, dim);
    <a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a> = <a href="#SobolIntervalToIndex" class="code">SobolIntervalToIndex</a>(Log2Int(<a href="#SobolSampler::scale" class="code">scale</a>), sampleIndex, <a href="#SobolSampler::pixel" class="code">pixel</a>);
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPrivateMembers-1"></span><div class="fragmentname">&lt;&lt;SobolSampler Private Members&gt;&gt;+=&nbsp;<a href="#fragment-SobolSamplerPrivateMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> <span class="anchor" id="SobolSampler::pixel"></span>pixel;
int <span class="anchor" id="SobolSampler::dimension"></span>dimension;
int64_t <span class="anchor" id="SobolSampler::sobolIndex"></span>sobolIndex;</div><p>


</p>
<p>The <tt>SobolIntervalToIndex()</tt> function returns the index of the
<tt>sampleIndex</tt>th sample in the pixel <tt>p</tt>, if the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.965ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2568.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg>
sampling domain has been scaled by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.162ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 3944.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 Superscript monospace l monospace o monospace g Baseline monospace 2 monospace upper S monospace c monospace a monospace l monospace e</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D695" d="M467 30c0 -30 -25 -30 -40 -30h-329c-14 0 -40 0 -40 30c0 31 25 31 41 31h129v489h-130c-14 0 -40 0 -40 30c0 31 25 31 41 31h158c34 0 40 -10 40 -41v-509h130c16 0 40 0 40 -31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D698" d="M467 216c0 -126 -95 -222 -205 -222s-205 95 -205 222c0 125 93 224 205 224s205 -99 205 -224zM398 223c0 91 -64 156 -136 156c-71 0 -136 -65 -136 -156c0 -93 62 -168 136 -168s136 75 136 168Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D690" d="M509 388c0 -29 -23 -41 -40 -41c-10 0 -33 7 -39 34c-13 -1 -37 -5 -58 -17c17 -28 26 -57 26 -87c0 -89 -73 -161 -165 -161c-49 0 -87 23 -90 25c-4 -10 -6 -24 -6 -28c0 0 1 -22 12 -36c12 -14 18 -14 33 -14c8 -2 21 -2 29 -2h70c90 0 132 -22 145 -29 c51 -27 69 -77 69 -114c0 -85 -105 -147 -233 -147s-233 61 -233 147c0 11 0 79 74 124c-9 12 -23 37 -23 72c0 30 9 52 20 68c-15 19 -32 52 -32 95c0 85 71 160 165 160c46 0 81 -19 97 -30c46 34 95 35 106 35c54 0 73 -31 73 -54zM329 277c0 53 -42 100 -96 100 c-52 0 -96 -44 -96 -101c0 -53 42 -100 96 -100c52 0 96 44 96 101zM437 -82c0 86 -113 86 -202 86c-73 0 -82 0 -107 -16c-32 -20 -41 -52 -41 -70c0 -44 75 -87 175 -87s175 43 175 87Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D7F8" d="M472 41c0 -32 -7 -41 -40 -41h-339c-16 0 -41 0 -41 31c0 14 6 19 15 27l221 186c66 55 115 113 115 183c0 88 -77 134 -159 134c-55 0 -102 -31 -117 -77c9 -7 14 -20 14 -32c0 -28 -23 -45 -44 -45c-17 0 -45 11 -45 48c0 85 79 167 197 167c122 0 223 -75 223 -195 c0 -80 -46 -144 -109 -200c-43 -40 -139 -115 -198 -166h238c0 28 0 47 35 47c34 0 34 -22 34 -41v-26Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D682" d="M472 166c0 -89 -72 -177 -188 -177c-64 0 -125 16 -165 46c-9 -32 -15 -46 -37 -46c-30 0 -30 25 -30 41v132c0 20 0 41 35 41c32 0 33 -18 34 -35c1 -18 5 -60 47 -87c40 -27 89 -31 117 -31c79 0 122 59 122 111c0 87 -83 107 -111 113l-115 27 c-83 24 -129 90 -129 157c0 85 75 164 186 164c45 0 99 -12 140 -47c8 30 13 47 37 47c30 0 30 -25 30 -41v-132c0 -20 0 -41 -35 -41c-20 0 -31 6 -34 28c-6 31 -21 125 -139 125c-71 0 -120 -48 -120 -99c0 -47 38 -82 80 -94l81 -18c78 -18 105 -25 146 -65 c12 -13 48 -55 48 -119Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D68C" d="M466 109c0 -17 -34 -115 -173 -115c-126 0 -220 102 -220 222c0 88 60 224 232 224c45 0 149 0 149 -73c0 -29 -21 -46 -45 -46s-43 14 -44 49c0 9 -39 9 -60 9c-135 0 -163 -115 -163 -163c0 -91 72 -161 157 -161c74 0 93 47 99 60c7 20 17 22 33 22c6 0 35 0 35 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D68A" d="M519 31c0 -31 -22 -31 -50 -31c-38 0 -86 1 -108 32c-47 -31 -109 -38 -146 -38c-102 0 -165 65 -165 134c0 96 123 146 300 149c0 71 -52 102 -128 102c-9 0 -22 0 -36 -1c-20 -2 -21 -3 -21 -11c-1 -37 -29 -46 -44 -46c-24 0 -45 16 -45 46c0 73 102 73 145 73 c144 0 198 -84 198 -155v-216c8 -3 18 -8 60 -8c15 0 40 0 40 -30zM350 134v84c-145 -4 -231 -41 -231 -90c0 -39 41 -73 103 -73c8 0 53 0 89 17c39 18 39 39 39 62Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D68E" d="M464 109c0 -25 -47 -115 -179 -115c-129 0 -230 101 -230 223c0 123 96 223 215 223c130 0 194 -98 194 -212c0 -37 -19 -37 -40 -37h-298c16 -86 91 -136 166 -136c28 0 82 9 104 60c7 19 15 22 33 22c6 0 35 0 35 -28zM393 251c-9 103 -71 128 -123 128 c-70 0 -129 -55 -143 -128h266Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,393)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D695" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D698" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D690" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D7F8" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D682" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D68C" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D68A" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D695" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMONOSPACE-1D68E" x="4204" y="0"></use>
</g>
</g>
</svg> to cover the pixel
sampling area.

</p>
<p></p>
<span class="anchor" id="fragment-LowDiscrepancyDeclarations-0"></span><div class="fragmentname">&lt;&lt;Low Discrepancy Declarations&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint64_t <span class="anchor" id="SobolIntervalToIndex"></span>SobolIntervalToIndex(uint32_t log2Scale, uint64_t sampleIndex,
                              <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> p);</div><p>


</p>
<p>

</p>
<p>The general approach used to derive the algorithm it implements is similar
to that used by the Halton sampler in its <tt>StartPixelSample()</tt>
method.  Here, scaling by a power of two means that the base-2 logarithm of
the scale gives the number of digits of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.662ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 4160 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C left-bracket d Subscript i Baseline left-parenthesis a right-parenthesis right-bracket Superscript upper T</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="831" y="0"></use>
<g transform="translate(1110,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1974" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="2364" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2893" y="0"></use>
<g transform="translate(3283,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="513"></use>
</g>
</g>
</svg> product
that form the scaled sample&rsquo;s integer component.  To find the values of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="0" y="0"></use>
</g>
</svg>
that give a particular integer value after scaling, we can compute the
inverse of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.931ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 831.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
</g>
</svg>: given
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.535ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 6258 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v equals bold upper C left-bracket d Subscript i Baseline left-parenthesis a right-parenthesis right-bracket Superscript upper T Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="1819" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="2651" y="0"></use>
<g transform="translate(2929,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3794" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="4183" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4713" y="0"></use>
<g transform="translate(5102,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="5979" y="0"></use>
</g>
</svg>
</div>
<p>

then equivalently
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.868ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 7262.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">bold upper C Superscript negative 1 Baseline v equals left-bracket d Subscript i Baseline left-parenthesis a right-parenthesis right-bracket Superscript upper T Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D402" d="M766 227c0 -115 -113 -238 -300 -238c-249 0 -402 149 -402 354s153 354 402 354c68 0 135 -18 197 -68l66 59c8 7 10 9 19 9c18 0 18 -9 18 -28v-215c0 -26 -1 -28 -27 -28c-23 0 -24 2 -27 21c-22 127 -117 203 -225 203c-52 0 -139 -11 -204 -77 c-63 -66 -66 -174 -66 -230c0 -90 12 -165 59 -222c52 -61 136 -85 214 -85c101 0 222 61 229 195c1 17 10 17 23 17c17 0 24 -1 24 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D447" d="M704 666c0 -3 -1 -13 -2 -17l-27 -174c-2 -15 -4 -23 -15 -23c-9 0 -12 7 -12 13c0 3 2 15 3 19c4 26 8 65 8 80c0 78 -45 82 -146 82c-21 0 -54 0 -63 -2c-12 -3 -16 -9 -23 -37l-133 -531c-4 -15 -4 -21 -4 -21c0 -16 8 -19 37 -22c26 -2 39 -2 64 -2c26 0 34 0 34 -11 c0 -20 -12 -20 -22 -20c-28 0 -58 2 -87 2l-83 1l-85 -1c-27 0 -55 -2 -82 -2c-6 0 -17 0 -17 12c0 19 6 19 42 19c107 0 110 11 119 48l134 534c1 3 4 15 4 21c0 8 0 12 -28 12h-39c-148 0 -174 -18 -228 -173c-6 -16 -7 -21 -17 -21c-7 0 -12 5 -12 11c0 0 5 16 6 18 l60 176c7 19 8 20 32 20h555c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D402" x="0" y="0"></use>
<g transform="translate(831,424)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2599" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="3655" y="0"></use>
<g transform="translate(3933,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="736" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4798" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="5188" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5717" y="0"></use>
<g transform="translate(6107,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D447" x="393" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="6983" y="0"></use>
</g>
</svg>
</div>
<p>

We will not include the implementation of this function here.

</p>
<p>Sample generation is now straightforward.  There is the usual management of
the <tt>dimension</tt> value, again with the first two dimensions reserved
for the pixel sample, and then a call to <tt>SampleDimension()</tt> gives the
sample for a single Sobol&rsquo; dimension.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPublicMethods-2"></span><div class="fragmentname">&lt;&lt;SobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SobolSamplerPublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SobolSamplerPublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="SobolSampler::Get1D"></span>Get1D() {
    if (<a href="#SobolSampler::dimension" class="code">dimension</a> &gt;= <a href="#NSobolDimensions" class="code">NSobolDimensions</a>)
        <a href="#SobolSampler::dimension" class="code">dimension</a> = 2;
    return <a href="#SobolSampler::SampleDimension" class="code">SampleDimension</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>++);
}</div><p>


</p>
<p>The <tt>SampleDimension()</tt> method takes care of calling
<a href="#SobolSample"><tt>SobolSample()</tt></a> for the current sample index and specified dimension
using the appropriate randomizer.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPrivateMethods-0"></span><div class="fragmentname">&lt;&lt;SobolSampler Private Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="SobolSampler::SampleDimension"></span>SampleDimension(int dimension) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnun-randomizedSobolsampleifappropriate-0">Return un-randomized Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample if appropriate</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1170" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1170"><i></i></a><div id="fragbit-1170" class="collapse"><div class="fragmentcode">       if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::None" class="code">RandomizeStrategy</a>::None)
           return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, dimension, <a href="#NoRandomizer" class="code">NoRandomizer</a>());</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ReturnrandomizedSobolsampleusingmonorandomize-0">Return randomized Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample using <tt>randomize</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1171" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1171"><i></i></a><div id="fragbit-1171" class="collapse"><div class="fragmentcode">       uint32_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>, <a href="#SobolSampler::seed" class="code">seed</a>);
       if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::PermuteDigits)
           return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, BinaryPermuteScrambler(hash));
       else if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::FastOwen)
           return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, FastOwenScrambler(hash));
       else
           return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, OwenScrambler(hash));</div></div>
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-Returnun-randomizedSobolsampleifappropriate-0"></span><div class="fragmentname">&lt;&lt;Return un-randomized Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample if appropriate&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::None" class="code">RandomizeStrategy</a>::None)
    return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, dimension, <a href="#NoRandomizer" class="code">NoRandomizer</a>());</div><p>


</p>
<p>
If a randomizer is being used, a seed value must be computed for it.  Note
that the hash value passed to each randomizer is based solely on the
current dimension and user-provided seed, if any.  It must <em>not</em> be
based on the current pixel or the current sample index within the pixel,
since the same randomization should be used at all the pixels and all
the samples within them.

</p>
<p></p>
<span class="anchor" id="fragment-ReturnrandomizedSobolsampleusingmonorandomize-0"></span><div class="fragmentname">&lt;&lt;Return randomized Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample using <tt>randomize</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint32_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>, <a href="#SobolSampler::seed" class="code">seed</a>);
if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::PermuteDigits)
    return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, BinaryPermuteScrambler(hash));
else if (<a href="#SobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::FastOwen)
    return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, FastOwenScrambler(hash));
else
    return <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, <a href="#SobolSampler::dimension" class="code">dimension</a>, OwenScrambler(hash));</div><p>


</p>
<p>2D sample generation is easily implemented using <tt>SampleDimension()</tt>.
If all sample dimensions have been consumed, <tt>Get2D()</tt> goes back to
the start and skips the first two dimensions, as was done in the <tt>HaltonSampler</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPublicMethods-3"></span><div class="fragmentname">&lt;&lt;SobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SobolSamplerPublicMethods-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SobolSamplerPublicMethods-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="SobolSampler::Get2D"></span>Get2D() {
    if (<a href="#SobolSampler::dimension" class="code">dimension</a> + 1 &gt;= <a href="#NSobolDimensions" class="code">NSobolDimensions</a>)
        <a href="#SobolSampler::dimension" class="code">dimension</a> = 2;
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u(<a href="#SobolSampler::SampleDimension" class="code">SampleDimension</a>(<a href="#SobolSampler::dimension" class="code">dimension</a>), <a href="#SobolSampler::SampleDimension" class="code">SampleDimension</a>(<a href="#SobolSampler::dimension" class="code">dimension</a> + 1));
    <a href="#SobolSampler::dimension" class="code">dimension</a> += 2;
    return u;
}</div><p>


</p>
<p>Pixel samples are generated using the first two dimensions of the Sobol&rsquo;
sample.  <a href="#SobolIntervalToIndex"><tt>SobolIntervalToIndex()</tt></a> does not account for randomization,
so the <a href="#NoRandomizer"><tt>NoRandomizer</tt></a> is always used for the pixel sample, regardless
of the value of <tt>randomize</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-SobolSamplerPublicMethods-4"></span><div class="fragmentname">&lt;&lt;SobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-SobolSamplerPublicMethods-3"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="SobolSampler::GetPixel2D"></span>GetPixel2D() {
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u(<a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, 0, <a href="#NoRandomizer" class="code">NoRandomizer</a>()),
              <a href="#SobolSample" class="code">SobolSample</a>(<a href="#SobolSampler::sobolIndex" class="code">sobolIndex</a>, 1, <a href="#NoRandomizer" class="code">NoRandomizer</a>()));
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RemapSoboldimensionsusedforpixelsamples-0">Remap Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> dimensions used for pixel samples</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1172" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1172"><i></i></a><div id="fragbit-1172" class="collapse"><div class="fragmentcode">       for (int dim = 0; dim &lt; 2; ++dim)
           u[dim] = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u[dim] * <a href="#SobolSampler::scale" class="code">scale</a> - <a href="#SobolSampler::pixel" class="code">pixel</a>[dim], 0, <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#OneMinusEpsilon" class="code">OneMinusEpsilon</a>);
       </div></div>
    return u;
}</div><p>


</p>
<p>The samples returned for the pixel position need to be adjusted so that
they are offsets within the current pixel.  Similar to what was done in the
<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#HaltonSampler"><tt>HaltonSampler</tt></a>, the sample value is scaled so that the pixel
coordinates are in the integer component of the result.  The remaining
fractional component gives the offset within the pixel that the sampler
returns.

</p>
<p></p>
<span class="anchor" id="fragment-RemapSoboldimensionsusedforpixelsamples-0"></span><div class="fragmentname">&lt;&lt;Remap Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> dimensions used for pixel samples&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">for (int dim = 0; dim &lt; 2; ++dim)
    u[dim] = <a href="../Utilities/Mathematical_Infrastructure.html#Clamp" class="code">Clamp</a>(u[dim] * <a href="#SobolSampler::scale" class="code">scale</a> - <a href="#SobolSampler::pixel" class="code">pixel</a>[dim], 0, <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#OneMinusEpsilon" class="code">OneMinusEpsilon</a>);
</div><p>


</p>
<p>

</p>
<p>


</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#PaddedSobolrsquoSampler"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="PaddedSobolrsquoSampler"></span><h3>8.7.5  Padded Sobol&rsquo; Sampler</h3><p>


</p>
<p>The <a href="#SobolSampler"><tt>SobolSampler</tt></a> generates sample points that have low discrepancy
over all of their <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg> dimensions.  However, the distribution of samples in
two-dimensional slices of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg>- dimensional space is not necessarily
particularly good.  Figure&nbsp;<a href="#fig:sobol-first-256-bleh">8.36</a> shows an example.

</p>
<p> </p>
<span class="anchor" id="fig:sobol-first-256-bleh"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f36.svg" title=""><img src="pha08f36.svg" width=397 height=397 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.36: <span class="legend">
Plot of the first 256 points from dimensions&nbsp;4 and&nbsp;5 of
the Sobol&rsquo; sequence.  The 2D projection of these two dimensions is not
well distributed and is not stratified over elementary intervals.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>For rendering, this state of affairs means that, for example, the samples
taken over the surface of a light source at a given pixel may not be well
distributed.  It is of only slight solace to know that the full set of
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.209ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 520.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">d</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D451" d="M516 683l-144 -578c-4 -17 -6 -24 -6 -48c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293 c45 0 74 -27 92 -64l60 237l3 20c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 13 6 18 14 19c17 2 112 11 127 11c13 0 13 -11 13 -11zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37 l50 196c1 5 3 11 3 17Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D451" x="0" y="0"></use>
</g>
</svg>-dimensional samples are well distributed in return.
Figure&nbsp;<a href="#fig:sobol-checkerboard-artifacts">8.37</a> shows this problem in
practice with the <a href="#SobolSampler"><tt>SobolSampler</tt></a>: 2D projections of the form shown in
Figure&nbsp;<a href="#fig:sobol-first-256-bleh">8.36</a> end up generating a characteristic
checkerboard pattern in the image at low sampling rates.

</p>
<p></p>
<span class="anchor" id="fig:sobol-checkerboard-artifacts"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="killeroo-sobol-checkerboard.png" style="max-width: 100%; height: auto;" width=400 height=600>
</div>
<p>

</p>
<figcaption class="caption">Figure 8.37: Scene Rendered Using the <a href="#SobolSampler"><tt>SobolSampler</tt></a> at a Low Sampling
Rate. <span class="legend">
With that sampler, these sorts of checkerboard patterns can result due to
structure in the lower-dimensional projections of the form shown in
Figure&nbsp;<a href="#fig:sobol-first-256-bleh">8.36</a>.
<em>(Killeroo model courtesy of headus/Rezard.)</em>
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Therefore, the <tt>PaddedSobolSampler</tt> generates samples from the
Sobol&rsquo; sequence in a way that focuses on returning good distributions for
the dimensions used by each 1D and 2D sample independently.  It does so via
padding samples, similarly to the <a href="../Sampling_and_Reconstruction/Stratified_Sampler.html#StratifiedSampler"><tt>StratifiedSampler</tt></a>, but here using
Sobol&rsquo; samples rather than jittered samples.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerDefinition-0"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="PaddedSobolSampler"></span>PaddedSobolSampler {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-PaddedSobolSamplerPublicMethods-0">PaddedSobolSampler Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1173" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1173"><i></i></a><div id="fragbit-1173" class="collapse"><div class="fragmentcode">       PBRT_CPU_GPU
       static constexpr const char *Name() { return "PaddedSobolSampler"; }
       static PaddedSobolSampler *Create(const ParameterDictionary &amp;parameters,
                                         const FileLoc *loc, Allocator alloc);
       PaddedSobolSampler(int samplesPerPixel, RandomizeStrategy randomizer, int seed = 0)
           : samplesPerPixel(samplesPerPixel), randomize(randomizer), seed(seed) {
           if (!IsPowerOf2(samplesPerPixel))
               Warning("Sobol samplers with non power-of-two sample counts (%d) are suboptimal.",
                       samplesPerPixel);
       }
       PBRT_CPU_GPU
       int SamplesPerPixel() const { return samplesPerPixel; }
       void StartPixelSample(<a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> p, int index, int dim) {
           pixel = p;
           sampleIndex = index;
           <a href="#PaddedSobolSampler::dimension" class="code">dimension</a> = dim;
       }
       Float Get1D() {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Getpermutedindexforcurrentpixelsample-0">Get permuted index for current pixel sample</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1174" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1174"><i></i></a><div id="fragbit-1174" class="collapse"><div class="fragmentcode">              uint64_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#PaddedSobolSampler::pixel" class="code">pixel</a>, <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>, <a href="#PaddedSobolSampler::seed" class="code">seed</a>);
              int index = <a href="../Utilities/Mathematical_Infrastructure.html#PermutationElement" class="code">PermutationElement</a>(<a href="#PaddedSobolSampler::sampleIndex" class="code">sampleIndex</a>, <a href="#PaddedSobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, hash);</div></div>
           int dim = <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>++;
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnrandomized1DvanderCorputsamplefordimensionmonodim-0">Return randomized 1D van der Corput sample for dimension <tt>dim</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1175" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1175"><i></i></a><div id="fragbit-1175" class="collapse"><div class="fragmentcode">              return <a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(0, index, hash &gt;&gt; 32);</div></div>
       }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <a href="#PaddedSobolSampler::Get2D" class="code">Get2D</a>() {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Getpermutedindexforcurrentpixelsample-0">Get permuted index for current pixel sample</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1176" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1176"><i></i></a><div id="fragbit-1176" class="collapse"><div class="fragmentcode">              uint64_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#PaddedSobolSampler::pixel" class="code">pixel</a>, <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>, <a href="#PaddedSobolSampler::seed" class="code">seed</a>);
              int index = <a href="../Utilities/Mathematical_Infrastructure.html#PermutationElement" class="code">PermutationElement</a>(<a href="#PaddedSobolSampler::sampleIndex" class="code">sampleIndex</a>, <a href="#PaddedSobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, hash);</div></div>
           int dim = <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>;
           <a href="#PaddedSobolSampler::dimension" class="code">dimension</a> += 2;
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnrandomized2DSobolsample-0">Return randomized 2D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1177" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1177"><i></i></a><div id="fragbit-1177" class="collapse"><div class="fragmentcode">              return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(0, index, uint32_t(hash)),
                             <a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(1, index, hash &gt;&gt; 32));</div></div>
       }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> GetPixel2D() { return <a href="#PaddedSobolSampler::Get2D" class="code">Get2D</a>(); }
       PBRT_CPU_GPU
       RandomizeStrategy GetRandomizeStrategy() const { return randomize; }
       
       <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler" class="code">Sampler</a> Clone(Allocator alloc);
       std::string ToString() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-PaddedSobolSamplerPrivateMethods-0">PaddedSobolSampler Private Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1178" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1178"><i></i></a><div id="fragbit-1178" class="collapse"><div class="fragmentcode">       Float SampleDimension(int dimension, uint32_t a, uint32_t hash) const {
           if (<a href="#PaddedSobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::None)
               return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, NoRandomizer());
           else if (<a href="#PaddedSobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::PermuteDigits)
               return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, BinaryPermuteScrambler(hash));
           else if (<a href="#PaddedSobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::FastOwen)
               return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, FastOwenScrambler(hash));
           else
               return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, OwenScrambler(hash));
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-PaddedSobolSamplerPrivateMembers-0">PaddedSobolSampler Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1179" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1179"><i></i></a><div id="fragbit-1179" class="collapse"><div class="fragmentcode">       int samplesPerPixel, seed;
       <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> randomize;
       <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> pixel;
       int sampleIndex, dimension;</div></div>
};</div><p>


</p>
<p>

</p>
<p>The constructor, not included here, initializes the following member
variables from provided values.  As with the <a href="#SobolSampler"><tt>SobolSampler</tt></a>, using a
pixel sample count that is not a power of&nbsp;2 will give suboptimal results; a
warning is issued in this case.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Private Members&gt;&gt;=&nbsp;<a href="#fragment-PaddedSobolSamplerPrivateMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">int <span class="anchor" id="PaddedSobolSampler::samplesPerPixel"></span>samplesPerPixel, <span class="anchor" id="PaddedSobolSampler::seed"></span>seed;
<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <span class="anchor" id="PaddedSobolSampler::randomize"></span>randomize;</div><p>


</p>
<p>

</p>
<p><tt>StartPixelSample()</tt><span class="anchor" id="PaddedSobolSampler::StartPixelSample"></span>,
also not included here, just records the specified pixel, sample index, and
dimension.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerPrivateMembers-1"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Private Members&gt;&gt;+=&nbsp;<a href="#fragment-PaddedSobolSamplerPrivateMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> <span class="anchor" id="PaddedSobolSampler::pixel"></span>pixel;
int <span class="anchor" id="PaddedSobolSampler::sampleIndex"></span>sampleIndex, <span class="anchor" id="PaddedSobolSampler::dimension"></span>dimension;</div><p>


</p>
<p>1D samples are generated by randomly shuffling a randomized van der Corput
sequence.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerPublicMethods-0"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Public Methods&gt;&gt;=&nbsp;<a href="#fragment-PaddedSobolSamplerPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="PaddedSobolSampler::Get1D"></span>Get1D() {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Getpermutedindexforcurrentpixelsample-0">Get permuted index for current pixel sample</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1180" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1180"><i></i></a><div id="fragbit-1180" class="collapse"><div class="fragmentcode">       uint64_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#PaddedSobolSampler::pixel" class="code">pixel</a>, <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>, <a href="#PaddedSobolSampler::seed" class="code">seed</a>);
       int index = <a href="../Utilities/Mathematical_Infrastructure.html#PermutationElement" class="code">PermutationElement</a>(<a href="#PaddedSobolSampler::sampleIndex" class="code">sampleIndex</a>, <a href="#PaddedSobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, hash);</div></div>
    int dim = <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>++;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnrandomized1DvanderCorputsamplefordimensionmonodim-0">Return randomized 1D van der Corput sample for dimension <tt>dim</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1181" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1181"><i></i></a><div id="fragbit-1181" class="collapse"><div class="fragmentcode">       return <a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(0, index, hash &gt;&gt; 32);</div></div>
}</div><p>


</p>
<p>Here, the
permutation used for padding is based on the current pixel and dimension.
It must not be
based on the sample index, as the same permutation should be applied to all
sample indices of a given dimension in a given pixel.

</p>
<p></p>
<span class="anchor" id="fragment-Getpermutedindexforcurrentpixelsample-0"></span><div class="fragmentname">&lt;&lt;Get permuted index for current pixel sample&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint64_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#PaddedSobolSampler::pixel" class="code">pixel</a>, <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>, <a href="#PaddedSobolSampler::seed" class="code">seed</a>);
int index = <a href="../Utilities/Mathematical_Infrastructure.html#PermutationElement" class="code">PermutationElement</a>(<a href="#PaddedSobolSampler::sampleIndex" class="code">sampleIndex</a>, <a href="#PaddedSobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, hash);</div><p>


</p>
<p>

</p>
<p>Given the permuted sample index value <tt>index</tt>, a separate method,
<tt>SampleDimension()</tt>, takes care of generating the corresponding
Sobol&rsquo; sample.  The high bits of the hash value are
reused for the sample&rsquo;s randomization; doing so should be safe, since
<a href="../Utilities/Mathematical_Infrastructure.html#PermutationElement"><tt>PermutationElement()</tt></a> uses the hash it is passed in an entirely
different way than any of the sample randomization schemes&nbsp;do.

</p>
<p></p>
<span class="anchor" id="fragment-Returnrandomized1DvanderCorputsamplefordimensionmonodim-0"></span><div class="fragmentname">&lt;&lt;Return randomized 1D van der Corput sample for dimension <tt>dim</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">return <a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(0, index, hash &gt;&gt; 32);</div><p>


</p>
<p><tt>SampleDimension()</tt> follows the same approach as the corresponding
method in <a href="#SobolSampler"><tt>SobolSampler</tt></a>, creating the appropriate randomizer before
calling <tt>SobolSample()</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerPrivateMethods-0"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Private Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="PaddedSobolSampler::SampleDimension"></span>SampleDimension(int dimension, uint32_t a, uint32_t hash) const {
    if (<a href="#PaddedSobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::None)
        return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, NoRandomizer());
    else if (<a href="#PaddedSobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::PermuteDigits)
        return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, BinaryPermuteScrambler(hash));
    else if (<a href="#PaddedSobolSampler::randomize" class="code">randomize</a> == <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy::FastOwen" class="code">RandomizeStrategy</a>::FastOwen)
        return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, FastOwenScrambler(hash));
    else
        return <a href="#SobolSample" class="code">SobolSample</a>(a, dimension, OwenScrambler(hash));
}</div><p>


</p>
<p>Padded 2D samples are generated starting with a similar permutation of
sample indices.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerPublicMethods-1"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-PaddedSobolSamplerPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-PaddedSobolSamplerPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="PaddedSobolSampler::Get2D"></span>Get2D() {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Getpermutedindexforcurrentpixelsample-0">Get permuted index for current pixel sample</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1182" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1182"><i></i></a><div id="fragbit-1182" class="collapse"><div class="fragmentcode">       uint64_t hash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#PaddedSobolSampler::pixel" class="code">pixel</a>, <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>, <a href="#PaddedSobolSampler::seed" class="code">seed</a>);
       int index = <a href="../Utilities/Mathematical_Infrastructure.html#PermutationElement" class="code">PermutationElement</a>(<a href="#PaddedSobolSampler::sampleIndex" class="code">sampleIndex</a>, <a href="#PaddedSobolSampler::samplesPerPixel" class="code">samplesPerPixel</a>, hash);</div></div>
    int dim = <a href="#PaddedSobolSampler::dimension" class="code">dimension</a>;
    <a href="#PaddedSobolSampler::dimension" class="code">dimension</a> += 2;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Returnrandomized2DSobolsample-0">Return randomized 2D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1183" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1183"><i></i></a><div id="fragbit-1183" class="collapse"><div class="fragmentcode">       return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(0, index, uint32_t(hash)),
                      <a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(1, index, hash &gt;&gt; 32));</div></div>
}</div><p>


</p>
<p>Randomization also parallels the 1D case; again, bits from <tt>hash</tt> are
used both for the random permutation of sample indices and for
sample randomization.

</p>
<p></p>
<span class="anchor" id="fragment-Returnrandomized2DSobolsample-0"></span><div class="fragmentname">&lt;&lt;Return randomized 2D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(0, index, uint32_t(hash)),
               <a href="#PaddedSobolSampler::SampleDimension" class="code">SampleDimension</a>(1, index, hash &gt;&gt; 32));</div><p>


</p>
<p>For this sampler, pixel samples are generated in the same manner as all
other 2D samples, so the sample generation request is forwarded on to
<tt>Get2D()</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-PaddedSobolSamplerPublicMethods-2"></span><div class="fragmentname">&lt;&lt;PaddedSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-PaddedSobolSamplerPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="PaddedSobolSampler::GetPixel2D"></span>GetPixel2D() { return <a href="#PaddedSobolSampler::Get2D" class="code">Get2D</a>(); }</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#BlueNoiseSobolrsquoSampler"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="BlueNoiseSobolrsquoSampler"></span><h3>8.7.6  Blue Noise Sobol&rsquo; Sampler</h3><p>


</p>
<p><tt>ZSobolSampler</tt> is a third sampler based on the Sobol&rsquo; sequence.  It
is also based on padding 1D and 2D Sobol&rsquo; samples, but uses sample indices in a
way that leads to a blue noise distribution of sample values. This tends to
push error to higher frequencies, which in turn makes it appear more visually
pleasing.  Figure&nbsp;<a href="#fig:padded-vs-zsobol-rendered">8.38</a> compares a scene rendered with the
<a href="#PaddedSobolSampler"><tt>PaddedSobolSampler</tt></a> and the <a href="#ZSobolSampler"><tt>ZSobolSampler</tt></a>; both have essentially the
same MSE, but the one rendered using <a href="#ZSobolSampler"><tt>ZSobolSampler</tt></a> looks better to
most human observers.  This <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler"><tt>Sampler</tt></a> is the default one used by <tt>pbrt</tt> if no sampler is specified in the scene description. 

</p>
<p></p>
<span class="anchor" id="fig:padded-vs-zsobol-rendered"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>

<div class="card-img-top" style="display:block; width: 100%; padding-top: 68.444%;  position:relative;">
<div id="xa_PaddedSobolSampler22" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div></div>
<script>
Jeri.renderViewer(document.getElementById('xa_PaddedSobolSampler22'), {
  title: '(a)_PaddedSobolSampler22', children: [
 { title: '(a) PaddedSobolSampler', image: 'samplers-dragon-paddedsobol-1spp.png' },  { title: '(b) ZSobolSampler', image: 'samplers-dragon-zsobol-1spp.png' }]});
</script>
<button data-toggle="tooltip" data-placement="left" class="btn yojeri" title="This image is interactive. Click and drag to pan and use the mouse-wheel to zoom. After clicking on the image to select it, type '?' to see a summary of keyboard controls."><i class="fa fa-snowflake fa-border"></i></button><p>

</p>
<figcaption class="caption">Figure 8.38: The Benefit of Blue Noise with Padded Sobol&rsquo; Points. <span class="legend">
(a)&nbsp;Rendered using the <a href="#PaddedSobolSampler"><tt>PaddedSobolSampler</tt></a>.
(b)&nbsp;Rendered with the <a href="#ZSobolSampler"><tt>ZSobolSampler</tt></a>.
Both images are rendered using&nbsp;1 sample per pixel and have the same overall
error, but the second image
looks much better thanks to a blue noise distribution of error.
<em>(Dragon model courtesy of the Stanford Computer Graphics Laboratory.)</em>
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerDefinition-0"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="ZSobolSampler"></span>ZSobolSampler {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ZSobolSamplerPublicMethods-0">ZSobolSampler Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1184" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1184"><i></i></a><div id="fragbit-1184" class="collapse"><div class="fragmentcode">       ZSobolSampler(int samplesPerPixel, <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> fullResolution,
                     <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <a href="#ZSobolSampler::randomize" class="code">randomize</a>, int <a href="#ZSobolSampler::seed" class="code">seed</a> = 0)
           : <a href="#ZSobolSampler::randomize" class="code">randomize</a>(<a href="#ZSobolSampler::randomize" class="code">randomize</a>), <a href="#ZSobolSampler::seed" class="code">seed</a>(<a href="#ZSobolSampler::seed" class="code">seed</a>) {
           <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> = <a href="../Utilities/Mathematical_Infrastructure.html#Log2Int" class="code">Log2Int</a>(samplesPerPixel);
           int res = <a href="../Utilities/Mathematical_Infrastructure.html#RoundUpPow2" class="code">RoundUpPow2</a>(std::max(fullResolution.x, fullResolution.y));
           int log4SamplesPerPixel = (<a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> + 1) / 2;
           <a href="#ZSobolSampler::nBase4Digits" class="code">nBase4Digits</a> = <a href="../Utilities/Mathematical_Infrastructure.html#Log2Int" class="code">Log2Int</a>(res) + log4SamplesPerPixel;
       }
       PBRT_CPU_GPU
       static constexpr const char *Name() { return "ZSobolSampler"; }
       
       static ZSobolSampler *Create(const ParameterDictionary &amp;parameters,
                                    <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> fullResolution, const FileLoc *loc,
                                    Allocator alloc);
       
       PBRT_CPU_GPU
       int SamplesPerPixel() const { return 1 &lt;&lt; <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a>; }
       void StartPixelSample(<a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> p, int index, int dim) {
           <a href="#ZSobolSampler::dimension" class="code">dimension</a> = dim;
           <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> = (<a href="../Utilities/Mathematical_Infrastructure.html#EncodeMorton2" class="code">EncodeMorton2</a>(p.x, p.y) &lt;&lt; <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a>) | index;
       }
       Float Get1D() {
           uint64_t sampleIndex = <a href="#ZSobolSampler::GetSampleIndex" class="code">GetSampleIndex</a>();
           ++<a href="#ZSobolSampler::dimension" class="code">dimension</a>;
           &lt;&lt;<span class="fragmentname">Generate 1D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample at <tt>sampleIndex</tt></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1185" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1185"><i></i></a><div id="fragbit-1185" class="collapse"><div class="fragmentcode">              uint32_t sampleHash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#ZSobolSampler::dimension" class="code">dimension</a>, <a href="#ZSobolSampler::seed" class="code">seed</a>);
              if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::None)
                  return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, NoRandomizer());
              else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::PermuteDigits)
                  return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, BinaryPermuteScrambler(sampleHash));
              else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::FastOwen)
                  return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, FastOwenScrambler(sampleHash));
              else
                  return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, OwenScrambler(sampleHash));</div></div>
       }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <a href="#ZSobolSampler::Get2D" class="code">Get2D</a>() {
           uint64_t sampleIndex = <a href="#ZSobolSampler::GetSampleIndex" class="code">GetSampleIndex</a>();
           <a href="#ZSobolSampler::dimension" class="code">dimension</a> += 2;
           &lt;&lt;<span class="fragmentname">Generate 2D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample at <tt>sampleIndex</tt></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1186" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1186"><i></i></a><div id="fragbit-1186" class="collapse"><div class="fragmentcode">              uint64_t bits = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#ZSobolSampler::dimension" class="code">dimension</a>, <a href="#ZSobolSampler::seed" class="code">seed</a>);
              uint32_t sampleHash[2] = {uint32_t(bits), uint32_t(bits &gt;&gt; 32)};
              if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::None)
                  return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, NoRandomizer()),
                          <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, NoRandomizer())};
              else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::PermuteDigits)
                  return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, BinaryPermuteScrambler(sampleHash[0])),
                          <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, BinaryPermuteScrambler(sampleHash[1]))};
              else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::FastOwen)
                  return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, FastOwenScrambler(sampleHash[0])),
                          <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, FastOwenScrambler(sampleHash[1]))};
              else
                  return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, OwenScrambler(sampleHash[0])),
                          <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, OwenScrambler(sampleHash[1]))};</div></div>
       }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> GetPixel2D() { return <a href="#ZSobolSampler::Get2D" class="code">Get2D</a>(); }
       <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler" class="code">Sampler</a> Clone(Allocator alloc);
       std::string ToString() const;
       uint64_t <a href="#ZSobolSampler::GetSampleIndex" class="code">GetSampleIndex</a>() const {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Definethefullsetof4-waypermutationsinmonopermutations-0">Define the full set of 4-way permutations in <tt>permutations</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1187" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1187"><i></i></a><div id="fragbit-1187" class="collapse"><div class="fragmentcode">              static const uint8_t permutations[24][4] = {
                  {0, 1, 2, 3}, {0, 1, 3, 2}, {0, 2, 1, 3}, {0, 2, 3, 1},
                  &lt;&lt;<span class="fragmentname">Define remaining 20 4-way permutations</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1188" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1188"><i></i></a><div id="fragbit-1188" class="collapse"><div class="fragmentcode">                     {0, 3, 2, 1},
                             {0, 3, 1, 2}, {1, 0, 2, 3}, {1, 0, 3, 2}, {1, 2, 0, 3}, {1, 2, 3, 0},
                             {1, 3, 2, 0}, {1, 3, 0, 2}, {2, 1, 0, 3}, {2, 1, 3, 0}, {2, 0, 1, 3},
                             {2, 0, 3, 1}, {2, 3, 0, 1}, {2, 3, 1, 0}, {3, 1, 2, 0}, {3, 1, 0, 2},
                             {3, 2, 1, 0}, {3, 2, 0, 1}, {3, 0, 2, 1}, {3, 0, 1, 2}</div></div>
              };</div></div>
           uint64_t sampleIndex = 0;
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Applyrandompermutationstofullbase-4digits-0">Apply random permutations to full base-4 digits</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1189" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1189"><i></i></a><div id="fragbit-1189" class="collapse"><div class="fragmentcode">              bool pow2Samples = <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> &amp; 1;
              int lastDigit = pow2Samples ? 1 : 0;
              for (int i = <a href="#ZSobolSampler::nBase4Digits" class="code">nBase4Digits</a> - 1; i &gt;= lastDigit; --i) {
                  &lt;&lt;<span class="fragmentname"><a href="#fragment-Randomlypermuteithbase-4digitinmonomortonIndex-0">Randomly permute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th base-4 digit in <tt>mortonIndex</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1190" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1190"><i></i></a><div id="fragbit-1190" class="collapse"><div class="fragmentcode">                     int digitShift = 2 * i - (pow2Samples ? 1 : 0);
                     int digit = (<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; digitShift) &amp; 3;
                     &lt;&lt;<span class="fragmentname"><a href="#fragment-Choosepermutationmonoptouseformonodigit-0">Choose permutation <tt>p</tt> to use for <tt>digit</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1191" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1191"><i></i></a><div id="fragbit-1191" class="collapse"><div class="fragmentcode">                        uint64_t higherDigits = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; (digitShift + 2);
                        int p = (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>(higherDigits ^ (0x55555555u * dimension)) &gt;&gt; 24) % 24;</div></div>
                     digit = permutations[p][digit];
                     sampleIndex |= uint64_t(digit) &lt;&lt; digitShift;</div></div>
              }</div></div>
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Handlepower-of-2butnot4samplecount-0">Handle power-of-2 (but not 4) sample count</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1192" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1192"><i></i></a><div id="fragbit-1192" class="collapse"><div class="fragmentcode">              if (pow2Samples) {
                  int digit = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &amp; 1;
                  sampleIndex |= digit ^
                      (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>((<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; 1) ^ (0x55555555u * <a href="#ZSobolSampler::dimension" class="code">dimension</a>)) &amp; 1);
              }</div></div>
           return sampleIndex;
       }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ZSobolSamplerPrivateMembers-0">ZSobolSampler Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1193" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1193"><i></i></a><div id="fragbit-1193" class="collapse"><div class="fragmentcode">       <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> randomize;
       int seed, log2SamplesPerPixel, nBase4Digits;
       uint64_t mortonIndex;
       int dimension;</div></div>
};</div><p>


</p>
<p>This sampler generates blue noise samples by
taking advantage of the properties of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>-sequences. To understand the
idea behind its implementation, first consider rendering a two-pixel image
using&nbsp;16 samples per pixel where a set of 2D samples are used for area
light source sampling in each pixel. If the first&nbsp;16 samples from a
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>-sequence are used for the first pixel and the next&nbsp;16 for the
second, then not only will each pixel individually use well-stratified
samples, but the set of all 32 samples will collectively be
well stratified thanks to the stratification of
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>-sequences over elementary intervals
(Section&nbsp;<a href="#sec:elementary-intervals">8.7.1</a>).  Consequently, the samples used
in each pixel will generally be in different locations than in the other pixel,
which is precisely the sample decorrelation exhibited by blue noise.  (See
Figure&nbsp;<a href="#fig:first-64-sobol-grouped-in-16">8.39</a>.)

</p>
<p>
 </p>
<span class="anchor" id="fig:first-64-sobol-grouped-in-16"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f39.svg" title=""><img src="pha08f39.svg" width=325 height=253 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.39: The First 64 2D Sobol&rsquo; Points, Colored in Sets of 16. <span class="legend">
If four adjacent pixels each use one of these sets for
sampling, then each would not only have well-distributed points
individually, but the points collectively would be decorrelated due to being
from a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg>-sequence.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>More generally, if all the pixels in an image take different power-of-2
aligned and sized segments of samples from a single large set of Sobol&rsquo;
samples in a way that nearby pixels generally take adjacent segments, then
the distribution of samples across the entire image will be such that
pixels generally use different sample values than their neighbors.  
Allocating segments of samples in scanline order would give good
distributions along scanlines, but it would not do much from scanline to
scanline.  The Morton curve, which was introduced earlier in
Section&nbsp;<a href="../Primitives_and_Intersection_Acceleration/Bounding_Volume_Hierarchies.html#sec:hlbvh">7.3.3</a> in the context of linear bounding volume
hierarchies, gives a better mechanism for this task: if we compute the
Morton code for each pixel <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.312ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2287.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1897" y="0"></use>
</g>
</svg> and then use that to determine the
pixel&rsquo;s starting index into the full set of Sobol&rsquo; samples, then nearby
pixels&mdash;those that are nearby in both <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>&mdash;will tend to use nearby segments
of the samples.  This idea is illustrated in
Figure&nbsp;<a href="#fig:allocate-sobol-morton-curve">8.40</a>.

</p>
<p>
 </p>
<span class="anchor" id="fig:allocate-sobol-morton-curve"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f40.svg" title=""><img src="pha08f40.svg" width=308 height=308 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.40: Allocating Sobol&rsquo; Samples in Morton Curve Order. <span class="legend">
With a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
</g>
</svg> pixel image rendered using&nbsp;2 samples per pixel, we can
take the full set of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.168ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3947.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 times 4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="2446" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="3446" y="0"></use>
</g>
</svg> Sobol&rsquo; samples and then
allocate segments of samples to pixels according to their Morton indices.  For
example, pixel <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2225.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 2 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1835" y="0"></use>
</g>
</svg> has Morton index&nbsp;6, so it uses samples with
indices&nbsp;12 and&nbsp;13.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p> </p>
<span class="anchor" id="fig:rendered-zsobol-morton"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
<img src="samplers-dragon-zsobol-nopermute.png" style="max-width: 100%; height: auto;" width=1350 height=900>
</div>
<p>

</p>
<figcaption class="caption">Figure 8.41: <span class="legend">
If a regular Morton curve without permutations is used to allocate Sobol&rsquo;
indices in pixels, visible structure will be present in the rendered image.
(Compare with Figure&nbsp;<a href="#fig:padded-vs-zsobol-rendered">8.38</a>(b) where such a
permutation is used.)
<em>(Dragon model courtesy of the Stanford Computer Graphics Laboratory.)</em>
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p>Used directly in this manner, the Morton curve can lead to visible
structure in the image; see Figure&nbsp;<a href="#fig:rendered-zsobol-morton">8.41</a>,
where samples were allocated in
that way.  This issue can be addressed with a random permutation of the
Morton indices interpreted as base-4 numbers, which effectively groups
pairs of one bit from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and one bit from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> in the Morton index into
single base-4 digits.  Randomly permuting these digits still maintains much
of the spatial coherence of the Morton curve; see Figure&nbsp;<a href="#fig:sampling-random-morton-permutations">8.42</a> for
an illustration of the permutation approach.
Figure&nbsp;<a href="#fig:padded-vs-zsobol-rendered">8.38</a>(b) shows the resulting
improvement in a rendered image.

</p>
<p></p>
<span class="anchor" id="fig:sampling-random-morton-permutations"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f42.svg" title=""><img src="pha08f42.svg" width=831 height=224 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.42: <span class="legend">
If pixels&rsquo; Morton indices are interpreted as base-4 numbers and
their digits are randomly permuted, the resulting curve is still spatially
coherent.
(a)&nbsp;Applying the permutation shown to the first base-4 digit for a 
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
</g>
</svg> pixel image causes the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 times 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1723" y="0"></use>
</g>
</svg> blocks of pixels to be
visited in a different order than the usual Morton curve.
(b)&nbsp;If the second base-4 digit is also permuted (here with different
permutations for each <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">2 times 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1723" y="0"></use>
</g>
</svg> block, not shown), then the pixels
within each block are also visited in different orders.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>A second problem with the approach as described so far is that it does not
randomize the order of sample indices within a pixel, as is necessary for
padding samples across different dimensions.  This shortcoming can be
addressed by appending the bits of the sample index within a pixel to the
pixel&rsquo;s Morton code and then including those in the index randomization as
well.

</p>
<p>In addition to the usual configuration parameters, the <tt>ZSobolSampler</tt>
constructor also stores the base-2 logarithm of the number of samples per
pixel as well as the number of base-4 digits in the full extended Morton
index that includes the sample index.

</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPublicMethods-0"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Public Methods&gt;&gt;=&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">ZSobolSampler(int samplesPerPixel, <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> fullResolution,
              <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <a href="#ZSobolSampler::randomize" class="code">randomize</a>, int <a href="#ZSobolSampler::seed" class="code">seed</a> = 0)
    : <a href="#ZSobolSampler::randomize" class="code">randomize</a>(<a href="#ZSobolSampler::randomize" class="code">randomize</a>), <a href="#ZSobolSampler::seed" class="code">seed</a>(<a href="#ZSobolSampler::seed" class="code">seed</a>) {
    <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> = <a href="../Utilities/Mathematical_Infrastructure.html#Log2Int" class="code">Log2Int</a>(samplesPerPixel);
    int res = <a href="../Utilities/Mathematical_Infrastructure.html#RoundUpPow2" class="code">RoundUpPow2</a>(std::max(fullResolution.x, fullResolution.y));
    int log4SamplesPerPixel = (<a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> + 1) / 2;
    <a href="#ZSobolSampler::nBase4Digits" class="code">nBase4Digits</a> = <a href="../Utilities/Mathematical_Infrastructure.html#Log2Int" class="code">Log2Int</a>(res) + log4SamplesPerPixel;
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Private Members&gt;&gt;=&nbsp;<a href="#fragment-ZSobolSamplerPrivateMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Sampling_and_Reconstruction/Halton_Sampler.html#RandomizeStrategy" class="code">RandomizeStrategy</a> <span class="anchor" id="ZSobolSampler::randomize"></span>randomize;
int <span class="anchor" id="ZSobolSampler::seed"></span>seed, <span class="anchor" id="ZSobolSampler::log2SamplesPerPixel"></span>log2SamplesPerPixel, <span class="anchor" id="ZSobolSampler::nBase4Digits"></span>nBase4Digits;</div><p>


</p>
<p>

</p>
<p>The <tt>StartPixelSample()</tt> method&rsquo;s main task is to construct the
initial unpermuted sample index by computing the pixel&rsquo;s Morton code and
then appending the sample index, using a left shift to make space for it.
This value is stored in <tt>mortonIndex</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPublicMethods-1"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">void <span class="anchor" id="ZSobolSampler::StartPixelSample"></span>StartPixelSample(<a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> p, int index, int dim) {
    <a href="#ZSobolSampler::dimension" class="code">dimension</a> = dim;
    <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> = (<a href="../Utilities/Mathematical_Infrastructure.html#EncodeMorton2" class="code">EncodeMorton2</a>(p.x, p.y) &lt;&lt; <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a>) | index;
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPrivateMembers-1"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Private Members&gt;&gt;+=&nbsp;<a href="#fragment-ZSobolSamplerPrivateMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">uint64_t <span class="anchor" id="ZSobolSampler::mortonIndex"></span>mortonIndex;
int <span class="anchor" id="ZSobolSampler::dimension"></span>dimension;</div><p>


</p>
<p>Sample generation is similar to the <a href="#PaddedSobolSampler"><tt>PaddedSobolSampler</tt></a> with the
exception that the index of the sample is found with a call to the
<tt>GetSampleIndex()</tt> method (shown next), which randomizes
<tt>mortonIndex</tt>.  The &lt;&lt;<span class="fragmentname">Generate 1D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample at
<tt>sampleIndex</tt></span>&gt;&gt; fragment then calls <a href="#SobolSample"><tt>SobolSample()</tt></a> to generate the
<tt>sampleIndex</tt>th sample using the appropriate randomizer.  It is
otherwise effectively the same as the
<a href="#PaddedSobolSampler::SampleDimension"><tt>PaddedSobolSampler::SampleDimension()</tt></a> method, so its implementation
is not included here.

</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPublicMethods-2"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="ZSobolSampler::Get1D"></span>Get1D() {
    uint64_t sampleIndex = <a href="#ZSobolSampler::GetSampleIndex" class="code">GetSampleIndex</a>();
    ++<a href="#ZSobolSampler::dimension" class="code">dimension</a>;
    &lt;&lt;<span class="fragmentname">Generate 1D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample at <tt>sampleIndex</tt></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1194" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1194"><i></i></a><div id="fragbit-1194" class="collapse"><div class="fragmentcode">       uint32_t sampleHash = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#ZSobolSampler::dimension" class="code">dimension</a>, <a href="#ZSobolSampler::seed" class="code">seed</a>);
       if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::None)
           return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, NoRandomizer());
       else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::PermuteDigits)
           return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, BinaryPermuteScrambler(sampleHash));
       else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::FastOwen)
           return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, FastOwenScrambler(sampleHash));
       else
           return <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, OwenScrambler(sampleHash));</div></div>
}</div><p>


</p>
<p>

</p>
<p>2D samples are generated in a similar manner, using the first two Sobol&rsquo;
sequence dimensions and a sample index returned by
<tt>GetSampleIndex()</tt>.  Here as well, the fragment that dispatches calls
to <a href="#SobolSample"><tt>SobolSample()</tt></a> corresponding to the chosen randomization scheme is
not included.

</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPublicMethods-3"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="ZSobolSampler::Get2D"></span>Get2D() {
    uint64_t sampleIndex = <a href="#ZSobolSampler::GetSampleIndex" class="code">GetSampleIndex</a>();
    <a href="#ZSobolSampler::dimension" class="code">dimension</a> += 2;
    &lt;&lt;<span class="fragmentname">Generate 2D Sobol <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.902ex" height="2.176ex" style="vertical-align: -0.171ex;" viewBox="0 -863.1 388.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="0" y="513"></use>
</g>
</svg> sample at <tt>sampleIndex</tt></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1195" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1195"><i></i></a><div id="fragbit-1195" class="collapse"><div class="fragmentcode">       uint64_t bits = <a href="../Utilities/Mathematical_Infrastructure.html#Hash" class="code">Hash</a>(<a href="#ZSobolSampler::dimension" class="code">dimension</a>, <a href="#ZSobolSampler::seed" class="code">seed</a>);
       uint32_t sampleHash[2] = {uint32_t(bits), uint32_t(bits &gt;&gt; 32)};
       if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::None)
           return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, NoRandomizer()),
                   <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, NoRandomizer())};
       else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::PermuteDigits)
           return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, BinaryPermuteScrambler(sampleHash[0])),
                   <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, BinaryPermuteScrambler(sampleHash[1]))};
       else if (<a href="#ZSobolSampler::randomize" class="code">randomize</a> == RandomizeStrategy::FastOwen)
           return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, FastOwenScrambler(sampleHash[0])),
                   <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, FastOwenScrambler(sampleHash[1]))};
       else
           return {<a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 0, OwenScrambler(sampleHash[0])),
                   <a href="#SobolSample" class="code">SobolSample</a>(sampleIndex, 1, OwenScrambler(sampleHash[1]))};</div></div>
}</div><p>


</p>
<p>

</p>
<p>Pixel samples are generated the same way as other 2D sample distributions.

</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPublicMethods-4"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="ZSobolSampler::GetPixel2D"></span>GetPixel2D() { return <a href="#ZSobolSampler::Get2D" class="code">Get2D</a>(); }</div><p>


</p>
<p>

</p>
<p>The <tt>GetSampleIndex()</tt> method is where most of the complexity of this
sampler lies.  It computes a random permutation of the digits of
<tt>mortonIndex</tt>, including handling the case where the number of samples
per pixel is only a power of&nbsp;2 but not a power of&nbsp;4; that case needs
special treatment since the total number of bits in the index is odd, which
means that only one of the two bits needed for the last base-4 digit is
available.

</p>
<p></p>
<span class="anchor" id="fragment-ZSobolSamplerPublicMethods-5"></span><div class="fragmentname">&lt;&lt;ZSobolSampler Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-ZSobolSamplerPublicMethods-4"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">uint64_t <span class="anchor" id="ZSobolSampler::GetSampleIndex"></span>GetSampleIndex() const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Definethefullsetof4-waypermutationsinmonopermutations-0">Define the full set of 4-way permutations in <tt>permutations</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1196" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1196"><i></i></a><div id="fragbit-1196" class="collapse"><div class="fragmentcode">       static const uint8_t permutations[24][4] = {
           {0, 1, 2, 3}, {0, 1, 3, 2}, {0, 2, 1, 3}, {0, 2, 3, 1},
           &lt;&lt;<span class="fragmentname">Define remaining 20 4-way permutations</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1197" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1197"><i></i></a><div id="fragbit-1197" class="collapse"><div class="fragmentcode">              {0, 3, 2, 1},
                      {0, 3, 1, 2}, {1, 0, 2, 3}, {1, 0, 3, 2}, {1, 2, 0, 3}, {1, 2, 3, 0},
                      {1, 3, 2, 0}, {1, 3, 0, 2}, {2, 1, 0, 3}, {2, 1, 3, 0}, {2, 0, 1, 3},
                      {2, 0, 3, 1}, {2, 3, 0, 1}, {2, 3, 1, 0}, {3, 1, 2, 0}, {3, 1, 0, 2},
                      {3, 2, 1, 0}, {3, 2, 0, 1}, {3, 0, 2, 1}, {3, 0, 1, 2}</div></div>
       };</div></div>
    uint64_t sampleIndex = 0;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Applyrandompermutationstofullbase-4digits-0">Apply random permutations to full base-4 digits</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1198" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1198"><i></i></a><div id="fragbit-1198" class="collapse"><div class="fragmentcode">       bool pow2Samples = <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> &amp; 1;
       int lastDigit = pow2Samples ? 1 : 0;
       for (int i = <a href="#ZSobolSampler::nBase4Digits" class="code">nBase4Digits</a> - 1; i &gt;= lastDigit; --i) {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Randomlypermuteithbase-4digitinmonomortonIndex-0">Randomly permute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th base-4 digit in <tt>mortonIndex</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1199" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1199"><i></i></a><div id="fragbit-1199" class="collapse"><div class="fragmentcode">              int digitShift = 2 * i - (pow2Samples ? 1 : 0);
              int digit = (<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; digitShift) &amp; 3;
              &lt;&lt;<span class="fragmentname"><a href="#fragment-Choosepermutationmonoptouseformonodigit-0">Choose permutation <tt>p</tt> to use for <tt>digit</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1200" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1200"><i></i></a><div id="fragbit-1200" class="collapse"><div class="fragmentcode">                 uint64_t higherDigits = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; (digitShift + 2);
                 int p = (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>(higherDigits ^ (0x55555555u * dimension)) &gt;&gt; 24) % 24;</div></div>
              digit = permutations[p][digit];
              sampleIndex |= uint64_t(digit) &lt;&lt; digitShift;</div></div>
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Handlepower-of-2butnot4samplecount-0">Handle power-of-2 (but not 4) sample count</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1201" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1201"><i></i></a><div id="fragbit-1201" class="collapse"><div class="fragmentcode">       if (pow2Samples) {
           int digit = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &amp; 1;
           sampleIndex |= digit ^
               (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>((<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; 1) ^ (0x55555555u * <a href="#ZSobolSampler::dimension" class="code">dimension</a>)) &amp; 1);
       }</div></div>
    return sampleIndex;
}</div><p>


</p>
<p>We will find it useful to have all of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.233ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3114.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 factorial equals 24</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-21" d="M192 665l-39 -456c-1 -17 -4 -22 -14 -22c-12 0 -13 8 -14 23l-39 455c0 33 27 51 53 51s53 -18 53 -51zM192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-21" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1056" y="0"></use>
<g transform="translate(2113,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
</g>
</g>
</svg> permutations of four
elements explicitly enumerated; they are stored in the
<tt>permutations</tt> array.

</p>
<p></p>
<span class="anchor" id="fragment-Definethefullsetof4-waypermutationsinmonopermutations-0"></span><div class="fragmentname">&lt;&lt;Define the full set of 4-way permutations in <tt>permutations</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">static const uint8_t permutations[24][4] = {
    {0, 1, 2, 3}, {0, 1, 3, 2}, {0, 2, 1, 3}, {0, 2, 3, 1},
    &lt;&lt;<span class="fragmentname">Define remaining 20 4-way permutations</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1202" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1202"><i></i></a><div id="fragbit-1202" class="collapse"><div class="fragmentcode">       {0, 3, 2, 1},
               {0, 3, 1, 2}, {1, 0, 2, 3}, {1, 0, 3, 2}, {1, 2, 0, 3}, {1, 2, 3, 0},
               {1, 3, 2, 0}, {1, 3, 0, 2}, {2, 1, 0, 3}, {2, 1, 3, 0}, {2, 0, 1, 3},
               {2, 0, 3, 1}, {2, 3, 0, 1}, {2, 3, 1, 0}, {3, 1, 2, 0}, {3, 1, 0, 2},
               {3, 2, 1, 0}, {3, 2, 0, 1}, {3, 0, 2, 1}, {3, 0, 1, 2}</div></div>
};</div><p>


</p>
<p>

</p>
<p>The digits are randomized from most significant to least significant.  In
the case of the number of samples only being a power of&nbsp;2, the loop
terminates before the last bit, which is handled specially since it is not
a full base-4 digit.

</p>
<p></p>
<span class="anchor" id="fragment-Applyrandompermutationstofullbase-4digits-0"></span><div class="fragmentname">&lt;&lt;Apply random permutations to full base-4 digits&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">bool pow2Samples = <a href="#ZSobolSampler::log2SamplesPerPixel" class="code">log2SamplesPerPixel</a> &amp; 1;
int lastDigit = pow2Samples ? 1 : 0;
for (int i = <a href="#ZSobolSampler::nBase4Digits" class="code">nBase4Digits</a> - 1; i &gt;= lastDigit; --i) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Randomlypermuteithbase-4digitinmonomortonIndex-0">Randomly permute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th base-4 digit in <tt>mortonIndex</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1203" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1203"><i></i></a><div id="fragbit-1203" class="collapse"><div class="fragmentcode">       int digitShift = 2 * i - (pow2Samples ? 1 : 0);
       int digit = (<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; digitShift) &amp; 3;
       &lt;&lt;<span class="fragmentname"><a href="#fragment-Choosepermutationmonoptouseformonodigit-0">Choose permutation <tt>p</tt> to use for <tt>digit</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1204" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1204"><i></i></a><div id="fragbit-1204" class="collapse"><div class="fragmentcode">          uint64_t higherDigits = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; (digitShift + 2);
          int p = (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>(higherDigits ^ (0x55555555u * dimension)) &gt;&gt; 24) % 24;</div></div>
       digit = permutations[p][digit];
       sampleIndex |= uint64_t(digit) &lt;&lt; digitShift;</div></div>
}</div><p>


</p>
<p>After the current digit is extracted from <tt>mortonIndex</tt>, it is
permuted using the selected permutation before being shifted back into
place to be added to <tt>sampleIndex</tt>.  

</p>
<p></p>
<span class="anchor" id="fragment-Randomlypermuteithbase-4digitinmonomortonIndex-0"></span><div class="fragmentname">&lt;&lt;Randomly permute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th base-4 digit in <tt>mortonIndex</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">int digitShift = 2 * i - (pow2Samples ? 1 : 0);
int digit = (<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; digitShift) &amp; 3;
&lt;&lt;<span class="fragmentname"><a href="#fragment-Choosepermutationmonoptouseformonodigit-0">Choose permutation <tt>p</tt> to use for <tt>digit</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1205" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1205"><i></i></a><div id="fragbit-1205" class="collapse"><div class="fragmentcode">   uint64_t higherDigits = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; (digitShift + 2);
   int p = (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>(higherDigits ^ (0x55555555u * dimension)) &gt;&gt; 24) % 24;</div></div>
digit = permutations[p][digit];
sampleIndex |= uint64_t(digit) &lt;&lt; digitShift;</div><p>


</p>
<p>Which permutation to use is determined by hashing both the higher-order
digits and the current sample dimension.  In this way, the index is hashed
differently for different dimensions, which randomizes the association of
samples in different dimensions for padding.  The use of the higher-order
digits in this way means that this approach bears some resemblance to Owen
scrambling, though here it is applied to sample indices rather than sample
values.  The result is a top-down hierarchical randomization of the Morton
curve.

</p>
<p></p>
<span class="anchor" id="fragment-Choosepermutationmonoptouseformonodigit-0"></span><div class="fragmentname">&lt;&lt;Choose permutation <tt>p</tt> to use for <tt>digit</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">uint64_t higherDigits = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; (digitShift + 2);
int p = (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>(higherDigits ^ (0x55555555u * dimension)) &gt;&gt; 24) % 24;</div><p>


</p>
<p>In the case of a power-of-2 sample count, the single remaining bit in
<tt>mortonIndex</tt> is handled specially, though following the same approach
as the other digits: the higher-order bits and dimension are hashed to
choose a permutation.  In this case, there are only two possible
permutations, and as with the <a href="#BinaryPermuteScrambler"><tt>BinaryPermuteScrambler</tt></a>, an exclusive
<span style="font-variant: small-caps;">or</span> is sufficient to apply whichever of them was selected.

</p>
<p></p>
<span class="anchor" id="fragment-Handlepower-of-2butnot4samplecount-0"></span><div class="fragmentname">&lt;&lt;Handle power-of-2 (but not 4) sample count&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (pow2Samples) {
    int digit = <a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &amp; 1;
    sampleIndex |= digit ^
        (<a href="../Utilities/Mathematical_Infrastructure.html#MixBits" class="code">MixBits</a>((<a href="#ZSobolSampler::mortonIndex" class="code">mortonIndex</a> &gt;&gt; 1) ^ (0x55555555u * <a href="#ZSobolSampler::dimension" class="code">dimension</a>)) &amp; 1);
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#Evaluation"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="Evaluation"></span><h3>8.7.7  Evaluation</h3><p>


</p>
<p>
In this section we have defined three <a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler"><tt>Sampler</tt></a>s, each of which
supports four randomization algorithms, giving a total of 12 different ways of
generating samples.  All are effective samplers, though their
characteristics vary.  In the interest of space, we will not include
evaluations of every one of them here but will focus on the most
significant differences among them.

</p>
<p></p>
<span class="anchor" id="fig:sobol-sample-psds"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f43.svg" title=""><img src="pha08f43.svg" width=700 height=689 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.43: Power Spectral Density of the Sobol&rsquo; Point Set. <span class="legend">
(a)&nbsp;Unscrambled,
(b)&nbsp;scrambled using random digit permutations,
(c)&nbsp;scrambled using the <a href="#FastOwenScrambler"><tt>FastOwenScrambler</tt></a>,
(d)&nbsp;scrambled using hashed Owen scrambling.
The unscrambled Sobol&rsquo; points have a remarkably bad power spectral
density (PSD) and random digit
permutations are of only slight benefit.  Owen scrambling greatly improves
the PSD.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Figure&nbsp;<a href="#fig:sobol-sample-psds">8.43</a>(a) shows the PSD of the unscrambled 2D Sobol&rsquo;
point set; it is an especially bad power
spectrum.  Like the Halton points, the 2D Sobol&rsquo; points have low energy along the two axes
thanks to well-distributed 1D projections, but there is significant
structured variation at higher off-axis frequencies, including regions with
very high PSD values.
As seen in Figure&nbsp;<a href="#fig:sobol-sample-psds">8.43</a>(b), randomizing the Sobol&rsquo; points with
random digit permutations only slightly improves the power spectrum.  Only
with the Owen scrambling algorithms does the power spectrum start to
become uniform at higher frequencies, though some structure still remains
(Figures&nbsp;<a href="#fig:sobol-sample-psds">8.43</a>(c) and&nbsp;(d)).

</p>
<p>These well-distributed 1D projections are one reason why
low-discrepancy sequences are generally more effective than stratified
patterns: they are more robust with respect to preserving their
good distribution properties after being transformed to other domains.
Figure&nbsp;<a href="#fig:mc-strat-02-warp">8.44</a> shows what happens when a set of 16
sample points are transformed to be points on a skinny
quadrilateral by scaling them to cover its surface; samples from the
Sobol&rsquo; sequence remain well distributed, but samples from a stratified
pattern fare worse.

</p>
<p></p>
<span class="anchor" id="fig:mc-strat-02-warp"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f44.svg" title=""><img src="pha08f44.svg" width=759 height=110 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.44: <span class="legend"> (a) Transforming a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
</g>
</svg> stratified
sampling pattern to points on a long and thin quadrilateral light source 
effectively gives fewer than 16 well-distributed samples; stratification in the
vertical direction is not helpful. (b)&nbsp;Samples from the Sobol&rsquo; sequence
remain well distributed even after this transformation.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p> </p>
<span class="anchor" id="fig:dof-halton-sobol"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>

<div class="card-img-top" style="display:block; width: 100%; padding-top: 104.000%;  position:relative;">
<div id="xa_Stratified_Sampler23" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div></div>
<script>
Jeri.renderViewer(document.getElementById('xa_Stratified_Sampler23'), {
  title: '(a)_Stratified_Sampler23', children: [
 { title: '(a) Stratified Sampler', image: 'dof-sphere-stratified.png' },  { title: '(b) Halton Sampler', image: 'dof-sphere-halton.png' },  { title: '(c) Padded Sobol Sampler', image: 'dof-sphere-paddedsobol.png' },  { title: '(d) Sobol Sampler', image: 'dof-sphere-sobol.png' },  { title: '(e) ZSobol Sampler', image: 'dof-sphere-zsobol.png' }]});
</script>
<button data-toggle="tooltip" data-placement="left" class="btn yojeri" title="This image is interactive. Click and drag to pan and use the mouse-wheel to zoom. After clicking on the image to select it, type '?' to see a summary of keyboard controls."><i class="fa fa-snowflake fa-border"></i></button><p>

</p>
<figcaption class="caption">Figure 8.45: Comparisons of the Halton and Various Sobol&rsquo; Samplers for Rendering
Depth of Field. <span class="legend">
Mean squared error is reported normalized to that of the stratified sampler.
(a)&nbsp;An image rendered using the <a href="../Sampling_and_Reconstruction/Stratified_Sampler.html#StratifiedSampler"><tt>StratifiedSampler</tt></a> (normalized MSE 1),
(b)&nbsp;an image rendered using the <a href="../Sampling_and_Reconstruction/Halton_Sampler.html#HaltonSampler"><tt>HaltonSampler</tt></a> (normalized MSE 1.44),
(c)&nbsp;an image rendered using the <a href="#PaddedSobolSampler"><tt>PaddedSobolSampler</tt></a> (normalized MSE 0.96),
(d)&nbsp;an image rendered using the <a href="#SobolSampler"><tt>SobolSampler</tt></a> (normalized MSE 0.64), and
(e)&nbsp;an image rendered using the <a href="#ZSobolSampler"><tt>ZSobolSampler</tt></a> (normalized MSE 0.84).
All the low-discrepancy samplers use hashed Owen scrambling for
randomization and 16 samples per pixel.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Returning to the simple scene with defocus blur that was used in
Figure&nbsp;<a href="../Sampling_and_Reconstruction/Stratified_Sampler.html#fig:sample-uniform-stratified">8.23</a>,
Figure&nbsp;<a href="#fig:dof-halton-sobol">8.45</a> compares using the Halton sampler to the
three Sobol&rsquo; samplers for rendering that scene.  We can see that the
Halton sampler has higher error than the <a href="../Sampling_and_Reconstruction/Stratified_Sampler.html#StratifiedSampler"><tt>StratifiedSampler</tt></a>, which is
due to its 2D projections (as are used for sampling the lens) not
necessarily being well distributed.  The <a href="#PaddedSobolSampler"><tt>PaddedSobolSampler</tt></a> gives
little benefit over the stratified sampler, since for sampling a lens, the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">4 times 4</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1723" y="0"></use>
</g>
</svg> stratification is the most important one and both fulfill
that.  The <a href="#SobolSampler"><tt>SobolSampler</tt></a> has remarkably low error, even though the
rendered image shows the characteristic structure of 2D projections of the
Sobol&rsquo; sequence.  The <a href="#ZSobolSampler"><tt>ZSobolSampler</tt></a> combines reasonably low
error with the visual benefit of distributing its error with blue
noise.

</p>
<p>

</p>
<p>Figure&nbsp;<a href="#fig:sobol-eval-functions">8.46</a> shows the performance of Sobol&rsquo;
sample points with the two test functions.  It does well with both, but
especially so with Owen scrambled points and the smooth Gaussian function,
where it has an asymptotically faster rate of convergence.
Figure&nbsp;<a href="#fig:sobol-sampler-mse-plot">8.47</a> graphs MSE versus the sample count
for the blurry dragon test scene from Figure&nbsp;<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#fig:scene-rendered-various-samplers">8.32</a>.
Both the Halton and Sobol&rsquo; samplers have roughly 10% lower MSE than
independent sampling at
equivalent sample counts. 

</p>
<p>
</p>
<span class="anchor" id="fig:sobol-eval-functions"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
<img src="pha08f46.png" style="max-width: 100%; height: auto;" width=1226 height=1153>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.46: Error When Integrating Simple 2D Functions with Sobol&rsquo;
Samples. <span class="legend">
(a)&nbsp;Sobol&rsquo; sampling exhibits lower error and a faster asymptotic rate of
convergence than independent sampling does.  For a smooth function like the Gaussian,
Owen scrambling the sample points
gives an even better rate of convergence, especially at power-of-two
numbers of sample points.
(b)&nbsp;Using Sobol&rsquo; points is also effective for the rotated checkerboard
function. Owen scrambling gives a further benefit, though without the
substantial improvement in rate of convergence that was seen with the
Gaussian.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>
</p>
<span class="anchor" id="fig:sobol-sampler-mse-plot"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
<img src="pha08f47.png" style="max-width: 100%; height: auto;" width=1090 height=544>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.47: Log&ndash;Log Plot of MSE When Rendering the Scene in
Figure&nbsp;<a href="../Sampling_and_Reconstruction/Halton_Sampler.html#fig:scene-rendered-various-samplers">8.32</a> with Low-Discrepancy
Samplers. <span class="legend">
For this scene, both the Halton and Sobol&rsquo; samplers are similarly
effective.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Sampling_and_Reconstruction/Image_Reconstruction.html">Sampling and Reconstruction / Image Reconstruction</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
