
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

  <script async src="https://cse.google.com/cse.js?cx=003601324460585362024:4xwpwgaitgd"></script>
  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
        
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Image Reconstruction</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Sampling_and_Reconstruction.html">Sampling and Reconstruction</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Image Reconstruction</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Sampling_and_Reconstruction/Sobol_Samplers.html">(Previous: Sobol&rsquo; Samplers)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:image-reconstruction"></span><h2>8.8 Image Reconstruction</h2><p>



</p>
<p>
As discussed in Section&nbsp;<a href="../Cameras_and_Film/Film_and_Imaging.html#sec:film-filtering-samples">5.4.3</a>, each pixel in the <a href="../Cameras_and_Film/Film_and_Imaging.html#Film"><tt>Film</tt></a>
computes an estimate of the integral of the product of a filter function
with samples taken from the image function.  In
Section&nbsp;<a href="../Sampling_and_Reconstruction/Sampling_Theory.html#sec:sampling-theory">8.1</a>, we saw that sampling theory provides a
mathematical foundation for how this filtering operation should be
performed in order to achieve an antialiased result.  We should, in
principle:
</p>
<ol>
<li> Reconstruct a continuous image function from the set of
image samples.
<li> Prefilter that function to remove any frequencies past the
Nyquist limit for the pixel spacing.
<li> Sample the prefiltered function at the pixel locations to compute the final pixel
values.
</ol><p>

Because we know that we will be resampling the function at only the pixel
locations, it is not necessary to construct an explicit representation of
the function.  Instead, we can combine the first two steps using a single
filter function.

</p>
<p>Recall that if the original function had been uniformly sampled at a frequency
greater than the Nyquist frequency and reconstructed with the sinc filter, then
the reconstructed function in the first step would match the original image
function perfectly&mdash;quite a feat since we only have point samples.  But
because the image function almost always will have higher
frequencies than could be accounted for by the sampling rate (due to edges,
etc.), we chose to sample it nonuniformly, trading off noise for aliasing.

</p>
<p>The theory behind ideal reconstruction depends on the samples being
uniformly spaced.  While a number of attempts have been made to extend the
theory to nonuniform sampling, there is not yet an accepted approach to
this problem.  Furthermore, because the sampling rate is known to be
insufficient to capture the function, perfect reconstruction is not
possible.  Recent research in the field of sampling theory has revisited
the issue of reconstruction with the explicit acknowledgment that perfect
reconstruction is not generally attainable in practice.  This slight shift
in perspective has led to powerful new reconstruction techniques.  In
particular, the goal of research in reconstruction theory has shifted from
perfect reconstruction to developing reconstruction techniques that can be
shown to minimize error between the reconstructed function and the original
function, <em>regardless of whether the original was band limited</em>.

</p>
<p>The sinc filter is not an appropriate choice here: recall that the ideal
sinc filter is prone to ringing when the underlying function has
frequencies beyond the Nyquist limit, meaning edges in
the image have faint replicated copies of the edge in nearby pixels (the
Gibbs phenomenon; see Section <a href="../Sampling_and_Reconstruction/Sampling_Theory.html#sec:sample-alias-rendering">8.1.5</a>).
Furthermore, the sinc filter has <em>infinite support</em>: it does not fall
off to zero at a finite distance from its center, so all the image
samples would need to be filtered for each output pixel.  In practice,
there is no single best filter function.  Choosing the best one for a
particular scene takes a mixture of quantitative evaluation and qualitative
judgment. <tt>pbrt</tt> therefore provides a variety of choices.

</p>
<p>Figure&nbsp;<a href="#fig:filter-comparisons">8.48</a> shows comparisons of zoomed-in regions
of images rendered using a variety of the filters from this section to
reconstruct pixel values.

</p>
<p> </p>
<span class="anchor" id="fig:filter-comparisons"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>

<div class="card-img-top" style="display:block; width: 100%; padding-top: 54.688%;  position:relative;">
<div id="xa_Box_filter25" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div></div>
<script>
Jeri.renderViewer(document.getElementById('xa_Box_filter25'), {
  title: '(a)_Box_filter25', children: [
 { title: '(a) Box filter', image: 'crown-filter-box.png' },  { title: '(b) Gaussian', image: 'crown-filter-gaussian.png' },  { title: '(c) Mitchell-Netravali', image: 'crown-filter-mitchell.png' }]});
</script>
<button data-toggle="tooltip" data-placement="left" class="btn yojeri" title="This image is interactive. Click and drag to pan and use the mouse-wheel to zoom. After clicking on the image to select it, type '?' to see a summary of keyboard controls."><i class="fa fa-snowflake fa-border"></i></button><p>

</p>
<figcaption class="caption">Figure 8.48: <span class="legend"> The pixel reconstruction filter used
to convert the image samples into pixel values can have a noticeable effect
on the character of the final image.  Here, we see enlargements of a
region of the imperial crown model, filtered with (a)&nbsp;the box
filter, (b)&nbsp;Gaussian filter, and (c)&nbsp;Mitchell&ndash;Netravali filter.
Note that the Mitchell filter gives the sharpest image, while the Gaussian
blurs it.  The box filter is the least desirable, since it allows high-frequency
aliasing to leak into the final image. (Note the stair-step pattern along
bright gold edges, for example.)
<em>(Crown model courtesy of Martin Lubich.)</em>
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#FilterInterface"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:filter-interface"></span><span id="FilterInterface"></span><h3>8.8.1  Filter Interface</h3><p>



</p>
<p>The <tt>Filter</tt> class defines the interface for pixel reconstruction
filters in <tt>pbrt</tt>.  It is defined in the file <a href="https://github.com/mmp/pbrt-v4/tree/master/src/pbrt/base/filter.h"><tt>base/filter.h</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-FilterDefinition-0"></span><div class="fragmentname">&lt;&lt;Filter Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="Filter"></span>Filter :
        public <a href="../Utilities/Containers_and_Memory_Management.html#TaggedPointer" class="code">TaggedPointer</a>&lt;<a href="#BoxFilter" class="code">BoxFilter</a>, <a href="#GaussianFilter" class="code">GaussianFilter</a>, <a href="#MitchellFilter" class="code">MitchellFilter</a>,
                             <a href="#LanczosSincFilter" class="code">LanczosSincFilter</a>, <a href="#TriangleFilter" class="code">TriangleFilter</a>&gt; {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FilterInterface-0">Filter Interface</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1206" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1206"><i></i></a><div id="fragbit-1206" class="collapse"><div class="fragmentcode">       using <a href="../Utilities/Containers_and_Memory_Management.html#TaggedPointer" class="code">TaggedPointer</a>::<a href="../Utilities/Containers_and_Memory_Management.html#TaggedPointer" class="code">TaggedPointer</a>;
       
       static <a href="#Filter" class="code">Filter</a> Create(const std::string &amp;name,
                                  const ParameterDictionary &amp;parameters, const FileLoc *loc,
                                  Allocator alloc);
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> Radius() const;
       Float Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const;
       Float Integral() const;
       FilterSample Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const;
       std::string ToString() const;</div></div>
};</div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fig:filter-width-support"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f49.svg" title=""><img src="pha08f49.svg" width=386 height=266 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.49: <span class="legend"> The extent of filters in <tt>pbrt</tt> is
specified in terms of each one&rsquo;s radius from the origin to its cutoff point.  The
support of a filter is its total nonzero extent, here equal to twice its
radius.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>All filters are 2D functions that are centered at the origin and define a radius beyond
which they have a value of&nbsp;0.  The radii are different in the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> directions but are assumed to be symmetric in each. A filter provides 
its radius via the <tt>Radius()</tt> method.  The filter&rsquo;s overall extent
in each direction (its <em>support</em>) is twice the value of its
corresponding radius (Figure&nbsp;<a href="#fig:filter-width-support">8.49</a>).

</p>
<p></p>
<span class="anchor" id="fragment-FilterInterface-0"></span><div class="fragmentname">&lt;&lt;Filter Interface&gt;&gt;=&nbsp;<a href="#fragment-FilterInterface-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <span class="anchor" id="Filter::Radius"></span>Radius() const;</div><p>


</p>
<p><tt>Filter</tt> implementations must also provide a method that evaluates
their filter function.  This function may be called with points that are
outside of the filter&rsquo;s radius; in this case it is the
responsibility of the implementation to detect this case and return the
value&nbsp;0.  It is not required for the filter values returned by
<tt>Evaluate()</tt> to integrate to&nbsp;1 since the estimator used to compute pixel values,
Equation&nbsp;(<a href="../Cameras_and_Film/Film_and_Imaging.html#eq:pixel-contribution-weighted-sum">5.13</a>), is self-normalizing.

</p>
<p></p>
<span class="anchor" id="fragment-FilterInterface-1"></span><div class="fragmentname">&lt;&lt;Filter Interface&gt;&gt;+=&nbsp;<a href="#fragment-FilterInterface-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-FilterInterface-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Filter::Evaluate"></span>Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const;</div><p>


</p>
<p>Filters also must be able to return their integral.  Most are able to
compute this value in closed form.  Thus, if calling code requires a
normalized filter function, it is easy enough to find it by dividing values
returned by <tt>Evaluate()</tt> by the integral.

</p>
<p></p>
<span class="anchor" id="fragment-FilterInterface-2"></span><div class="fragmentname">&lt;&lt;Filter Interface&gt;&gt;+=&nbsp;<a href="#fragment-FilterInterface-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-FilterInterface-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Filter::Integral"></span>Integral() const;</div><p>


</p>
<p>Filters must also provide an importance sampling method, <tt>Sample</tt>,
which takes a random sample <tt>u</tt> in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.965ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2568.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-parenthesis squared</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-FilterInterface-3"></span><div class="fragmentname">&lt;&lt;Filter Interface&gt;&gt;+=&nbsp;<a href="#fragment-FilterInterface-2"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">FilterSample <span class="anchor" id="Filter::Sample"></span>Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const;</div><p>


</p>
<p>The returned <tt>FilterSample</tt> structure stores both the sampled position
<tt>p</tt> and a weight, which is the ratio of the value of the filter
function at <tt>p</tt> to the value of the PDF used for sampling there.
Because some filters are able to exactly sample from their distribution,
returning this ratio directly allows them to save the trouble of evaluating
those two values and instead to always return a weight of&nbsp;1.

</p>
<p></p>
<span class="anchor" id="fragment-FilterSampleDefinition-0"></span><div class="fragmentname">&lt;&lt;FilterSample Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">struct <span class="anchor" id="FilterSample"></span>FilterSample {
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="FilterSample::p"></span>p;
    Float <span class="anchor" id="FilterSample::weight"></span>weight;
};</div><p>


</p>
<p>Given the specification of this interface, we can now implement 
the <tt>GetCameraSample()</tt> function that most integrators
use to compute the <tt>CameraSample</tt>s that they pass to the
<a href="../Cameras_and_Film/Camera_Interface.html#Camera::GenerateRay"><tt>Camera::GenerateRay()</tt></a> methods.

</p>
<p></p>
<span class="anchor" id="fragment-SamplerInlineFunctions-0"></span><div class="fragmentname">&lt;&lt;Sampler Inline Functions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">template &lt;typename S&gt;
<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample" class="code">CameraSample</a> <span class="anchor" id="GetCameraSample"></span>GetCameraSample(S sampler, <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> pPixel, <a href="#Filter" class="code">Filter</a> filter) {
    FilterSample fs = filter.<a href="#Filter::Sample" class="code">Sample</a>(sampler.<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler::GetPixel2D" class="code">GetPixel2D</a>());
    <a href="../Cameras_and_Film/Camera_Interface.html#CameraSample" class="code">CameraSample</a> cs;
    &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializemonoCameraSamplemembervariables-0">Initialize <tt>CameraSample</tt> member variables</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1207" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1207"><i></i></a><div id="fragbit-1207" class="collapse"><div class="fragmentcode">       cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::pFilm" class="code">pFilm</a> = pPixel + fs.<a href="#FilterSample::p" class="code">p</a> + <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a>(0.5f, 0.5f);
       cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::time" class="code">time</a> = sampler.<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler::Get1D" class="code">Get1D</a>();
       cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::pLens" class="code">pLens</a> = sampler.<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler::Get2D" class="code">Get2D</a>();
       cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::filterWeight" class="code">filterWeight</a> = fs.<a href="#FilterSample::weight" class="code">weight</a>;</div></div>
    return cs;
}</div><p>


</p>
<p>One subtlety in the definition of this function is that it is templated
based on the type of the sampler passed to it.  If a value of type
<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler"><tt>Sampler</tt></a> is passed to this method, then it proceeds using <tt>pbrt</tt>&rsquo;s
usual dynamic dispatch mechanism to call the corresponding methods of the
<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler"><tt>Sampler</tt></a> implementation.  However, if a concrete sampler type
(e.g., <tt>HaltonSampler</tt>) is passed to it, then the corresponding methods
can be called directly (and are generally expanded inline in the function).
This capability is used to improve performance in <tt>pbrt</tt>&rsquo;s GPU rendering
path; see Section&nbsp;<a href="../Wavefront_Rendering_on_GPUs/Path_Tracer_Implementation.html#sec:gpu-camera-rays">15.3.3</a>.

</p>
<p>After the filter&rsquo;s <tt>Sample()</tt> method has returned a
<tt>FilterSample</tt>, the image sample position can be found by adding the
filter&rsquo;s sampled offset to the pixel coordinate before a shift of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.972ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0.5</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="779" y="0"></use>
</g>
</svg> in
each dimension accounts for the mapping from discrete to continuous pixel
coordinates (recall Section&nbsp;<a href="../Sampling_and_Reconstruction/Sampling_Theory.html#sec:pixel-concepts">8.1.4</a>).  The filter&rsquo;s weight
is passed along in the <tt>CameraSample</tt> so that it is available to the
<a href="../Cameras_and_Film/Film_and_Imaging.html#Film"><tt>Film</tt></a> when its <tt>AddSample()</tt> method
is called.

</p>
<p></p>
<span class="anchor" id="fragment-InitializemonoCameraSamplemembervariables-0"></span><div class="fragmentname">&lt;&lt;Initialize <tt>CameraSample</tt> member variables&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::pFilm" class="code">pFilm</a> = pPixel + fs.<a href="#FilterSample::p" class="code">p</a> + <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a>(0.5f, 0.5f);
cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::time" class="code">time</a> = sampler.<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler::Get1D" class="code">Get1D</a>();
cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::pLens" class="code">pLens</a> = sampler.<a href="../Sampling_and_Reconstruction/Sampling_Interface.html#Sampler::Get2D" class="code">Get2D</a>();
cs.<a href="../Cameras_and_Film/Camera_Interface.html#CameraSample::filterWeight" class="code">filterWeight</a> = fs.<a href="#FilterSample::weight" class="code">weight</a>;</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#FilterSampler"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="FilterSampler"></span><h3>8.8.2  FilterSampler</h3><p>


</p>
<p>Not all <tt>Filter</tt>s are able to easily sample from the distributions of
their filter functions.  Therefore, <tt>pbrt</tt> provides a <tt>FilterSampler</tt>
class that wraps up the details of sampling based on a tabularized
representation of the filter.

</p>
<p></p>
<span class="anchor" id="fragment-FilterSamplerDefinition-0"></span><div class="fragmentname">&lt;&lt;FilterSampler Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="FilterSampler"></span>FilterSampler {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FilterSamplerPublicMethods-0">FilterSampler Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1208" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1208"><i></i></a><div id="fragbit-1208" class="collapse"><div class="fragmentcode">       <a href="#FilterSampler" class="code">FilterSampler</a>(<a href="#Filter" class="code">Filter</a> filter, Allocator alloc = {});
       std::string ToString() const;
       <a href="#FilterSample" class="code">FilterSample</a> <a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           Float pdf;
           <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> pi;
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p = <a href="#FilterSampler::distrib" class="code">distrib</a>.<a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D::Sample" class="code">Sample</a>(u, &amp;pdf, &amp;pi);
           return <a href="#FilterSample" class="code">FilterSample</a>{p, <a href="#FilterSampler::f" class="code">f</a>[pi] / pdf};
       }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-FilterSamplerPrivateMembers-0">FilterSampler Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1209" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1209"><i></i></a><div id="fragbit-1209" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds2f" class="code">Bounds2f</a> domain;
       <a href="../Utilities/Containers_and_Memory_Management.html#Array2D" class="code">Array2D</a>&lt;Float&gt; f;
       <a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D" class="code">PiecewiseConstant2D</a> distrib;</div></div>
};</div><p>


</p>
<p>

</p>
<p>Only the <tt>Filter</tt> and an allocator are provided to the constructor.
We have not found it particularly useful to allow the caller to specify the
rate at which the filter function is sampled to construct the table used
for sampling, so instead hardcode a sampling rate of 32 times per unit
filter extent in each dimension.

</p>
<p></p>
<span class="anchor" id="fragment-FilterSamplerMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;FilterSampler Method Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#FilterSampler" class="code">FilterSampler</a>::<a href="#FilterSampler" class="code">FilterSampler</a>(<a href="#Filter" class="code">Filter</a> filter, Allocator alloc)
    : domain(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(-filter.<a href="#Filter::Radius" class="code">Radius</a>()), <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(filter.<a href="#Filter::Radius" class="code">Radius</a>())),
      f(int(32 * filter.<a href="#Filter::Radius" class="code">Radius</a>().x), int(32 * filter.<a href="#Filter::Radius" class="code">Radius</a>().y), alloc),
      distrib(alloc) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Tabularizeunnormalizedfilterfunctioninmonof-0">Tabularize unnormalized filter function in <tt>f</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1210" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1210"><i></i></a><div id="fragbit-1210" class="collapse"><div class="fragmentcode">       for (int y = 0; y &lt; <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::YSize" class="code">YSize</a>(); ++y)
           for (int x = 0; x &lt; <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::XSize" class="code">XSize</a>(); ++x) {
               <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p = <a href="#FilterSampler::domain" class="code">domain</a>.<a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>((x + 0.5f) / <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::XSize" class="code">XSize</a>(),
                                               (y + 0.5f) / <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::YSize" class="code">YSize</a>()));
               <a href="#FilterSampler::f" class="code">f</a>(x, y) = filter.<a href="#Filter::Evaluate" class="code">Evaluate</a>(p);
           }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computesamplingdistributionforfilter-0">Compute sampling distribution for filter</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1211" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1211"><i></i></a><div id="fragbit-1211" class="collapse"><div class="fragmentcode">       <a href="#FilterSampler::distrib" class="code">distrib</a> = <a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D" class="code">PiecewiseConstant2D</a>(<a href="#FilterSampler::f" class="code">f</a>, <a href="#FilterSampler::domain" class="code">domain</a>, alloc);</div></div>
}</div><p>


</p>
<p><tt>domain</tt> gives the bounds of the filter and <tt>f</tt> stores
tabularized filter function values.

</p>
<p></p>
<span class="anchor" id="fragment-FilterSamplerPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;FilterSampler Private Members&gt;&gt;=&nbsp;<a href="#fragment-FilterSamplerPrivateMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Bounding_Boxes.html#Bounds2f" class="code">Bounds2f</a> <span class="anchor" id="FilterSampler::domain"></span>domain;
<a href="../Utilities/Containers_and_Memory_Management.html#Array2D" class="code">Array2D</a>&lt;Float&gt; <span class="anchor" id="FilterSampler::f"></span>f;</div><p>


</p>
<p>All the filters currently implemented in <tt>pbrt</tt> are symmetric about the
origin, which means that they could be tabularized over a single <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg>
quadrant.  Further, they are all separable into the product of two 1D
functions.  Either of these properties could be exploited to
reduce the amount of storage required for the tables used for sampling.
However, to allow full flexibility with the definition of additional filter
functions, the <a href="#FilterSampler"><tt>FilterSampler</tt></a> simply evaluates the filter at
equally spaced positions over its entire domain to initialize the <tt>f</tt>
array.

</p>
<p></p>
<span class="anchor" id="fragment-Tabularizeunnormalizedfilterfunctioninmonof-0"></span><div class="fragmentname">&lt;&lt;Tabularize unnormalized filter function in <tt>f</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">for (int y = 0; y &lt; <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::YSize" class="code">YSize</a>(); ++y)
    for (int x = 0; x &lt; <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::XSize" class="code">XSize</a>(); ++x) {
        <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p = <a href="#FilterSampler::domain" class="code">domain</a>.<a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>((x + 0.5f) / <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::XSize" class="code">XSize</a>(),
                                        (y + 0.5f) / <a href="#FilterSampler::f" class="code">f</a>.<a href="../Utilities/Containers_and_Memory_Management.html#Array2D::YSize" class="code">YSize</a>()));
        <a href="#FilterSampler::f" class="code">f</a>(x, y) = filter.<a href="#Filter::Evaluate" class="code">Evaluate</a>(p);
    }</div><p>


</p>
<p>Given a tabularized function, it is easy to initialize the sampling
distribution.

</p>
<p></p>
<span class="anchor" id="fragment-Computesamplingdistributionforfilter-0"></span><div class="fragmentname">&lt;&lt;Compute sampling distribution for filter&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#FilterSampler::distrib" class="code">distrib</a> = <a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D" class="code">PiecewiseConstant2D</a>(<a href="#FilterSampler::f" class="code">f</a>, <a href="#FilterSampler::domain" class="code">domain</a>, alloc);</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-FilterSamplerPrivateMembers-1"></span><div class="fragmentname">&lt;&lt;FilterSampler Private Members&gt;&gt;+=&nbsp;<a href="#fragment-FilterSamplerPrivateMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode"><a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D" class="code">PiecewiseConstant2D</a> <span class="anchor" id="FilterSampler::distrib"></span>distrib;</div><p>


</p>
<p>There are two important details in the implementation of its
<tt>Sample()</tt> method.  First, the implementation does not
use <a href="#Filter::Evaluate"><tt>Filter::Evaluate()</tt></a> to evaluate the filter function but instead
uses the tabularized version of it in <tt>f</tt>.  By using the piecewise
constant approximation of the filter function, it ensures that the returned
weight <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.622ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5003.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis normal p prime right-parenthesis slash p left-parenthesis normal p prime right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
<g transform="translate(942,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1886" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="2276" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="2776" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3280" y="0"></use>
<g transform="translate(3669,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4614" y="0"></use>
</g>
</svg> for a sampled point <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.194ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 944.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal p prime</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-70" d="M521 216c0 -129 -104 -227 -223 -227c-76 0 -118 54 -123 70v-9v-168c0 -45 11 -45 78 -45v-31l-113 3l-112 -3v31c67 0 78 0 78 45v468c0 44 -7 50 -78 50v31l144 11v-66c20 22 62 66 140 66c112 0 209 -99 209 -226zM438 216c0 113 -61 201 -134 201 c-51 0 -100 -29 -129 -80v-223c0 -20 0 -21 14 -42c27 -41 65 -61 105 -61c74 0 144 84 144 205Z"></path>
<path stroke-width="1" id="E1-LATINMODERNVARIANTS-2032" d="M340 496c0 -10 -3 -20 -8 -28l-227 -372h-38l171 424c6 15 26 29 48 29c30 0 54 -24 54 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNVARIANTS-2032" x="787" y="513"></use>
</g>
</svg> is always <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.815ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1212 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus-or-minus c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-B1" d="M722 -64c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-B1" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="778" y="0"></use>
</g>
</svg> for a
constant <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 433.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
</g>
</svg>.  If it did not do this, there
would be variation in the returned weight for non-constant filter functions,
due to the sampling distribution not being exactly proportional to the
filter function&mdash;see Figure&nbsp;<a href="#fig:filter-sampler-zero-crossing-challenge">8.50</a>, which
illustrates the issue.

</p>
<p></p>
<span class="anchor" id="fig:filter-sampler-zero-crossing-challenge"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f50.svg" title=""><img src="pha08f50.svg" width=369 height=239 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.50: <span class="legend">
Filter function <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.422ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1904 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
</g>
</svg> and a piecewise-constant sampling distribution
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.382ex" height="2.843ex" style="vertical-align: -0.838ex; margin-left: -0.073ex;" viewBox="-31.5 -863.1 1886.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">p left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="503" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="893" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1465" y="0"></use>
</g>
</svg> found
by evaluating it at the center of each cell, as is done by the
<a href="#FilterSampler"><tt>FilterSampler</tt></a>.
If filter positions are found by sampling from <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.382ex" height="2.843ex" style="vertical-align: -0.838ex; margin-left: -0.073ex;" viewBox="-31.5 -863.1 1886.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">p left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="503" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="893" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1465" y="0"></use>
</g>
</svg> and contributions are
weighted using the ratio <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.893ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4259.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis slash p left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1904" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="2404" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2908" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="3297" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3870" y="0"></use>
</g>
</svg>, then different samples may have very
different contributions.  For example, the two points shown have a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.133ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1779.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">10 times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="1001" y="0"></use>
</g>
</svg> difference in their <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.893ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4259.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis slash p left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1904" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="2404" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2908" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="3297" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3870" y="0"></use>
</g>
</svg> values.  This variation in filter
weights can lead to variance in images and therefore the 
<a href="#FilterSampler"><tt>FilterSampler</tt></a> uses the same piecewise-constant approximation of
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.422ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1904 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
</g>
</svg> for evaluation as is used for sampling.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>A second important detail is that the integer coordinates of the sample returned by
<a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D::Sample"><tt>PiecewiseConstant2D::Sample()</tt></a> are used to index into <tt>f</tt> for
filter function evaluation.  If
instead the point <tt>p</tt> was scaled up by the
size of the <tt>f</tt> array in each dimension and converted to an integer,
the result would occasionally differ from the integer coordinates computed during
sampling by <a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D"><tt>PiecewiseConstant2D</tt></a> due to floating-point round-off error.
(Using the notation of Section&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#sec:ieee-fp">6.8.1</a>, the issue is that with
floating-point arithmetic, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.338ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10479 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis a circled-division-slash b right-parenthesis circled-times b not-equals left-parenthesis a slash b right-parenthesis b equals a</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44E" d="M498 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-48 0 -83 33 -91 75c-60 -71 -110 -75 -130 -75c-78 0 -133 66 -133 160c0 146 124 293 241 293c45 0 74 -27 92 -64c3 22 18 44 42 44c17 0 29 -10 29 -27c0 -4 0 -6 -7 -34l-36 -140l-22 -90 c-11 -44 -13 -52 -13 -74c0 -20 3 -46 30 -46c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10zM361 332c0 6 -14 88 -79 88c-40 0 -85 -37 -116 -96c-23 -46 -55 -169 -55 -219c0 -39 14 -94 64 -94c28 0 69 16 113 71c15 17 15 19 20 37l50 196c1 5 3 11 3 17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2298" d="M691 250c0 123 -74 229 -180 276l-206 -566c26 -8 55 -12 84 -12c167 0 302 135 302 302zM473 540c-26 8 -55 12 -84 12c-167 0 -302 -135 -302 -302c0 -123 74 -229 180 -276zM731 250c0 -189 -153 -342 -342 -342s-342 153 -342 342s153 342 342 342s342 -153 342 -342 Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2297" d="M691 250c0 76 -28 146 -75 199l-199 -199l199 -199c47 53 75 123 75 199zM588 477c-53 47 -123 75 -199 75s-146 -28 -199 -75l199 -199zM361 250l-199 199c-47 -53 -75 -123 -75 -199s28 -146 75 -199zM588 23l-199 199l-199 -199c53 -47 123 -75 199 -75s146 28 199 75 zM731 250c0 -189 -153 -342 -342 -342s-342 153 -342 342s153 342 342 342s342 -153 342 -342Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2260" d="M722 153c0 -11 -9 -20 -20 -20h-334l-128 -350c-2 -8 -10 -13 -18 -13c-12 0 -20 9 -20 20c0 2 0 5 1 7l122 336h-249c-11 0 -20 9 -20 20s9 20 20 20h264l56 154h-320c-11 0 -20 9 -20 20s9 20 20 20h334l128 350c2 8 10 13 19 13c11 0 20 -9 20 -20c0 -2 -1 -5 -2 -7 l-122 -336h249c11 0 20 -9 20 -20s-9 -20 -20 -20h-264l-56 -154h320c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2298" x="1141" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2141" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2571" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2297" x="3183" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="4183" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2260" x="4891" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5947" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="6336" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="6866" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="7366" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7796" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="8185" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="8893" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44E" x="9949" y="0"></use>
</g>
</svg>.)
Again, variance would result, as the ratio <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.893ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4259.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis slash p left-parenthesis x right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1904" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="2404" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2908" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="3297" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3870" y="0"></use>
</g>
</svg> might not be <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.815ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 1212 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus-or-minus c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-B1" d="M722 -64c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-B1" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="778" y="0"></use>
</g>
</svg>.
 
</p>
<span class="anchor" id="fragment-FilterSamplerPublicMethods-0"></span><div class="fragmentname">&lt;&lt;FilterSampler Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#FilterSample" class="code">FilterSample</a> <span class="anchor" id="FilterSampler::Sample"></span><a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    Float pdf;
    <a href="../Geometry_and_Transformations/Points.html#Point2i" class="code">Point2i</a> pi;
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p = <a href="#FilterSampler::distrib" class="code">distrib</a>.<a href="../Sampling_Algorithms/Sampling_Multidimensional_Functions.html#PiecewiseConstant2D::Sample" class="code">Sample</a>(u, &amp;pdf, &amp;pi);
    return <a href="#FilterSample" class="code">FilterSample</a>{p, <a href="#FilterSampler::f" class="code">f</a>[pi] / pdf};
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#BoxFilter"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="BoxFilter"></span><h3>8.8.3  Box Filter</h3><p>


</p>
<p>One of the most commonly used filters in graphics is the <em>box filter</em>
(and, in fact, when filtering and reconstruction are not addressed
explicitly, the box filter is the <em>de facto</em> result).  The box filter
equally weights all samples within a square region of the image.  Although
computationally efficient, it is just about the worst filter possible.
Recall from the discussion in Section&nbsp;<a href="../Sampling_and_Reconstruction/Sampling_Theory.html#sec:ideal-sampling">8.1.2</a> that the box
filter allows high-frequency sample data to leak into the reconstructed
values.  This causes postaliasing&mdash;even if the original sample values were
at a high enough frequency to avoid aliasing, errors are introduced by poor
filtering.

</p>
<p></p>
<span class="anchor" id="fig:box-tri-filter"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f51.svg" title=""><img src="pha08f51.svg" width=740 height=255 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.51: <span class="legend"> Graphs of the (a) box filter  and (b)
triangle filter.  Although neither of these is a particularly good
filter, they are both computationally efficient, easy to implement, and
good baselines for evaluating other filters.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fig:box-recon-examples"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f52.svg" title=""><img src="pha08f52.svg" width=444 height=635 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.52: <span class="legend"> The box filter 
reconstructing (a)&nbsp;a step function and (b)&nbsp;a sinusoidal function with increasing
frequency as <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> increases.  This filter does well with the
step function,  as expected, but does an extremely poor job with the sinusoidal
function.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Figure&nbsp;<a href="#fig:box-tri-filter">8.51</a>(a) shows a graph of the box filter, and
Figure&nbsp;<a href="#fig:box-recon-examples">8.52</a> shows the result of using the box
filter to reconstruct two
1D functions.  

</p>
<p>For the step function we used previously to illustrate the Gibbs
phenomenon, the box does reasonably well.  However, the results are much worse
for a sinusoidal function that has increasing frequency along the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> axis.
Not only does the box filter do a poor job of reconstructing the function when
the frequency is low, giving a discontinuous result even though the
original function was smooth, but it also does an extremely poor job of
reconstruction as the function&rsquo;s frequency approaches and passes the Nyquist
limit.

</p>
<p></p>
<span class="anchor" id="fragment-BoxFilterDefinition-0"></span><div class="fragmentname">&lt;&lt;BoxFilter Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="BoxFilter"></span>BoxFilter {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-BoxFilterPublicMethods-0">BoxFilter Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1212" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1212"><i></i></a><div id="fragbit-1212" class="collapse"><div class="fragmentcode">       BoxFilter(<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <a href="#BoxFilter::radius" class="code">radius</a> = <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a>(0.5, 0.5)) : <a href="#BoxFilter::radius" class="code">radius</a>(<a href="#BoxFilter::radius" class="code">radius</a>) {}
       
       static BoxFilter *Create(const ParameterDictionary &amp;parameters, const FileLoc *loc,
                                Allocator alloc);
       
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> Radius() const { return <a href="#BoxFilter::radius" class="code">radius</a>; }
       
       std::string ToString() const;
       Float Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
           return (std::abs(p.x) &lt;= <a href="#BoxFilter::radius" class="code">radius</a>.x &amp;&amp; std::abs(p.y) &lt;= <a href="#BoxFilter::radius" class="code">radius</a>.y) ? 1 : 0;
       }
       FilterSample Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p(<a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[0], -<a href="#BoxFilter::radius" class="code">radius</a>.x, <a href="#BoxFilter::radius" class="code">radius</a>.x),
                     <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[1], -<a href="#BoxFilter::radius" class="code">radius</a>.y, <a href="#BoxFilter::radius" class="code">radius</a>.y));
           return {p, Float(1)};
       }
       Float Integral() const { return 2 * <a href="#BoxFilter::radius" class="code">radius</a>.x * 2 * <a href="#BoxFilter::radius" class="code">radius</a>.y; }</div></div>
  private:
    <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <span class="anchor" id="BoxFilter::radius"></span>radius;
};</div><p>


</p>
<p>For this filter and all the following ones, we will not include the
rudimentary constructors and <tt>Radius()</tt> method implementations.

</p>
<p>

</p>
<p>Evaluating the box filter requires checking that the given point is inside
the box.

</p>
<p></p>
<span class="anchor" id="fragment-BoxFilterPublicMethods-0"></span><div class="fragmentname">&lt;&lt;BoxFilter Public Methods&gt;&gt;=&nbsp;<a href="#fragment-BoxFilterPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="BoxFilter::Evaluate"></span>Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
    return (std::abs(p.x) &lt;= <a href="#BoxFilter::radius" class="code">radius</a>.x &amp;&amp; std::abs(p.y) &lt;= <a href="#BoxFilter::radius" class="code">radius</a>.y) ? 1 : 0;
}</div><p>


</p>
<p>Sampling is also easy: the random sample <tt>u</tt> is used to linearly
interpolate within the filter&rsquo;s extent.  Since sampling is exact and the
filter function is positive, the weight is always&nbsp;1.

</p>
<p></p>
<span class="anchor" id="fragment-BoxFilterPublicMethods-1"></span><div class="fragmentname">&lt;&lt;BoxFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-BoxFilterPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-BoxFilterPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">FilterSample <span class="anchor" id="BoxFilter::Sample"></span>Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p(<a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[0], -<a href="#BoxFilter::radius" class="code">radius</a>.x, <a href="#BoxFilter::radius" class="code">radius</a>.x),
              <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(u[1], -<a href="#BoxFilter::radius" class="code">radius</a>.y, <a href="#BoxFilter::radius" class="code">radius</a>.y));
    return {p, Float(1)};
}</div><p>


</p>
<p>Finally, the integral is equal to the filter&rsquo;s area.

</p>
<p></p>
<span class="anchor" id="fragment-BoxFilterPublicMethods-2"></span><div class="fragmentname">&lt;&lt;BoxFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-BoxFilterPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="BoxFilter::Integral"></span>Integral() const { return 2 * <a href="#BoxFilter::radius" class="code">radius</a>.x * 2 * <a href="#BoxFilter::radius" class="code">radius</a>.y; }</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#TriangleFilter"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="TriangleFilter"></span><h3>8.8.4  Triangle Filter</h3><p>


</p>
<p>The triangle filter gives slightly better results than the box: the weight
falls off linearly from the filter center over the square extent of the
filter. See Figure&nbsp;<a href="#fig:box-tri-filter">8.51</a>(b) for a graph of the triangle
filter.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleFilterDefinition-0"></span><div class="fragmentname">&lt;&lt;TriangleFilter Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="TriangleFilter"></span>TriangleFilter {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-TriangleFilterPublicMethods-0">TriangleFilter Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1213" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1213"><i></i></a><div id="fragbit-1213" class="collapse"><div class="fragmentcode">       TriangleFilter(<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <a href="#TriangleFilter::radius" class="code">radius</a>) : <a href="#TriangleFilter::radius" class="code">radius</a>(<a href="#TriangleFilter::radius" class="code">radius</a>) {}
       
       static TriangleFilter *Create(const ParameterDictionary &amp;parameters,
                                     const FileLoc *loc, Allocator alloc);
       
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> Radius() const { return <a href="#TriangleFilter::radius" class="code">radius</a>; }
       
       std::string ToString() const;
       Float Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
           return std::max&lt;Float&gt;(0, <a href="#TriangleFilter::radius" class="code">radius</a>.x - std::abs(p.x)) *
                  std::max&lt;Float&gt;(0, <a href="#TriangleFilter::radius" class="code">radius</a>.y - std::abs(p.y));
       }
       <a href="#FilterSample" class="code">FilterSample</a> Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
           return {<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="../Sampling_Algorithms/Sampling_1D_Functions.html#SampleTent" class="code">SampleTent</a>(u[0], <a href="#TriangleFilter::radius" class="code">radius</a>.x),
                           <a href="../Sampling_Algorithms/Sampling_1D_Functions.html#SampleTent" class="code">SampleTent</a>(u[1], <a href="#TriangleFilter::radius" class="code">radius</a>.y)), Float(1)};
       }
       Float Integral() const { return <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="#TriangleFilter::radius" class="code">radius</a>.x) * <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="#TriangleFilter::radius" class="code">radius</a>.y); }</div></div>
  private:
    <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <span class="anchor" id="TriangleFilter::radius"></span>radius;
};</div><p>


</p>
<p>

</p>
<p>Evaluating the triangle filter is simple: it is the product of two linear
functions that go to&nbsp;0 after the width of the filter in both the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>
directions.  Here we have defined the filter to have a slope of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.971ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 1279 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus-or-minus 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-B1" d="M722 -64c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-B1" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="778" y="0"></use>
</g>
</svg>,
though the filter could alternatively have been defined to have a value of
1 at the origin and a slope that depends on the radius.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleFilterPublicMethods-0"></span><div class="fragmentname">&lt;&lt;TriangleFilter Public Methods&gt;&gt;=&nbsp;<a href="#fragment-TriangleFilterPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="TriangleFilter::Evaluate"></span>Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
    return std::max&lt;Float&gt;(0, <a href="#TriangleFilter::radius" class="code">radius</a>.x - std::abs(p.x)) *
           std::max&lt;Float&gt;(0, <a href="#TriangleFilter::radius" class="code">radius</a>.y - std::abs(p.y));
}</div><p>


</p>
<p>Because the filter is separable, its PDF is as well, and so each dimension
can be sampled independently.  The sampling method uses a separate
<tt>SampleTent()</tt> utility function that is defined in
Section&nbsp;<a href="../Sampling_Algorithms/Sampling_1D_Functions.html#sec:sampling-tent-function">A.4.1</a>.
Once again, the weight returned in
the <a href="#FilterSample"><tt>FilterSample</tt></a> is always&nbsp;1 because the filter is positive and
sampling is exact.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleFilterPublicMethods-1"></span><div class="fragmentname">&lt;&lt;TriangleFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TriangleFilterPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-TriangleFilterPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#FilterSample" class="code">FilterSample</a> <span class="anchor" id="TriangleFilter::Sample"></span>Sample(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const {
    return {<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="../Sampling_Algorithms/Sampling_1D_Functions.html#SampleTent" class="code">SampleTent</a>(u[0], <a href="#TriangleFilter::radius" class="code">radius</a>.x),
                    <a href="../Sampling_Algorithms/Sampling_1D_Functions.html#SampleTent" class="code">SampleTent</a>(u[1], <a href="#TriangleFilter::radius" class="code">radius</a>.y)), Float(1)};
}</div><p>


</p>
<p>Finally, the triangle filter is easily integrated.

</p>
<p></p>
<span class="anchor" id="fragment-TriangleFilterPublicMethods-2"></span><div class="fragmentname">&lt;&lt;TriangleFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-TriangleFilterPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="TriangleFilter::Integral"></span>Integral() const { return <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="#TriangleFilter::radius" class="code">radius</a>.x) * <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(<a href="#TriangleFilter::radius" class="code">radius</a>.y); }</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#GaussianFilter"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="GaussianFilter"></span><h3>8.8.5  Gaussian Filter</h3><p>


</p>
<p>Unlike the box and triangle filters, the Gaussian filter gives a reasonably
good result in practice.  This filter applies a Gaussian bump that is
centered at the pixel and radially symmetric around it.
Figure&nbsp;<a href="#fig:gaussian-mitchell-filter">8.53</a> compares plots of the Gaussian
filter and the Mitchell filter (described in Section&nbsp;<a href="#sec:Mitchell-filter">8.8.6</a>).
The Gaussian does tend to cause slight
blurring of the final image compared to some of the other filters, but this
blurring can help mask any remaining aliasing.  This filter is the
default one used in <tt>pbrt</tt>.

</p>
<p> </p>
<span class="anchor" id="fig:gaussian-mitchell-filter"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f53.svg" title=""><img src="pha08f53.svg" width=717 height=264 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.53: <span class="legend"> Graphs of (a)&nbsp;the Gaussian filter
 and (b)&nbsp;the Mitchell filter with <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.521ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 2807.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper B equals one-third</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1037" y="0"></use>
<g transform="translate(1815,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="84" y="-589"></use>
</g>
</g>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.523ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 2808.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper C equals one-third</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D436" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-89 0 -183 -50 -244 -121c-100 -117 -121 -279 -121 -336c0 -156 106 -208 196 -208c52 0 115 17 184 73c69 58 92 129 101 158c2 8 7 10 13 10c0 0 12 0 12 -10 c0 -3 -17 -94 -110 -176c-53 -46 -129 -86 -216 -86c-153 0 -271 109 -271 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D436" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1038" y="0"></use>
<g transform="translate(1816,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="84" y="-589"></use>
</g>
</g>
</g>
</svg>, each with
a width of&nbsp;2.  The Gaussian gives images that
tend to be a bit blurry, while the negative lobes of the Mitchell filter
help to accentuate and sharpen edges in final images.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-GaussianFilterDefinition-0"></span><div class="fragmentname">&lt;&lt;GaussianFilter Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="GaussianFilter"></span>GaussianFilter {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-GaussianFilterPublicMethods-0">GaussianFilter Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1214" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1214"><i></i></a><div id="fragbit-1214" class="collapse"><div class="fragmentcode">       GaussianFilter(<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <a href="#GaussianFilter::radius" class="code">radius</a>, Float <a href="#GaussianFilter::sigma" class="code">sigma</a> = 0.5f, <a href="../Introduction/Using_and_Understanding_the_Code.html#Allocator" class="code">Allocator</a> alloc = {})
           : <a href="#GaussianFilter::radius" class="code">radius</a>(<a href="#GaussianFilter::radius" class="code">radius</a>), <a href="#GaussianFilter::sigma" class="code">sigma</a>(<a href="#GaussianFilter::sigma" class="code">sigma</a>), <a href="#GaussianFilter::expX" class="code">expX</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(<a href="#GaussianFilter::radius" class="code">radius</a>.x, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>)),
             <a href="#GaussianFilter::expY" class="code">expY</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(<a href="#GaussianFilter::radius" class="code">radius</a>.y, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>)), <a href="#GaussianFilter::sampler" class="code">sampler</a>(this, alloc) {}
       static GaussianFilter *Create(const ParameterDictionary &amp;parameters,
                                     const FileLoc *loc, <a href="../Introduction/Using_and_Understanding_the_Code.html#Allocator" class="code">Allocator</a> alloc);
       
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> Radius() const { return <a href="#GaussianFilter::radius" class="code">radius</a>; }
       
       std::string ToString() const;
       Float Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
           return (std::max&lt;Float&gt;(0, <a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(p.x, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) - <a href="#GaussianFilter::expX" class="code">expX</a>) *
                   std::max&lt;Float&gt;(0, <a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(p.y, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) - <a href="#GaussianFilter::expY" class="code">expY</a>));
       }
       Float Integral() const {
           return ((<a href="../Utilities/Mathematical_Infrastructure.html#GaussianIntegral" class="code">GaussianIntegral</a>(-<a href="#GaussianFilter::radius" class="code">radius</a>.x, <a href="#GaussianFilter::radius" class="code">radius</a>.x, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) -
                    2 * <a href="#GaussianFilter::radius" class="code">radius</a>.x * <a href="#GaussianFilter::expX" class="code">expX</a>) *
                   (<a href="../Utilities/Mathematical_Infrastructure.html#GaussianIntegral" class="code">GaussianIntegral</a>(-<a href="#GaussianFilter::radius" class="code">radius</a>.y, <a href="#GaussianFilter::radius" class="code">radius</a>.y, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) -
                    2 * <a href="#GaussianFilter::radius" class="code">radius</a>.y * <a href="#GaussianFilter::expY" class="code">expY</a>));
       }
       FilterSample <a href="#FilterSampler::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const { return <a href="#GaussianFilter::sampler" class="code">sampler</a>.<a href="#FilterSampler::Sample" class="code">Sample</a>(u); }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-GaussianFilterPrivateMembers-0">GaussianFilter Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1215" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1215"><i></i></a><div id="fragbit-1215" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> radius;
       Float sigma, expX, expY;
       <a href="#FilterSampler" class="code">FilterSampler</a> sampler;</div></div>
};</div><p>


</p>
<p>The <em>Gaussian function</em> is parameterized by the position of the peak <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.402ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 603.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">mu</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D707" d="M572 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-44 0 -81 28 -90 73c-24 -28 -63 -73 -133 -73c-20 0 -65 4 -97 31c-38 -154 -51 -206 -55 -215c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l144 579c9 35 37 36 40 36c17 0 29 -10 29 -27 c0 -5 -10 -43 -15 -64l-42 -168c-7 -28 -14 -56 -14 -85c0 -54 24 -87 74 -87c81 0 129 91 130 96l26 102l47 187c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104c0 -20 3 -46 30 -46 c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D707" x="0" y="0"></use>
</g>
</svg>
and the standard deviation <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.327ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 571.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sigma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="0" y="0"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.256ex" height="7.176ex" style="vertical-align: -2.838ex;" viewBox="0 -1867.7 12165.7 3089.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">g left-parenthesis x comma mu comma sigma right-parenthesis equals StartFraction 1 Over StartRoot 2 pi sigma squared EndRoot EndFraction normal e Superscript minus StartFraction left-parenthesis x minus mu right-parenthesis squared Over 2 sigma squared EndFraction Baseline period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D707" d="M572 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-44 0 -81 28 -90 73c-24 -28 -63 -73 -133 -73c-20 0 -65 4 -97 31c-38 -154 -51 -206 -55 -215c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l144 579c9 35 37 36 40 36c17 0 29 -10 29 -27 c0 -5 -10 -43 -15 -64l-42 -168c-7 -28 -14 -56 -14 -85c0 -54 24 -87 74 -87c81 0 129 91 130 96l26 102l47 187c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104c0 -20 3 -46 30 -46 c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-221A" d="M853 20c0 -5 -1 -6 -6 -17l-456 -944c-7 -15 -9 -19 -25 -19c-11 0 -13 1 -19 15l-198 435l-52 -39c-9 -8 -11 -8 -14 -8c-6 0 -10 4 -10 11c0 4 1 5 12 14l99 75c9 8 11 8 14 8c7 0 9 -6 13 -14l178 -392l423 876c6 12 9 19 21 19s20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="477" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="867" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1439" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D707" x="1884" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2488" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="2933" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3504" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="4172" y="0"></use>
<g transform="translate(4950,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="3049" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1274" y="676"></use>
<g transform="translate(60,-961)">
 <use xlink:href="#E1-LATINMODERNMAIN-221A" x="0" y="840"></use>
<rect stroke="none" width="2096" height="60" x="833" y="821"></rect>
<g transform="translate(833,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="500" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="808" y="408"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(8518,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="0" y="0"></use>
<g transform="translate(444,681)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2212" x="0" y="0"></use>
<g transform="translate(550,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="2033" height="60" x="0" y="146"></rect>
<g transform="translate(60,514)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-2212" x="962" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D707" x="1740" y="0"></use>
<g transform="translate(1345,0)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="389" y="362"></use>
</g>
</g>
<g transform="translate(536,-567)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(287,0)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-32" x="571" y="288"></use>
</g>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="11887" y="0"></use>
</g>
</svg>
</div>
<p>

Larger values of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.327ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 571.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">sigma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="0" y="0"></use>
</g>
</svg>
cause a slower falloff, which leads to a blurrier image when the Gaussian
is used as a filter.

</p>
<p>The <tt>GaussianFilter</tt> is centered at the origin, so <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.663ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 2438.1 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">mu equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D707" d="M572 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-44 0 -81 28 -90 73c-24 -28 -63 -73 -133 -73c-20 0 -65 4 -97 31c-38 -154 -51 -206 -55 -215c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l144 579c9 35 37 36 40 36c17 0 29 -10 29 -27 c0 -5 -10 -43 -15 -64l-42 -168c-7 -28 -14 -56 -14 -85c0 -54 24 -87 74 -87c81 0 129 91 130 96l26 102l47 187c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104c0 -20 3 -46 30 -46 c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D707" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="881" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1937" y="0"></use>
</g>
</svg>.  Further,
the filter function subtracts the
value of the Gaussian at the end of its extent <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 451.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
</g>
</svg> from the filter value in order
to make the filter go to&nbsp;0 at its limit:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:gaussian-filter-function"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.175ex" height="5.509ex" style="vertical-align: -2.171ex;" viewBox="0 -1437.2 19019.7 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis x right-parenthesis equals StartLayout Enlarged left-brace 1st Row 1st Column g left-parenthesis x comma 0 comma sigma right-parenthesis minus g left-parenthesis r comma 0 comma sigma right-parenthesis 2nd Column StartAbsoluteValue x EndAbsoluteValue less-than r 2nd Row 1st Column 0 2nd Column otherwise period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-77" d="M703 400c-35 -1 -66 -14 -84 -64l-117 -328c-4 -10 -7 -19 -20 -19s-16 8 -20 19l-102 284l-101 -283c-5 -14 -7 -20 -20 -20s-16 8 -21 22l-126 354c-12 32 -24 35 -74 35v31l93 -3l109 3v-31c-20 0 -59 0 -59 -27c0 -4 0 -6 5 -18l95 -267l86 242c-7 19 -18 49 -23 55 c-10 13 -26 15 -63 15v31c30 -2 59 -3 89 -3l104 3v-31c-20 0 -59 0 -59 -27c0 -5 1 -7 5 -19l99 -279l91 256c5 13 5 15 5 21c0 29 -22 47 -58 48v31l93 -3c22 0 51 1 73 3v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-7B" d="M608 -780c0 -11 -9 -20 -20 -20c-2 0 -3 0 -5 1c-145 37 -273 148 -273 261v526c0 99 -81 213 -195 243c-9 2 -15 10 -15 19s6 17 15 19c114 30 195 144 195 243v526c0 113 128 224 273 261c2 1 3 1 5 1c11 0 20 -9 20 -20c0 -9 -6 -17 -15 -19 c-114 -29 -195 -134 -195 -223v-526c0 -108 -96 -212 -215 -262c119 -50 215 -154 215 -262v-526c0 -89 81 -194 195 -223c9 -2 15 -10 15 -19Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2181" y="0"></use>
<g transform="translate(3238,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-7B"></use>
<g transform="translate(874,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,525)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="477" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="867" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1439" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1884" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2385" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="2830" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3401" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="4013" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="5014" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5491" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="5881" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="6332" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="6777" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="7278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="7723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="8295" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-626"></use>
</g>
<g transform="translate(9674,0)">
<g transform="translate(0,525)">
<g transform="translate(332,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="851" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="2463" y="0"></use>
</g>
</g>
<g transform="translate(0,-626)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="332" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-68" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="2223" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-77" x="2615" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="3338" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="3616" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="4011" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="4455" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:gaussian-filter-function">8.26</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

For efficiency, the constructor precomputes the constant term for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.525ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3670.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">g left-parenthesis r comma 0 comma sigma right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="477" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="867" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1318" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2264" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="2709" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3280" y="0"></use>
</g>
</svg> in
each direction.

</p>
<p></p>
<span class="anchor" id="fragment-GaussianFilterPublicMethods-0"></span><div class="fragmentname">&lt;&lt;GaussianFilter Public Methods&gt;&gt;=&nbsp;<a href="#fragment-GaussianFilterPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">GaussianFilter(<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> radius, Float sigma = 0.5f, <a href="../Introduction/Using_and_Understanding_the_Code.html#Allocator" class="code">Allocator</a> alloc = {})
    : radius(radius), sigma(sigma), expX(<a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(radius.x, 0, sigma)),
      expY(<a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(radius.y, 0, sigma)), sampler(this, alloc) {}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-GaussianFilterPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;GaussianFilter Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <span class="anchor" id="GaussianFilter::radius"></span>radius;
Float <span class="anchor" id="GaussianFilter::sigma"></span>sigma, <span class="anchor" id="GaussianFilter::expX"></span>expX, <span class="anchor" id="GaussianFilter::expY"></span>expY;
<a href="#FilterSampler" class="code">FilterSampler</a> <span class="anchor" id="GaussianFilter::sampler"></span>sampler;</div><p>


</p>
<p>

</p>
<p>The product of the two 1D Gaussian functions gives the overall filter value
according to Equation&nbsp;(<a href="#eq:gaussian-filter-function">8.26</a>).  The calls to
<tt>std::max()</tt> ensure that the value of&nbsp;0 is returned for points outside
of the filter&rsquo;s extent.

</p>
<p></p>
<span class="anchor" id="fragment-GaussianFilterPublicMethods-1"></span><div class="fragmentname">&lt;&lt;GaussianFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-GaussianFilterPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-GaussianFilterPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="GaussianFilter::Evaluate"></span>Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
    return (std::max&lt;Float&gt;(0, <a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(p.x, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) - <a href="#GaussianFilter::expX" class="code">expX</a>) *
            std::max&lt;Float&gt;(0, <a href="../Utilities/Mathematical_Infrastructure.html#Gaussian" class="code">Gaussian</a>(p.y, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) - <a href="#GaussianFilter::expY" class="code">expY</a>));
}</div><p>


</p>
<p>The integral of the Gaussian is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.534ex" height="6.509ex" style="vertical-align: -2.838ex;" viewBox="0 -1580.7 14438 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">integral g left-parenthesis x comma mu comma sigma right-parenthesis normal d x equals one-half e r f left-parenthesis StartFraction mu minus x Over StartRoot italic 2 EndRoot sigma EndFraction right-parenthesis italic comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D707" d="M572 143c0 0 -13 -63 -30 -99c-16 -32 -39 -55 -74 -55c-44 0 -81 28 -90 73c-24 -28 -63 -73 -133 -73c-20 0 -65 4 -97 31c-38 -154 -51 -206 -55 -215c-2 -3 -14 -21 -35 -21c-17 0 -28 12 -28 27c0 0 0 4 3 16l144 579c9 35 37 36 40 36c17 0 29 -10 29 -27 c0 -5 -10 -43 -15 -64l-42 -168c-7 -28 -14 -56 -14 -85c0 -54 24 -87 74 -87c81 0 129 91 130 96l26 102l47 187c8 34 34 35 39 35c15 0 29 -9 29 -27c0 -6 -10 -44 -15 -67c-4 -15 -14 -53 -17 -68l-28 -108c-8 -35 -20 -82 -20 -104c0 -20 3 -46 30 -46 c41 0 59 59 76 124c3 14 4 18 14 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70E" d="M567 407c0 -34 -36 -34 -49 -34h-110c31 -44 31 -92 31 -109c0 -154 -133 -275 -251 -275c-91 0 -150 70 -150 158c0 119 111 284 262 284h228c18 0 39 0 39 -24zM375 276c0 31 -8 97 -92 97c-34 0 -94 -14 -136 -83c-35 -59 -47 -141 -47 -171c0 -72 40 -108 89 -108 c39 0 93 26 132 85c34 51 54 133 54 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-66" d="M357 635c0 -24 -15 -44 -44 -44c-27 0 -43 20 -43 43c0 25 18 38 30 42c-15 7 -30 7 -33 7c-44 0 -92 -48 -92 -136v-116h117v-31h-114v-322c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v324h-79v31h79v115c0 106 85 159 155 159 c53 0 90 -33 90 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-221A" d="M853 20c0 -5 -1 -6 -6 -17l-456 -944c-7 -15 -9 -19 -25 -19c-11 0 -13 1 -19 15l-198 435l-52 -39c-9 -8 -11 -8 -14 -8c-6 0 -10 4 -10 11c0 4 1 5 12 14l99 75c9 8 11 8 14 8c7 0 9 -6 13 -14l178 -392l423 876c6 12 9 19 21 19s20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-28" d="M682 -928c0 -10 -8 -18 -18 -18c-4 0 -8 2 -11 4c-222 167 -427 613 -427 1006v372c0 393 205 839 427 1006c3 2 7 4 11 4c10 0 18 -8 18 -18c0 -6 -3 -11 -7 -14c-213 -160 -361 -603 -361 -978v-372c0 -375 148 -818 361 -978c4 -3 7 -8 7 -14Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE6-29" d="M510 64c0 -393 -205 -839 -427 -1006c-3 -2 -7 -4 -11 -4c-10 0 -18 8 -18 18c0 6 3 11 7 14c213 160 361 603 361 978v372c0 375 -148 818 -361 978c-4 3 -7 8 -7 14c0 10 8 18 18 18c4 0 8 -2 11 -4c222 -167 427 -613 427 -1006v-372Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="1110" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1587" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1977" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2549" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D707" x="2994" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3598" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="4043" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4615" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5171" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="5727" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="6577" y="0"></use>
<g transform="translate(7356,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="60" y="-687"></use>
</g>
</g>
<g transform="translate(8494,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-66" x="837" y="0"></use>
</g>
<g transform="translate(9804,0)">
 <use xlink:href="#E1-LATINMODERNSIZE6-28"></use>
<g transform="translate(736,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="2474" height="60" x="0" y="220"></rect>
<g transform="translate(60,736)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D707" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="825" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-78" x="1826" y="0"></use>
</g>
<g transform="translate(284,-920)">
 <use xlink:href="#E1-LATINMODERNMAIN-221A" x="0" y="799"></use>
<rect stroke="none" width="500" height="60" x="833" y="780"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="833" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70E" x="1334" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE6-29" x="3451" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="14159" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.774ex" height="2.176ex" style="vertical-align: -0.338ex; margin-right: -0.118ex;" viewBox="0 -791.3 1194.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">e r f</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-66" d="M357 635c0 -24 -15 -44 -44 -44c-27 0 -43 20 -43 43c0 25 18 38 30 42c-15 7 -30 7 -33 7c-44 0 -92 -48 -92 -136v-116h117v-31h-114v-322c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v324h-79v31h79v115c0 106 85 159 155 159 c53 0 90 -33 90 -70Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="444" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-66" x="837" y="0"></use>
</g>
</svg> is the error function.  <a href="../Utilities/Mathematical_Infrastructure.html#GaussianIntegral"><tt>GaussianIntegral()</tt></a> evaluates its
value over a given range.  The filter function&rsquo;s integral can be
computed by evaluating the Gaussian&rsquo;s integral over the filter&rsquo;s
range and subtracting the integral of the offset that takes the filter to
zero at the end of its extent.

</p>
<p></p>
<span class="anchor" id="fragment-GaussianFilterPublicMethods-2"></span><div class="fragmentname">&lt;&lt;GaussianFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-GaussianFilterPublicMethods-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-GaussianFilterPublicMethods-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="GaussianFilter::Integral"></span>Integral() const {
    return ((<a href="../Utilities/Mathematical_Infrastructure.html#GaussianIntegral" class="code">GaussianIntegral</a>(-<a href="#GaussianFilter::radius" class="code">radius</a>.x, <a href="#GaussianFilter::radius" class="code">radius</a>.x, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) -
             2 * <a href="#GaussianFilter::radius" class="code">radius</a>.x * <a href="#GaussianFilter::expX" class="code">expX</a>) *
            (<a href="../Utilities/Mathematical_Infrastructure.html#GaussianIntegral" class="code">GaussianIntegral</a>(-<a href="#GaussianFilter::radius" class="code">radius</a>.y, <a href="#GaussianFilter::radius" class="code">radius</a>.y, 0, <a href="#GaussianFilter::sigma" class="code">sigma</a>) -
             2 * <a href="#GaussianFilter::radius" class="code">radius</a>.y * <a href="#GaussianFilter::expY" class="code">expY</a>));
}</div><p>


</p>
<p>It is possible to sample from the Gaussian function using a polynomial
approximation to the inverse error function, though that is not sufficient
in this case, given the presence of the second term of the filter function in
Equation&nbsp;(<a href="#eq:gaussian-filter-function">8.26</a>).  <tt>pbrt</tt>&rsquo;s
<tt>GaussianFilter</tt> implementation therefore uses a <a href="#FilterSampler"><tt>FilterSampler</tt></a>
for sampling.

</p>
<p></p>
<span class="anchor" id="fragment-GaussianFilterPublicMethods-3"></span><div class="fragmentname">&lt;&lt;GaussianFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-GaussianFilterPublicMethods-2"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">FilterSample <span class="anchor" id="GaussianFilter::Sample"></span><a href="#FilterSampler::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const { return <a href="#GaussianFilter::sampler" class="code">sampler</a>.<a href="#FilterSampler::Sample" class="code">Sample</a>(u); }</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#MitchellFilter"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:Mitchell-filter"></span><span id="MitchellFilter"></span><h3>8.8.6  Mitchell Filter</h3><p>



</p>
<p>Filter design is notoriously difficult, mixing mathematical analysis and
perceptual experiments. Mitchell and Netravali (<a href="Further_Reading.html#cite:Mitchell88">1988</a>) 
developed a family of parameterized filter functions in order to be able to
explore this space in a systematic manner.  After analyzing test subjects&rsquo;
subjective responses to images filtered with a variety of parameter values,
they developed a filter that tends to do a good job of trading off between
<em>ringing</em> (phantom edges next to actual edges in the image) and
<em>blurring</em> (excessively blurred results)&mdash;two common artifacts from
poor reconstruction filters.

</p>
<p>Note from the graph in Figure&nbsp;<a href="#fig:gaussian-mitchell-filter">8.53</a>(b) that
this filter function takes on negative values out by its edges; it has
<em>negative lobes</em>.  In practice these negative regions improve the
sharpness of edges, giving crisper images (reduced blurring).  If they
become too large, however, ringing tends to start to enter the image.
Furthermore, because the final pixel values can become negative, they
will eventually need to be clamped to a legal output range.

</p>
<p>Figure&nbsp;<a href="#fig:mitchell-recon-examples">8.54</a> shows this filter reconstructing
the two test functions.  It does extremely well with both of them: there is
minimal ringing with the step function, and it does a good job with
the sinusoidal function, up until the point where the sampling rate is not
sufficient to capture the function&rsquo;s detail.

</p>
<p></p>
<span class="anchor" id="fig:mitchell-recon-examples"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f54.svg" title=""><img src="pha08f54.svg" width=444 height=617 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.54: The Mitchell&ndash;Netravali Filter
Used to Reconstruct the Example Functions. <span class="legend">  It does a good job with both
of these functions, (a)&nbsp;introducing minimal ringing with the step function
and (b)&nbsp;accurately representing the sinusoid until aliasing from
undersampling starts to dominate.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-MitchellFilterDefinition-0"></span><div class="fragmentname">&lt;&lt;MitchellFilter Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="MitchellFilter"></span>MitchellFilter {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-MitchellFilterPublicMethods-0">MitchellFilter Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1216" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1216"><i></i></a><div id="fragbit-1216" class="collapse"><div class="fragmentcode">       MitchellFilter(<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <a href="#MitchellFilter::radius" class="code">radius</a>, Float b = 1.f/3.f, Float c = 1.f/3.f,
                      Allocator alloc = {})
           : <a href="#MitchellFilter::radius" class="code">radius</a>(<a href="#MitchellFilter::radius" class="code">radius</a>), b(b), c(c), <a href="#MitchellFilter::sampler" class="code">sampler</a>(this, alloc) {}
       static MitchellFilter *Create(const ParameterDictionary &amp;parameters,
                                     const FileLoc *loc, Allocator alloc);
       
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> Radius() const { return <a href="#MitchellFilter::radius" class="code">radius</a>; }
       
       std::string ToString() const;
       Float Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
           return <a href="#MitchellFilter::Mitchell1D" class="code">Mitchell1D</a>(2 * p.x / <a href="#MitchellFilter::radius" class="code">radius</a>.x) * <a href="#MitchellFilter::Mitchell1D" class="code">Mitchell1D</a>(2 * p.y / <a href="#MitchellFilter::radius" class="code">radius</a>.y);
       }
       <a href="#FilterSample" class="code">FilterSample</a> <a href="#FilterSampler::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const { return <a href="#MitchellFilter::sampler" class="code">sampler</a>.<a href="#FilterSampler::Sample" class="code">Sample</a>(u); }
       Float Integral() const { return <a href="#MitchellFilter::radius" class="code">radius</a>.x * <a href="#MitchellFilter::radius" class="code">radius</a>.y / 4; }</div></div>
  private:
    &lt;&lt;<span class="fragmentname">MitchellFilter Private Methods</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1217" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1217"><i></i></a><div id="fragbit-1217" class="collapse"><div class="fragmentcode">       Float Mitchell1D(Float x) const {
           x = std::abs(x);
           if (x &lt;= 1)
               return ((12 - 9 * b - 6 * c) * x * x * x + (-18 + 12 * b + 6 * c) * x * x +
                       (6 - 2 * b)) *
                      (1.f / 6.f);
           else if (x &lt;= 2)
               return ((-b - 6 * c) * x * x * x + (6 * b + 30 * c) * x * x +
                       (-12 * b - 48 * c) * x + (8 * b + 24 * c)) *
                      (1.f / 6.f);
           else
               return 0;
       }</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-MitchellFilterPrivateMembers-0">MitchellFilter Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1218" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1218"><i></i></a><div id="fragbit-1218" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> radius;
       Float b, c;
       <a href="#FilterSampler" class="code">FilterSampler</a> sampler;</div></div>
};</div><p>


</p>
<p>The Mitchell filter has two parameters called <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 433.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
</g>
</svg>.  Although any values
can be used for these parameters, Mitchell and Netravali recommend that they lie along
the line <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.268ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4421 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b plus 2 c equals 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="651" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1652" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="2152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2864" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="3920" y="0"></use>
</g>
</svg>.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-MitchellFilterPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;MitchellFilter Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <span class="anchor" id="MitchellFilter::radius"></span>radius;
Float <span class="anchor" id="MitchellFilter::b"></span>b, <span class="anchor" id="MitchellFilter::c"></span>c;
<a href="#FilterSampler" class="code">FilterSampler</a> <span class="anchor" id="MitchellFilter::sampler"></span>sampler;</div><p>


</p>
<p>

</p>
<p>The Mitchell&ndash;Netravali filter is the product of 1D filter functions in the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> directions and is therefore separable.

</p>
<p></p>
<span class="anchor" id="fragment-MitchellFilterPublicMethods-0"></span><div class="fragmentname">&lt;&lt;MitchellFilter Public Methods&gt;&gt;=&nbsp;<a href="#fragment-MitchellFilterPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="MitchellFilter::Evaluate"></span>Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
    return <a href="#MitchellFilter::Mitchell1D" class="code">Mitchell1D</a>(2 * p.x / <a href="#MitchellFilter::radius" class="code">radius</a>.x) * <a href="#MitchellFilter::Mitchell1D" class="code">Mitchell1D</a>(2 * p.y / <a href="#MitchellFilter::radius" class="code">radius</a>.y);
}</div><p>


</p>
<p>The 1D function used in the Mitchell filter is an even function
defined over the range <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.461ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2781.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket negative 2 comma 2 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1057" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1557" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="2002" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="2503" y="0"></use>
</g>
</svg>.  This function is made by joining a cubic
polynomial defined over <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg> with another cubic polynomial defined over
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 1 comma 2 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg>.  This combined polynomial is also reflected around the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="850" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1906" y="0"></use>
</g>
</svg> plane to
give the complete function.
These polynomials are controlled by the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 433.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
</g>
</svg> parameters and are chosen
carefully to guarantee <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.852ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1228 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper C Superscript 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D436" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-89 0 -183 -50 -244 -121c-100 -117 -121 -279 -121 -336c0 -156 106 -208 196 -208c52 0 115 17 184 73c69 58 92 129 101 158c2 8 7 10 13 10c0 0 12 0 12 -10 c0 -3 -17 -94 -110 -176c-53 -46 -129 -86 -216 -86c-153 0 -271 109 -271 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D436" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="1094" y="513"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.852ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1228 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper C Superscript 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D436" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-89 0 -183 -50 -244 -121c-100 -117 -121 -279 -121 -336c0 -156 106 -208 196 -208c52 0 115 17 184 73c69 58 92 129 101 158c2 8 7 10 13 10c0 0 12 0 12 -10 c0 -3 -17 -94 -110 -176c-53 -46 -129 -86 -216 -86c-153 0 -271 109 -271 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D436" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1094" y="513"></use>
</g>
</svg> continuity at <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="850" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1906" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x equals 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="850" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1906" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x equals 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="850" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1906" y="0"></use>
</g>
</svg>.
The polynomials are
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="77.525ex" height="15.176ex" style="vertical-align: -7.005ex;" viewBox="0 -3518.2 33378.7 6534.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column Blank 2nd Column f left-parenthesis x right-parenthesis 2nd Row 1st Column Blank 2nd Column equals one-sixth StartLayout Enlarged left-brace 1st Row 1st Column left-parenthesis 12 minus 9 b minus 6 c right-parenthesis StartAbsoluteValue x EndAbsoluteValue cubed plus left-parenthesis negative 18 plus 12 b plus 6 c right-parenthesis StartAbsoluteValue x EndAbsoluteValue squared plus left-parenthesis 6 minus 2 b right-parenthesis 2nd Column StartAbsoluteValue x EndAbsoluteValue less-than 1 2nd Row 1st Column left-parenthesis negative b minus 6 c right-parenthesis StartAbsoluteValue x EndAbsoluteValue cubed plus left-parenthesis 6 b plus 30 c right-parenthesis StartAbsoluteValue x EndAbsoluteValue squared plus left-parenthesis minus 12 b minus 48 c right-parenthesis StartAbsoluteValue x EndAbsoluteValue 2nd Column 1 less-than-or-equal-to StartAbsoluteValue x EndAbsoluteValue less-than 2 3rd Row 1st Column plus left-parenthesis 8 b plus 24 c right-parenthesis 4th Row 1st Column 0 2nd Column otherwise period EndLayout EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-39" d="M457 329c0 -215 -122 -351 -251 -351c-85 0 -139 41 -139 108c0 39 30 48 46 48c22 0 46 -15 46 -46c0 -17 -8 -46 -52 -46c27 -34 81 -36 98 -36c58 0 162 46 162 280v32c-23 -58 -64 -100 -125 -100c-112 0 -200 98 -200 223c0 75 23 117 64 162c43 45 92 63 147 63 c89 0 204 -68 204 -337zM365 421c0 46 -4 109 -16 141c-17 45 -50 79 -96 79c-35 0 -73 -13 -100 -63c-21 -37 -21 -84 -21 -138c0 -49 0 -99 18 -136c31 -63 77 -63 93 -63c88 0 122 97 122 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7C" d="M159 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3C" d="M689 -9c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2264" d="M691 75c24 -11 7 -47 -18 -36l-581 275c-17 8 -17 32 0 40l581 275c25 11 42 -25 18 -36l-548 -259zM702 -99c0 -11 -9 -20 -20 -20h-586c-11 0 -20 9 -20 20s9 20 20 20h586c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6F" d="M471 214c0 -127 -101 -225 -222 -225c-117 0 -221 96 -221 225c0 125 97 234 222 234c121 0 221 -106 221 -234zM388 222c0 38 0 96 -26 139s-69 65 -113 65c-40 0 -87 -21 -114 -67c-24 -44 -24 -98 -24 -137c0 -36 0 -97 25 -141c27 -46 71 -67 114 -67 c50 0 94 29 116 74c22 44 22 98 22 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-74" d="M332 124c0 -64 -28 -135 -99 -135c-36 0 -129 12 -129 135v276h-85v22c98 4 128 111 129 193h25v-184h143v-31h-143v-278c0 -17 0 -108 67 -108c37 0 67 38 67 112v55h25v-57Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-68" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v520c0 49 -8 56 -78 56v31l144 11v-348h1c16 36 60 96 144 96c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-65" d="M415 119c0 -19 -45 -130 -167 -130c-115 0 -220 97 -220 231c0 125 92 228 208 228c125 0 179 -97 179 -196c0 -21 -3 -21 -25 -21h-279c0 -36 0 -102 30 -150c23 -37 63 -67 113 -67c10 0 100 0 135 103c2 8 4 14 13 14c5 0 13 -2 13 -12zM349 252 c0 39 -10 174 -113 174c-34 0 -118 -25 -124 -174h237Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-77" d="M703 400c-35 -1 -66 -14 -84 -64l-117 -328c-4 -10 -7 -19 -20 -19s-16 8 -20 19l-102 284l-101 -283c-5 -14 -7 -20 -20 -20s-16 8 -21 22l-126 354c-12 32 -24 35 -74 35v31l93 -3l109 3v-31c-20 0 -59 0 -59 -27c0 -4 0 -6 5 -18l95 -267l86 242c-7 19 -18 49 -23 55 c-10 13 -26 15 -63 15v31c30 -2 59 -3 89 -3l104 3v-31c-20 0 -59 0 -59 -27c0 -5 1 -7 5 -19l99 -279l91 256c5 13 5 15 5 21c0 29 -22 47 -58 48v31l93 -3c22 0 51 1 73 3v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A7" d="M755 724c0 -11 -7 -21 -17 -24c-138 -51 -236 -202 -236 -325v-375h-102v375c0 151 151 312 320 373c3 1 6 2 9 2c14 0 26 -12 26 -26Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A9" d="M755 26c0 -14 -12 -26 -26 -26c-3 0 -6 1 -9 2c-169 61 -320 222 -320 373v375h102v-375c0 -123 98 -274 236 -325c10 -3 17 -13 17 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A8" d="M502 1500v-375c0 -147 -120 -300 -265 -375c145 -75 265 -228 265 -375v-375h-102v375c0 137 -97 300 -236 351c-10 3 -17 13 -17 24s7 21 17 24c139 51 236 214 236 351v375h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-E003" d="M502 0h-102v748h102v-748Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(267,0)">
<g transform="translate(0,2599)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1514" y="0"></use>
</g>
<g transform="translate(0,-775)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1000" y="0"></use>
<g transform="translate(1778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="60" y="-687"></use>
</g>
</g>
<g transform="translate(2916,0)">
<g transform="translate(0,2625)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A7" x="0" y="-751"></use>
<g transform="translate(0,-1672.8244771304105) scale(1,1.2961608506414026)">
 <use xlink:href="#E1-LATINMODERNSIZE7-E003"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A8" x="0" y="-3126"></use>
<g transform="translate(0,-4046.9451151114627) scale(1,1.2961608506414026)">
 <use xlink:href="#E1-LATINMODERNSIZE7-E003"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A9" x="0" y="-4750"></use>
</g>
<g transform="translate(1069,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1675)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1612" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-39" x="2613" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="3113" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="3765" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="4766" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="5266" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5700" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="6089" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="6368" y="0"></use>
<g transform="translate(6940,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="393" y="675"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="7895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8896" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="9285" y="0"></use>
<g transform="translate(10064,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="11287" y="0"></use>
<g transform="translate(12288,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="13289" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="13940" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="14941" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="15442" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15875" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="16265" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="16543" y="0"></use>
<g transform="translate(17116,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="675"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="18070" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="19071" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="19460" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="20183" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="21184" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="21684" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="22114" y="0"></use>
</g>
<g transform="translate(0,374)">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="1168" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="1819" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="2820" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="3320" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3754" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="4143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="4422" y="0"></use>
<g transform="translate(4994,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="393" y="675"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="5949" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6950" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="7339" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="7840" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8492" y="0"></use>
<g transform="translate(9492,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-33"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="10493" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10927" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="11316" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="11595" y="0"></use>
<g transform="translate(12167,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="393" y="675"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="13122" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="14123" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="14512" y="0"></use>
<g transform="translate(15291,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="16292" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="16943" y="0"></use>
<g transform="translate(17944,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-34"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="18945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="19379" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="19768" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="20047" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="20619" y="0"></use>
</g>
<g transform="translate(0,-777)">
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="2612" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="3112" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3764" y="0"></use>
<g transform="translate(4765,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-32"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="500" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="5766" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6199" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-1926"></use>
</g>
<g transform="translate(23493,0)">
<g transform="translate(0,1675)">
<g transform="translate(332,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="851" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2463" y="0"></use>
</g>
</g>
<g transform="translate(0,374)">
<g transform="translate(332,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2264" x="778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="1834" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="2113" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-7C" x="2685" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3C" x="3241" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="4298" y="0"></use>
</g>
</g>
<g transform="translate(0,-1926)">
 <use xlink:href="#E1-LATINMODERNMAIN-6F" x="332" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-74" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-68" x="1222" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="1778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-72" x="2223" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-77" x="2615" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="3338" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="3616" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-65" x="4011" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="4455" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

<tt>Mitchell1D()</tt><span class="anchor" id="MitchellFilter::Mitchell1D"></span> evaluates this
function.  Its implementation is straightforward and is not included here.

</p>
<p>

</p>
<p>As a cubic polynomial, sampling this filter function directly would require
inverting a quartic.  Therefore, the <tt>MitchellFilter</tt> uses the
<a href="#FilterSampler"><tt>FilterSampler</tt></a> for sampling.

</p>
<p></p>
<span class="anchor" id="fragment-MitchellFilterPublicMethods-1"></span><div class="fragmentname">&lt;&lt;MitchellFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-MitchellFilterPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-MitchellFilterPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#FilterSample" class="code">FilterSample</a> <span class="anchor" id="MitchellFilter::Sample"></span><a href="#FilterSampler::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const { return <a href="#MitchellFilter::sampler" class="code">sampler</a>.<a href="#FilterSampler::Sample" class="code">Sample</a>(u); }</div><p>


</p>
<p>However, the function is easily integrated.  The result is independent of
the values of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 433.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-MitchellFilterPublicMethods-2"></span><div class="fragmentname">&lt;&lt;MitchellFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-MitchellFilterPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="MitchellFilter::Integral"></span>Integral() const { return <a href="#MitchellFilter::radius" class="code">radius</a>.x * <a href="#MitchellFilter::radius" class="code">radius</a>.y / 4; }</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#WindowedSincFilter"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:windowed-sinc"></span><span id="WindowedSincFilter"></span><h3>8.8.7  Windowed Sinc Filter</h3><p>



</p>
<p>Finally, the <a href="#LanczosSincFilter"><tt>LanczosSincFilter</tt></a> class implements a filter
based on the sinc function.  In practice, the sinc filter is often
multiplied by another function that goes to&nbsp;0 after some distance. This
gives a filter function with finite extent.  An additional parameter
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">tau</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70F" d="M511 407c0 -34 -36 -34 -49 -34h-168l-67 -342c-3 -15 -8 -43 -41 -43c-22 0 -29 16 -29 27c0 4 6 25 10 37l98 321h-83c-21 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 6 28 54 61 90c44 47 83 47 103 47h280c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70F" x="0" y="0"></use>
</g>
</svg> controls how many cycles the sinc function passes through before it
is clamped to a value of&nbsp;0.
Figure&nbsp;<a href="#fig:sinc-and-window-graphs">8.55</a> shows a graph of three cycles of
the sinc function, along with a graph of the windowing function we
use, which was developed by Lanczos.  The Lanczos window is
just the central lobe of the sinc function, scaled to cover the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">tau</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70F" d="M511 407c0 -34 -36 -34 -49 -34h-168l-67 -342c-3 -15 -8 -43 -41 -43c-22 0 -29 16 -29 27c0 4 6 25 10 37l98 321h-83c-21 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 6 28 54 61 90c44 47 83 47 103 47h280c19 0 40 0 40 -24Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70F" x="0" y="0"></use>
</g>
</svg>
cycles:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:windowed-sinc"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.37ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 13506.3 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">w left-parenthesis x right-parenthesis equals normal s normal i normal n normal c left-parenthesis StartFraction x Over tau EndFraction right-parenthesis equals StartFraction sine left-parenthesis pi x slash tau right-parenthesis Over pi x slash tau EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-73" d="M360 128c0 -72 -46 -139 -161 -139c-21 0 -66 1 -110 43c-18 -19 -18 -21 -20 -23c-19 -19 -20 -20 -25 -20c-11 0 -11 7 -11 24v132c0 18 0 25 13 25c10 0 11 -4 14 -17c19 -85 55 -142 139 -142c78 0 113 40 113 91c0 72 -82 88 -104 92c-72 14 -100 20 -132 46 c-27 22 -43 50 -43 85c0 56 38 123 160 123c15 0 56 0 94 -28c4 3 14 12 17 16c13 12 15 12 20 12c11 0 11 -7 11 -24v-101c0 -19 0 -24 -13 -24c0 0 -11 0 -12 9c-2 31 -7 121 -117 121c-86 0 -112 -41 -112 -76c0 -58 67 -71 123 -82c42 -8 81 -16 114 -48 c12 -12 42 -42 42 -95Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-63" d="M415 119c0 -10 -32 -130 -166 -130c-116 0 -215 99 -215 227c0 124 92 232 217 232c77 0 153 -39 153 -107c0 -30 -20 -47 -46 -47c-28 0 -46 20 -46 46c0 13 6 43 47 46c-35 36 -98 37 -107 37c-53 0 -135 -42 -135 -205c0 -161 88 -204 141 -204c37 0 102 12 131 105 c2 6 4 10 13 10c3 0 13 0 13 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70F" d="M511 407c0 -34 -36 -34 -49 -34h-168l-67 -342c-3 -15 -8 -43 -41 -43c-22 0 -29 16 -29 27c0 4 6 25 10 37l98 321h-83c-21 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 6 28 54 61 90c44 47 83 47 103 47h280c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE4-28" d="M539 -632c0 -8 -6 -14 -14 -14c-3 0 -6 1 -9 2c-175 132 -337 475 -337 776v236c0 301 162 644 337 776c3 1 6 2 9 2c8 0 14 -6 14 -14c0 -5 -2 -9 -5 -12c-167 -125 -283 -466 -283 -752v-236c0 -286 116 -627 283 -752c3 -3 5 -7 5 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE4-29" d="M418 132c0 -301 -162 -644 -337 -776c-3 -1 -6 -2 -9 -2c-8 0 -14 6 -14 14c0 5 2 9 5 12c167 125 283 466 283 752v236c0 286 -116 627 -283 752c-3 3 -5 7 -5 12c0 8 6 14 14 14c3 0 6 -1 9 -2c175 -132 337 -475 337 -776v-236Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70B" d="M567 407c0 -34 -36 -34 -49 -34h-114c-11 -52 -18 -106 -18 -159c0 -28 0 -93 29 -165c6 -14 6 -16 6 -22c0 -20 -21 -38 -41 -38c-15 0 -26 6 -36 50c-8 34 -8 61 -8 76c0 67 9 110 42 258h-113l-56 -221c-13 -50 -13 -52 -27 -98c-12 -37 -20 -65 -50 -65 c-13 0 -29 8 -29 27c0 7 0 9 8 24c42 91 96 212 128 333h-57c-20 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 5 26 51 61 90c44 47 82 47 104 47h335c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="716" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1106" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1678" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2345" y="0"></use>
<g transform="translate(3402,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-73" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-63" x="1229" y="0"></use>
</g>
<g transform="translate(5242,0)">
 <use xlink:href="#E1-LATINMODERNSIZE4-28"></use>
<g transform="translate(597,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="692" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70F" x="90" y="-686"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE4-29" x="1530" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="7648" y="0"></use>
<g transform="translate(8426,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4283" height="60" x="0" y="220"></rect>
<g transform="translate(60,770)">
 <use xlink:href="#E1-LATINMODERNMAIN-73"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-69" x="394" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-6E" x="673" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1229" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="1619" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="2189" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="2762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70F" x="3262" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3774" y="0"></use>
</g>
<g transform="translate(1064,-771)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="570" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1143" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70F" x="1643" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="13227" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:windowed-sinc">8.27</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

Figure&nbsp;<a href="#fig:sinc-and-window-graphs">8.55</a> also shows the filter that we will
implement here, which is the product of the sinc function and the windowing
function.  It is evaluated by the <tt>WindowedSinc()</tt> utility function.

</p>
<p></p>
<span class="anchor" id="fragment-MathInlineFunctions-2"></span><div class="fragmentname">&lt;&lt;Math Inline Functions&gt;&gt;+=&nbsp;<a href="../Shapes/Managing_Rounding_Error.html#fragment-MathInlineFunctions-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-MathInlineFunctions-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="WindowedSinc"></span>WindowedSinc(Float x, Float radius, Float tau) {
    if (std::abs(x) &gt; radius)
        return 0;
    return <a href="#Sinc" class="code">Sinc</a>(x) * <a href="#Sinc" class="code">Sinc</a>(x / tau);
}</div><p>


</p>
<p>Its implementation uses the <tt>Sinc()</tt> function, which in turn is
implemented using the numerically robust <tt>SinXOverX()</tt> function.

</p>
<p></p>
<span class="anchor" id="fragment-MathInlineFunctions-3"></span><div class="fragmentname">&lt;&lt;Math Inline Functions&gt;&gt;+=&nbsp;<a href="#fragment-MathInlineFunctions-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="../Utilities/Mathematical_Infrastructure.html#fragment-MathInlineFunctions-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="Sinc"></span>Sinc(Float x) { return <a href="../Utilities/Mathematical_Infrastructure.html#SinXOverX" class="code">SinXOverX</a>(<a href="../Utilities/Mathematical_Infrastructure.html#Pi" class="code">Pi</a> * x); }</div><p>


</p>
<p> </p>
<span class="anchor" id="fig:sinc-and-window-graphs"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f55.svg" title=""><img src="pha08f55.svg" width=966 height=285 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.55: Graphs of the Sinc Filter. <span class="legend">  
(a)&nbsp;The sinc function, truncated after three cycles (blue line)
and the Lanczos windowing function (red line).  (b)&nbsp;The
product of these two functions, as implemented in the
<a href="#LanczosSincFilter"><tt>LanczosSincFilter</tt></a>.</span>
</figcaption><p>
 

</p>
</div></div><p>


</p>
<p>Figure&nbsp;<a href="#fig:sinc-recon-examples">8.56</a> shows the windowed sinc&rsquo;s reconstruction
results for uniform 1D samples.  Thanks to the windowing, the reconstructed
step function exhibits far less ringing than the reconstruction using the
infinite-extent sinc function (compare to Figure&nbsp;<a href="../Sampling_and_Reconstruction/Sampling_Theory.html#fig:sinc-gibbs-ringing">8.11</a>).
The windowed sinc filter also does extremely well at reconstructing the
sinusoidal function until prealiasing begins.

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fig:sinc-recon-examples"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha08f56.svg" title=""><img src="pha08f56.svg" width=444 height=617 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 8.56: Results of Using the Windowed Sinc 
Filter to Reconstruct the Example Functions. <span class="legend"> Here, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.449ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2346.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">tau equals 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D70F" d="M511 407c0 -34 -36 -34 -49 -34h-168l-67 -342c-3 -15 -8 -43 -41 -43c-22 0 -29 16 -29 27c0 4 6 25 10 37l98 321h-83c-21 0 -78 0 -127 -77c-6 -8 -8 -12 -16 -12c-12 0 -12 10 -12 10c0 6 28 54 61 90c44 47 83 47 103 47h280c19 0 40 0 40 -24Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D70F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="789" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1845" y="0"></use>
</g>
</svg>.  (a)&nbsp;Like the
infinite sinc, it suffers from ringing with the step function, although there
is much less ringing in the windowed version.  (b)&nbsp;The filter does quite well with
the sinusoid, however.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-LanczosSincFilterDefinition-0"></span><div class="fragmentname">&lt;&lt;LanczosSincFilter Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="LanczosSincFilter"></span>LanczosSincFilter {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-LanczosSincFilterPublicMethods-0">LanczosSincFilter Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1219" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1219"><i></i></a><div id="fragbit-1219" class="collapse"><div class="fragmentcode">       LanczosSincFilter(<a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <a href="#LanczosSincFilter::radius" class="code">radius</a>, Float <a href="#LanczosSincFilter::tau" class="code">tau</a> = 3.f, Allocator alloc = {})
           : <a href="#LanczosSincFilter::radius" class="code">radius</a>(<a href="#LanczosSincFilter::radius" class="code">radius</a>), <a href="#LanczosSincFilter::tau" class="code">tau</a>(<a href="#LanczosSincFilter::tau" class="code">tau</a>), <a href="#LanczosSincFilter::sampler" class="code">sampler</a>(this, alloc) {}
       static LanczosSincFilter *Create(const ParameterDictionary &amp;parameters,
                                        const FileLoc *loc, Allocator alloc);
       
       PBRT_CPU_GPU
       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> Radius() const { return <a href="#LanczosSincFilter::radius" class="code">radius</a>; }
       
       std::string ToString() const;
       Float Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
           return <a href="#WindowedSinc" class="code">WindowedSinc</a>(p.x, <a href="#LanczosSincFilter::radius" class="code">radius</a>.x, <a href="#LanczosSincFilter::tau" class="code">tau</a>) *
                  <a href="#WindowedSinc" class="code">WindowedSinc</a>(p.y, <a href="#LanczosSincFilter::radius" class="code">radius</a>.y, <a href="#LanczosSincFilter::tau" class="code">tau</a>);
       }
       <a href="#FilterSample" class="code">FilterSample</a> <a href="#FilterSampler::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const { return <a href="#LanczosSincFilter::sampler" class="code">sampler</a>.<a href="#FilterSampler::Sample" class="code">Sample</a>(u); }
       Float Integral() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-LanczosSincFilterPrivateMembers-0">LanczosSincFilter Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-1220" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-1220"><i></i></a><div id="fragbit-1220" class="collapse"><div class="fragmentcode">       <a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> radius;
       Float tau;
       <a href="#FilterSampler" class="code">FilterSampler</a> sampler;</div></div>
};</div><p>


</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-LanczosSincFilterPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;LanczosSincFilter Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Vectors.html#Vector2f" class="code">Vector2f</a> <span class="anchor" id="LanczosSincFilter::radius"></span>radius;
Float <span class="anchor" id="LanczosSincFilter::tau"></span>tau;
<a href="#FilterSampler" class="code">FilterSampler</a> <span class="anchor" id="LanczosSincFilter::sampler"></span>sampler;</div><p>


</p>
<p>

</p>
<p>The evaluation method is easily implemented in terms of the
<tt>WindowedSinc()</tt> function.

</p>
<p></p>
<span class="anchor" id="fragment-LanczosSincFilterPublicMethods-0"></span><div class="fragmentname">&lt;&lt;LanczosSincFilter Public Methods&gt;&gt;=&nbsp;<a href="#fragment-LanczosSincFilterPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="LanczosSincFilter::Evaluate"></span>Evaluate(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> p) const {
    return <a href="#WindowedSinc" class="code">WindowedSinc</a>(p.x, <a href="#LanczosSincFilter::radius" class="code">radius</a>.x, <a href="#LanczosSincFilter::tau" class="code">tau</a>) *
           <a href="#WindowedSinc" class="code">WindowedSinc</a>(p.y, <a href="#LanczosSincFilter::radius" class="code">radius</a>.y, <a href="#LanczosSincFilter::tau" class="code">tau</a>);
}</div><p>


</p>
<p>There is no convenient closed-form approach for sampling from the windowed
sinc function&rsquo;s distribution, so a <a href="#FilterSampler"><tt>FilterSampler</tt></a> is used here as
well.

</p>
<p></p>
<span class="anchor" id="fragment-LanczosSincFilterPublicMethods-1"></span><div class="fragmentname">&lt;&lt;LanczosSincFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-LanczosSincFilterPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-LanczosSincFilterPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#FilterSample" class="code">FilterSample</a> <span class="anchor" id="LanczosSincFilter::Sample"></span><a href="#FilterSampler::Sample" class="code">Sample</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> u) const { return <a href="#LanczosSincFilter::sampler" class="code">sampler</a>.<a href="#FilterSampler::Sample" class="code">Sample</a>(u); }</div><p>


</p>
<p>There is no closed-form expression of the filter&rsquo;s integral, so its
<tt>Integral()</tt> method, not included in the text, approximates it using a
Riemann sum. 

</p>
<p></p>
<span class="anchor" id="fragment-LanczosSincFilterPublicMethods-2"></span><div class="fragmentname">&lt;&lt;LanczosSincFilter Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-LanczosSincFilterPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="LanczosSincFilter::Integral"></span>Integral() const;</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Sampling_and_Reconstruction/Further_Reading.html">Sampling and Reconstruction / Further Reading</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
