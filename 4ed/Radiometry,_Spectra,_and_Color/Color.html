
<!doctype html>
<html lang="en">
<head>

<!-- all praise to https://realfavicongenerator.net -->
<link rel="icon" href="/favicon.ico?v=2" /> <!-- force refresh -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="/fonts.css">
  <link rel="stylesheet" href="../pbrstyle.css">
  <link rel="stylesheet" href="/fontawesome-free-5.15.3-web/css/all.css">

<script async src="https://cse.google.com/cse.js?cx=22a43cef261a245ea"></script>  <script src="/react.min.js"></script>
  <script src="/react-dom.min.js"></script>
  <script src="/jeri.min.js"></script>
  <link rel="preload" href="/exr.worker.js" as="script" crossorigin="anonymous">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/bootstrap.min.css">

  <title>Color</title>
</head>
        
<body>

<nav class="fixed-top-lg-navbar navbar navbar-expand bg-light navbar-light">
  <ul class="nav navbar-nav">
    <a class="navbar-brand" href="../contents.html"><img src="../pbr.jpg" width=25 height=25></a>
    <li class="nav-item"><a class="nav-link" href="../Radiometry,_Spectra,_and_Color.html">Radiometry, Spectra, and Color</a></li>
    <span class="navbar-text">/</span>
    <li class="nav-item"><a class="nav-link" href="#">Color</a></li>
    <span class="navbar-text">&nbsp;&nbsp;</span>
    <li class="nav-item"><a class="nav-link" href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html">(Previous: Representing Spectral Distributions)</a></li>
  </ul>

  <ul class="nav navbar-nav ml-auto d-none d-md-block">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
  <ul class="nav navbar-nav d-block d-md-none">
        <li class="nav-item"><div class="gcse-search"></div></li>
    </ul>
</nav>

<div class="maincontainer">
<div class="container-fluid">

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#"><i class="fas fa-link "></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:color"></span><h2>4.6 Color</h2><p>



</p>
<p>&ldquo;Spectral distribution&rdquo; and &ldquo;color&rdquo; might seem like two names for the
same thing, but they are distinct.  A spectral distribution is a purely
physical concept, while color describes the human perception of a spectrum.
Color is thus closely connected to the physiology of the human visual
system and the brain&rsquo;s processing of visual stimulus.

</p>
<p>Although the majority of rendering computation in <tt>pbrt</tt> is based on
spectral distributions, color still must be treated carefully.  For
example, the spectral distribution at each pixel in a rendered image must
be converted to RGB color to be displayed on a monitor.  Performing this
conversion accurately requires using information about the monitor&rsquo;s color
characteristics.  The renderer also finds color in scene descriptions that
use it to describe reflectance and light emission.
Although it is convenient for humans to use colors to describe the appearance
of modeled scenes, these colors must be converted to spectra
if a renderer uses spectral distributions in its
light transport simulation.
Unfortunately, doing so is an underspecified problem. A variety of
approaches have been developed for it; the one implemented in <tt>pbrt</tt> is
described in Section&nbsp;<a href="#sec:rgb-to-spectrum">4.6.6</a>.

</p>
<p>The <em>tristimulus theory</em> of color perception says that all visible
spectral distributions can be accurately represented for human observers
using three scalar values.  Its basis is that there are three types of
photoreceptive cone cells in the eye, each sensitive to different
wavelengths of light.  This theory, which has been tested in numerous
experiments since its introduction in the 1800s, has led to the development
of <em>spectral matching functions</em>, which are functions of wavelength that
can be used to compute a tristimulus representation of a spectral
distribution.

</p>
<p>Integrating the product of a spectral distribution <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg> with three
tristimulus matching functions <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.462ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 4504.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">m Subscript StartSet 1 comma 2 comma 3 EndSet Baseline left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45A" d="M848 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 4 31 13 55c20 53 62 167 62 224c0 36 -11 70 -54 70c-109 0 -162 -120 -165 -133l-60 -241c-8 -32 -14 -57 -45 -57c-15 0 -29 9 -29 27c0 5 9 39 13 59c9 33 10 39 20 76l28 116c8 30 15 58 15 83 c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84c0 38 -15 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23 c0 0 -12 0 -12 10c0 3 13 62 31 97c9 18 28 57 74 57c45 0 87 -30 92 -87c17 23 66 87 156 87c25 0 57 -5 82 -26c28 -24 31 -58 32 -71c37 53 88 97 163 97s115 -42 115 -107c0 -57 -42 -168 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7B" d="M425 -238c0 -7 -5 -12 -12 -12c-105 0 -196 52 -196 125v250c0 58 -55 113 -130 113c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 55 130 113v250c0 73 91 125 196 125c7 0 12 -5 12 -12s-5 -12 -12 -12c-75 0 -130 -49 -130 -101v-250c0 -58 -48 -104 -115 -125 c67 -21 115 -67 115 -125v-250c0 -52 55 -101 130 -101c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-7D" d="M425 250c0 -7 -5 -12 -12 -12c-75 0 -130 -55 -130 -113v-250c0 -73 -91 -125 -196 -125c-7 0 -12 5 -12 12s5 12 12 12c75 0 130 49 130 101v250c0 58 48 104 115 125c-67 21 -115 67 -115 125v250c0 52 -55 101 -130 101c-7 0 -12 5 -12 12s5 12 12 12 c105 0 196 -52 196 -125v-250c0 -58 55 -113 130 -113c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45A" x="0" y="0"></use>
<g transform="translate(878,-187)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-7B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-2C" x="1780" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="2058" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-7D" x="2559" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3141" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3531" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4114" y="0"></use>
</g>
</svg> gives three
<em>tristimulus values</em> <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.927ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 829.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.341ex" height="5.676ex" style="vertical-align: -2.338ex;" viewBox="0 -1437.2 9619.2 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">v Subscript i Baseline equals integral upper S left-parenthesis lamda right-parenthesis m Subscript i Baseline left-parenthesis lamda right-parenthesis normal d lamda period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D463" d="M468 372c0 -52 -57 -383 -225 -383c-46 0 -134 16 -134 124c0 43 13 89 57 205c7 18 17 45 17 70c0 32 -17 32 -25 32c-29 0 -72 -23 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -12 -50 c-31 -83 -58 -156 -58 -212c0 -52 23 -87 74 -87c117 0 178 229 178 271c0 36 -13 62 -34 82c-11 11 -16 17 -16 30c0 22 24 48 49 48c18 0 44 -16 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45A" d="M848 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 20 4 31 13 55c20 53 62 167 62 224c0 36 -11 70 -54 70c-109 0 -162 -120 -165 -133l-60 -241c-8 -32 -14 -57 -45 -57c-15 0 -29 9 -29 27c0 5 9 39 13 59c9 33 10 39 20 76l28 116c8 30 15 58 15 83 c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84c0 38 -15 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23 c0 0 -12 0 -12 10c0 3 13 62 31 97c9 18 28 57 74 57c45 0 87 -30 92 -87c17 23 66 87 156 87c25 0 57 -5 82 -26c28 -24 31 -58 32 -71c37 53 88 97 163 97s115 -42 115 -107c0 -57 -42 -168 -61 -220c-9 -22 -18 -46 -18 -71c0 -23 7 -33 24 -33c55 0 87 71 102 124 c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D463" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="686" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1107" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="2163" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="3274" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3919" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4309" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4892" y="0"></use>
<g transform="translate(5448,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="1242" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6671" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7060" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7644" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="8200" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8757" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="9340" y="0"></use>
</g>
</svg>
</div>
<p>

The matching functions thus define a <em>color space</em>, which is a 3D
vector space of the tristimulus values: the tristimulus values for
the sum of two spectra are given by the sum of their tristimulus values and
the tristimulus values associated with a spectrum that has been scaled by a
constant can be found by scaling the tristimulus values by the same factor.
Note that from these definitions, the tristimulus values for the product of
two spectral distributions are <em>not</em> given by the product of their
tristimulus values.  This nit is why using tristimulus color like RGB for
rendering may not give accurate results; we will say more about this topic in
Section&nbsp;<a href="#sec:rgb-to-spectrum">4.6.6</a>.

</p>
<p>The files <a href="https://github.com/mmp/pbrt-v4/tree/master/src/pbrt/util/color.h"><tt>util/color.h</tt></a> and <a href="https://github.com/mmp/pbrt-v4/tree/master/src/pbrt/util/color.cpp"><tt>util/color.cpp</tt></a> in the
<tt>pbrt</tt> distribution contain the implementation of the
functionality related to color that is introduced in this section.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#XYZColor"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:color-xyz"></span><span id="XYZColor"></span><h3>4.6.1  XYZ Color</h3><p>



</p>
<p> </p>
<span class="anchor" id="fig:cie-xyz"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f18.svg" title=""><img src="pha04f18.svg" width=504 height=348 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.18: The XYZ Color Matching Curves. <span class="legend">
A given spectral distribution can be converted to XYZ by multiplying it by
each of the three matching curves and integrating the result
to compute the values <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg>, using
Equation&nbsp;(<a href="#eq:xyz-matching">4.22</a>).</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>An important set of color matching functions were determined by the
Commission Internationale de l&rsquo;&Eacute;clairage (CIE) standards body after a
series of experiments with human test subjects.  They define the <em>XYZ
color space</em> and are graphed in Figure&nbsp;<a href="#fig:cie-xyz">4.18</a>.  XYZ is a
<em>device-independent</em> color space, which means that it does not
describe the characteristics of a particular display or color measurement
device.

</p>
<p>Given a spectral distribution <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg>, its XYZ color space
coordinates <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg> are computed by integrating its
product with the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.142ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2214 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper X left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="851" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1241" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1824" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.936ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2125 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1735" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.845ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2086 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Z left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="723" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1113" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1696" y="0"></use>
</g>
</svg> spectral


matching curves:<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="A variety of conventions are used to define these
integrals, sometimes with other or no normalization factors.  For use in
<tt>pbrt</tt>, the normalization by one over the integral of the <i>Y</i> matching curve
is convenient, as it causes a spectral distribution with a constant value
of 1 to have <i>y<sub>&lambda;</sub></i>=1.">
      <sup>&dagger;</sup>
    </button>
		

</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:xyz-matching"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.177ex" height="20.509ex" style="vertical-align: -9.671ex;" viewBox="0 -4666.3 15145.4 8830.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column x Subscript lamda 2nd Column equals StartFraction 1 Over integral Underscript lamda Endscripts upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline EndFraction integral Underscript lamda Endscripts upper S left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Row 1st Column y Subscript lamda 2nd Column equals StartFraction 1 Over integral Underscript lamda Endscripts upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline EndFraction integral Underscript lamda Endscripts upper S left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Row 1st Column z Subscript lamda 2nd Column equals StartFraction 1 Over integral Underscript lamda Endscripts upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline EndFraction integral Underscript lamda Endscripts upper S left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-222B" d="M609 722c0 -30 -22 -43 -42 -43c-19 0 -41 13 -41 42c0 14 8 37 37 41c-22 19 -53 21 -63 21c-45 0 -79 -25 -93 -209l-19 -249c-8 -111 -44 -402 -57 -454c-22 -90 -70 -177 -165 -177c-60 0 -110 35 -110 83c0 30 22 43 42 43c19 0 41 -13 41 -42c0 -14 -8 -37 -37 -41 c21 -18 51 -21 64 -21c57 0 93 45 106 209l19 249c9 121 45 403 57 458c17 76 56 173 151 173c60 0 110 -35 110 -83Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3197)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
<g transform="translate(82,157)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
<g transform="translate(107,-2882)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
<g transform="translate(1352,0)">
<g transform="translate(0,3197)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4896" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2197" y="676"></use>
<g transform="translate(60,-826)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="941" y="-484"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="1344" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2107" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2496" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3080" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="3636" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4192" y="0"></use>
</g>
</g>
</g>
<g transform="translate(6359,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="812" y="-1270"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="7613" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8258" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8648" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9231" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="9787" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10639" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="11028" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11612" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="12168" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="12724" y="0"></use>
</g>
<g transform="translate(0,157)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4896" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2197" y="676"></use>
<g transform="translate(60,-826)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="941" y="-484"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="1344" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2107" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2496" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3080" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="3636" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4192" y="0"></use>
</g>
</g>
</g>
<g transform="translate(6359,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="812" y="-1270"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="7613" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8258" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8648" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9231" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="9787" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10550" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="10939" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11523" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="12079" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="12635" y="0"></use>
</g>
<g transform="translate(0,-2882)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4896" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2197" y="676"></use>
<g transform="translate(60,-826)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="941" y="-484"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="1344" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2107" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2496" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3080" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="3636" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4192" y="0"></use>
</g>
</g>
</g>
<g transform="translate(6359,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="812" y="-1270"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="7613" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="8258" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8648" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="9231" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="9787" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10511" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="10900" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11484" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="12040" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="12596" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="13180" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:xyz-matching">4.22</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>


</p>
<p>The CIE <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.936ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2125 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1735" y="0"></use>
</g>
</svg> tristimulus curve was chosen to be proportional to the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.952ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2132 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper V left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="769" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1159" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1742" y="0"></use>
</g>
</svg> spectral response curve used to define photometric quantities
such as luminance in Equation&nbsp;(<a href="../Radiometry,_Spectra,_and_Color/Radiometry.html#eq:luminance">4.6</a>). Their relationship is:
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.86ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7259.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper V left-parenthesis lamda right-parenthesis equals 683 upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D449" d="M769 671c0 0 -1 -18 -13 -19c-37 -2 -79 -5 -128 -83l-360 -573c-8 -13 -12 -18 -28 -18c-13 0 -17 3 -20 23l-79 617c-3 25 -4 34 -60 34c-16 0 -25 0 -25 12c0 19 12 19 19 19c17 0 36 -2 54 -2s37 -1 55 -1c41 0 84 3 124 3c6 0 14 -2 14 -11c0 -20 -11 -20 -25 -20 c-46 0 -69 -13 -69 -30l68 -529l307 488s15 23 15 38c0 21 -19 31 -46 33c-7 0 -16 1 -16 12c0 19 13 19 19 19c32 0 66 -3 99 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D449" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="769" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1159" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1742" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2409" y="0"></use>
<g transform="translate(3466,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-36"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1001" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="5134" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5896" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6286" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6869" y="0"></use>
</g>
</svg>.

</p>
<p>Remarkably, spectra with substantially different distributions may have
very similar <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg> values.  To the human observer,
such spectra appear the same.  Pairs of such spectra are called
<em>metamers</em>.

</p>
<p>Figure&nbsp;<a href="#fig:xyz-3d-curve">4.19</a> shows a 3D plot of the curve in the XYZ space
corresponding to the XYZ coefficients for single wavelengths of light
over the visible range.  The coefficients for more complex spectral
distributions therefore correspond to linear combinations of points along
this curve.  Although all spectral distributions can be represented with
XYZ coefficients, not all values of XYZ coefficients correspond to realizable
spectra; such sets of coefficients are termed <em>imaginary colors</em>.

</p>
<p></p>
<span class="anchor" id="fig:xyz-3d-curve"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f19.svg" title=""><img src="pha04f19.svg" width=400 height=385 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.19: <span class="legend">
Plot of XYZ color coefficients for the wavelengths of
light in the visible range.  The curve is shaded with the RGB color
associated with each wavelength.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Three functions in the <tt>Spectra</tt> namespace provide the CIE XYZ matching
curves sampled at 1-nm increments from 360&nbsp;nm to 830&nbsp;nm.

</p>
<p></p>
<span class="anchor" id="fragment-SpectralFunctionDeclarations-1"></span><div class="fragmentname">&lt;&lt;Spectral Function Declarations&gt;&gt;+=&nbsp;<a href="Representing_Spectral_Distributions.html#fragment-SpectralFunctionDeclarations-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">namespace Spectra {
    const DenselySampledSpectrum &amp;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::X" class="code">X</a>();
    const DenselySampledSpectrum &amp;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Y" class="code">Y</a>();
    const DenselySampledSpectrum &amp;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Z</a>();
}</div><p>


</p>
<p>The integral of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.936ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2125 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1735" y="0"></use>
</g>
</svg> is precomputed and available in a constant.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumConstants-2"></span><div class="fragmentname">&lt;&lt;Spectrum Constants&gt;&gt;+=&nbsp;<a href="Representing_Spectral_Distributions.html#fragment-SpectrumConstants-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static constexpr Float <span class="anchor" id="CIE_Y_integral"></span>CIE_Y_integral = 106.856895;</div><p>


</p>
<p>There is also an <tt>XYZ</tt> class that represents XYZ colors.

</p>
<p></p>
<span class="anchor" id="fragment-XYZDefinition-0"></span><div class="fragmentname">&lt;&lt;XYZ Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="XYZ"></span>XYZ {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-XYZPublicMethods-0">XYZ Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-167" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-167"><i></i></a><div id="fragbit-167" class="collapse"><div class="fragmentcode">       <a href="#XYZ" class="code">XYZ</a>(Float <a href="#XYZ::X" class="code">X</a>, Float <a href="#XYZ::Y" class="code">Y</a>, Float <a href="#XYZ::Z" class="code">Z</a>) : <a href="#XYZ::X" class="code">X</a>(<a href="#XYZ::X" class="code">X</a>), <a href="#XYZ::Y" class="code">Y</a>(<a href="#XYZ::Y" class="code">Y</a>), <a href="#XYZ::Z" class="code">Z</a>(<a href="#XYZ::Z" class="code">Z</a>) {}
       Float Average() const { return (<a href="#XYZ::X" class="code">X</a> + <a href="#XYZ::Y" class="code">Y</a> + <a href="#XYZ::Z" class="code">Z</a>) / 3; }
       <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> xy() const {
           return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="#XYZ::X" class="code">X</a> / (<a href="#XYZ::X" class="code">X</a> + <a href="#XYZ::Y" class="code">Y</a> + <a href="#XYZ::Z" class="code">Z</a>), <a href="#XYZ::Y" class="code">Y</a> / (<a href="#XYZ::X" class="code">X</a> + <a href="#XYZ::Y" class="code">Y</a> + <a href="#XYZ::Z" class="code">Z</a>));
       }
       static <a href="#XYZ" class="code">XYZ</a> FromxyY(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> xy, Float <a href="#XYZ::Y" class="code">Y</a> = 1) {
           if (xy.y == 0)
               return <a href="#XYZ" class="code">XYZ</a>(0, 0, 0);
           return <a href="#XYZ" class="code">XYZ</a>(xy.x * <a href="#XYZ::Y" class="code">Y</a> / xy.y, <a href="#XYZ::Y" class="code">Y</a>, (1 - xy.x - xy.y) * <a href="#XYZ::Y" class="code">Y</a> / xy.y);
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> &amp;operator+=(const <a href="#XYZ" class="code">XYZ</a> &amp;s) {
           <a href="#XYZ::X" class="code">X</a> += s.<a href="#XYZ::X" class="code">X</a>;
           <a href="#XYZ::Y" class="code">Y</a> += s.<a href="#XYZ::Y" class="code">Y</a>;
           <a href="#XYZ::Z" class="code">Z</a> += s.<a href="#XYZ::Z" class="code">Z</a>;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator+(const <a href="#XYZ" class="code">XYZ</a> &amp;s) const {
           <a href="#XYZ" class="code">XYZ</a> ret = *this;
           return ret += s;
       }
       
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> &amp;operator-=(const <a href="#XYZ" class="code">XYZ</a> &amp;s) {
           <a href="#XYZ::X" class="code">X</a> -= s.<a href="#XYZ::X" class="code">X</a>;
           <a href="#XYZ::Y" class="code">Y</a> -= s.<a href="#XYZ::Y" class="code">Y</a>;
           <a href="#XYZ::Z" class="code">Z</a> -= s.<a href="#XYZ::Z" class="code">Z</a>;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator-(const <a href="#XYZ" class="code">XYZ</a> &amp;s) const {
           <a href="#XYZ" class="code">XYZ</a> ret = *this;
           return ret -= s;
       }
       PBRT_CPU_GPU
       friend <a href="#XYZ" class="code">XYZ</a> operator-(Float a, const <a href="#XYZ" class="code">XYZ</a> &amp;s) { return {a - s.<a href="#XYZ::X" class="code">X</a>, a - s.<a href="#XYZ::Y" class="code">Y</a>, a - s.<a href="#XYZ::Z" class="code">Z</a>}; }
       
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> &amp;operator*=(const <a href="#XYZ" class="code">XYZ</a> &amp;s) {
           <a href="#XYZ::X" class="code">X</a> *= s.<a href="#XYZ::X" class="code">X</a>;
           <a href="#XYZ::Y" class="code">Y</a> *= s.<a href="#XYZ::Y" class="code">Y</a>;
           <a href="#XYZ::Z" class="code">Z</a> *= s.<a href="#XYZ::Z" class="code">Z</a>;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator*(const <a href="#XYZ" class="code">XYZ</a> &amp;s) const {
           <a href="#XYZ" class="code">XYZ</a> ret = *this;
           return ret *= s;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator*(Float a) const {
           DCHECK(!IsNaN(a));
           return {a * <a href="#XYZ::X" class="code">X</a>, a * <a href="#XYZ::Y" class="code">Y</a>, a * <a href="#XYZ::Z" class="code">Z</a>};
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> &amp;operator*=(Float a) {
           DCHECK(!IsNaN(a));
           <a href="#XYZ::X" class="code">X</a> *= a;
           <a href="#XYZ::Y" class="code">Y</a> *= a;
           <a href="#XYZ::Z" class="code">Z</a> *= a;
           return *this;
       }
       
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> &amp;operator/=(const <a href="#XYZ" class="code">XYZ</a> &amp;s) {
           <a href="#XYZ::X" class="code">X</a> /= s.<a href="#XYZ::X" class="code">X</a>;
           <a href="#XYZ::Y" class="code">Y</a> /= s.<a href="#XYZ::Y" class="code">Y</a>;
           <a href="#XYZ::Z" class="code">Z</a> /= s.<a href="#XYZ::Z" class="code">Z</a>;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator/(const <a href="#XYZ" class="code">XYZ</a> &amp;s) const {
           <a href="#XYZ" class="code">XYZ</a> ret = *this;
           return ret /= s;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> &amp;operator/=(Float a) {
           DCHECK(!IsNaN(a));
           DCHECK_NE(a, 0);
           <a href="#XYZ::X" class="code">X</a> /= a;
           <a href="#XYZ::Y" class="code">Y</a> /= a;
           <a href="#XYZ::Z" class="code">Z</a> /= a;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator/(Float a) const {
           <a href="#XYZ" class="code">XYZ</a> ret = *this;
           return ret /= a;
       }
       
       PBRT_CPU_GPU
       <a href="#XYZ" class="code">XYZ</a> operator-() const { return {-<a href="#XYZ::X" class="code">X</a>, -<a href="#XYZ::Y" class="code">Y</a>, -<a href="#XYZ::Z" class="code">Z</a>}; }
       
       PBRT_CPU_GPU
       bool operator==(const <a href="#XYZ" class="code">XYZ</a> &amp;s) const { return <a href="#XYZ::X" class="code">X</a> == s.<a href="#XYZ::X" class="code">X</a> &amp;&amp; <a href="#XYZ::Y" class="code">Y</a> == s.<a href="#XYZ::Y" class="code">Y</a> &amp;&amp; <a href="#XYZ::Z" class="code">Z</a> == s.<a href="#XYZ::Z" class="code">Z</a>; }
       PBRT_CPU_GPU
       bool operator!=(const <a href="#XYZ" class="code">XYZ</a> &amp;s) const { return <a href="#XYZ::X" class="code">X</a> != s.<a href="#XYZ::X" class="code">X</a> || <a href="#XYZ::Y" class="code">Y</a> != s.<a href="#XYZ::Y" class="code">Y</a> || <a href="#XYZ::Z" class="code">Z</a> != s.<a href="#XYZ::Z" class="code">Z</a>; }
       PBRT_CPU_GPU
       Float operator[](int c) const {
           DCHECK(c &gt;= 0 &amp;&amp; c &lt; 3);
           if (c == 0)
               return <a href="#XYZ::X" class="code">X</a>;
           else if (c == 1)
               return <a href="#XYZ::Y" class="code">Y</a>;
           return <a href="#XYZ::Z" class="code">Z</a>;
       }
       PBRT_CPU_GPU
       Float &amp;operator[](int c) {
           DCHECK(c &gt;= 0 &amp;&amp; c &lt; 3);
           if (c == 0)
               return <a href="#XYZ::X" class="code">X</a>;
           else if (c == 1)
               return <a href="#XYZ::Y" class="code">Y</a>;
           return <a href="#XYZ::Z" class="code">Z</a>;
       }
       
       std::string ToString() const;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-XYZPublicMembers-0">XYZ Public Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-168" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-168"><i></i></a><div id="fragbit-168" class="collapse"><div class="fragmentcode">       Float X = 0, Y = 0, Z = 0;</div></div>
};</div><p>


</p>
<p>Its implementation is the obvious one, using three <tt>Float</tt> values to
represent the three color components.  All the regular arithmetic
operations are provided for <tt>XYZ</tt> in methods that are not included in
the text here.

</p>
<p></p>
<span class="anchor" id="fragment-XYZPublicMethods-0"></span><div class="fragmentname">&lt;&lt;XYZ Public Methods&gt;&gt;=&nbsp;<a href="#fragment-XYZPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#XYZ" class="code">XYZ</a>(Float X, Float Y, Float Z) : X(X), Y(Y), Z(Z) {}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-XYZPublicMembers-0"></span><div class="fragmentname">&lt;&lt;XYZ Public Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="XYZ::X"></span>X = 0, <span class="anchor" id="XYZ::Y"></span>Y = 0, <span class="anchor" id="XYZ::Z"></span>Z = 0;</div><p>


</p>
<p>

</p>
<p>The <tt>SpectrumToXYZ()</tt> function computes the XYZ coefficients of a
spectral distribution following Equation&nbsp;(<a href="#eq:xyz-matching">4.22</a>) using the
following <tt>InnerProduct()</tt> utility function to handle each component.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumFunctionDefinitions-0"></span><div class="fragmentname">&lt;&lt;Spectrum Function Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#XYZ" class="code">XYZ</a> <span class="anchor" id="SpectrumToXYZ"></span>SpectrumToXYZ(<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum" class="code">Spectrum</a> s) {
    return <a href="#XYZ" class="code">XYZ</a>(<a href="#Spectrum::InnerProduct" class="code">InnerProduct</a>(&amp;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::X(), s),
               <a href="#Spectrum::InnerProduct" class="code">InnerProduct</a>(&amp;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::Y(), s),
               <a href="#Spectrum::InnerProduct" class="code">InnerProduct</a>(&amp;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::Z(), s)) / <a href="#CIE_Y_integral" class="code">CIE_Y_integral</a>;
}</div><p>


</p>
<p>Monte Carlo is not necessary for a simple 1D integral of two spectra, so <tt>InnerProduct()</tt>
computes a Riemann sum over integer wavelengths instead:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.63ex" height="7.676ex" style="vertical-align: -3.338ex;" viewBox="0 -1867.7 16201.9 3304.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">integral Subscript lamda Subscript normal m normal i normal n Baseline Superscript lamda Subscript normal m normal a normal x Baseline Baseline f left-parenthesis lamda right-parenthesis g left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline almost-equals sigma-summation Underscript lamda equals lamda Subscript normal m normal i normal n Baseline Overscript lamda Subscript normal m normal a normal x Baseline Endscripts f left-parenthesis lamda right-parenthesis g left-parenthesis lamda right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-78" d="M516 0c-30 2 -69 3 -96 3l-108 -3v31c27 1 36 16 36 25c0 6 -13 22 -21 33l-76 100c-61 -72 -90 -105 -90 -127c0 -15 7 -28 29 -31v-31l-95 3c-26 0 -57 -1 -83 -3v31c21 0 80 2 128 60c47 57 47 59 94 119l-99 129c-47 60 -48 61 -118 61v31c27 -2 74 -3 95 -3l108 3 v-31c-20 -1 -35 -10 -35 -25c0 -6 0 -8 9 -18l78 -101l62 78c5 6 15 19 15 35s-8 29 -29 31v31c13 -1 66 -3 96 -3c26 0 56 1 82 3v-31c-47 -1 -88 -16 -119 -52c-24 -26 -62 -75 -92 -113l134 -173c23 -29 41 -31 95 -31v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="0" y="0"></use>
<g transform="translate(1054,1088)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(412,-107)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
<g transform="translate(574,-898)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(412,-135)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-69" x="833" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-6E" x="1112" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="2873" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3425" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3815" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4398" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="4955" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5432" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5822" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6405" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="6961" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7518" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="8379" y="0"></use>
<g transform="translate(9430,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="479" y="0"></use>
<g transform="translate(0,-1110)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="583" y="0"></use>
<g transform="translate(963,0)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(412,-135)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-69" x="833" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-6E" x="1112" y="0"></use>
</g>
</g>
</g>
<g transform="translate(425,1175)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
<g transform="translate(412,-107)">
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-6D" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-61" x="833" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNMAIN-78" x="1334" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="12001" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="12554" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="12943" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="13527" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="14083" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="14560" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="14950" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="15533" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="15923" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p></p>
<span class="anchor" id="fragment-SpectrumInlineFunctions-0"></span><div class="fragmentname">&lt;&lt;Spectrum Inline Functions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="Spectrum::InnerProduct"></span>InnerProduct(<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum" class="code">Spectrum</a> f, <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum" class="code">Spectrum</a> g) {
    Float integral = 0;
    for (Float <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::operator" class="code">lambda</a> = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Lambda_min" class="code">Lambda_min</a>; <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::operator" class="code">lambda</a> &lt;= <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Lambda_max" class="code">Lambda_max</a>; ++<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::operator" class="code">lambda</a>)
        integral += f(<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::operator" class="code">lambda</a>) * g(<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::operator" class="code">lambda</a>);
    return integral;
}</div><p>


</p>
<p>It is also useful to be able to compute XYZ coefficients for a <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum"><tt>SampledSpectrum</tt></a>.
Because <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum"><tt>SampledSpectrum</tt></a> only has point samples of the spectral
distribution at predetermined wavelengths, they are found via a Monte
Carlo estimate of Equation&nbsp;(<a href="#eq:xyz-matching">4.22</a>) using the sampled
spectral values <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.89ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 813.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">s Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="663" y="-213"></use>
</g>
</svg> at wavelengths <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.155ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 927.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">lamda Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
</svg> and their associated PDFs:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:xyz-mc"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.053ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 16383.9 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda Baseline almost-equals StartFraction 1 Over integral Underscript lamda Endscripts upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline EndFraction left-parenthesis StartFraction 1 Over n EndFraction sigma-summation Underscript i equals 1 Overscript n Endscripts StartFraction s Subscript i Baseline upper X left-parenthesis lamda Subscript i Baseline right-parenthesis Over p left-parenthesis lamda Subscript i Baseline right-parenthesis EndFraction right-parenthesis comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-222B" d="M609 722c0 -30 -22 -43 -42 -43c-19 0 -41 13 -41 42c0 14 8 37 37 41c-22 19 -53 21 -63 21c-45 0 -79 -25 -93 -209l-19 -249c-8 -111 -44 -402 -57 -454c-22 -90 -70 -177 -165 -177c-60 0 -110 35 -110 83c0 30 22 43 42 43c19 0 41 -13 41 -42c0 -14 -8 -37 -37 -41 c21 -18 51 -21 64 -21c57 0 93 45 106 209l19 249c9 121 45 403 57 458c17 76 56 173 151 173c60 0 110 -35 110 -83Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-2211" d="M1387 -130l-121 -320h-1182c-18 0 -27 0 -27 11c0 0 0 6 10 18l518 607l-529 724c0 11 0 30 1 33c3 6 4 7 27 7h1182l121 -281h-25c-34 81 -102 126 -127 142c-79 50 -166 67 -220 75c-9 2 -100 16 -234 16h-548l466 -637c7 -10 7 -15 7 -15c0 -5 -2 -8 -9 -16l-509 -597 h603c192 0 290 26 311 31c115 30 221 98 260 202h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45D" d="M490 282c0 -147 -125 -293 -241 -293c-51 0 -79 35 -92 64c-7 -25 -49 -188 -49 -200c0 -9 0 -16 50 -16c14 0 24 0 24 -11c0 -20 -13 -20 -18 -20c-32 0 -66 3 -99 3c-28 0 -57 -3 -84 -3c-8 0 -13 4 -13 12c0 19 11 19 23 19c44 0 46 7 54 41l112 445c4 17 7 28 7 51 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c37 0 80 -21 90 -75c33 39 81 75 131 75c76 0 133 -66 133 -160zM418 326c0 59 -24 94 -64 94c-17 0 -46 -7 -81 -38c-18 -15 -45 -43 -52 -70 l-49 -196c-3 -12 -3 -16 -3 -16c0 -6 13 -89 79 -89c37 0 85 33 119 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-28" d="M823 -1224c0 -11 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 202 -513 751 -513 1241v500c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-500c0 -468 180 -1015 435 -1207c6 -4 9 -10 9 -17Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE7-29" d="M598 0c0 -490 -245 -1039 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 10 -21 21c0 7 3 13 9 17c255 192 435 739 435 1207v500c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="1362" y="0"></use>
<g transform="translate(2136,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4896" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2197" y="676"></use>
<g transform="translate(60,-826)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="941" y="-484"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="1344" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2107" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2496" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3080" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="3636" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4192" y="0"></use>
</g>
</g>
</g>
<g transform="translate(7550,0)">
 <use xlink:href="#E1-LATINMODERNSIZE7-28"></use>
<g transform="translate(875,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="110" y="676"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2002,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="721" y="1627"></use>
</g>
<g transform="translate(3447,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="3658" height="60" x="0" y="220"></rect>
<g transform="translate(60,768)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="663" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="980" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1831" y="0"></use>
<g transform="translate(2221,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3149" y="0"></use>
</g>
<g transform="translate(724,-769)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="503" y="0"></use>
<g transform="translate(893,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="825" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1820" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE7-29" x="7512" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="16105" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:xyz-mc">4.23</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

and so forth, where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg> is the number of wavelength samples.

</p>
<p><a href="#SampledSpectrum::ToXYZ"><tt>SampledSpectrum::ToXYZ()</tt></a> computes the value of this estimator.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-2"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="Representing_Spectral_Distributions.html#fragment-SpectrumMethodDefinitions-1"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumMethodDefinitions-3"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#XYZ" class="code">XYZ</a> <span class="anchor" id="SampledSpectrum::ToXYZ"></span><a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a>::ToXYZ(const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths" class="code">SampledWavelengths</a> &amp;lambda) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-SampletheXYandZmatchingcurvesatmonolambda-0">Sample the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.978ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 851.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper X</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.771ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 762.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="0" y="0"></use>
</g>
</svg> matching curves at <tt>lambda</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-169" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-169"><i></i></a><div id="fragbit-169" class="collapse"><div class="fragmentcode">       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> X = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::X().<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::Sample" class="code">Sample</a>(lambda);
       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Y = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::Y().<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::Sample" class="code">Sample</a>(lambda);
       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Z = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::Z().<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::Sample" class="code">Sample</a>(lambda);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Evaluateestimatortocomputexyzcoefficients-0">Evaluate estimator to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.432ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3199.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y comma z right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1897" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="2342" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2810" y="0"></use>
</g>
</svg> coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-170" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-170"><i></i></a><div id="fragbit-170" class="collapse"><div class="fragmentcode">       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> pdf = lambda.<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths::PDF" class="code">PDF</a>();
       return <a href="#XYZ" class="code">XYZ</a>(<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv" class="code">SafeDiv</a>(X * *this, pdf).<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average" class="code">Average</a>(),
                  <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv" class="code">SafeDiv</a>(Y * *this, pdf).<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average" class="code">Average</a>(),
                  <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv" class="code">SafeDiv</a>(Z * *this, pdf).<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average" class="code">Average</a>()) / <a href="#CIE_Y_integral" class="code">CIE_Y_integral</a>;</div></div>
}</div><p>


</p>
<p>The first step is to sample the
matching curves at the specified wavelengths.

</p>
<p></p>
<span class="anchor" id="fragment-SampletheXYandZmatchingcurvesatmonolambda-0"></span><div class="fragmentname">&lt;&lt;Sample the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.978ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 851.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper X</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.771ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 762.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="0" y="0"></use>
</g>
</svg> matching curves at <tt>lambda</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> X = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::X().<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::Sample" class="code">Sample</a>(lambda);
<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Y = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::Y().<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::Sample" class="code">Sample</a>(lambda);
<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Z = <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectra::Z" class="code">Spectra</a>::Z().<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::Sample" class="code">Sample</a>(lambda);</div><p>


</p>
<p>The summand in Equation&nbsp;(<a href="#eq:xyz-mc">4.23</a>) is easily computed with values at
hand.  Here, we evaluate all terms of each sum with a single
expression.  Using <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv"><tt>SampledSpectrum::SafeDiv()</tt></a> to divide by the PDF
values handles the case of the PDF being equal to zero for some
wavelengths, as can happen if
<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths::TerminateSecondary"><tt>SampledWavelengths::TerminateSecondary()</tt></a> was called.  Finally,
<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average"><tt>SampledSpectrum::Average()</tt></a> conveniently takes care of summing the
individual terms and dividing by <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">n</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="0" y="0"></use>
</g>
</svg> to compute the estimator&rsquo;s value for
each coefficient.

</p>
<p></p>
<span class="anchor" id="fragment-Evaluateestimatortocomputexyzcoefficients-0"></span><div class="fragmentname">&lt;&lt;Evaluate estimator to compute <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.432ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3199.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y comma z right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1897" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="2342" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2810" y="0"></use>
</g>
</svg> coefficients&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> pdf = lambda.<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths::PDF" class="code">PDF</a>();
return <a href="#XYZ" class="code">XYZ</a>(<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv" class="code">SafeDiv</a>(X * *this, pdf).<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average" class="code">Average</a>(),
           <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv" class="code">SafeDiv</a>(Y * *this, pdf).<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average" class="code">Average</a>(),
           <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::SafeDiv" class="code">SafeDiv</a>(Z * *this, pdf).<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum::Average" class="code">Average</a>()) / <a href="#CIE_Y_integral" class="code">CIE_Y_integral</a>;</div><p>


</p>
<p>To avoid the expense of computing the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.978ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 851.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper X</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="0" y="0"></use>
</g>
</svg> coefficients
when only luminance is needed, there is a
<tt>y()</tt><span class="anchor" id="SampledSpectrum::y"></span> method that only returns <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.771ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 762.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
</g>
</svg>.
Its implementation is the obvious subset of <tt>XYZ()</tt> and so is not
included here.

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x1-ChromaticityandxyYColor"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x1-ChromaticityandxyYColor"></span><h4>Chromaticity and xyY Color</h4><p>


</p>
<p>Color can be separated into <em>lightness</em>, which describes how bright it
is relative to something white, and <em>chroma</em>, which describes its
relative colorfulness with respect to white.  One approach to quantifying
chroma is the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.555ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1530.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="1063" y="0"></use>
</g>
</svg> <em>chromaticity coordinates</em>, which are defined in
terms of XYZ color space coordinates by
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.876ex" height="16.843ex" style="vertical-align: -7.838ex;" viewBox="0 -3877 13724.2 7251.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column x 2nd Column equals StartFraction x Subscript lamda Baseline Over x Subscript lamda Baseline plus y Subscript lamda Baseline plus z Subscript lamda Baseline EndFraction 2nd Row 1st Column y 2nd Column equals StartFraction y Subscript lamda Baseline Over x Subscript lamda Baseline plus y Subscript lamda Baseline plus z Subscript lamda Baseline EndFraction 3rd Row 1st Column z 2nd Column equals StartFraction z Subscript lamda Baseline Over x Subscript lamda Baseline plus y Subscript lamda Baseline plus z Subscript lamda Baseline EndFraction equals 1 minus x minus y period EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="2672"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="82" y="111"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="105" y="-2403"></use>
</g>
<g transform="translate(839,0)">
<g transform="translate(0,2672)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5632" height="60" x="0" y="220"></rect>
<g transform="translate(2273,679)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
<g transform="translate(60,-686)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1307" y="0"></use>
<g transform="translate(2308,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3533" y="0"></use>
<g transform="translate(4534,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(0,111)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5632" height="60" x="0" y="220"></rect>
<g transform="translate(2314,725)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
<g transform="translate(60,-686)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1307" y="0"></use>
<g transform="translate(2308,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3533" y="0"></use>
<g transform="translate(4534,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(0,-2403)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5632" height="60" x="0" y="220"></rect>
<g transform="translate(2327,679)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
<g transform="translate(60,-686)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="1307" y="0"></use>
<g transform="translate(2308,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="3533" y="0"></use>
<g transform="translate(4534,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="7206" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="8262" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="8985" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="9985" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2212" x="10780" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="11781" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="12271" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>
<p>

Note that any two of them are sufficient to specify chromaticity.

</p>
<p>Considering just <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, we can plot a
<em>chromaticity diagram</em> to visualize their values; see
Figure&nbsp;<a href="#fig:xy-chromaticity-diagram">4.20</a>.
Spectra with light at just a single wavelength&mdash;the pure spectral
colors&mdash;lie along the curved part of the chromaticity diagram.  This part
corresponds to the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> projection of the 3D XYZ curve that was shown in
Figure&nbsp;<a href="#fig:xyz-3d-curve">4.19</a>.  All the valid colors lie inside the upside-down
horseshoe shape; points outside that region correspond to imaginary
colors.

</p>
<p></p>
<span class="anchor" id="fig:xy-chromaticity-diagram"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f20.svg" title=""><img src="pha04f20.svg" width=378 height=376 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.20: <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> Chromaticity Diagram. <span class="legend">
All valid colors lie inside the shaded region.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The xyY color space separates a color&rsquo;s chromaticity from its lightness.
It uses the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> chromaticity coordinates and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg> from XYZ,
since the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.936ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2125 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper Y left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="762" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1152" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1735" y="0"></use>
</g>
</svg> matching curve was defined to be proportional to
luminance.  <tt>pbrt</tt> makes limited use of xyY colors and therefore does not
provide a class to represent them, but the <a href="#XYZ"><tt>XYZ</tt></a> class does provide a
method that returns its <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> chromaticity coordinates as a <a href="../Geometry_and_Transformations/Points.html#Point2f"><tt>Point2f</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-XYZPublicMethods-1"></span><div class="fragmentname">&lt;&lt;XYZ Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-XYZPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-XYZPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="XYZ::xy"></span>xy() const {
    return <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a>(<a href="#XYZ::X" class="code">X</a> / (<a href="#XYZ::X" class="code">X</a> + <a href="#XYZ::Y" class="code">Y</a> + <a href="#XYZ::Z" class="code">Z</a>), <a href="#XYZ::Y" class="code">Y</a> / (<a href="#XYZ::X" class="code">X</a> + <a href="#XYZ::Y" class="code">Y</a> + <a href="#XYZ::Z" class="code">Z</a>));
}</div><p>


</p>
<p>A corresponding method converts from xyY to XYZ, given <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> and
optionally <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg> coordinates.

</p>
<p></p>
<span class="anchor" id="fragment-XYZPublicMethods-2"></span><div class="fragmentname">&lt;&lt;XYZ Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-XYZPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static <a href="#XYZ" class="code">XYZ</a> <span class="anchor" id="XYZ::FromxyY"></span>FromxyY(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> xy, Float Y = 1) {
    if (xy.y == 0)
        return <a href="#XYZ" class="code">XYZ</a>(0, 0, 0);
    return <a href="#XYZ" class="code">XYZ</a>(xy.x * Y / xy.y, Y, (1 - xy.x - xy.y) * Y / xy.y);
}</div><p>


</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#RGBColor"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:rgb"></span><span id="RGBColor"></span><h3>4.6.2  RGB Color</h3><p>



</p>
<p>RGB color is used more commonly than XYZ in rendering applications.  In
RGB color spaces, colors are represented by a triplet of values
corresponding to red, green, and blue colors, often referred to as
<em>RGB</em>.  However, an RGB triplet on its own is meaningless; it must be
defined with respect to a specific RGB color space.

</p>
<p>To understand why, consider what happens when an RGB color is shown on a
display: the spectrum that is displayed is given by the weighted
sum of three spectral emission curves, one for each of red, green, and
blue, as emitted by the display elements, be they phosphors, LED or LCD
elements, or plasma cells.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="This model is admittedly a
simplification in that it neglects any additional processing the display
does; in particular, many displays perform nonlinear remappings of the
displayed values; this topic will be discussed in
Section&nbsp;<a href="../Utilities/Images.html#sec:color-encodings">B.5.6</a>.">
      <sup>&dagger;</sup>
    </button>
		  Figure&nbsp;<a href="#fig:display-rgb-plots">4.21</a>
plots the red, green, and blue distributions emitted by an LCD display and
an LED display; note that they are remarkably different.
Figure&nbsp;<a href="#fig:display-rgb-result">4.22</a> in turn shows the spectral
distributions that result from displaying the RGB color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.792ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5507.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.6 comma 0.3 comma 0.2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1669" y="0"></use>
<g transform="translate(2114,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3393" y="0"></use>
<g transform="translate(3838,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5118" y="0"></use>
</g>
</svg>
on those displays.  Not surprisingly, the resulting spectra are quite
different as&nbsp;well.

</p>
<p></p>
<span class="anchor" id="fig:display-rgb-plots"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f21.svg" title=""><img src="pha04f21.svg" width=784 height=299 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.21: Red, Green, and Blue Emission Curves for an LCD Display and an LED
  Display. <span class="legend">
  The first plot shows the curves for an LCD display, and the second shows
  them for an LED.
  These two
  displays have quite different emission profiles. <em>(Data courtesy of
    X-Rite, Inc.)</em></span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fig:display-rgb-result"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f22.svg" title=""><img src="pha04f22.svg" width=364 height=281 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.22: Spectral Distributions from Displaying the RGB Color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.792ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5507.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.6 comma 0.3 comma 0.2 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1669" y="0"></use>
<g transform="translate(2114,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3393" y="0"></use>
<g transform="translate(3838,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5118" y="0"></use>
</g>
</svg>
on LED (red) and LCD (blue) Displays. <span class="legend">  The
resulting emitted distributions are remarkably
different, even given the same RGB values, due to the different emission
curves illustrated in Figure&nbsp;<a href="#fig:display-rgb-plots">4.21</a>.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>If a display&rsquo;s <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.929ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2122 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper R left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.991ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2149 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper G left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="786" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1176" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1759" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.929ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2122 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper B left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</svg> curves
are known, the RGB coefficients for displaying a spectral distribution
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg> on that display can be found by integrating <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg> with
each curve:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.387ex" height="5.676ex" style="vertical-align: -2.338ex;" viewBox="0 -1437.2 8777.6 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r equals integral upper R left-parenthesis lamda right-parenthesis upper S left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="729" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="1785" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="2895" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3655" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4044" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4628" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="5184" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5829" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6219" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6802" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="7359" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7915" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="8499" y="0"></use>
</g>
</svg>
</div>
<p>

and so forth.  The same approaches that were used to compute XYZ values for
spectra in the previous section can be used to compute the values of these
integrals.

</p>
<p>Alternatively, if we already have the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.999ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4735.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x Subscript lamda Baseline comma y Subscript lamda Baseline comma z Subscript lamda Baseline right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1474" y="0"></use>
<g transform="translate(1919,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2922" y="0"></use>
<g transform="translate(3368,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4346" y="0"></use>
</g>
</svg>
representation of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg>, it is possible to convert the XYZ
coefficients directly to corresponding RGB coefficients.
Consider, for example, computing the value of the red component for a spectral
distribution <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.664ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2008 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
</g>
</svg>:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:red-from-spectrum-integral"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.219ex" height="18.176ex" style="vertical-align: -8.505ex;" viewBox="0 -4164 28941.3 7825.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">StartLayout 1st Row 1st Column r 2nd Column equals integral upper R left-parenthesis lamda right-parenthesis upper S left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Row 1st Column Blank 2nd Column almost-equals integral upper R left-parenthesis lamda right-parenthesis left-parenthesis x Subscript lamda Baseline upper X left-parenthesis lamda right-parenthesis plus y Subscript lamda Baseline upper Y left-parenthesis lamda right-parenthesis plus z Subscript lamda Baseline upper Z left-parenthesis lamda right-parenthesis right-parenthesis normal d lamda Subscript Baseline 3rd Row 1st Column Blank 2nd Column equals x Subscript lamda Baseline integral upper R left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline plus y Subscript lamda Baseline integral upper R left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline plus z Subscript lamda Baseline integral upper R left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline comma EndLayout</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="2724"></use>
</g>
<g transform="translate(718,0)">
<g transform="translate(0,2724)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="1056" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="2166" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2925" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3315" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3898" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="4455" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5100" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5490" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6073" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="6629" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="7186" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="1051" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="2161" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="2920" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3893" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4283" y="0"></use>
<g transform="translate(4672,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="5758" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6609" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6999" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7582" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="8194" y="0"></use>
<g transform="translate(9194,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="10198" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="10960" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="11350" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="11933" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="12545" y="0"></use>
<g transform="translate(13546,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="14524" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="15247" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="15637" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="16220" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="16610" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="17166" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="17722" y="0"></use>
<g transform="translate(0,-2724)">
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="2308" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="3418" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="4177" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4567" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5150" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="5706" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="6558" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6947" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7531" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="8087" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8644" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9449" y="0"></use>
<g transform="translate(10450,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="11620" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="12730" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="13489" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="13879" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="14462" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="15019" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="15781" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="16171" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="16754" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="17310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="17867" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="18672" y="0"></use>
<g transform="translate(19673,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSIZE1-222B" x="20818" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="21928" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="22688" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="23077" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="23661" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="24217" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="24940" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="25330" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="25913" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="26469" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="27026" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="27609" y="0"></use>
</g>
</g>
</g>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:red-from-spectrum-integral">4.24</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

where the second step takes advantage of the tristimulus theory of color
perception.

</p>
<p>The integrals of the products of an RGB response function and XYZ
matching function can be precomputed for given response curves, making it
possible to express the full conversion as a matrix:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="71.277ex" height="10.176ex" style="vertical-align: -4.505ex;" viewBox="0 -2441.8 30688.6 4381.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 3 By 1 Matrix 1st Row  r 2nd Row  g 3rd Row  b EndMatrix equals Start 3 By 3 Matrix 1st Row 1st Column integral upper R left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Column integral upper R left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Column integral upper R left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Row 1st Column integral upper G left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Column integral upper G left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Column integral upper G left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Row 1st Column integral upper B left-parenthesis lamda right-parenthesis upper X left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 2nd Column integral upper B left-parenthesis lamda right-parenthesis upper Y left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline 3rd Column integral upper B left-parenthesis lamda right-parenthesis upper Z left-parenthesis lamda right-parenthesis normal d lamda Subscript Baseline EndMatrix Start 3 By 1 Matrix 1st Row  x Subscript lamda Baseline 2nd Row  y Subscript lamda Baseline 3rd Row  z Subscript lamda Baseline EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-222B" d="M609 722c0 -30 -22 -43 -42 -43c-19 0 -41 13 -41 42c0 14 8 37 37 41c-22 19 -53 21 -63 21c-45 0 -79 -25 -93 -209l-19 -249c-8 -111 -44 -402 -57 -454c-22 -90 -70 -177 -165 -177c-60 0 -110 35 -110 83c0 30 22 43 42 43c19 0 41 -13 41 -42c0 -14 -8 -37 -37 -41 c21 -18 51 -21 64 -21c57 0 93 45 106 209l19 249c9 121 45 403 57 458c17 76 56 173 151 173c60 0 110 -35 110 -83Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44B" d="M851 672c0 -19 -9 -19 -22 -20c-60 -3 -98 -27 -127 -51c-32 -28 -137 -147 -205 -217l129 -309c17 -40 19 -43 86 -44c8 0 18 0 18 -12c0 -19 -12 -19 -19 -19c-25 0 -86 3 -111 3l-126 -3c-4 0 -15 0 -15 12c0 17 9 18 20 19c39 4 58 21 58 29l-5 14l-101 239l-90 -98 l-102 -108c-12 -13 -27 -29 -27 -45c0 -28 31 -30 40 -31c0 0 12 -1 12 -11c0 -20 -12 -20 -18 -20c-36 0 -75 3 -112 3c-31 0 -64 -3 -94 -3c-13 0 -13 11 -13 11c0 19 9 19 22 20c51 3 98 19 147 72c6 5 7 6 13 11l211 227l-118 279c-9 22 -15 32 -75 32 c-13 0 -23 0 -23 11c0 20 12 20 18 20c25 0 87 -3 112 -3c42 0 85 3 126 3c3 0 15 0 15 -12c0 -17 -10 -18 -20 -19c-42 -4 -59 -23 -59 -29l5 -13l84 -199l162 174c8 9 19 22 19 36c0 28 -31 30 -40 31c-7 1 -12 4 -12 11c0 20 13 20 19 20c36 0 74 -3 111 -3 c31 0 64 3 94 3c13 0 13 -11 13 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44C" d="M762 671c0 -18 -9 -18 -20 -19c-68 -5 -101 -39 -131 -69l-14 -14l-248 -285c-8 -9 -9 -12 -14 -31l-35 -141c-5 -21 -14 -56 -14 -63c0 -12 6 -14 27 -16c17 -2 38 -2 38 -2c19 0 28 0 28 -11c0 -20 -12 -20 -19 -20l-128 3l-126 -3s-14 0 -14 11c0 20 8 20 27 20 c80 1 81 4 94 59c5 18 45 179 45 182s-3 14 -4 17l-123 329c-9 25 -13 34 -73 34c-13 0 -23 0 -23 11c0 20 13 20 19 20c25 0 87 -3 112 -3l126 3c3 0 15 0 15 -11c0 -20 -10 -20 -24 -20c-10 0 -59 0 -59 -24c0 0 0 -3 6 -17l110 -297l232 267c4 5 27 31 27 48 c0 21 -29 23 -36 23c-5 0 -15 1 -15 12c0 19 13 19 19 19c32 0 67 -3 100 -3c27 0 56 3 82 3c8 0 13 -4 13 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44D" d="M723 674c0 -6 -2 -11 -3 -15l-559 -625h171c170 0 218 72 262 208c7 21 8 25 17 25s13 -6 13 -11c0 -4 -3 -11 -4 -15l-71 -221c-6 -19 -7 -20 -31 -20h-435c-18 0 -25 0 -25 9c0 3 4 18 4 18l559 625h-163c-156 0 -208 -66 -246 -184c-2 -3 -4 -10 -13 -10 c-12 0 -12 11 -12 11s1 9 3 14l55 180c6 19 7 20 31 20h422c20 0 25 0 25 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="13" y="1353"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="-47"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="24" y="-1453"></use>
</g>
</g>
<g transform="translate(1468,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2413" y="0"></use>
<g transform="translate(3470,0)">
<g transform="translate(0,2319)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2689.51) scale(1,2.49)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-4138"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(13,1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="3120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3972" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4361" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5501" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6058" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="3147" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3999" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4388" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4972" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5528" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6085" y="0"></use>
<g transform="translate(13,-1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44B" x="3120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3972" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4361" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4945" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5501" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6058" y="0"></use>
</g>
</g>
<g transform="translate(7658,0)">
<g transform="translate(13,1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="3120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3883" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4272" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4856" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5412" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5969" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="3147" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3910" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4299" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4883" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5439" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5996" y="0"></use>
<g transform="translate(13,-1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44C" x="3120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3883" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4272" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4856" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5412" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5969" y="0"></use>
</g>
</g>
<g transform="translate(15237,0)">
<g transform="translate(13,1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="3120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3844" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4233" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4817" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5373" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5930" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="2008" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="3147" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3871" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4260" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4844" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5400" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5957" y="0"></use>
<g transform="translate(13,-1513)">
 <use xlink:href="#E1-LATINMODERNMAIN-222B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="832" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1591" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1981" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2564" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44D" x="3120" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3844" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="4233" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4817" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-64" x="5373" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="5930" y="0"></use>
</g>
</g>
</g>
<g transform="translate(22987,2319)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2689.51) scale(1,2.49)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-4138"></use>
</g>
</g>
<g transform="translate(27499,0)">
<g transform="translate(0,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1353)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
<g transform="translate(41,-47)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
<g transform="translate(53,-1453)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2076,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="30410" y="0"></use>
</g>
</svg>
</div>
<p>

<tt>pbrt</tt> frequently uses this approach in order to efficiently convert colors
from one color space to another.

</p>
<p>An <tt>RGB</tt> class that has the obvious representation and provides
a variety of useful arithmetic operations (not included in the text) is
also provided by <tt>pbrt</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-RGBDefinition-0"></span><div class="fragmentname">&lt;&lt;RGB Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="RGB"></span>RGB {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBPublicMethods-0">RGB Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-171" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-171"><i></i></a><div id="fragbit-171" class="collapse"><div class="fragmentcode">       <a href="#RGB" class="code">RGB</a>(Float r, Float g, Float b) : r(r), g(g), b(b) {}
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> &amp;operator+=(<a href="#RGB" class="code">RGB</a> s) {
           r += s.r;
           g += s.g;
           b += s.b;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator+(<a href="#RGB" class="code">RGB</a> s) const {
           <a href="#RGB" class="code">RGB</a> ret = *this;
           return ret += s;
       }
       
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> &amp;operator-=(<a href="#RGB" class="code">RGB</a> s) {
           r -= s.r;
           g -= s.g;
           b -= s.b;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator-(<a href="#RGB" class="code">RGB</a> s) const {
           <a href="#RGB" class="code">RGB</a> ret = *this;
           return ret -= s;
       }
       PBRT_CPU_GPU
       friend <a href="#RGB" class="code">RGB</a> operator-(Float a, <a href="#RGB" class="code">RGB</a> s) { return {a - s.r, a - s.g, a - s.b}; }
       
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> &amp;operator*=(<a href="#RGB" class="code">RGB</a> s) {
           r *= s.r;
           g *= s.g;
           b *= s.b;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator*(<a href="#RGB" class="code">RGB</a> s) const {
           <a href="#RGB" class="code">RGB</a> ret = *this;
           return ret *= s;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator*(Float a) const {
           DCHECK(!IsNaN(a));
           return {a * r, a * g, a * b};
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> &amp;operator*=(Float a) {
           DCHECK(!IsNaN(a));
           r *= a;
           g *= a;
           b *= a;
           return *this;
       }
       PBRT_CPU_GPU
       friend <a href="#RGB" class="code">RGB</a> operator*(Float a, <a href="#RGB" class="code">RGB</a> s) { return s * a; }
       
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> &amp;operator/=(<a href="#RGB" class="code">RGB</a> s) {
           r /= s.r;
           g /= s.g;
           b /= s.b;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator/(<a href="#RGB" class="code">RGB</a> s) const {
           <a href="#RGB" class="code">RGB</a> ret = *this;
           return ret /= s;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> &amp;operator/=(Float a) {
           DCHECK(!IsNaN(a));
           DCHECK_NE(a, 0);
           r /= a;
           g /= a;
           b /= a;
           return *this;
       }
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator/(Float a) const {
           <a href="#RGB" class="code">RGB</a> ret = *this;
           return ret /= a;
       }
       
       PBRT_CPU_GPU
       <a href="#RGB" class="code">RGB</a> operator-() const { return {-r, -g, -b}; }
       
       PBRT_CPU_GPU
       Float Average() const { return (r + g + b) / 3; }
       
       PBRT_CPU_GPU
       bool operator==(<a href="#RGB" class="code">RGB</a> s) const { return r == s.r &amp;&amp; g == s.g &amp;&amp; b == s.b; }
       PBRT_CPU_GPU
       bool operator!=(<a href="#RGB" class="code">RGB</a> s) const { return r != s.r || g != s.g || b != s.b; }
       PBRT_CPU_GPU
       Float operator[](int c) const {
           DCHECK(c &gt;= 0 &amp;&amp; c &lt; 3);
           if (c == 0)
               return r;
           else if (c == 1)
               return g;
           return b;
       }
       PBRT_CPU_GPU
       Float &amp;operator[](int c) {
           DCHECK(c &gt;= 0 &amp;&amp; c &lt; 3);
           if (c == 0)
               return r;
           else if (c == 1)
               return g;
           return b;
       }
       
       std::string ToString() const;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBPublicMembers-0">RGB Public Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-172" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-172"><i></i></a><div id="fragbit-172" class="collapse"><div class="fragmentcode">       Float r = 0, g = 0, b = 0;</div></div>
};</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-RGBPublicMethods-0"></span><div class="fragmentname">&lt;&lt;RGB Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#RGB" class="code">RGB</a>(Float r, Float g, Float b) : r(r), g(g), b(b) {}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-RGBPublicMembers-0"></span><div class="fragmentname">&lt;&lt;RGB Public Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="RGB::r"></span>r = 0, <span class="anchor" id="RGB::g"></span>g = 0, <span class="anchor" id="RGB::b"></span>b = 0;</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#RGBColorSpaces"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:standard-color-spaces"></span><span id="RGBColorSpaces"></span><h3>4.6.3  RGB Color Spaces</h3><p>



</p>
<p>Full spectral response curves are not necessary to define color spaces.
For example, a color space can be defined using <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg> chromaticity
coordinates to specify three <em>color primaries</em>.  From them, it is
possible to derive matrices that convert XYZ colors to and from that color
space.  In cases where we do not otherwise need explicit spectral response
curves, this is a convenient way to specify a color space.

</p>
<p>The <tt>RGBColorSpace</tt> class, which is defined in the files
<a href="https://github.com/mmp/pbrt-v4/tree/master/src/util/colorspace.h"><tt>util/colorspace.h</tt></a><span class="anchor" id="utilcolorspace.h"></span> and
<tt>util/colorspace.cpp</tt><span class="anchor" id="utilcolorspace.cpp"></span>, uses this
approach to encapsulate a representation of an RGB color space as well as a
variety of useful operations like converting XYZ colors to and from its
color space.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpaceDefinition-0"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="RGBColorSpace"></span>RGBColorSpace {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBColorSpacePublicMethods-0">RGBColorSpace Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-173" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-173"><i></i></a><div id="fragbit-173" class="collapse"><div class="fragmentcode">       <a href="#RGBColorSpace" class="code">RGBColorSpace</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> r, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> g, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> b, <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum" class="code">Spectrum</a> illuminant,
                     const RGBToSpectrumTable *rgbToSpectrumTable, Allocator alloc);
       
       PBRT_CPU_GPU
       RGBSigmoidPolynomial ToRGBCoeffs(<a href="#RGB" class="code">RGB</a> rgb) const;
       
       static void Init(Allocator alloc);
       
       &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBColorSpacePublicMembers-0">RGBColorSpace Public Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-174" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-174"><i></i></a><div id="fragbit-174" class="collapse"><div class="fragmentcode">          <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> r, g, b, w;
          DenselySampledSpectrum illuminant;
          <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt; XYZFromRGB, RGBFromXYZ;
          static const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> *sRGB, *DCI_P3, *Rec2020, *ACES2065_1;</div></div>
       
       PBRT_CPU_GPU
       bool operator==(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs) const {
           return (r == cs.r &amp;&amp; g == cs.g &amp;&amp; b == cs.b &amp;&amp; w == cs.w &amp;&amp;
                   rgbToSpectrumTable == cs.rgbToSpectrumTable);
       }
       PBRT_CPU_GPU
       bool operator!=(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs) const {
           return (r != cs.r || g != cs.g || b != cs.b || w != cs.w ||
                   rgbToSpectrumTable != cs.rgbToSpectrumTable);
       }
       
       std::string ToString() const;
       <a href="#RGB" class="code">RGB</a> LuminanceVector() const {
           return <a href="#RGB" class="code">RGB</a>(XYZFromRGB[1][0], XYZFromRGB[1][1], XYZFromRGB[1][2]);
       }
       <a href="#RGB" class="code">RGB</a> ToRGB(<a href="#XYZ" class="code">XYZ</a> xyz) const { return <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Mul" class="code">Mul</a>&lt;<a href="#RGB" class="code">RGB</a>&gt;(RGBFromXYZ, xyz); }
       <a href="#XYZ" class="code">XYZ</a> ToXYZ(<a href="#RGB" class="code">RGB</a> rgb) const { return <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Mul" class="code">Mul</a>&lt;<a href="#XYZ" class="code">XYZ</a>&gt;(XYZFromRGB, rgb); }
       static const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> *GetNamed(std::string name);
       static const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> *Lookup(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> r, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> g, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> b,
                                          <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> w);</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBColorSpacePrivateMembers-0">RGBColorSpace Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-175" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-175"><i></i></a><div id="fragbit-175" class="collapse"><div class="fragmentcode">       const <a href="#RGBToSpectrumTable" class="code">RGBToSpectrumTable</a> *rgbToSpectrumTable;</div></div>
};</div><p>


</p>
<p>An RGB color space is defined using the chromaticities of red, green, and
blue color primaries.  The primaries define the <em>gamut</em> of the color
space, which is the set of colors it can represent with RGB values
between&nbsp;0 and&nbsp;1. For three primaries, the gamut forms a triangle on the
chromaticity diagram where each primary&rsquo;s chromaticity defines one of the
vertices.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="Some displays use more than three primaries to increase
the size of the gamut, though we will assume conventional RGB here.">
      <sup>&dagger;</sup>
    </button>
		

</p>
<p>In addition to the primaries, it is necessary to specify the color space&rsquo;s
<em>whitepoint</em>, which is the color that is displayed when all three
primaries are activated to their maximum emission.  It may be surprising
that this is necessary&mdash;after all, should not white correspond to a
spectral distribution with the same value at every wavelength?  White
is, however, a color, and as a color it is what humans <em>perceive</em> as
being uniform and label &ldquo;white.&rdquo;  The spectra for white colors
tend to have more power in the lower wavelengths that correspond to blues
and greens than they do at higher wavelengths that correspond to oranges and
reds. The D65 illuminant, which was described in Section&nbsp;<a href="../Radiometry,_Spectra,_and_Color/Light_Emission.html#sec:standard-illuminants">4.4.2</a>
and plotted in Figure&nbsp;<a href="../Radiometry,_Spectra,_and_Color/Light_Emission.html#fig:d-illuminant">4.14</a>, is
a common choice for specifying color spaces&rsquo; whitepoints.

</p>
<p>While the chromaticities of the whitepoint are sufficient to define a color
space, the <tt>RGBColorSpace</tt> constructor takes its full spectral
distribution, which is useful for forthcoming code
that converts from color to spectral distributions.
Storing the illuminant spectrum allows users of the renderer
to specify emission from light sources using RGB color; the provided
illuminant then gives the spectral distribution for RGB white, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 1 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>.

</p>
<p>

</p>
<p>

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpaceMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Method Definitions&gt;&gt;=&nbsp;<a href="#fragment-RGBColorSpaceMethodDefinitions-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#RGBColorSpace" class="code">RGBColorSpace</a>::<a href="#RGBColorSpace" class="code">RGBColorSpace</a>(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> r, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> g, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> b,
        <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum" class="code">Spectrum</a> illuminant, const RGBToSpectrumTable *rgbToSpec,
        Allocator alloc)
    : r(r), g(g), b(b), illuminant(illuminant, alloc),
      rgbToSpectrumTable(rgbToSpec) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-ComputewhitepointprimariesandXYZcoordinates-0">Compute whitepoint primaries and XYZ coordinates</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-176" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-176"><i></i></a><div id="fragbit-176" class="collapse"><div class="fragmentcode">       <a href="#XYZ" class="code">XYZ</a> W = <a href="#SpectrumToXYZ" class="code">SpectrumToXYZ</a>(illuminant);
       <a href="#RGBColorSpace::w" class="code">w</a> = W.<a href="#XYZ::xy" class="code">xy</a>();
       <a href="#XYZ" class="code">XYZ</a> R = <a href="#XYZ" class="code">XYZ</a>::FromxyY(r), G = <a href="#XYZ" class="code">XYZ</a>::FromxyY(g), B = <a href="#XYZ" class="code">XYZ</a>::FromxyY(b);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-InitializeXYZcolorspaceconversionmatrices-0">Initialize XYZ color space conversion matrices</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-177" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-177"><i></i></a><div id="fragbit-177" class="collapse"><div class="fragmentcode">       <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt; rgb(R.X, G.X, B.X,
                           R.Y, G.Y, B.Y,
                           R.Z, G.Z, B.Z);
       <a href="#XYZ" class="code">XYZ</a> C = <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::InvertOrExit" class="code">InvertOrExit</a>(rgb) * W;
       XYZFromRGB = rgb * <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt;::<a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Diag" class="code">Diag</a>(C[0], C[1], C[2]);
       RGBFromXYZ = <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::InvertOrExit" class="code">InvertOrExit</a>(XYZFromRGB);</div></div>
}</div><p>


</p>
<p><tt>RGBColorSpace</tt> represents the illuminant as a
<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#DenselySampledSpectrum"><tt>DenselySampledSpectrum</tt></a> for efficient lookups by
wavelength.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpacePublicMembers-0"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Public Members&gt;&gt;=&nbsp;<a href="#fragment-RGBColorSpacePublicMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> <span class="anchor" id="RGBColorSpace::r"></span>r, <span class="anchor" id="RGBColorSpace::g"></span>g, <span class="anchor" id="RGBColorSpace::b"></span>b, <span class="anchor" id="RGBColorSpace::w"></span>w;
DenselySampledSpectrum <span class="anchor" id="RGBColorSpace::illuminant"></span>illuminant;</div><p>


</p>
<p><tt>RGBColorSpace</tt>s also store a pointer to an <a href="#RGBToSpectrumTable"><tt>RGBToSpectrumTable</tt></a>
class that stores information related to
converting RGB values in the color space to full spectral distributions; it
will be introduced shortly, in Section&nbsp;<a href="#sec:rgb-to-spectrum">4.6.6</a>.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpacePrivateMembers-0"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">const <a href="#RGBToSpectrumTable" class="code">RGBToSpectrumTable</a> *<span class="anchor" id="RGBColorSpace::rgbToSpectrumTable"></span>rgbToSpectrumTable;</div><p>


</p>
<p>To find RGB values in the color space, it is useful to be able to
convert to and from XYZ.  This can be done using <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.165ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2223.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">3 times 3</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="722" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1723" y="0"></use>
</g>
</svg> matrices.
To compute them, we will require the XYZ coordinates of the
chromaticities and the whitepoint.

</p>
<p></p>
<span class="anchor" id="fragment-ComputewhitepointprimariesandXYZcoordinates-0"></span><div class="fragmentname">&lt;&lt;Compute whitepoint primaries and XYZ coordinates&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="#XYZ" class="code">XYZ</a> W = <a href="#SpectrumToXYZ" class="code">SpectrumToXYZ</a>(illuminant);
<a href="#RGBColorSpace::w" class="code">w</a> = W.<a href="#XYZ::xy" class="code">xy</a>();
<a href="#XYZ" class="code">XYZ</a> R = <a href="#XYZ" class="code">XYZ</a>::FromxyY(r), G = <a href="#XYZ" class="code">XYZ</a>::FromxyY(g), B = <a href="#XYZ" class="code">XYZ</a>::FromxyY(b);</div><p>


</p>
<p>We will first derive the matrix <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.426ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1044.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper M</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D440" d="M1044 672c0 -20 -9 -20 -32 -20c-75 0 -77 -10 -86 -46l-133 -533c-5 -18 -5 -20 -5 -24c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -13 -20 -19 -20c-41 0 -84 3 -125 3l-124 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47l143 573h-1l-404 -633 c-5 -7 -11 -18 -22 -18c-12 0 -13 11 -15 23l-86 620h-1l-136 -545c-3 -11 -4 -16 -4 -23c0 -23 11 -43 68 -44c7 0 18 0 18 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3c-33 0 -68 -3 -100 -3c-8 0 -14 3 -14 12c0 18 13 19 18 19c81 3 98 35 108 75l127 509 c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h137c26 0 28 0 31 -23l78 -566l365 570c12 19 13 19 39 19h132c17 0 27 0 27 -11Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D440" x="0" y="0"></use>
</g>
</svg> that transforms from RGB coefficients
in the color space to XYZ:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.279ex" height="9.509ex" style="vertical-align: -4.171ex;" viewBox="0 -2298.3 7870.1 4094.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 3 By 1 Matrix 1st Row  x Subscript lamda Baseline 2nd Row  y Subscript lamda Baseline 3rd Row  z Subscript lamda Baseline EndMatrix equals upper M Start 3 By 1 Matrix 1st Row  r 2nd Row  g 3rd Row  b EndMatrix period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D440" d="M1044 672c0 -20 -9 -20 -32 -20c-75 0 -77 -10 -86 -46l-133 -533c-5 -18 -5 -20 -5 -24c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -13 -20 -19 -20c-41 0 -84 3 -125 3l-124 -3c-3 0 -15 0 -15 12c0 19 11 19 28 19c79 0 81 8 91 47l143 573h-1l-404 -633 c-5 -7 -11 -18 -22 -18c-12 0 -13 11 -15 23l-86 620h-1l-136 -545c-3 -11 -4 -16 -4 -23c0 -23 11 -43 68 -44c7 0 18 0 18 -11c0 -20 -13 -20 -18 -20c-33 0 -69 3 -103 3c-33 0 -68 -3 -100 -3c-8 0 -14 3 -14 12c0 18 13 19 18 19c81 3 98 35 108 75l127 509 c3 12 4 15 4 19c0 11 -6 14 -22 16c-12 1 -30 2 -43 2c-20 0 -29 0 -29 12c0 19 11 19 30 19h137c26 0 28 0 31 -23l78 -566l365 570c12 19 13 19 39 19h132c17 0 27 0 27 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1353)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
<g transform="translate(41,-47)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
<g transform="translate(53,-1453)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2076,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3021" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D440" x="4077" y="0"></use>
<g transform="translate(5288,0)">
<g transform="translate(0,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="13" y="1353"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="-47"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="24" y="-1453"></use>
</g>
</g>
<g transform="translate(1468,2153)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="7591" y="0"></use>
</g>
</svg>
</div>
<p>


</p>
<p>

</p>
<p>This matrix can be found by considering the relationship between the RGB
triplet <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 1 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg> and the whitepoint in XYZ coordinates, which is available
in <tt>W</tt>.  In this case, we know that
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.779ex" height="2.343ex" style="vertical-align: -1.005ex;" viewBox="0 -576.1 1627 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">w Subscript x Sub Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
<g transform="translate(716,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
</svg> must be proportional to the sum of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.52ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1085.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="809" y="-213"></use>
</g>
</svg> coordinates of the red,
green, and blue primaries, since we are considering the case of a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 1 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>
RGB.  The same follows for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.33ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1003.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="693" y="-213"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.272ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 978.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z Subscript lamda</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="658" y="-213"></use>
</g>
</svg>.  This relationship can be
expressed as
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="80.251ex" height="10.176ex" style="vertical-align: -4.505ex;" viewBox="0 -2441.8 34552.3 4381.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 3 By 1 Matrix 1st Row  w Subscript x Sub Subscript lamda Subscript Baseline 2nd Row  w Subscript y Sub Subscript lamda Subscript Baseline 3rd Row  w Subscript z Sub Subscript lamda Subscript Baseline EndMatrix equals Start 3 By 3 Matrix 1st Row 1st Column r Subscript x Sub Subscript lamda Subscript Baseline 2nd Column g Subscript x Sub Subscript lamda Subscript Baseline 3rd Column b Subscript x Sub Subscript lamda Subscript Baseline 2nd Row 1st Column r Subscript y Sub Subscript lamda Subscript Baseline 2nd Column g Subscript y Sub Subscript lamda Subscript Baseline 3rd Column b Subscript y Sub Subscript lamda Subscript Baseline 3rd Row 1st Column r Subscript z Sub Subscript lamda Subscript Baseline 2nd Column g Subscript z Sub Subscript lamda Subscript Baseline 3rd Column b Subscript z Sub Subscript lamda Subscript Baseline EndMatrix Start 3 By 3 Matrix 1st Row 1st Column c Subscript r Baseline 2nd Column 0 3rd Column 0 2nd Row 1st Column 0 2nd Column c Subscript g Baseline 3rd Column 0 3rd Row 1st Column 0 2nd Column 0 3rd Column c Subscript b Baseline EndMatrix Start 3 By 1 Matrix 1st Row  1 2nd Row  1 3rd Row  1 EndMatrix equals Start 3 By 3 Matrix 1st Row 1st Column r Subscript x Sub Subscript lamda Subscript Baseline 2nd Column g Subscript x Sub Subscript lamda Subscript Baseline 3rd Column b Subscript x Sub Subscript lamda Subscript Baseline 2nd Row 1st Column r Subscript y Sub Subscript lamda Subscript Baseline 2nd Column g Subscript y Sub Subscript lamda Subscript Baseline 3rd Column b Subscript y Sub Subscript lamda Subscript Baseline 3rd Row 1st Column r Subscript z Sub Subscript lamda Subscript Baseline 2nd Column g Subscript z Sub Subscript lamda Subscript Baseline 3rd Column b Subscript z Sub Subscript lamda Subscript Baseline EndMatrix Start 3 By 1 Matrix 1st Row  c Subscript r Baseline 2nd Row  c Subscript g Baseline 3rd Row  c Subscript b Baseline EndMatrix comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D464" d="M691 372c0 -48 -32 -182 -66 -260c-26 -60 -70 -123 -145 -123c-30 0 -99 6 -125 70c-40 -70 -87 -70 -104 -70c-75 0 -142 35 -142 126c0 38 12 84 56 202c7 17 18 45 18 70c0 32 -16 33 -25 33c-35 0 -74 -31 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10 c0 9 37 154 132 154c49 0 82 -37 82 -82c0 -20 -6 -34 -17 -64c-47 -123 -52 -162 -52 -194c0 -17 0 -91 80 -91c39 0 69 31 92 84c-1 5 -1 7 -1 18c0 18 2 36 9 66c7 26 54 217 57 224c7 20 25 28 37 28c15 0 29 -9 29 -27c0 -6 -10 -43 -15 -65l-42 -168 c-4 -14 -11 -45 -11 -73c0 -57 27 -87 74 -87c49 0 84 35 110 88c26 51 55 149 55 183c0 48 -25 74 -36 85c-9 8 -15 14 -15 27c0 22 25 48 50 48c17 0 44 -15 44 -70Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2329)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2706.0696391948677) scale(1,1.2528168223724954)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-4159"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
<g transform="translate(716,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
<g transform="translate(716,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D464" x="0" y="0"></use>
<g transform="translate(716,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
</g>
<g transform="translate(2618,2329)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2706.0696391948677) scale(1,1.2528168223724954)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-4159"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3563" y="0"></use>
<g transform="translate(4619,0)">
<g transform="translate(0,2329)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2709.791811105206) scale(1,2.5306449120344805)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-4159"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
<g transform="translate(2351,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
<g transform="translate(477,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
<g transform="translate(477,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
<g transform="translate(477,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
<g transform="translate(4739,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
</g>
<g transform="translate(7289,2329)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2709.791811105206) scale(1,2.5306449120344805)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-4159"></use>
</g>
</g>
<g transform="translate(12950,0)">
<g transform="translate(0,2197)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2446.66066893058) scale(1,2.0033279938488575)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3895"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1397)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="176" y="-3"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="176" y="-1498"></use>
</g>
<g transform="translate(1842,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="185" y="1397"></use>
<g transform="translate(0,-3)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D454" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="185" y="-1498"></use>
</g>
<g transform="translate(3713,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="168" y="1397"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="168" y="-3"></use>
<g transform="translate(0,-1498)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="613" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(5760,2197)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2446.66066893058) scale(1,2.0033279938488575)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3895"></use>
</g>
</g>
<g transform="translate(19753,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2347.1057884231536) scale(1,0.8942115768463074)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3799"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-1450"></use>
</g>
</g>
<g transform="translate(1491,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2347.1057884231536) scale(1,0.8942115768463074)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3799"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="22189" y="0"></use>
<g transform="translate(23246,0)">
<g transform="translate(0,2329)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2709.791811105206) scale(1,2.5306449120344805)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-4159"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
<g transform="translate(451,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
<g transform="translate(2351,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
<g transform="translate(477,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
<g transform="translate(477,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
<g transform="translate(477,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
<g transform="translate(4739,0)">
<g transform="translate(0,1529)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="705" y="-271"></use>
</g>
</g>
<g transform="translate(28,16)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="604" y="-304"></use>
</g>
</g>
<g transform="translate(37,-1517)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
<g transform="translate(429,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E1-LATINMODERNNORMAL-1D706" x="573" y="-271"></use>
</g>
</g>
</g>
</g>
<g transform="translate(7289,2329)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2709.791811105206) scale(1,2.5306449120344805)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-4159"></use>
</g>
</g>
<g transform="translate(31577,0)">
<g transform="translate(0,2197)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2442.6743122967596) scale(1,0.9896846276690906)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A3" x="0" y="-3895"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(9,1397)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="613" y="-213"></use>
</g>
<g transform="translate(0,-3)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D454" x="613" y="-213"></use>
</g>
<g transform="translate(16,-1498)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="613" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(1862,2197)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2442.6743122967596) scale(1,0.9896846276690906)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A6" x="0" y="-3895"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="34273" y="0"></use>
</g>
</svg>
</div>
<p>

which only has unknowns <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.981ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 852.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript r</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="613" y="-213"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.023ex" height="2.343ex" style="vertical-align: -1.005ex;" viewBox="0 -576.1 871.1 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript g</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D454" x="613" y="-213"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.944ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 837.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="613" y="-213"></use>
</g>
</svg>.  These can be found by
multiplying the whitepoint XYZ coordinates by the inverse of the remaining
matrix.  Inverting this matrix then gives the matrix that goes to RGB from
XYZ.

</p>
<p></p>
<span class="anchor" id="fragment-InitializeXYZcolorspaceconversionmatrices-0"></span><div class="fragmentname">&lt;&lt;Initialize XYZ color space conversion matrices&gt;&gt;=&nbsp;</div>
<div class="fragmentcode"><a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt; rgb(R.X, G.X, B.X,
                    R.Y, G.Y, B.Y,
                    R.Z, G.Z, B.Z);
<a href="#XYZ" class="code">XYZ</a> C = <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::InvertOrExit" class="code">InvertOrExit</a>(rgb) * W;
XYZFromRGB = rgb * <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt;::<a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Diag" class="code">Diag</a>(C[0], C[1], C[2]);
RGBFromXYZ = <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::InvertOrExit" class="code">InvertOrExit</a>(XYZFromRGB);</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpacePublicMembers-1"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Public Members&gt;&gt;+=&nbsp;<a href="#fragment-RGBColorSpacePublicMembers-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-RGBColorSpacePublicMembers-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt; <span class="anchor" id="RGBColorSpace::XYZFromRGB"></span>XYZFromRGB, <span class="anchor" id="RGBColorSpace::RGBFromXYZ"></span>RGBFromXYZ;</div><p>


</p>
<p>

</p>
<p>Given a color space&rsquo;s XYZ/RGB conversion matrices, a matrix-vector
multiplication is sufficient to convert any XYZ triplet into the color
space and to convert any RGB in the color space to XYZ.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpacePublicMethods-0"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Public Methods&gt;&gt;=&nbsp;<a href="#fragment-RGBColorSpacePublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#RGB" class="code">RGB</a> <span class="anchor" id="RGBColorSpace::ToRGB"></span>ToRGB(<a href="#XYZ" class="code">XYZ</a> xyz) const { return <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Mul" class="code">Mul</a>&lt;<a href="#RGB" class="code">RGB</a>&gt;(RGBFromXYZ, xyz); }
<a href="#XYZ" class="code">XYZ</a> <span class="anchor" id="RGBColorSpace::ToXYZ"></span>ToXYZ(<a href="#RGB" class="code">RGB</a> rgb) const { return <a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix::Mul" class="code">Mul</a>&lt;<a href="#XYZ" class="code">XYZ</a>&gt;(XYZFromRGB, rgb); }</div><p>


</p>
<p>Furthermore, it is easy to compute a matrix that converts from
one color space to another by using these matrices and converting by way of
XYZ colors.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpaceMethodDefinitions-1"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-RGBColorSpaceMethodDefinitions-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-RGBColorSpaceMethodDefinitions-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="../Utilities/Mathematical_Infrastructure.html#SquareMatrix" class="code">SquareMatrix</a>&lt;3&gt; <span class="anchor" id="RGBColorSpace::ConvertRGBColorSpace"></span>ConvertRGBColorSpace(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;from,
                                     const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;to) {
    if (from == to) return {};
    return to.<a href="#RGBColorSpace::RGBFromXYZ" class="code">RGBFromXYZ</a> * from.<a href="#RGBColorSpace::XYZFromRGB" class="code">XYZFromRGB</a>;
}</div><p>


</p>
<p><a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum"><tt>SampledSpectrum</tt></a> provides a convenience method that converts
to RGB in a given color space, again via XYZ.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-3"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-2"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumMethodDefinitions-4"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode"><a href="#RGB" class="code">RGB</a> <span class="anchor" id="SampledSpectrum::ToRGB"></span><a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a>::<a href="#RGBColorSpace::ToRGB" class="code">ToRGB</a>(const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths" class="code">SampledWavelengths</a> &amp;lambda,
                           const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs) const {
    <a href="#XYZ" class="code">XYZ</a> xyz = ToXYZ(lambda);
    return cs.<a href="#RGBColorSpace::ToRGB" class="code">ToRGB</a>(xyz);
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x3-StandardColorSpaces"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x3-StandardColorSpaces"></span><h4>Standard Color Spaces</h4><p>



</p>
<p>There are a number of widely used standard color spaces for which <tt>pbrt</tt> includes built-in support.  A few examples include:
</p>
<ul>
<li> sRGB, which was developed in the 1990s and was widely used for
monitors for many years.  One of the original motivations for its development was to
standardize color on the web.
<li> DCI-P3, which was developed for digital film projection and covers a
wider gamut than sRGB.  At the time of writing, it is increasingly being
adopted for computer displays and mobile phones.
<li> Rec2020, which covers an even wider gamut, and is used in the UHDTV
television standard.
<li> ACES2065-1, which has primaries that are outside of the representable
colors and are placed so that all colors can be represented by it.  One
reason for this choice was for it to be suitable as a format for long-term
archival storage.
</ul><p>

The gamuts of each are shown in Figure&nbsp;<a href="#fig:color-space-gamuts">4.23</a>.

</p>
<p>
 </p>
<span class="anchor" id="fig:color-space-gamuts"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f23.svg" title=""><img src="pha04f23.svg" width=385 height=439 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.23: <span class="legend">
The gamuts of the sRGB, DCI-P3, Rec2020, and ACES2065-1 color
spaces, visualized using the chromaticity diagram.
sRGB covers the
smallest gamut, DCI-P3 the next largest, Rec2020 an even larger one.
ACES2065-1, which corresponds to the large triangle, is distinguished by
using primaries
that correspond to imaginary colors.  In doing so, it is able to
represent all valid colors, unlike the others.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The <tt>RGBColorSpace</tt> class provides pre-initialized instances of the
<a href="#RGBColorSpace"><tt>RGBColorSpace</tt></a>s for each of these.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpacePublicMembers-2"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Public Members&gt;&gt;+=&nbsp;<a href="#fragment-RGBColorSpacePublicMembers-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> *<span class="anchor" id="RGBColorSpace::sRGB"></span>sRGB, *<span class="anchor" id="RGBColorSpace::DCI_P3"></span>DCI_P3, *<span class="anchor" id="RGBColorSpace::Rec2020"></span>Rec2020, *<span class="anchor" id="RGBColorSpace::ACES2065_1"></span>ACES2065_1;</div><p>


</p>
<p>It is also possible to look color spaces up by name or by specifying the
chromaticity of primaries and a whitepoint.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpacePublicMethods-1"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-RGBColorSpacePublicMethods-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">static const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> *<span class="anchor" id="RGBColorSpace::GetNamed"></span>GetNamed(std::string name);
static const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> *<span class="anchor" id="RGBColorSpace::Lookup"></span>Lookup(<a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> r, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> g, <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> b,
                                   <a href="../Geometry_and_Transformations/Points.html#Point2f" class="code">Point2f</a> w);</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#WhySpectralRendering"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:spectral-rendering-motivation"></span><span id="WhySpectralRendering"></span><h3>4.6.4  Why Spectral Rendering?</h3><p>



</p>
<p>Thus far, we have been proceeding with the description of <tt>pbrt</tt>&rsquo;s
implementation with the understanding that it uses point-sampled spectra to
represent spectral quantities.  While that may seem natural given <tt>pbrt</tt>&rsquo;s
physical basis and general adoption of Monte Carlo integration, it does not
fit with the current widespread practice of using RGB color for spectral
computations in rendering.  We hinted at a significant problem with that
practice at the start of this section; having introduced RGB color spaces,
we can now go farther.

</p>
<p>As discussed earlier, because color spaces are vector spaces,
addition of two colors in the same color space gives
the same color as adding the underlying spectra and then finding the
resulting spectrum&rsquo;s color.  That is not so for multiplication.  To
understand the problem,
suppose that we are rendering a uniformly colored object (e.g., green) that is
uniformly illuminated by light of the same color. For simplicity, assume
that both illumination and the object&rsquo;s reflectance value are represented by the
RGB color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg>. The scattered light is then given by a
product of reflectance and incident illumination:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.915ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 10727.3 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 3 By 1 Matrix 1st Row  0 2nd Row  1 3rd Row  0 EndMatrix circled-dot Start 3 By 1 Matrix 1st Row  0 2nd Row  1 3rd Row  0 EndMatrix equals Start 3 By 1 Matrix 1st Row  0 2nd Row  1 3rd Row  0 EndMatrix comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2299" d="M731 250c0 -189 -153 -342 -342 -342s-342 153 -342 342s153 342 342 342s342 -153 342 -342zM691 250c0 167 -135 302 -302 302s-302 -135 -302 -302s135 -302 302 -302s302 135 302 302zM442 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3799"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="1350"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-1450"></use>
</g>
</g>
<g transform="translate(1699,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3799"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2299" x="2797" y="0"></use>
<g transform="translate(3797,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3799"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="1350"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-1450"></use>
</g>
</g>
<g transform="translate(1699,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3799"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="6650" y="0"></use>
<g transform="translate(7707,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3799"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="1350"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="-1450"></use>
</g>
</g>
<g transform="translate(1699,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3799"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="10448" y="0"></use>
</g>
</svg>
</div>
<p>

where componentwise multiplication of RGB colors is indicated by the
&ldquo;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 778.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">circled-dot</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-2299" d="M731 250c0 -189 -153 -342 -342 -342s-342 153 -342 342s153 342 342 342s342 -153 342 -342zM691 250c0 167 -135 302 -302 302s-302 -135 -302 -302s135 -302 302 -302s302 135 302 302zM442 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-2299" x="0" y="0"></use>
</g>
</svg>&rdquo; operator.

</p>
<p>In the sRGB color space, the green color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg> maps to the upper
vertex of the gamut of representable colors
(Figure&nbsp;<a href="#fig:green-in-two-color-spaces">4.24</a>), and this RGB color value
furthermore remains unchanged by the multiplication.

</p>
<p>Now suppose that we change to the wide-gamut color space ACES2065-1.  The
sRGB color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg> can be found to be <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.28ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7009.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.38 comma 0.82 comma 0.12 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4394" y="0"></use>
<g transform="translate(4839,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6619" y="0"></use>
</g>
</svg> in this color
space&mdash;it thus maps to a location that lies in the interior of the set of
representable colors. Performing the same component-wise multiplication
gives the result:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.785ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 14115.6 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">Start 3 By 1 Matrix 1st Row  0.38 2nd Row  0.82 3rd Row  0.12 EndMatrix circled-dot Start 3 By 1 Matrix 1st Row  0.38 2nd Row  0.82 3rd Row  0.12 EndMatrix almost-equals Start 3 By 1 Matrix 1st Row  0.14 2nd Row  0.67 3rd Row  0.01 EndMatrix</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239B" d="M823 1474c0 -7 -3 -13 -9 -17c-255 -192 -435 -739 -435 -1207v-250h-102v250c0 490 245 1039 513 1241c3 2 7 4 12 4c11 0 21 -10 21 -21Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239D" d="M823 21c0 -12 -10 -21 -21 -21c-5 0 -9 2 -12 4c-268 201 -513 751 -513 1241v250h102v-250c0 -469 180 -1015 435 -1208c6 -3 9 -9 9 -16Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239C" d="M379 0h-102v498h102v-498Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239E" d="M598 0h-102v250c0 468 -180 1015 -435 1207c-6 4 -9 10 -9 17c0 11 10 21 21 21c5 0 9 -2 12 -4c268 -202 513 -751 513 -1241v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-23A0" d="M598 1245c0 -490 -245 -1040 -513 -1241c-3 -2 -7 -4 -12 -4c-11 0 -21 9 -21 21c0 7 3 13 9 16c255 193 435 739 435 1208v250h102v-250Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSYMBOLS-239F" d="M598 498v-498h-102v498h102Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2299" d="M731 250c0 -189 -153 -342 -342 -342s-342 153 -342 342s153 342 342 342s342 -153 342 -342zM691 250c0 167 -135 302 -302 302s-302 -135 -302 -302s135 -302 302 -302s302 135 302 302zM442 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2248" d="M717 438v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76 c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12zM717 218v-2c-20 -93 -56 -149 -139 -169c-11 -3 -23 -4 -35 -4c-62 0 -120 37 -172 76c-43 32 -89 67 -138 67c-9 0 -17 -1 -26 -3c-67 -17 -111 -49 -127 -124 c-1 -5 -6 -9 -12 -9c-7 0 -12 5 -12 12v2c20 93 56 149 139 169c12 3 24 4 35 4c62 0 120 -37 172 -76c43 -32 89 -67 139 -67c8 0 16 1 25 3c67 17 111 49 127 124c2 5 6 9 12 9c7 0 12 -5 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-37" d="M485 644c0 -21 0 -23 -9 -35l-135 -190c-44 -62 -58 -148 -62 -171c-8 -54 -11 -109 -11 -164v-51c0 -10 0 -55 -46 -55s-46 45 -46 55c0 102 33 241 123 376l112 158h-207c-13 0 -91 0 -98 -6c-13 -12 -22 -75 -25 -91h-25l33 206h25c4 -19 6 -32 128 -32h243Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3799"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="1279" y="0"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2979,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3799"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2299" x="4076" y="0"></use>
<g transform="translate(5077,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3799"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="1279" y="0"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2979,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3799"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2248" x="9209" y="0"></use>
<g transform="translate(10261,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239B" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239C"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239D" x="0" y="-3799"></use>
</g>
<g transform="translate(1042,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1279" y="0"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-37" x="1279" y="0"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1279" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2979,2150)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239E" x="0" y="-1496"></use>
<g transform="translate(0,-2351.188) scale(1,1.812)">
 <use xlink:href="#E1-LATINMODERNSYMBOLS-239F"></use>
</g>
 <use xlink:href="#E1-LATINMODERNSYMBOLS-23A0" x="0" y="-3799"></use>
</g>
</g>
</g>
</svg>
</div>
<p>

This time, the resulting color has lower intensity than it started with and
has also become more saturated due to an increase in the relative
proportion of green light. That leads to the somewhat bizarre situation
shown in Figure&nbsp;<a href="#fig:green-in-two-color-spaces">4.24</a>: component-wise
multiplication in this new color space not only produces a different
color&mdash;it also increases saturation so severely that the color is pushed
outside of the CIE horseshoe shape of physically realizable colors!

</p>
<p></p>
<span class="anchor" id="fig:green-in-two-color-spaces"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f24.svg" title=""><img src="pha04f24.svg" width=385 height=439 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.24: <span class="legend"> The same color can have very different RGB values
when expressed in RGB color spaces with differently shaped gamuts. The
green primary <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0 comma 1 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg> in the sRGB color gamut (inner triangle) has
chromaticity coordinates <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.787ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3783.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.3 comma 0.6 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1669" y="0"></use>
<g transform="translate(2114,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3393" y="0"></use>
</g>
</svg> (white dot).  In the wide-gamut
ACES2065-1 color space (outer triangle), the same color has the
RGB value <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.28ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7009.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.38 comma 0.82 comma 0.12 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4394" y="0"></use>
<g transform="translate(4839,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6619" y="0"></use>
</g>
</svg>.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The ability to multiply spectral values is crucial for evaluating the
interaction of materials and light sources in the context of rendering. At
the same time, this example demonstrates the problem when RGB values are
used for this purpose: the multiplication operation is in some sense
arbitrary, because its behavior heavily depends on the chosen color space.
Thus, rendering using a spectral model is preferable even in situations
where RGB output is ultimately desired, as is the case with <tt>pbrt</tt>.

</p>
<p>Additional benefits come from using spectral representations for rendering:
they allow dispersion to easily be modeled and advanced reflectance models
often have a natural dependence on wavelength to account for iridescence in
thin layers or diffraction from surface microstructure.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#ChoosingtheNumberofWavelengthSamples"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:number-of-wavelength-samples"></span><span id="ChoosingtheNumberofWavelengthSamples"></span><h3>4.6.5  Choosing the Number of Wavelength Samples</h3><p>



</p>
<p>Even though it uses a spectral model for light transport simulation,
<tt>pbrt</tt>&rsquo;s output is generally an image in a tristimulus color representation
like RGB.  Having described how those colors are computed&mdash;Monte Carlo
estimates of the products of spectra and matching functions of the form of
Equation&nbsp;(<a href="#eq:xyz-mc">4.23</a>)&mdash;we will briefly return to the question of how
many spectral samples are used for the <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum"><tt>SampledSpectrum</tt></a> class.  The
associated Monte Carlo estimators are easy to evaluate, but error in them
leads to <em>color noise</em> in images.
Figure&nbsp;<a href="#fig:color-noise-example">4.25</a> shows an example of this phenomenon.

</p>
<p>
 </p>
<span class="anchor" id="fig:color-noise-example"></span><div class="card outerfigure"><div class="card-body figure"><p>


</p>
<div class="figure-row">
  <a href="pha04f25.svg" title=""><img src="pha04f25.svg" width=994 height=353 style="max-width: 100%;"></a>
</div>
<p>

</p>
<figcaption class="caption">Figure 4.25: <span class="legend">
(a)&nbsp;Reference image of the example scene.
(b)&nbsp;If the scene is rendered using only a single image sample per pixel,
each sampling only a single wavelength, there is a substantial amount of
variance from error in the Monte Carlo estimates of the pixels&rsquo; RGB colors.
(c)&nbsp;With four wavelength samples (<tt>pbrt</tt>&rsquo;s default), this variance is
substantially reduced, though color noise is still evident.  In practice,
four wavelength samples is usually sufficient since multiple image samples are
generally taken at each pixel.
<em>(Model courtesy of Yasutoshi Mori.)</em>
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Figure&nbsp;<a href="#fig:color-noise-example">4.25</a>(a) shows a scene illuminated by a
point light source where only direct illumination from the light is
included.   In this simple setting, the Monte Carlo estimator for the
scattered light has zero variance at all wavelengths, so the only source of
Monte Carlo error is the integrals of the color matching functions.  With a
single ray path per pixel and each one tracking a single wavelength, the image
is quite noisy, as shown in Figure&nbsp;<a href="#fig:color-noise-example">4.25</a>(b).
Intuitively, the challenge in this case can be understood from the fact
that the renderer is trying to estimate three values at each pixel&mdash;red,
green, and blue&mdash;all from the spectral value at a single wavelength.

</p>
<p>Increasing the number of pixel samples can reduce this error (as long as
they sample different wavelengths), though it is
more effective to associate multiple wavelength samples with each ray.  The
path that a ray takes through the scene is usually independent of
wavelength and the incremental cost to compute lighting at multiple
wavelengths is generally small compared to the cost of finding ray
intersections and computing other wavelength-independent quantities.  (Considering
multiple wavelengths for each ray can be seen as an application of the
Monte Carlo splitting technique that is described in
Section&nbsp;<a href="../Monte_Carlo_Integration/Improving_Efficiency.html#sec:mc-splitting">2.2.5</a>.)
Figure&nbsp;<a href="#fig:color-noise-example">4.25</a>(c) shows the improvement from
associating four wavelengths with each ray; color noise is substantially
reduced.

</p>
<p></p>
<span class="anchor" id="fig:mc-efficiency-vs-wavelength-samples-simple-scene"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f26.svg" title=""><img src="pha04f26.svg" width=784 height=549 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.26: <span class="legend">
(a)&nbsp;Rendering time when rendering the scene in Figure&nbsp;<a href="#fig:color-noise-example">4.25</a>
graphed as a function of the number of wavelength samples, normalized to
rendering time with one wavelength sample.
(b)&nbsp;Mean squared error as a function of number of wavelength samples for
both independent and stratified samples.
(c)&nbsp;Monte Carlo efficiency as a function of number of stratified wavelength samples.
These results suggest that at least 32 wavelength samples are optimal.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>

</p>
<p>However, computing scattering from too many wavelengths with each ray can
harm efficiency due to the increased computation required to compute
spectral quantities.  To investigate this trade-off, we rendered
the scene from Figure&nbsp;<a href="#fig:color-noise-example">4.25</a> with a variety of
numbers of wavelength samples, both with wavelengths sampled independently
and with stratified sampling of wavelengths.  (For both, wavelengths were
sampled uniformly over the range 360&ndash;830&nbsp;nm.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="In
Section&nbsp;5.4.2, we will see that nonuniform
sampling of wavelengths is beneficial but will stick to uniform sampling
here for simplicity.">
      <sup>&dagger;</sup>
    </button>
		)
Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-simple-scene">4.26</a> shows the
results.

</p>
<p>Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-simple-scene">4.26</a>(a) shows
that for this scene, rendering with 32 wavelength samples requires nearly
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.78ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2058 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1.6 times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="1279" y="0"></use>
</g>
</svg> more time than rendering with a single wavelength sample.  (Rendering
performance with both independent and stratified sampling is
effectively the same.)  However, as shown in
Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-simple-scene">4.26</a>(b), the
benefit of more wavelength samples is substantial.  On the log&ndash;log plot
there, we can see that with independent samples, mean squared error
decreases at a rate <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.302ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3144 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper O left-parenthesis 1 slash n right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D442" d="M740 436c0 -239 -223 -458 -435 -458c-144 0 -256 101 -256 267c0 233 220 460 436 460c149 0 255 -108 255 -269zM651 475c0 149 -90 205 -172 205c-79 0 -177 -52 -246 -156c-77 -117 -91 -263 -91 -307c0 -132 70 -213 169 -213c84 0 166 59 214 120 c99 123 126 279 126 351Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45B" d="M571 143c0 -8 -37 -154 -131 -154c-47 0 -82 35 -82 82c0 11 1 23 10 46c16 43 65 171 65 233c0 33 -9 70 -54 70c-95 0 -148 -91 -163 -122l-13 -50c-5 -23 -11 -45 -17 -67l-22 -90c-6 -25 -18 -72 -19 -74c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43 l58 231c13 52 16 63 16 84c0 33 -11 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 4 14 63 30 97c10 18 29 57 75 57s87 -31 92 -87c17 23 66 87 156 87c72 0 115 -40 115 -107c0 -57 -42 -167 -61 -220c-9 -22 -18 -46 -18 -71 c0 -23 7 -33 24 -33c49 0 82 56 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D442" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1153" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1653" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45B" x="2154" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2754" y="0"></use>
</g>
</svg>, in line with the rate at which variance
decreases with more samples.  Stratified sampling does remarkably well,
not only delivering orders of magnitude lower error, but at a faster
asymptotic convergence rate as well.

</p>
<p>Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-simple-scene">4.26</a>(c) plots
Monte Carlo efficiency for both approaches (note, with a logarithmic scale
for the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> axis).  The result seems clear; 32 stratified wavelength
samples is over a million times more efficient than one sample and there
the curve has not yet leveled off.  Why stop measuring at 32, and why is
<tt>pbrt</tt> stuck with a default of four wavelength samples for its
<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#NSpectrumSamples"><tt>NSpectrumSamples</tt></a> parameter?

</p>
<p></p>
<span class="anchor" id="fig:mc-efficiency-vs-wavelength-samples-watercolor"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f27.svg" title=""><img src="pha04f27.svg" width=784 height=568 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.27: <span class="legend">
(a)&nbsp;A more complex scene, where variance in the Monte Carlo estimator is
present from a variety of sources beyond wavelength sampling.
(b)&nbsp;Graph of mean squared error versus the number of stratified wavelength
samples.  The benefits of additional wavelength samples are limited after
six of them.
(c)&nbsp;Monte Carlo efficiency versus number of stratified wavelength
samples, normalized to efficiency with one wavelength sample. For this
scene, eight samples is optimal.
</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>There are three main reasons for the current setting.  First, although
Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-simple-scene">4.26</a>(a) shows
nearly a <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.296ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2280 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">500 times</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-D7" d="M624 15c-7 -8 -20 -8 -28 0l-207 207l-207 -207c-8 -8 -21 -8 -28 0c-8 7 -8 20 0 28l207 207l-207 207c-8 8 -8 21 0 28c7 8 20 8 28 0l207 -207l207 207c8 8 21 8 28 0c8 -7 8 -20 0 -28l-207 -207l207 -207c8 -8 8 -21 0 -28Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-35"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1001" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-D7" x="1501" y="0"></use>
</g>
</svg> reduction in error from 8 to 32 wavelength samples,
the two images are nearly indistinguishable&mdash;the difference in error is
irrelevant due to limitations in display technology and the human visual
system.  Second, scenes are usually rendered following multiple ray paths
in each pixel in order to reduce error from other Monte Carlo estimators.
As more pixel samples are taken with fewer wavelengths, the total number of
wavelengths that contribute to each pixel&rsquo;s value increases.

</p>
<p>Finally, and most importantly, those other sources of Monte Carlo error
often make larger contributions to the overall error than wavelength
sampling.
Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-watercolor">4.27</a>(a) shows a
much more complex scene with challenging lighting that is sampled using
Monte Carlo.  A graph of mean squared error as a function of the number of
wavelength samples is shown in
Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-watercolor">4.27</a>(b) and
Monte Carlo efficiency is shown in
Figure&nbsp;<a href="#fig:mc-efficiency-vs-wavelength-samples-watercolor">4.27</a>(c).  It is
evident that after eight wavelength samples, the incremental cost of more
of them is not beneficial.

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#FromRGBtoSpectra"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="sec:rgb-to-spectrum"></span><span id="FromRGBtoSpectra"></span><h3>4.6.6  From RGB to Spectra</h3><p>



</p>
<p>Although converting spectra to RGB for image output is a well-specified
operation, the same is not true for converting RGB colors to spectral
distributions.  That is an important task, since much of the input to a
renderer is often in the form of RGB colors.  Scenes authored in current 3D
modeling tools normally specify objects&rsquo; reflection properties and lights&rsquo;
emission using RGB parameters and textures.  In a spectral renderer, these
RGB values must somehow be converted into equivalent color spectra, but
unfortunately any such conversion is inherently ambiguous due to the
existence of metamers.  How we can expect to find a reasonable solution if
the problem is so poorly defined?  On the flip side, this ambiguity can also
be seen positively: it leaves a large space of possible answers containing
techniques that are simple and efficient.

</p>
<p></p>
<span class="anchor" id="fig:smooth_reflectance_spectra"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f28.svg" title=""><img src="pha04f28.svg" width=446 height=287 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.28: <span class="legend">
Spectral reflectances of several color checker patches.  Each curve is
shaded with the associated RGB color.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>Further complicating this task, we must account for three fundamentally
different types of spectral distributions:
</p>
<ul>
<li> <em>Illuminant spectra</em>, which specify the spectral dependence of a
light source&rsquo;s emission profile.  These are nonnegative and unbounded;
their shapes range from smooth (incandescent light sources, LEDs) to
extremely spiky (stimulated emission in lasers or gas discharge in xenon
arc and fluorescent lamps).
<li> <em>Reflectance spectra</em>, which describe reflection from absorbing
surfaces. Reflectance spectra conserve the amount of energy at each
wavelength, meaning that values cannot be outside of the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg>
range. They are typically smooth functions in the visible wavelength
range.<button style="button" data-toggle="tooltip" data-placement="right" data-html="true" class="btn footnote-button" title="Note that this observation does not always hold: in the
ultraviolet and infrared wavelength range, absorption bands cause sharp
spikes in reflectance spectra. Furthermore, wave-optical effects such as
iridescence produce oscillatory spectral variation. These behaviors could
likely be handled using specialized conversion techniques, which are beyond
the scope of the simple approach discussed here.">
      <sup>&dagger;</sup>
    </button>
		
(Figure&nbsp;<a href="#fig:smooth_reflectance_spectra">4.28</a> shows a few examples of
reflectance spectra from a color checker.)
<li> <em>Unbounded spectra</em>, which are nonnegative and unbounded but do
not describe emission.  Common examples include spectrally varying indices
of refraction and coefficients used to describe medium scattering
properties.
</ul><p>


</p>
<p>This section first presents an approach for converting an RGB color value
with components between&nbsp;0 and&nbsp;1 into a corresponding reflectance
spectrum, followed by a generalization to unbounded and
illuminant spectra.  The conversion exploits the ambiguity of the
problem to achieve the following goals:
</p>
<ul>
<li> <em>Identity</em>: If an RGB value is converted to a spectrum,
converting that spectrum back to RGB should give the same RGB coefficients.
<li> <em>Smoothness</em>: Motivated by the earlier observation about
real-world reflectance spectra, the output spectrum should be as smooth as possible.
Another kind of smoothness is also important: slight perturbations of the
input RGB color should lead to a corresponding small change of the output spectrum.
Discontinuities are undesirable, since they would cause visible seams on
textured objects if observed under different illuminants.
<li> <em>Energy conservation</em>: Given RGB values in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg>, the
associated spectral distribution should also be within <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg>.
</ul><p>


</p>
<p>Although real-world reflectance spectra exist in a wide variety of shapes, they
are often well-approximated by constant (white, black), approximately linear,
or peaked curves with one (green, yellow) or two modes (bluish-purple).

</p>
<p>The approach chosen here attempts to represent such spectra using a function
family that is designed to be simple, smooth, and efficient to evaluate at runtime,
while exposing a sufficient number of degrees of freedom to precisely reproduce
arbitrary RGB color values.

</p>
<p>Polynomials are typically a standard building block in such constructions;
indeed, a quadratic polynomial could represent constant and linear curves, as
well as ones that peak in the middle or toward the endpoints of the wavelength
range. However, their lack of energy conservation poses a problem that we address
using a sigmoid function:
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:rgb-to-spectrum-polynomial"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.523ex" height="6.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1437.2 10127.9 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">s left-parenthesis x right-parenthesis equals one-half plus StartFraction x Over 2 StartRoot 1 plus x squared EndRoot EndFraction period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE1-221A" d="M1020 830c0 -3 0 -5 -7 -18l-547 -1142c-10 -19 -11 -20 -42 -20l-228 531l-71 -54l-15 16l139 107l213 -496l516 1076c5 11 9 20 22 20c12 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="469" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="859" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1431" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2098" y="0"></use>
<g transform="translate(2877,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="60" y="676"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="4237" y="0"></use>
<g transform="translate(5016,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="4370" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="1899" y="676"></use>
<g transform="translate(60,-1025)">
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#E1-LATINMODERNSIZE1-221A" x="0" y="94"></use>
<rect stroke="none" width="2749" height="60" x="1000" y="885"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="809" y="408"></use>
</g>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="9849" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:rgb-to-spectrum-polynomial">4.25</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>

This function, plotted in Figure&nbsp;<a href="#fig:sigmoid">4.29</a>, is strictly monotonic and
smoothly approaches the endpoints <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
</g>
</svg> as <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.076ex" height="2.176ex" style="vertical-align: -0.505ex;" viewBox="0 -719.6 3907.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x right-arrow minus-or-plus normal infinity</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2192" d="M943 250c0 -6 -4 -11 -9 -13c-57 -19 -101 -59 -137 -104c-28 -36 -49 -80 -58 -127c-2 -9 -10 -16 -20 -16c-11 0 -20 9 -20 20c0 1 1 3 1 4c10 53 33 102 66 144c22 28 48 52 78 72h-766c-11 0 -20 9 -20 20s9 20 20 20h766c-30 20 -56 44 -78 72 c-33 42 -56 91 -66 144c0 1 -1 3 -1 4c0 11 9 20 20 20c10 0 18 -7 20 -16c9 -47 30 -91 58 -127c36 -45 80 -85 137 -104c5 -2 9 -7 9 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2213" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-221E" d="M943 216c0 -118 -76 -227 -192 -227c-79 0 -138 42 -170 69c-22 19 -23 20 -90 101c-13 -22 -102 -170 -246 -170c-119 0 -189 115 -189 226c0 118 76 227 192 227c79 0 138 -42 170 -69c22 -19 23 -20 90 -101c13 22 102 170 246 170c119 0 189 -115 189 -226zM921 216 c0 90 -54 194 -160 194c-113 0 -189 -105 -227 -173c28 -34 73 -97 101 -128c45 -49 86 -72 132 -72c84 0 154 79 154 179zM465 194c-28 34 -73 97 -101 128c-45 49 -86 72 -132 72c-84 0 -154 -79 -154 -179c0 -90 54 -194 160 -194c113 0 189 105 227 173Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2192" x="850" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2213" x="2128" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-221E" x="2907" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fig:sigmoid"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f29.svg" title=""><img src="pha04f29.svg" width=418 height=278 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.29: Sigmoid curve. <span class="legend">
The term <em>sigmoid</em> refers to smooth S-shaped curves that map all inputs to a
bounded output interval. The particular type of sigmoid used here is defined in
terms of algebraic functions, enabling highly efficient evaluation at runtime.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>We apply this sigmoid to a quadratic polynomial defined by three coefficients
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg>, squashing its domain to the interval <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg> to ensure energy
conservation.
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<span class="anchor" id="eq:rgb-to-spectrum-spd"></span><div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.938ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 11598.1 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis equals s left-parenthesis c 0 lamda squared plus c 1 lamda plus c 2 right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D460" d="M420 356c0 -39 -24 -56 -46 -56s-31 15 -31 29c0 22 20 44 48 45c-15 39 -65 46 -90 46c-88 0 -112 -61 -112 -90c0 -45 40 -52 76 -60c44 -9 73 -14 100 -42c12 -12 31 -37 31 -73c0 -45 -39 -166 -201 -166c-86 0 -143 40 -143 97c0 45 30 66 56 66c21 0 37 -12 37 -35 c0 -28 -25 -58 -63 -53c23 -53 100 -53 114 -53c120 0 143 84 143 110c0 55 -52 66 -104 76c-29 6 -103 21 -103 99c0 44 37 146 169 146c76 0 119 -41 119 -86Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2B" d="M722 250c0 -11 -9 -20 -20 -20h-293v-293c0 -11 -9 -20 -20 -20s-20 9 -20 20v293h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2285" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D460" x="3342" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3811" y="0"></use>
<g transform="translate(4201,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="613" y="-213"></use>
</g>
<g transform="translate(5088,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="825" y="583"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="6348" y="0"></use>
<g transform="translate(7348,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="8236" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2B" x="9041" y="0"></use>
<g transform="translate(10042,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="10930" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="11319" y="0"></use>
</g>
</svg>
</div>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">
<div class="eqno">(<a href="#eq:rgb-to-spectrum-spd">4.26</a>)</div>
</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<p>


</p>
<p>Representing ideally absorptive and reflective spectra (i.e., <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.925ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3842.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper S left-parenthesis lamda right-parenthesis equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D446" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="645" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1035" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1618" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="2285" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="3342" y="0"></use>
</g>
</svg> or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
</g>
</svg>)
is somewhat awkward using this representation, since the polynomial must
evaluate to positive or negative infinity to reach these two limits. This in
turn leads to a fraction of the form <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.618ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3280 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">plus-or-minus normal infinity slash normal infinity</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-B1" d="M722 -64c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h293v274h-293c-11 0 -20 9 -20 20s9 20 20 20h293v293c0 11 9 20 20 20s20 -9 20 -20v-293h293c11 0 20 -9 20 -20s-9 -20 -20 -20h-293v-274h293c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-221E" d="M943 216c0 -118 -76 -227 -192 -227c-79 0 -138 42 -170 69c-22 19 -23 20 -90 101c-13 -22 -102 -170 -246 -170c-119 0 -189 115 -189 226c0 118 76 227 192 227c79 0 138 -42 170 -69c22 -19 23 -20 90 -101c13 22 102 170 246 170c119 0 189 -115 189 -226zM921 216 c0 90 -54 194 -160 194c-113 0 -189 -105 -227 -173c28 -34 73 -97 101 -128c45 -49 86 -72 132 -72c84 0 154 79 154 179zM465 194c-28 34 -73 97 -101 128c-45 49 -86 72 -132 72c-84 0 -154 -79 -154 -179c0 -90 54 -194 160 -194c113 0 189 105 227 173Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-B1" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-221E" x="778" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-221E" x="2279" y="0"></use>
</g>
</svg> in
Equation&nbsp;(<a href="#eq:rgb-to-spectrum-polynomial">4.25</a>), which evaluates to a
not-a-number value in IEEE-754 arithmetic. We will need to separately handle
this limit case.

</p>
<p>We begin with the definition of a class that encapsulates the
coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg> and evaluates Equation&nbsp;(<a href="#eq:rgb-to-spectrum-spd">4.26</a>).

</p>
<p></p>
<span class="anchor" id="fragment-RGBSigmoidPolynomialDefinition-0"></span><div class="fragmentname">&lt;&lt;RGBSigmoidPolynomial Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="RGBSigmoidPolynomial"></span>RGBSigmoidPolynomial {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBSigmoidPolynomialPublicMethods-0">RGBSigmoidPolynomial Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-178" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-178"><i></i></a><div id="fragbit-178" class="collapse"><div class="fragmentcode">       RGBSigmoidPolynomial(Float <a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>, Float <a href="#RGBSigmoidPolynomial::c1" class="code">c1</a>, Float <a href="#RGBSigmoidPolynomial::c2" class="code">c2</a>)
           : <a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>(<a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>), <a href="#RGBSigmoidPolynomial::c1" class="code">c1</a>(<a href="#RGBSigmoidPolynomial::c1" class="code">c1</a>), <a href="#RGBSigmoidPolynomial::c2" class="code">c2</a>(<a href="#RGBSigmoidPolynomial::c2" class="code">c2</a>) {}
       Float operator()(Float lambda) const {
           return <a href="#RGBSigmoidPolynomial::s" class="code">s</a>(<a href="../Utilities/Mathematical_Infrastructure.html#EvaluatePolynomial" class="code">EvaluatePolynomial</a>(lambda, <a href="#RGBSigmoidPolynomial::c2" class="code">c2</a>, <a href="#RGBSigmoidPolynomial::c1" class="code">c1</a>, <a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>));
       }
       Float MaxValue() const {
           Float result = std::max((*this)(360), (*this)(830));
           Float lambda = -<a href="#RGBSigmoidPolynomial::c1" class="code">c1</a> / (2 * <a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>);
           if (lambda &gt;= 360 &amp;&amp; lambda &lt;= 830)
               result = std::max(result, (*this)(lambda));
           return result;
       }</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBSigmoidPolynomialPrivateMethods-0">RGBSigmoidPolynomial Private Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-179" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-179"><i></i></a><div id="fragbit-179" class="collapse"><div class="fragmentcode">       static Float s(Float x) {
           if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(x)) return x &gt; 0 ? 1 : 0;
           return .5f + x / (2 * std::sqrt(1 + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(x)));
       };</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBSigmoidPolynomialPrivateMembers-0">RGBSigmoidPolynomial Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-180" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-180"><i></i></a><div id="fragbit-180" class="collapse"><div class="fragmentcode">       Float c0, c1, c2;</div></div>
};</div><p>


</p>
<p>It has the expected constructor and member variables.

</p>
<p></p>
<span class="anchor" id="fragment-RGBSigmoidPolynomialPublicMethods-0"></span><div class="fragmentname">&lt;&lt;RGBSigmoidPolynomial Public Methods&gt;&gt;=&nbsp;<a href="#fragment-RGBSigmoidPolynomialPublicMethods-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">RGBSigmoidPolynomial(Float c0, Float c1, Float c2)
    : c0(c0), c1(c1), c2(c2) {}
</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-RGBSigmoidPolynomialPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;RGBSigmoidPolynomial Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="RGBSigmoidPolynomial::c0"></span>c0, <span class="anchor" id="RGBSigmoidPolynomial::c1"></span>c1, <span class="anchor" id="RGBSigmoidPolynomial::c2"></span>c2;</div><p>


</p>
<p>Given coefficient values, it is easy to evaluate the spectral function at a
specified wavelength.

</p>
<p></p>
<span class="anchor" id="fragment-RGBSigmoidPolynomialPublicMethods-1"></span><div class="fragmentname">&lt;&lt;RGBSigmoidPolynomial Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-RGBSigmoidPolynomialPublicMethods-0"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-RGBSigmoidPolynomialPublicMethods-2"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="RGBSigmoidPolynomial::operator"></span>operator()(Float lambda) const {
    return <a href="#RGBSigmoidPolynomial::s" class="code">s</a>(<a href="../Utilities/Mathematical_Infrastructure.html#EvaluatePolynomial" class="code">EvaluatePolynomial</a>(lambda, <a href="#RGBSigmoidPolynomial::c2" class="code">c2</a>, <a href="#RGBSigmoidPolynomial::c1" class="code">c1</a>, <a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>));
}</div><p>


</p>
<p>The sigmoid function follows the earlier definition and adds a special
case to handle positive and negative infinity.

</p>
<p></p>
<span class="anchor" id="fragment-RGBSigmoidPolynomialPrivateMethods-0"></span><div class="fragmentname">&lt;&lt;RGBSigmoidPolynomial Private Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">static Float <span class="anchor" id="RGBSigmoidPolynomial::s"></span>s(Float x) {
    if (<a href="../Shapes/Managing_Rounding_Error.html#IsInf" class="code">IsInf</a>(x)) return x &gt; 0 ? 1 : 0;
    return .5f + x / (2 * std::sqrt(1 + <a href="../Utilities/Mathematical_Infrastructure.html#Sqr" class="code">Sqr</a>(x)));
};</div><p>


</p>
<p>The <tt>MaxValue()</tt> method returns the maximum value of the spectral
distribution over the visible wavelength range 360&ndash;830&nbsp;nm.  Because the
sigmoid function is monotonically increasing, this problem reduces to locating
the maximum of the quadratic polynomial from
Equation&nbsp;(<a href="#eq:rgb-to-spectrum-polynomial">4.25</a>) and evaluating the model there.

</p>
<p>We conservatively check the endpoints of the interval along with the extremum
found by setting the polynomial&rsquo;s derivative to zero and solving for the
wavelength <tt>lambda</tt>. The value will be ignored if it happens to be a local
minimum.

</p>
<p></p>
<span class="anchor" id="fragment-RGBSigmoidPolynomialPublicMethods-2"></span><div class="fragmentname">&lt;&lt;RGBSigmoidPolynomial Public Methods&gt;&gt;+=&nbsp;<a href="#fragment-RGBSigmoidPolynomialPublicMethods-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">Float <span class="anchor" id="RGBSigmoidPolynomial::MaxValue"></span>MaxValue() const {
    Float result = std::max((*this)(360), (*this)(830));
    Float lambda = -<a href="#RGBSigmoidPolynomial::c1" class="code">c1</a> / (2 * <a href="#RGBSigmoidPolynomial::c0" class="code">c0</a>);
    if (lambda &gt;= 360 &amp;&amp; lambda &lt;= 830)
        result = std::max(result, (*this)(lambda));
    return result;
}</div><p>


</p>
<p>We now turn to the second half of <tt>RGBSigmoidPolynomial</tt>, which is the
computation that determines suitable coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.251ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 3552.6 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c 0 comma c 1 comma c 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="613" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="887" y="0"></use>
<g transform="translate(1332,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2219" y="0"></use>
<g transform="translate(2665,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="613" y="-213"></use>
</g>
</g>
</svg> for a given
RGB color. This step depends on the spectral emission curves of the color primaries and
generally does not have an explicit solution. We instead formulate it as an
optimization problem that minimizes the round-trip error (i.e., the <em>identity</em>
goal mentioned above) by computing the difference between input and output
RGB values following forward and reverse conversion. The precise optimization goal is
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.016ex" height="9.676ex" style="vertical-align: -4.338ex;" viewBox="0 -2298.3 28853.9 4166" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis c 0 Superscript asterisk Baseline comma c 1 Superscript asterisk Baseline comma c 2 Superscript asterisk Baseline right-parenthesis equals normal a normal r normal g normal m normal i normal n Underscript c 0 comma c 1 comma c 2 Endscripts double-vertical-bar Start 3 By 1 Matrix 1st Row  r 2nd Row  g 3rd Row  b EndMatrix minus integral Start 3 By 1 Matrix 1st Row  upper R left-parenthesis lamda right-parenthesis 2nd Row  upper G left-parenthesis lamda right-parenthesis 3rd Row  upper B left-parenthesis lamda right-parenthesis EndMatrix upper S left-parenthesis lamda comma c 0 comma c 1 comma c 2 right-parenthesis upper W left-parenthesis lamda right-parenthesis normal d lamda double-vertical-bar comma</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2217" d="M433 144c-9 -15 -29 -19 -43 -9l-128 94l17 -158c2 -17 -11 -32 -29 -32s-31 15 -29 32l17 158l-128 -94c-14 -10 -34 -6 -43 9c-9 16 -3 35 14 42l145 64l-145 64c-17 7 -23 26 -14 42c9 15 29 19 43 9l128 -94l-17 158c-2 17 11 33 29 33s31 -16 29 -33l-17 -158 l128 94c14 10 34 6 43 -9c9 -16 3 -35 -14 -42l-145 -64l145 -64c17 -7 23 -26 14 -42Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-61" d="M483 89c0 -81 -61 -95 -82 -95c-47 0 -74 42 -78 82c-19 -47 -65 -87 -131 -87c-63 0 -160 25 -160 106c0 44 25 96 100 130c63 30 133 33 184 36v37c0 89 -57 128 -106 128c-32 0 -81 -11 -108 -46c46 -1 51 -34 51 -46c0 -26 -18 -46 -46 -46c-26 0 -46 17 -46 47 c0 66 69 113 151 113c48 0 98 -16 137 -55c36 -37 36 -76 36 -118v-200c0 -5 4 -50 37 -50c11 0 36 6 36 64v56h25v-56zM316 140v100c-165 -6 -207 -89 -207 -144c0 -50 41 -85 90 -85c45 0 117 34 117 129Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-72" d="M364 381c0 -32 -25 -44 -43 -44c-22 0 -43 15 -43 43c0 26 20 38 23 39c-2 1 -4 1 -11 1c-76 0 -118 -89 -118 -188v-154c0 -36 2 -47 76 -47h21v-31c-40 3 -87 3 -127 3l-114 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l139 11v-110c14 43 50 110 123 110 c43 0 74 -29 74 -61Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-67" d="M485 404c0 -23 -19 -30 -29 -30c-16 0 -29 12 -29 29c0 12 5 23 16 27c-3 1 -10 1 -10 1c-18 0 -54 -5 -90 -39c25 -23 41 -60 41 -97c0 -77 -69 -146 -162 -146c-19 0 -60 3 -99 31c-17 -20 -17 -43 -17 -47c0 -32 21 -63 53 -67c7 -1 50 -1 75 -1c61 0 119 0 172 -28 c51 -28 65 -79 65 -114c0 -78 -104 -129 -222 -129c-122 0 -221 55 -221 127c0 40 32 83 92 100c-31 20 -44 58 -44 89c0 35 18 68 31 83c-25 21 -47 59 -47 103c0 77 69 146 162 146c22 0 64 -3 106 -36c42 41 86 47 106 47c39 0 51 -32 51 -49zM309 296 c0 23 0 123 -87 123c-40 0 -63 -28 -71 -40c-15 -25 -16 -57 -16 -84c0 -23 0 -123 87 -123c40 0 63 28 71 40c15 25 16 57 16 84zM419 -79c0 86 -112 86 -198 86h-59c-44 -3 -82 -40 -82 -86c0 -53 69 -104 170 -104c98 0 169 50 169 104Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6D" d="M813 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31 c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c45 0 119 -11 133 -98c17 38 61 98 145 98c58 0 91 -20 105 -37c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-69" d="M247 0c-34 1 -69 3 -104 3l-110 -3v31c67 0 78 0 78 45v269c0 49 -9 55 -74 55v31l140 11v-367c0 -39 4 -44 70 -44v-31zM192 604c0 -25 -20 -53 -54 -53c-30 0 -53 26 -53 53c0 25 20 53 54 53c30 0 53 -26 53 -53Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-6E" d="M535 0l-112 3l-113 -3v31c67 0 78 0 78 45v233c0 57 -11 111 -74 111c-64 0 -135 -56 -135 -160v-184c0 -45 11 -45 78 -45v-31l-112 3l-113 -3v31c67 0 78 0 78 45v268c0 49 -8 56 -78 56v31l141 11v-105c28 62 75 105 148 105c58 0 91 -20 105 -37 c31 -36 31 -67 31 -153v-191c1 -30 26 -30 78 -30v-31Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSYMBOLS-23A1" d="M647 1470c0 -17 -13 -30 -30 -30h-236v-1440h-60v1500h296c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSYMBOLS-23A3" d="M647 30c0 -17 -13 -30 -30 -30h-296v1500h60v-1440h236c17 0 30 -13 30 -30Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSYMBOLS-23A2" d="M381 0h-60v1000h60v-1000Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSYMBOLS-23A4" d="M346 0h-60v1440h-236c-17 0 -30 13 -30 30s13 30 30 30h296v-1500Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSYMBOLS-23A6" d="M346 0h-296c-17 0 -30 13 -30 30s13 30 30 30h236v1440h60v-1500Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSYMBOLS-23A5" d="M346 1000v-1000h-60v1000h60Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-2212" d="M722 250c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSIZE1-222B" d="M943 1268c0 -35 -25 -50 -49 -50c-23 0 -48 16 -48 49c0 25 17 47 50 49c-4 4 -29 23 -60 23c-39 0 -73 -129 -85 -178c-34 -129 -71 -329 -108 -542c-54 -321 -119 -640 -196 -956c-71 -290 -128 -524 -280 -524c-61 0 -111 42 -111 93c0 35 25 50 49 50 c23 0 48 -16 48 -49c0 -25 -17 -47 -49 -49c0 0 25 -23 61 -23c81 0 127 188 145 261c33 139 62 306 88 459c110 654 246 1156 249 1167c55 204 111 313 187 313c55 0 109 -39 109 -93Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D446" d="M645 695l-54 -219c-4 -17 -5 -20 -15 -20c-12 0 -12 10 -12 10c0 6 4 24 4 56c0 112 -61 155 -144 155c-95 0 -175 -85 -175 -166c0 -53 34 -82 61 -91l67 -18c89 -23 104 -27 127 -50c15 -14 49 -48 49 -117c0 -124 -118 -257 -254 -257c-58 0 -126 14 -169 72l-49 -57 c-12 -14 -13 -15 -18 -15c-6 0 -11 4 -11 10c0 3 56 231 60 235c3 3 5 4 10 4s12 -1 12 -11c0 0 -1 -3 -2 -7c-1 -6 -6 -30 -6 -54c0 -124 111 -146 175 -146c98 0 180 94 180 184c0 82 -55 97 -92 106l-107 28c-51 15 -104 61 -104 142c0 121 120 236 247 236 c65 0 117 -25 143 -72l48 57c12 14 13 15 18 15c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E2-LATINMODERNNORMAL-1D44A" d="M1048 672c0 -19 -10 -19 -19 -20c-63 -5 -87 -41 -112 -85l-328 -570c-5 -9 -11 -19 -24 -19c-12 0 -14 5 -16 26l-37 505l-294 -510c-9 -15 -12 -21 -24 -21c-14 0 -15 8 -16 26l-45 611c-2 28 -3 37 -53 37c-16 0 -25 0 -25 12c0 19 13 19 18 19c34 0 70 -3 105 -3 c41 0 83 3 123 3c0 0 14 0 14 -11c0 -20 -11 -20 -21 -20c-76 -1 -76 -24 -76 -36l38 -507l253 441l-6 77c-2 19 -9 25 -53 25c-14 0 -24 0 -24 11c0 20 13 20 19 20c23 0 82 -3 105 -3c40 0 82 3 122 3c4 0 15 -1 15 -11c0 -20 -10 -20 -27 -20c-73 -1 -71 -27 -70 -47 l37 -496l270 471c8 14 13 22 13 33c0 30 -35 38 -59 39c-6 0 -15 1 -15 12c0 19 13 19 19 19c33 0 70 -3 104 -3c25 0 53 3 77 3c8 0 12 -7 12 -11Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-64" d="M527 0l-147 -11v66c-25 -32 -70 -66 -134 -66c-114 0 -212 99 -212 226c0 129 105 227 223 227c54 0 97 -26 126 -62v216c0 49 -8 56 -78 56v31l144 11v-607c0 -49 8 -56 78 -56v-31zM380 118v205c0 18 0 20 -11 37c-31 45 -73 60 -108 60c-54 0 -92 -33 -113 -64 c-29 -45 -31 -105 -31 -142c0 -41 3 -98 29 -139c24 -38 60 -64 105 -64c43 0 88 22 118 70c11 17 11 19 11 37Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSIZE7-E12C" d="M136 0h-79v1163c0 21 17 39 39 39s40 -18 40 -39v-1163zM369 0h-79v1163c0 21 17 39 39 39s40 -18 40 -39v-1163Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSIZE7-E12A" d="M136 39c0 -21 -18 -39 -40 -39s-39 18 -39 39v1163h78zM369 39c0 -21 -18 -39 -40 -39s-39 18 -39 39v1163h78Z"></path>
<path stroke-width="1" id="E2-LATINMODERNSIZE7-E12B" d="M136 1202v-1202h-79v1202h79zM369 1202v-1202h-79v1202h79Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-2217" x="613" y="449"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-30" x="613" y="-435"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="1276" y="0"></use>
<g transform="translate(1722,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-2217" x="613" y="449"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-31" x="613" y="-435"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="2609" y="0"></use>
<g transform="translate(3054,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-2217" x="613" y="449"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-32" x="613" y="-435"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="3942" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-3D" x="4609" y="0"></use>
<g transform="translate(5665,0)">
 <use xlink:href="#E2-LATINMODERNMAIN-61" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-72" x="500" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-67" x="893" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6D" x="1393" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-69" x="2227" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-6E" x="2505" y="0"></use>
<g transform="translate(337,-807)">
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E2-LATINMODERNMAIN-30" x="533" y="-243"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-2C" x="939" y="0"></use>
<g transform="translate(861,0)">
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E2-LATINMODERNMAIN-31" x="533" y="-243"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-2C" x="2158" y="0"></use>
<g transform="translate(1722,0)">
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#E2-LATINMODERNMAIN-32" x="533" y="-243"></use>
</g>
</g>
</g>
<g transform="translate(8894,0)">
<g transform="translate(0,2223)">
 <use xlink:href="#E2-LATINMODERNSIZE7-E12C" x="0" y="-1203"></use>
<g transform="translate(0,-2791.638704318937) scale(1,1.361295681063123)">
 <use xlink:href="#E2-LATINMODERNSIZE7-E12B"></use>
</g>
 <use xlink:href="#E2-LATINMODERNSIZE7-E12A" x="0" y="-3946"></use>
</g>
<g transform="translate(424,0)">
<g transform="translate(0,2153)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A3" x="0" y="-3805"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D45F" x="13" y="1353"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D454" x="0" y="-47"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D44F" x="24" y="-1453"></use>
</g>
</g>
<g transform="translate(1468,2153)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2353.0998003992017) scale(1,0.9001996007984032)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A6" x="0" y="-3805"></use>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2212" x="2782" y="0"></use>
 <use xlink:href="#E2-LATINMODERNSIZE1-222B" x="3783" y="0"></use>
<g transform="translate(4893,0)">
<g transform="translate(0,2223)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A1" x="0" y="-1501"></use>
<g transform="translate(0,-2493.9590818363276) scale(1,1.0409181636726548)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A2"></use>
</g>
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A3" x="0" y="-3946"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(13,1423)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D445" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
<g transform="translate(0,-26)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D43A" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="786" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D706" x="1176" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="1759" y="0"></use>
</g>
<g transform="translate(13,-1475)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D435" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="1732" y="0"></use>
</g>
</g>
</g>
<g transform="translate(3140,2223)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A4" x="0" y="-1501"></use>
<g transform="translate(0,-2493.9590818363276) scale(1,1.0409181636726548)">
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A5"></use>
</g>
 <use xlink:href="#E2-LATINMODERNSYMBOLS-23A6" x="0" y="-3946"></use>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D446" x="8867" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="9513" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D706" x="9902" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="10486" y="0"></use>
<g transform="translate(10931,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-30" x="613" y="-213"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="11818" y="0"></use>
<g transform="translate(12264,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-31" x="613" y="-213"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="13151" y="0"></use>
<g transform="translate(13596,0)">
 <use xlink:href="#E2-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E2-LATINMODERNMAIN-32" x="613" y="-213"></use>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="14484" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D44A" x="15040" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-28" x="16088" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D706" x="16478" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-29" x="17061" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-64" x="17617" y="0"></use>
 <use xlink:href="#E2-LATINMODERNNORMAL-1D706" x="18174" y="0"></use>
<g transform="translate(19089,2223)">
 <use xlink:href="#E2-LATINMODERNSIZE7-E12C" x="0" y="-1203"></use>
<g transform="translate(0,-2791.638704318937) scale(1,1.361295681063123)">
 <use xlink:href="#E2-LATINMODERNSIZE7-E12B"></use>
</g>
 <use xlink:href="#E2-LATINMODERNSIZE7-E12A" x="0" y="-3946"></use>
</g>
</g>
 <use xlink:href="#E2-LATINMODERNMAIN-2C" x="28575" y="0"></use>
</g>
</svg>
</div>
<p>

where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.916ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7283.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper R left-parenthesis lamda right-parenthesis comma upper G left-parenthesis lamda right-parenthesis comma upper B left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D445" d="M646 553c0 99 -111 99 -182 99c-20 0 -52 0 -61 -1c-19 -3 -22 -13 -28 -37l-65 -261h112c90 0 143 32 169 58c39 39 55 108 55 142zM755 93c0 -14 -35 -115 -120 -115c-13 0 -133 0 -133 108c0 20 9 57 16 85c6 23 14 54 14 69c0 35 -18 91 -109 91h-119l-66 -265 c-1 -6 -3 -11 -3 -17c0 -18 28 -18 65 -18c19 0 28 0 28 -11c0 -20 -12 -20 -20 -20l-127 3l-126 -3s-14 0 -14 11c0 20 9 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 9 20 29 20h285 c131 0 221 -64 221 -150c0 -101 -119 -171 -220 -193c27 -10 94 -41 94 -118c0 -14 -2 -33 -4 -47c-4 -32 -10 -83 -10 -114c0 -39 7 -61 40 -61c23 0 66 17 91 91c2 7 4 14 13 14c0 0 12 0 12 -12Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43A" d="M760 695l-63 -255c-5 -18 -5 -20 -18 -20c-4 0 -15 0 -15 10s3 11 3 51c0 116 -59 193 -161 193c-99 0 -196 -61 -250 -129c-105 -130 -115 -295 -115 -326c0 -153 105 -210 201 -210c35 0 165 11 193 121c10 37 21 82 21 91c0 13 -5 16 -31 19c-23 2 -53 2 -53 2 c-22 0 -30 0 -30 11c0 20 12 20 21 20l140 -3c23 0 82 3 105 3c8 0 13 -4 13 -11c0 -19 -11 -20 -16 -20c-57 -1 -58 -3 -69 -48c-4 -17 -9 -34 -13 -51l-19 -77c-5 -21 -15 -59 -17 -61c0 0 -2 -4 -7 -4c-10 0 -36 37 -45 62c-18 -20 -37 -41 -87 -61 c-36 -15 -81 -24 -125 -24c-162 0 -273 115 -273 274c0 232 225 453 448 453c111 0 157 -75 166 -89l70 77c11 11 12 12 15 12c9 0 11 -7 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D435" d="M756 545c0 -95 -105 -169 -209 -188c97 -11 155 -69 155 -141c0 -98 -118 -216 -276 -216h-357c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 10 20 29 20h336 c120 0 186 -64 186 -138zM665 549c0 44 -21 103 -109 103h-129c-43 0 -45 -3 -54 -38l-62 -248h146c122 0 208 95 208 183zM609 227c0 43 -19 117 -115 117h-189l-69 -279c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h136c118 0 207 97 207 196Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D445" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="759" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1149" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="1732" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2122" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43A" x="2567" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="3353" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="3743" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="4326" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4716" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D435" x="5161" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="5920" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="6310" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6893" y="0"></use>
</g>
</svg> describe emission curves of the color primaries and
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.6ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2411 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper W left-parenthesis lamda right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44A" d="M1048 672c0 -19 -10 -19 -19 -20c-63 -5 -87 -41 -112 -85l-328 -570c-5 -9 -11 -19 -24 -19c-12 0 -14 5 -16 26l-37 505l-294 -510c-9 -15 -12 -21 -24 -21c-14 0 -15 8 -16 26l-45 611c-2 28 -3 37 -53 37c-16 0 -25 0 -25 12c0 19 13 19 18 19c34 0 70 -3 105 -3 c41 0 83 3 123 3c0 0 14 0 14 -11c0 -20 -11 -20 -21 -20c-76 -1 -76 -24 -76 -36l38 -507l253 441l-6 77c-2 19 -9 25 -53 25c-14 0 -24 0 -24 11c0 20 13 20 19 20c23 0 82 -3 105 -3c40 0 82 3 122 3c4 0 15 -1 15 -11c0 -20 -10 -20 -27 -20c-73 -1 -71 -27 -70 -47 l37 -496l270 471c8 14 13 22 13 33c0 30 -35 38 -59 39c-6 0 -15 1 -15 12c0 19 13 19 19 19c33 0 70 -3 104 -3c25 0 53 3 77 3c8 0 12 -7 12 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D706" d="M548 -1c0 -3 -1 -9 -11 -10h-22c-27 0 -37 0 -53 22c-16 23 -64 176 -105 281l-241 -284c-8 -10 -17 -21 -33 -21s-30 12 -30 29c0 13 6 19 18 31l276 274l-97 272c-25 68 -32 74 -65 80c0 0 -9 2 -9 10c0 11 13 11 18 11c47 0 101 -13 122 -71l204 -569 c7 -20 13 -35 23 -46c3 -4 5 -6 5 -9Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44A" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1048" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D706" x="1438" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2021" y="0"></use>
</g>
</svg> represents the whitepoint (e.g., D65 shown in Figure&nbsp;<a href="../Radiometry,_Spectra,_and_Color/Light_Emission.html#fig:d-illuminant">4.14</a> in the case of the sRGB color space).
Including the whitepoint in this optimization problem ensures
that monochromatic RGB values map to uniform reflectance spectra.

</p>
<p>In spaces with a relatively compact gamut like sRGB, this optimization can
achieve zero error regardless of the method used to quantify color distances.
In larger color spaces, particularly those including imaginary colors like
ACES2065-1, zero round-trip error is clearly not achievable, and the choice of norm
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.53ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1519.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">double-vertical-bar dot double-vertical-bar</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E2-LATINMODERNMAIN-2016" d="M151 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960zM287 -230c0 -11 -9 -20 -20 -20s-20 9 -20 20v960c0 11 9 20 20 20s20 -9 20 -20v-960Z"></path>
<path stroke-width="1" id="E2-LATINMODERNMAIN-22C5" d="M192 250c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="0" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-22C5" x="620" y="0"></use>
 <use xlink:href="#E2-LATINMODERNMAIN-2016" x="1121" y="0"></use>
</g>
</svg> becomes relevant. In principle, we could simply use the
2-norm&mdash;however, a problem with such a basic choice is that it is not
<em>perceptually uniform</em>: whether a given amount of error is actually
visible depends on its position within the RGB cube. We instead use CIE76
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.709ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1597 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">normal upper Delta upper E</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-394" d="M785 8c0 -8 -6 -8 -22 -8h-694c-16 0 -22 0 -22 8c0 0 0 3 5 12l338 678c7 13 9 18 26 18s19 -5 26 -18l338 -678c5 -9 5 -12 5 -12zM653 76l-269 540l-270 -540h539Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D438" d="M763 653l-20 -173c-2 -19 -3 -25 -14 -25c-9 0 -12 7 -12 12s1 12 1 18c4 27 4 29 4 53c0 82 -30 111 -152 111h-141c-44 0 -45 -4 -54 -39l-60 -241h94c92 0 110 23 131 99c3 12 5 18 14 18c7 0 12 -5 12 -11l-57 -234c-4 -15 -7 -20 -15 -20c-9 0 -13 6 -13 11 c0 3 1 6 3 11c7 30 7 42 7 49c0 25 0 46 -85 46h-99l-68 -273c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h146c171 0 208 67 273 215c2 6 4 12 13 12c12 0 12 -11 12 -11s-3 -9 -5 -14l-92 -216c-7 -16 -8 -17 -31 -17h-519c-19 0 -28 0 -28 12 c0 19 11 19 28 19c79 0 81 8 91 47l132 529c5 18 5 20 5 24c0 18 -28 18 -65 18c-19 0 -28 0 -28 11c0 20 10 20 30 20h505c25 0 30 0 27 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-394" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D438" x="833" y="0"></use>
</g>
</svg>, which first transforms both colors into a color space known as
CIELAB before evaluating the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">upper L 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D43F" d="M643 247c0 0 0 -3 -4 -14l-79 -216c-6 -17 -7 -17 -31 -17h-463c-18 0 -27 0 -27 11c0 20 10 20 27 20c79 0 81 8 91 47l134 537c3 12 4 15 4 19c0 13 -9 14 -27 16c-17 2 -38 2 -38 2c-19 0 -28 0 -28 11c0 20 12 20 19 20l133 -3l148 3c5 0 16 0 16 -12 c0 -19 -8 -19 -38 -19c-94 0 -97 -11 -106 -47l-135 -540c-5 -18 -5 -20 -5 -23c0 -8 3 -9 13 -10c6 -1 8 -1 22 -1h94c173 0 217 114 251 206c7 16 8 21 17 21s12 -7 12 -11Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D43F" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="963" y="-213"></use>
</g>
</svg>-distance.

</p>
<p>We then solve this optimization problem using the Gauss&ndash;Newton algorithm, an
approximate form of Newton&rsquo;s method. This optimization takes on the order of a
few microseconds, which would lead to inefficiencies if performed every
time an RGB value must be converted to a spectrum (e.g., once for every pixel of a
high-resolution texture).

</p>
<p>To avoid this inefficiency, we precompute coefficient tables spanning the
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.707ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 2457.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket cubed</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
<g transform="translate(1724,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-33" x="393" y="513"></use>
</g>
</g>
</svg> RGB color cube when <tt>pbrt</tt> is first compiled. It is worth noting that
the tabulation could in principle also be performed over a lower-dimensional 2D
space of chromaticities: for example, a computed spectrum representing the
maximally saturated color red <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.365ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3170.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 1 comma 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="890" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1335" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1835" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2781" y="0"></use>
</g>
</svg> could simply be scaled to reproduce
less saturated RGB colors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.209ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3103.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis c comma 0 comma 0 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="823" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="1268" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1768" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2213" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2714" y="0"></use>
</g>
</svg>, where <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.016ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3881.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c element-of left-parenthesis 0 comma 1 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2208" d="M587 -23c0 -11 -9 -20 -20 -20h-193c-162 0 -293 131 -293 293s131 293 293 293h193c11 0 20 -9 20 -20s-9 -20 -20 -20h-193c-133 0 -242 -103 -252 -233h445c27 0 27 -40 0 -40h-445c10 -130 119 -233 252 -233h193c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2208" x="711" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="1656" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="2046" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2546" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="2991" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3492" y="0"></use>
</g>
</svg>. However, spectra for
highly saturated colors must necessarily peak within a small wavelength range
to achieve this saturation, while less saturated colors can be represented by
smoother spectra. This is generally preferable whenever possible due to the
inherent smoothness of reflectance spectra encountered in physical reality.

</p>
<p>We therefore precompute a full 3D tabulation for each RGB color space that
<tt>pbrt</tt> supports (currently, sRGB, DCI-P3, Rec2020, and ACES2065-1).  The
implementation of this optimization step is contained in the file
<tt>cmd/rgb2spec_opt.cpp</tt>, though we will not discuss it in detail here; see
the &ldquo;Further Reading&rdquo; section for additional information.
Figure&nbsp;<a href="#fig:rgb-albedo-spectrum">4.30</a> shows plots of spectra corresponding to a
few RGB values.

</p>
<p></p>
<span class="anchor" id="fig:rgb-albedo-spectrum"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f30.svg" title=""><img src="pha04f30.svg" width=421 height=295 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.30: Spectra Computed from RGB Values. <span class="legend">
Plots of reflectance spectra represented by the <a href="#RGBSigmoidPolynomial"><tt>RGBSigmoidPolynomial</tt></a>
for the RGB colors <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.792ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5507.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.7 comma 0.5 comma 0.8 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-37" d="M485 644c0 -21 0 -23 -9 -35l-135 -190c-44 -62 -58 -148 -62 -171c-8 -54 -11 -109 -11 -164v-51c0 -10 0 -55 -46 -55s-46 45 -46 55c0 102 33 241 123 376l112 158h-207c-13 0 -91 0 -98 -6c-13 -12 -22 -75 -25 -91h-25l33 206h25c4 -19 6 -32 128 -32h243Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-38" d="M457 168c0 -107 -95 -190 -208 -190c-105 0 -207 67 -207 173c0 99 86 155 144 184c-25 17 -62 42 -73 54c-42 47 -44 92 -44 110c0 93 81 167 181 167c91 0 180 -57 180 -149c0 -66 -49 -118 -121 -155c64 -40 80 -50 99 -71c38 -42 49 -87 49 -123zM386 517 c0 72 -64 124 -137 124c-71 0 -136 -42 -136 -103c0 -17 4 -51 50 -81l124 -80c60 35 99 83 99 140zM407 132c0 61 -47 91 -75 110l-123 78c-85 -47 -117 -111 -117 -169c0 -83 72 -145 158 -145c82 0 157 52 157 126Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-37" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1669" y="0"></use>
<g transform="translate(2114,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="3393" y="0"></use>
<g transform="translate(3838,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-38" x="779" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="5118" y="0"></use>
</g>
</svg> (purple line), <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.28ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7009.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.25 comma 0.44 comma 0.33 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4394" y="0"></use>
<g transform="translate(4839,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="6619" y="0"></use>
</g>
</svg>
(green line), and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.442ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7509.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.36 comma 0.275 comma 0.21 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-33" d="M457 171c0 -102 -91 -193 -213 -193c-109 0 -202 66 -202 157c0 44 32 58 56 58c29 0 56 -20 56 -56c0 -38 -31 -60 -66 -55c35 -59 110 -76 153 -76c44 0 113 29 113 165c0 98 -37 166 -119 166h-44c-17 0 -24 0 -24 11c0 10 7 11 15 12c7 0 31 2 39 3c25 1 59 4 89 52 c26 44 28 102 28 114c0 90 -55 112 -96 112c-36 0 -102 -13 -133 -62c15 0 62 0 62 -50c0 -29 -20 -51 -51 -51c-29 0 -51 19 -51 52c0 76 76 136 177 136c96 0 184 -56 184 -138c0 -79 -58 -149 -140 -176c104 -21 167 -99 167 -181Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-36" d="M457 204c0 -132 -95 -226 -206 -226c-93 0 -209 71 -209 338c0 221 135 350 263 350c83 0 127 -48 127 -108c0 -39 -30 -48 -46 -48c-22 0 -46 15 -46 46c0 45 40 45 55 45c-22 34 -64 40 -88 40c-51 0 -175 -36 -175 -289v-24c20 48 57 99 125 99 c111 0 200 -96 200 -223zM367 205c0 49 0 100 -18 137c-31 62 -77 62 -93 62c-90 0 -122 -100 -122 -178c0 -18 0 -98 18 -145c6 -15 36 -75 99 -75c23 0 69 5 99 65c17 36 17 86 17 134Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-37" d="M485 644c0 -21 0 -23 -9 -35l-135 -190c-44 -62 -58 -148 -62 -171c-8 -54 -11 -109 -11 -164v-51c0 -10 0 -55 -46 -55s-46 45 -46 55c0 102 33 241 123 376l112 158h-207c-13 0 -91 0 -98 -6c-13 -12 -22 -75 -25 -91h-25l33 206h25c4 -19 6 -32 128 -32h243Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-33" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-36" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1780" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4895" y="0"></use>
<g transform="translate(5340,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7120" y="0"></use>
</g>
</svg> (brown line).  Each line is colored
with its corresponding RGB color.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>
The resulting tables are stored in the <tt>pbrt</tt> binary.  At system startup
time, an <tt>RGBToSpectrumTable</tt> for each of the RGB color spaces is
created.

</p>
<p></p>
<span class="anchor" id="fragment-RGBToSpectrumTableDefinition-0"></span><div class="fragmentname">&lt;&lt;RGBToSpectrumTable Definition&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">class <span class="anchor" id="RGBToSpectrumTable"></span>RGBToSpectrumTable {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBToSpectrumTablePublicConstants-0">RGBToSpectrumTable Public Constants</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-181" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-181"><i></i></a><div id="fragbit-181" class="collapse"><div class="fragmentcode">       static constexpr int <a href="#RGBToSpectrumTable::res" class="code">res</a> = 64;
       using CoefficientArray = float[3][<a href="#RGBToSpectrumTable::res" class="code">res</a>][<a href="#RGBToSpectrumTable::res" class="code">res</a>][<a href="#RGBToSpectrumTable::res" class="code">res</a>][3];</div></div>
    &lt;&lt;<span class="fragmentname">RGBToSpectrumTable Public Methods</span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-182" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-182"><i></i></a><div id="fragbit-182" class="collapse"><div class="fragmentcode">       RGBToSpectrumTable(const float *zNodes, const CoefficientArray *coeffs)
           : zNodes(zNodes), coeffs(coeffs) { }
       PBRT_CPU_GPU
       RGBSigmoidPolynomial operator()(<a href="#RGB" class="code">RGB</a> rgb) const;
       
       static void Init(Allocator alloc);
       
       static const RGBToSpectrumTable *sRGB;
       static const RGBToSpectrumTable *DCI_P3;
       static const RGBToSpectrumTable *Rec2020;
       static const RGBToSpectrumTable *ACES2065_1;
       
       std::string ToString() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBToSpectrumTablePrivateMembers-0">RGBToSpectrumTable Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-183" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-183"><i></i></a><div id="fragbit-183" class="collapse"><div class="fragmentcode">       const float *zNodes;
       const CoefficientArray *coeffs;</div></div>
};</div><p>


</p>
<p>

</p>
<p>The principal method of <tt>RGBToSpectrumTable</tt> returns the
<a href="#RGBSigmoidPolynomial"><tt>RGBSigmoidPolynomial</tt></a> corresponding to the given RGB color.

</p>
<p></p>
<span class="anchor" id="fragment-RGBToSpectrumTableMethodDefinitions-0"></span><div class="fragmentname">&lt;&lt;RGBToSpectrumTable Method Definitions&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">RGBSigmoidPolynomial <span class="anchor" id="RGBToSpectrumTable::operator"></span>RGBToSpectrumTable::operator()(<a href="#RGB" class="code">RGB</a> rgb) const {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Handleuniformmonorgbvalues-0">Handle uniform <tt>rgb</tt> values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-184" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-184"><i></i></a><div id="fragbit-184" class="collapse"><div class="fragmentcode">       if (rgb[0] == rgb[1] &amp;&amp; rgb[1] == rgb[2])
           return RGBSigmoidPolynomial(
               0, 0, (rgb[0] - .5f) / std::sqrt(rgb[0] * (1 - rgb[0])));</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Findmaximumcomponentandcomputeremappedcomponentvalues-0">Find maximum component and compute remapped component values</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-185" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-185"><i></i></a><div id="fragbit-185" class="collapse"><div class="fragmentcode">       int maxc = (rgb[0] &gt; rgb[1]) ? ((rgb[0] &gt; rgb[2]) ? 0 : 2) :
                                      ((rgb[1] &gt; rgb[2]) ? 1 : 2);
       float z = rgb[maxc];
       float x = rgb[(maxc + 1) % 3] * (<a href="#RGBToSpectrumTable::res" class="code">res</a> - 1) / z;
       float y = rgb[(maxc + 2) % 3] * (<a href="#RGBToSpectrumTable::res" class="code">res</a> - 1) / z;</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Computeintegerindicesandoffsetsforcoefficientinterpolation-0">Compute integer indices and offsets for coefficient interpolation</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-186" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-186"><i></i></a><div id="fragbit-186" class="collapse"><div class="fragmentcode">       int xi = std::min((int)x, res - 2), yi = std::min((int)y, res - 2),
           zi = <a href="../Utilities/Mathematical_Infrastructure.html#FindInterval" class="code">FindInterval</a>(res, [&amp;](int i) { return <a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[i] &lt; z; });
       Float dx = x - xi, dy = y - yi,
             dz = (z - <a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[zi]) / (<a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[zi + 1] - <a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[zi]);</div></div>
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Trilinearlyinterpolatesigmoidpolynomialcoefficientsmonoc-0">Trilinearly interpolate sigmoid polynomial coefficients <tt>c</tt></a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-187" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-187"><i></i></a><div id="fragbit-187" class="collapse"><div class="fragmentcode">       pstd::array&lt;Float, 3&gt; c;
       for (int i = 0; i &lt; 3; ++i) {
           &lt;&lt;<span class="fragmentname"><a href="#fragment-Definemonocolambdaforlookingupsigmoidpolynomialcoefficients-0">Define <tt>co</tt> lambda for looking up sigmoid polynomial coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-188" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-188"><i></i></a><div id="fragbit-188" class="collapse"><div class="fragmentcode">              auto co = [&amp;](int dx, int dy, int dz) {
                  return (*<a href="#RGBToSpectrumTable::coeffs" class="code">coeffs</a>)[maxc][zi + dz][yi + dy][xi + dx][i];
              };</div></div>
           c[i] = <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dz, <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dy, <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 0, 0), co(1, 0, 0)),
                                    <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 1, 0), co(1, 1, 0))),
                           <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dy, <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 0, 1), co(1, 0, 1)),
                                    <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 1, 1), co(1, 1, 1))));
       }</div></div>
    return RGBSigmoidPolynomial(c[0], c[1], c[2]);
}</div><p>


</p>
<p>If the three RGB values are equal, it is useful to ensure that the returned
spectrum is exactly constant.  (In some cases, a slight color shift may
otherwise be evident if interpolated values from the coefficient tables are
used.)  A constant spectrum results if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.482ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 4943.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c 0 equals c 1 equals 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="613" y="-213"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="1165" y="0"></use>
<g transform="translate(2221,0)">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="613" y="-213"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3386" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="4442" y="0"></use>
</g>
</svg> in
Equation&nbsp;(<a href="#eq:rgb-to-spectrum-spd">4.26</a>) and the appropriate value of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.061ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 887.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="613" y="-213"></use>
</g>
</svg>
can be found by inverting the sigmoid function.

</p>
<p></p>
<span class="anchor" id="fragment-Handleuniformmonorgbvalues-0"></span><div class="fragmentname">&lt;&lt;Handle uniform <tt>rgb</tt> values&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">if (rgb[0] == rgb[1] &amp;&amp; rgb[1] == rgb[2])
    return RGBSigmoidPolynomial(
        0, 0, (rgb[0] - .5f) / std::sqrt(rgb[0] * (1 - rgb[0])));</div><p>


</p>
<p> </p>
<span class="anchor" id="fig:rgb-spectrum-ci-plots"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f31.svg" title=""><img src="pha04f31.svg" width=927 height=775 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.31: Plots of Spectrum Polynomial Coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg>. <span class="legend">
These plots show the polynomial coefficients for the corresponding <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.469ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1063 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="572" y="0"></use>
</g>
</svg>
chromaticities in the sRGB color space.
Each of (a)&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.061ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 887.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-30" x="613" y="-213"></use>
</g>
</svg>, (b)&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.061ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 887.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c 1</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-31" x="613" y="-213"></use>
</g>
</svg>, and (c)&nbsp;<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.061ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 887.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNMAIN-32" x="613" y="-213"></use>
</g>
</svg> mostly vary smoothly, though
they exhibit sharp transitions.  (d)&nbsp;Partitioning the gamut according to which
of red, green, or blue has the largest magnitude closely corresponds to
these transitions; coefficients are therefore independently tabularized in
those three regions.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p>The coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg> from the optimization are generally
smoothly varying; small changes in RGB generally lead to small changes in
their values.  (This property also ends up being helpful for the
<em>smoothness</em> goal.)  However, there are a few regions of the RGB space
where they change rapidly, which makes direct 3D tabularization of them
prone to error in those regions&mdash;see
Figure&nbsp;<a href="#fig:rgb-spectrum-ci-plots">4.31</a>(a), (b), and (c).  A better approach
is to tabularize them independently based on which of the red, green, or
blue RGB coefficients has the largest magnitude.  This partitioning matches
the coefficient discontinuities well, as is shown in
Figure&nbsp;<a href="#fig:rgb-spectrum-ci-plots">4.31</a>(d).

</p>
<p>A 3D tabularization problem remains within each of the three partitions.
We will use the partition where the red component <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 451.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
</g>
</svg> has the greatest
magnitude to explain how the table is indexed.  For a given <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.032ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3027.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis r comma g comma b right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="841" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="1286" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1763" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="2208" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2638" y="0"></use>
</g>
</svg>, the
first step is to compute a renormalized coordinate
</p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">

</div>
<div class="col-md-10 col-lg-8">
<div class="displaymath"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.593ex" height="5.676ex" style="vertical-align: -2.171ex;" viewBox="0 -1508.9 9296.9 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y comma z right-parenthesis equals left-parenthesis StartFraction g Over r EndFraction comma StartFraction b Over r EndFraction comma r right-parenthesis period</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-3D" d="M722 347c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20zM722 153c0 -11 -9 -20 -20 -20h-626c-11 0 -20 9 -20 20s9 20 20 20h626c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-28" d="M608 -780c0 -9 -7 -16 -16 -16c-4 0 -7 1 -10 3c-199 150 -381 545 -381 893v300c0 348 182 743 381 893c3 2 6 3 10 3c9 0 16 -7 16 -16c0 -5 -3 -10 -6 -13c-190 -142 -323 -535 -323 -867v-300c0 -332 133 -725 323 -867c3 -3 6 -8 6 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNSIZE5-29" d="M462 100c0 -348 -182 -743 -382 -893c-2 -2 -6 -3 -9 -3c-9 0 -16 7 -16 16c0 5 2 10 6 13c190 142 323 535 323 867v300c0 332 -133 725 -323 867c-4 3 -6 8 -6 13c0 9 7 16 16 16c3 0 7 -1 9 -3c200 -150 382 -545 382 -893v-300Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1897" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="2342" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2810" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-3D" x="3477" y="0"></use>
<g transform="translate(4533,0)">
 <use xlink:href="#E1-LATINMODERNSIZE5-28"></use>
<g transform="translate(663,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="597" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="60" y="725"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="73" y="-686"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1501" y="0"></use>
<g transform="translate(1779,0)">
<g transform="translate(286,0)">
<rect stroke="none" width="571" height="60" x="0" y="220"></rect>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="71" y="676"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2757" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="3202" y="0"></use>
 <use xlink:href="#E1-LATINMODERNSIZE5-29" x="3654" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="9018" y="0"></use>
</g>
</svg>
</div>
<p>

(By convention, the largest component is always mapped to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>.)  A similar
remapping is applied if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.109ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 477.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">g</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
</g>
</svg> or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg> is the maximum.  With this mapping, all
three coordinates span the range <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-bracket 0 comma 1 right-bracket</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-5B" d="M256 -230c0 -11 -9 -20 -20 -20h-122v1000h122c11 0 20 -9 20 -20s-9 -20 -20 -20h-82v-920h82c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-5D" d="M164 -250h-122c-11 0 -20 9 -20 20s9 20 20 20h82v920h-82c-11 0 -20 9 -20 20s9 20 20 20h122v-1000Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="278" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-5D" x="1724" y="0"></use>
</g>
</svg>, which makes it possible to make
better use of samples in a fixed grid.

</p>
<p></p>
<span class="anchor" id="fragment-Findmaximumcomponentandcomputeremappedcomponentvalues-0"></span><div class="fragmentname">&lt;&lt;Find maximum component and compute remapped component values&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">int maxc = (rgb[0] &gt; rgb[1]) ? ((rgb[0] &gt; rgb[2]) ? 0 : 2) :
                               ((rgb[1] &gt; rgb[2]) ? 1 : 2);
float z = rgb[maxc];
float x = rgb[(maxc + 1) % 3] * (<a href="#RGBToSpectrumTable::res" class="code">res</a> - 1) / z;
float y = rgb[(maxc + 2) % 3] * (<a href="#RGBToSpectrumTable::res" class="code">res</a> - 1) / z;</div><p>


</p>
<p>The resolution of the tabularization, <tt>res</tt>, is the same in all three
dimensions.  Because it is set to be a compile time constant here, changing
the size of the tables would require recompiling <tt>pbrt</tt>.

</p>
<p></p>
<span class="anchor" id="fragment-RGBToSpectrumTablePublicConstants-0"></span><div class="fragmentname">&lt;&lt;RGBToSpectrumTable Public Constants&gt;&gt;=&nbsp;<a href="#fragment-RGBToSpectrumTablePublicConstants-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">static constexpr int <span class="anchor" id="RGBToSpectrumTable::res"></span>res = 64;</div><p>


</p>
<p>An equally spaced discretization is used for the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> coordinates in
the coefficient tables, though <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> is remapped through a nonlinear function
that allocates more samples near both&nbsp;0 and&nbsp;1.  The <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg> coefficients vary
most rapidly in that region, so this remapping allocates samples more
effectively.

</p>
<p>The <tt>zNodes</tt> array (which is of <tt>res</tt> elements) stores the result
of the remapping where if <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.283ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 552.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
</g>
</svg> is the remapping function then the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="0" y="0"></use>
</g>
</svg>th
element of <tt>zNodes</tt> stores <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.719ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3754 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">f left-parenthesis i slash monospace r monospace e monospace s right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D453" d="M552 636c0 -38 -29 -60 -55 -60c-19 0 -37 12 -37 35c0 15 10 50 54 54c-19 18 -45 18 -49 18c-21 0 -38 -15 -47 -34c-6 -12 -20 -83 -24 -104c-11 -58 -10 -56 -21 -114h83c17 0 27 0 27 -11c0 -20 -10 -20 -30 -20h-86l-60 -317c-1 -7 -24 -128 -56 -191 c-18 -38 -58 -97 -113 -97c-41 0 -85 24 -85 69c0 38 29 60 55 60c19 0 37 -12 37 -35c0 -15 -9 -51 -55 -54c19 -18 44 -18 48 -18c52 0 69 91 87 188l75 395h-66c-19 0 -28 0 -28 12c0 19 11 19 30 19h69c24 126 27 136 33 157c30 99 93 117 127 117c41 0 87 -23 87 -69Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D69B" d="M487 375c0 -27 -20 -43 -42 -43c-25 0 -42 20 -43 44c-121 0 -180 -96 -180 -190v-125h111c15 0 41 0 41 -31c0 -30 -26 -30 -41 -30h-261c-16 0 -40 0 -40 31c0 30 25 30 40 30h81v309h-81c-16 0 -40 0 -40 31c0 30 25 30 40 30h110c34 0 40 -10 40 -41v-34 c55 63 119 81 170 81c83 0 95 -42 95 -62Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D68E" d="M464 109c0 -25 -47 -115 -179 -115c-129 0 -230 101 -230 223c0 123 96 223 215 223c130 0 194 -98 194 -212c0 -37 -19 -37 -40 -37h-298c16 -86 91 -136 166 -136c28 0 82 9 104 60c7 19 15 22 33 22c6 0 35 0 35 -28zM393 251c-9 103 -71 128 -123 128 c-70 0 -129 -55 -143 -128h266Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMONOSPACE-1D69C" d="M459 125c0 -48 -32 -131 -190 -131c-28 0 -81 2 -130 38c-12 -37 -28 -38 -37 -38c-30 0 -30 25 -30 41v97c0 20 0 41 35 41c26 0 30 -11 35 -29c25 -78 81 -89 128 -89c91 0 128 33 128 70c0 53 -80 66 -129 74c-92 14 -197 31 -197 123c0 36 23 118 190 118 c19 0 63 0 107 -21c2 7 6 21 30 21c30 0 30 -25 30 -41v-69c0 -20 0 -41 -35 -41c-31 0 -33 17 -34 34c-3 26 -17 56 -100 56c-95 0 -127 -31 -127 -57c0 -39 68 -51 97 -55l68 -12c32 -5 161 -26 161 -130Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D453" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="552" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D456" x="942" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="1287" y="0"></use>
<g transform="translate(1788,0)">
 <use xlink:href="#E1-LATINMODERNMONOSPACE-1D69B" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMONOSPACE-1D68E" x="525" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMONOSPACE-1D69C" x="1051" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="3364" y="0"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-RGBToSpectrumTablePrivateMembers-0"></span><div class="fragmentname">&lt;&lt;RGBToSpectrumTable Private Members&gt;&gt;=&nbsp;<a href="#fragment-RGBToSpectrumTablePrivateMembers-1"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">const float *<span class="anchor" id="RGBToSpectrumTable::zNodes"></span>zNodes;</div><p>


</p>
<p>Finding integer coordinates in the table is simple for <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg> and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg> given
the equally spaced discretization.  For <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>, a binary search through
<tt>zNodes</tt> is required.  Given these coordinates, floating-point offsets
from them are then found for use in interpolation.

</p>
<p></p>
<span class="anchor" id="fragment-Computeintegerindicesandoffsetsforcoefficientinterpolation-0"></span><div class="fragmentname">&lt;&lt;Compute integer indices and offsets for coefficient interpolation&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">int xi = std::min((int)x, res - 2), yi = std::min((int)y, res - 2),
    zi = <a href="../Utilities/Mathematical_Infrastructure.html#FindInterval" class="code">FindInterval</a>(res, [&amp;](int i) { return <a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[i] &lt; z; });
Float dx = x - xi, dy = y - yi,
      dz = (z - <a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[zi]) / (<a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[zi + 1] - <a href="#RGBToSpectrumTable::zNodes" class="code">zNodes</a>[zi]);</div><p>


</p>
<p>We can now implement the fragment that trilinearly interpolates between the
eight coefficients around the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.432ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3199.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis x comma y comma z right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="389" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="962" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="1407" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="1897" y="0"></use>
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="2342" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="2810" y="0"></use>
</g>
</svg> lookup point.  The details of indexing
into the coefficient tables are handled by the <tt>co</tt> lambda function,
which we will define shortly, after describing the layout of the tables in
memory.  Note that although the <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> coordinate has a nonlinear mapping
applied to it, we still linearly interpolate between coefficient samples in
<svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>.  In practice, the error from doing so is minimal.

</p>
<p></p>
<span class="anchor" id="fragment-Trilinearlyinterpolatesigmoidpolynomialcoefficientsmonoc-0"></span><div class="fragmentname">&lt;&lt;Trilinearly interpolate sigmoid polynomial coefficients <tt>c</tt>&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">pstd::array&lt;Float, 3&gt; c;
for (int i = 0; i &lt; 3; ++i) {
    &lt;&lt;<span class="fragmentname"><a href="#fragment-Definemonocolambdaforlookingupsigmoidpolynomialcoefficients-0">Define <tt>co</tt> lambda for looking up sigmoid polynomial coefficients</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-189" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-189"><i></i></a><div id="fragbit-189" class="collapse"><div class="fragmentcode">       auto co = [&amp;](int dx, int dy, int dz) {
           return (*<a href="#RGBToSpectrumTable::coeffs" class="code">coeffs</a>)[maxc][zi + dz][yi + dy][xi + dx][i];
       };</div></div>
    c[i] = <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dz, <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dy, <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 0, 0), co(1, 0, 0)),
                             <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 1, 0), co(1, 1, 0))),
                    <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dy, <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 0, 1), co(1, 0, 1)),
                             <a href="../Monte_Carlo_Integration/Sampling_Using_the_Inversion_Method.html#Lerp" class="code">Lerp</a>(dx, co(0, 1, 1), co(1, 1, 1))));
}</div><p>


</p>
<p>The coefficients are stored in a five-dimensional array.  The first
dimension corresponds to whether <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 451.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">r</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D45F" d="M436 377c0 -36 -28 -59 -55 -59s-38 19 -38 35c0 26 22 50 52 55c0 0 -16 12 -42 12c-43 0 -72 -26 -80 -33c-24 -22 -52 -69 -56 -82l-32 -130c-4 -18 -38 -154 -40 -158c-7 -20 -25 -28 -37 -28c-15 0 -29 9 -29 27c0 5 6 28 9 43l58 231c13 52 16 63 16 84 c0 38 -14 46 -31 46c-36 0 -56 -48 -73 -119c-6 -22 -7 -23 -17 -23c0 0 -12 0 -12 10c0 3 13 63 31 97c9 18 28 57 74 57c47 0 83 -32 91 -77c19 28 63 77 128 77c51 0 83 -30 83 -65Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D45F" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.109ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 477.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">g</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D454" d="M474 395c0 -7 -2 -12 -3 -18l-111 -444c-15 -60 -87 -138 -212 -138c-96 0 -133 20 -133 61c0 40 32 58 54 58c27 0 38 -19 38 -35c0 -17 -11 -43 -41 -52c28 -9 61 -10 80 -10c106 0 140 99 144 108l33 132l-1 1c-10 -11 -57 -58 -116 -58c-72 0 -133 59 -133 158 c0 144 124 284 238 284c40 0 75 -26 93 -63c4 36 31 43 41 43c17 0 29 -10 29 -27zM392 334c0 5 -14 86 -80 86c-42 0 -85 -40 -112 -89c-27 -51 -56 -169 -56 -217c0 -40 15 -92 65 -92c29 0 60 18 81 36c22 19 45 44 51 70l48 191c1 4 3 10 3 15Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D454" x="0" y="0"></use>
</g>
</svg>, or <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">b</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D44F" d="M415 282c0 -144 -123 -293 -241 -293c-74 0 -127 62 -127 157c0 35 4 51 16 101l82 326c5 21 14 55 14 62c0 10 -2 17 -50 17c-15 0 -24 0 -24 12c0 18 11 19 19 20c26 2 99 10 122 10c13 0 13 -11 13 -11l-74 -301c30 31 71 60 117 60c80 0 133 -69 133 -160zM343 326 c0 64 -27 94 -63 94c-26 0 -71 -15 -120 -80c-9 -11 -9 -13 -15 -35l-22 -92c-16 -63 -16 -82 -16 -101c0 -74 33 -101 67 -101c39 0 85 36 118 103c18 38 51 153 51 212Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D44F" x="0" y="0"></use>
</g>
</svg> had the largest magnitude
and the next three correspond to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, respectively.  The last
dimension is over the three coefficients <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.807ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 777.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">c Subscript i</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D450" d="M430 107c0 -12 -84 -118 -227 -118c-104 0 -162 79 -162 169c0 141 133 284 268 284c71 0 118 -37 118 -86c0 -40 -27 -64 -56 -64c-19 0 -37 11 -37 35c0 7 2 24 18 39c14 14 28 14 44 14c-14 27 -52 40 -86 40c-55 0 -110 -43 -141 -100c-34 -62 -54 -159 -54 -200 c0 -60 27 -109 90 -109c12 0 121 0 200 99c6 8 8 10 13 10c6 0 12 -7 12 -13Z"></path>
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D456" d="M284 625c0 -30 -30 -53 -53 -53c-24 0 -38 17 -38 36c0 27 27 53 54 53c23 0 37 -16 37 -36zM293 143c0 -9 -37 -154 -131 -154c-48 0 -82 35 -82 82c0 21 13 54 23 80c16 43 61 159 69 185c4 10 11 31 11 52c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124 c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 38 154 132 154c50 0 82 -37 82 -82c0 -19 -5 -33 -13 -53c-10 -27 -10 -29 -22 -58l-39 -105c-23 -61 -29 -75 -29 -100c0 -23 7 -33 24 -33c51 0 84 61 102 124c5 15 5 18 15 18c3 0 12 0 12 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D450" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-LATINMODERNNORMAL-1D456" x="613" y="-213"></use>
</g>
</svg>.

</p>
<p></p>
<span class="anchor" id="fragment-RGBToSpectrumTablePublicConstants-1"></span><div class="fragmentname">&lt;&lt;RGBToSpectrumTable Public Constants&gt;&gt;+=&nbsp;<a href="#fragment-RGBToSpectrumTablePublicConstants-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">using CoefficientArray = float[3][<a href="#RGBToSpectrumTable::res" class="code">res</a>][<a href="#RGBToSpectrumTable::res" class="code">res</a>][<a href="#RGBToSpectrumTable::res" class="code">res</a>][3];</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-RGBToSpectrumTablePrivateMembers-1"></span><div class="fragmentname">&lt;&lt;RGBToSpectrumTable Private Members&gt;&gt;+=&nbsp;<a href="#fragment-RGBToSpectrumTablePrivateMembers-0"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">const CoefficientArray *<span class="anchor" id="RGBToSpectrumTable::coeffs"></span>coeffs;</div><p>


</p>
<p>The coefficient lookup lambda function is now just a matter of using the
correct values for each dimension of the array.  The provided integer
deltas are applied in <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">x</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D465" d="M527 376c0 -40 -32 -58 -54 -58c-27 0 -38 19 -38 35c0 24 20 49 48 54c-21 13 -45 13 -50 13c-70 0 -93 -92 -99 -118l-34 -137c-11 -44 -17 -66 -17 -88c0 -34 16 -66 55 -66c32 0 100 24 133 131c2 7 4 11 13 11c3 0 12 0 12 -10c0 -25 -57 -154 -160 -154 c-60 0 -96 39 -108 76c-3 -6 -39 -76 -105 -76c-44 0 -94 20 -94 66c0 32 25 58 55 58c15 0 37 -8 37 -35c0 -28 -22 -49 -47 -54c21 -13 44 -13 50 -13c44 0 79 42 95 104c37 140 54 207 54 238c0 58 -35 67 -54 67c-34 0 -100 -25 -134 -131c-2 -9 -5 -11 -13 -11 c0 0 -12 0 -12 10c0 25 57 154 161 154c29 0 83 -10 108 -76c12 23 47 76 105 76c34 0 93 -14 93 -66Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D465" x="0" y="0"></use>
</g>
</svg>, <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.139ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 490.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">y</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D466" d="M490 404c0 -7 0 -9 -4 -23l-96 -382c-28 -113 -131 -204 -234 -204c-62 0 -106 37 -106 87c0 49 33 65 56 65c10 0 37 -4 37 -35c0 -19 -10 -32 -20 -41c-14 -12 -27 -12 -43 -12c17 -39 62 -42 76 -42c46 0 84 29 110 63c40 53 52 102 65 154c-28 -28 -62 -45 -101 -45 c-59 0 -122 30 -122 119c0 47 18 104 58 210c7 19 17 45 17 70c0 32 -17 32 -25 32c-34 0 -74 -30 -101 -124c-5 -16 -6 -18 -16 -18c0 0 -12 0 -12 10c0 9 37 154 132 154c50 0 82 -37 82 -82c0 -20 -4 -31 -20 -72c-34 -88 -51 -150 -51 -196c0 -37 11 -81 62 -81 c66 0 109 70 113 85l45 180l20 80c4 18 12 49 14 54c9 15 25 21 35 21c15 0 29 -9 29 -27Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D466" x="0" y="0"></use>
</g>
</svg>, and <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.086ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 467.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">z</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNNORMAL-1D467" d="M467 432c0 -4 -22 -52 -117 -145c-36 -36 -98 -90 -98 -90c-36 -31 -65 -56 -119 -114c9 3 27 3 27 3c21 0 36 -4 70 -17c21 -7 39 -13 59 -13c33 0 97 19 120 84c3 7 5 13 14 13c8 0 12 -5 12 -10c0 -27 -58 -154 -157 -154c-29 0 -47 16 -64 37c-25 29 -35 38 -58 38 c-32 0 -62 -27 -85 -62c-6 -11 -8 -13 -16 -13c0 0 -12 0 -12 10c0 7 35 64 103 131l90 84c19 16 103 88 139 131c-26 0 -37 0 -77 15c-23 8 -42 15 -63 15c-8 0 -66 -1 -85 -47c-2 -6 -4 -11 -13 -11s-12 6 -12 11c0 21 46 114 121 114c33 0 50 -20 69 -43 c15 -17 27 -32 51 -32s45 16 75 64c5 9 8 11 15 11c0 0 11 0 11 -10Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNNORMAL-1D467" x="0" y="0"></use>
</g>
</svg> when doing so.

</p>
<p></p>
<span class="anchor" id="fragment-Definemonocolambdaforlookingupsigmoidpolynomialcoefficients-0"></span><div class="fragmentname">&lt;&lt;Define <tt>co</tt> lambda for looking up sigmoid polynomial coefficients&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">auto co = [&amp;](int dx, int dy, int dz) {
    return (*<a href="#RGBToSpectrumTable::coeffs" class="code">coeffs</a>)[maxc][zi + dz][yi + dy][xi + dx][i];
};</div><p>


</p>
<p>With <tt>RGBSigmoidPolynomial</tt>&rsquo;s implementation complete, we can now add
a method to <a href="#RGBColorSpace"><tt>RGBColorSpace</tt></a> to transform an RGB in its color space to an
<a href="#RGBSigmoidPolynomial"><tt>RGBSigmoidPolynomial</tt></a>.

</p>
<p></p>
<span class="anchor" id="fragment-RGBColorSpaceMethodDefinitions-2"></span><div class="fragmentname">&lt;&lt;RGBColorSpace Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-RGBColorSpaceMethodDefinitions-1"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">RGBSigmoidPolynomial <span class="anchor" id="RGBColorSpace::ToRGBCoeffs"></span><a href="#RGBColorSpace" class="code">RGBColorSpace</a>::ToRGBCoeffs(<a href="#RGB" class="code">RGB</a> rgb) const {
    return (*rgbToSpectrumTable)(ClampZero(rgb));
}</div><p>


</p>
<p>

</p>
<p>

</p>
<p>With these capabilities, we can now define the <tt>RGBAlbedoSpectrum</tt>
class, which implements the <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum"><tt>Spectrum</tt></a> interface to return spectral
samples according to the sigmoid-polynomial model.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumDefinitions-4"></span><div class="fragmentname">&lt;&lt;Spectrum Definitions&gt;&gt;+=&nbsp;<a href="Representing_Spectral_Distributions.html#fragment-SpectrumDefinitions-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumDefinitions-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">class <span class="anchor" id="RGBAlbedoSpectrum"></span>RGBAlbedoSpectrum {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBAlbedoSpectrumPublicMethods-0">RGBAlbedoSpectrum Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-190" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-190"><i></i></a><div id="fragbit-190" class="collapse"><div class="fragmentcode">       Float operator()(Float <a href="#RGBSigmoidPolynomial::operator" class="code">lambda</a>) const { return <a href="#RGBAlbedoSpectrum::rsp" class="code">rsp</a>(<a href="#RGBSigmoidPolynomial::operator" class="code">lambda</a>); }
       Float <a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>() const { return <a href="#RGBAlbedoSpectrum::rsp" class="code">rsp</a>.<a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>(); }
       PBRT_CPU_GPU
       RGBAlbedoSpectrum(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs, <a href="#RGB" class="code">RGB</a> rgb);
       
       PBRT_CPU_GPU
       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Sample(const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths" class="code">SampledWavelengths</a> &amp;<a href="#RGBSigmoidPolynomial::operator" class="code">lambda</a>) const {
           <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> s;
           for (int i = 0; i &lt; NSpectrumSamples; ++i)
               s[i] = <a href="#RGBAlbedoSpectrum::rsp" class="code">rsp</a>(<a href="#RGBSigmoidPolynomial::operator" class="code">lambda</a>[i]);
           return s;
       }
       
       std::string ToString() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBAlbedoSpectrumPrivateMembers-0">RGBAlbedoSpectrum Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-191" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-191"><i></i></a><div id="fragbit-191" class="collapse"><div class="fragmentcode">       RGBSigmoidPolynomial rsp;</div></div>
};</div><p>


</p>
<p>Runtime assertions in the constructor, not shown here, verify that the
provided RGB value is between&nbsp;0 and&nbsp;1.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-4"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-3"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumMethodDefinitions-5"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">RGBAlbedoSpectrum::RGBAlbedoSpectrum(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs, <a href="#RGB" class="code">RGB</a> rgb) {
    <a href="#RGBAlbedoSpectrum::rsp" class="code">rsp</a> = cs.<a href="#RGBColorSpace::ToRGBCoeffs" class="code">ToRGBCoeffs</a>(rgb);
}</div><p>


</p>
<p>The only member variable necessary is one to store the polynomial
coefficients.

</p>
<p></p>
<span class="anchor" id="fragment-RGBAlbedoSpectrumPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;RGBAlbedoSpectrum Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">RGBSigmoidPolynomial <span class="anchor" id="RGBAlbedoSpectrum::rsp"></span>rsp;</div><p>


</p>
<p>Implementation of the required <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum"><tt>Spectrum</tt></a> methods is a matter of
forwarding the requests on to the appropriate <a href="#RGBSigmoidPolynomial"><tt>RGBSigmoidPolynomial</tt></a>
methods.  As with most <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum"><tt>Spectrum</tt></a> implementations, we will not include
the <tt>Sample()</tt> method here since it just loops over the wavelengths
and evaluates Equation&nbsp;(<a href="#eq:rgb-to-spectrum-spd">4.26</a>) at each one.

</p>
<p></p>
<span class="anchor" id="fragment-RGBAlbedoSpectrumPublicMethods-0"></span><div class="fragmentname">&lt;&lt;RGBAlbedoSpectrum Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="RGBAlbedoSpectrum::operator"></span>operator()(Float <a href="#RGBSigmoidPolynomial::operator" class="code">lambda</a>) const { return <a href="#RGBAlbedoSpectrum::rsp" class="code">rsp</a>(<a href="#RGBSigmoidPolynomial::operator" class="code">lambda</a>); }
Float <span class="anchor" id="RGBAlbedoSpectrrum::MaxValue"></span><a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>() const { return <a href="#RGBAlbedoSpectrum::rsp" class="code">rsp</a>.<a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>(); }</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x6-UnboundedRGB"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x6-UnboundedRGB"></span><h4>Unbounded RGB</h4><p>


</p>
<p>For unbounded (positive-valued) RGB values, the <a href="#RGBSigmoidPolynomial"><tt>RGBSigmoidPolynomial</tt></a>
foundation can still be used&mdash;just with the addition of a scale factor that
remaps its range to the necessary range for the given RGB.   That approach is
implemented in the <tt>RGBUnboundedSpectrum</tt> class.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumDefinitions-5"></span><div class="fragmentname">&lt;&lt;Spectrum Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumDefinitions-4"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumDefinitions-6"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">class <span class="anchor" id="RGBUnboundedSpectrum"></span>RGBUnboundedSpectrum {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBUnboundedSpectrumPublicMethods-0">RGBUnboundedSpectrum Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-192" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-192"><i></i></a><div id="fragbit-192" class="collapse"><div class="fragmentcode">       Float operator()(Float lambda) const { return <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> * <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a>(lambda); }
       Float <a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>() const { return <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> * <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a>.<a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>(); }
       PBRT_CPU_GPU
       RGBUnboundedSpectrum(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs, <a href="#RGB" class="code">RGB</a> rgb);
       
       PBRT_CPU_GPU
       RGBUnboundedSpectrum()
           : <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a>(0, 0, 0), <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a>(0) {}
       
       PBRT_CPU_GPU
       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Sample(const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths" class="code">SampledWavelengths</a> &amp;lambda) const {
           <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> s;
           for (int i = 0; i &lt; NSpectrumSamples; ++i)
               s[i] = <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> * <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a>(lambda[i]);
           return s;
       }
       
       std::string ToString() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBUnboundedSpectrumPrivateMembers-0">RGBUnboundedSpectrum Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-193" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-193"><i></i></a><div id="fragbit-193" class="collapse"><div class="fragmentcode">       Float scale = 1;
       RGBSigmoidPolynomial rsp;</div></div>
};</div><p>


</p>
<p>A natural choice for a scale factor would be one over the maximum of the
red, green, and blue color components.  We would then use that to normalize
the RGB value before finding polynomial coefficients and then rescale
values returned by <a href="#RGBSigmoidPolynomial"><tt>RGBSigmoidPolynomial</tt></a> accordingly.  However, it is
possible to get better results by instead normalizing RGB to have a
maximum value of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1501.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1 slash 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1001" y="0"></use>
</g>
</svg> rather than&nbsp;1.  The reason is illustrated in
Figure&nbsp;<a href="#fig:rgb-sigmoid-normalization">4.32</a>: because reflectance spectra
must not exceed one, when highly saturated colors are provided, the
resulting spectra may have unusual features, including large magnitudes in
the unsaturated region of the spectrum.  Rescaling to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1501.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">1 slash 2</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-31" d="M419 0c-35 3 -122 3 -162 3s-127 0 -162 -3v31h32c90 0 93 12 93 48v518c-52 -26 -111 -26 -131 -26v31c32 0 120 0 182 64c23 0 23 -2 23 -26v-561c0 -37 3 -48 93 -48h32v-31Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2F" d="M445 730c0 -2 0 -5 -1 -7l-349 -960c-3 -8 -10 -13 -19 -13c-11 0 -20 9 -20 20c0 2 0 5 1 7l349 960c3 8 10 13 19 13c11 0 20 -9 20 -20Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-31" x="0" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1001" y="0"></use>
</g>
</svg> gives the fit
more room to work with, since the normalization constraint does not
immediately affect it.

</p>
<p></p>
<span class="anchor" id="fig:rgb-sigmoid-normalization"></span><div class="card outerfigure"><div class="card-body figure"><p>



</p>
<div class="figure-row">
  <a href="pha04f32.svg" title=""><img src="pha04f32.svg" width=637 height=295 style="max-width: 100%;"></a>
</div>
<p>


</p>
<figcaption class="caption">Figure 4.32: <span class="legend">
With the sigmoid polynomial representation, highly saturated colors may end
up with unexpected features in their spectra.  Here we have plotted the
spectrum returned by <a href="#RGBAlbedoSpectrum"><tt>RGBAlbedoSpectrum</tt></a> for the RGB color <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.442ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7509.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">left-parenthesis 0.95 comma 0.05 comma 0.025 right-parenthesis</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-28" d="M332 -238c0 -5 -5 -10 -10 -10c-2 0 -4 1 -6 2c-110 83 -215 283 -215 454v84c0 171 105 371 215 454c2 1 4 2 6 2c5 0 10 -5 10 -10c0 -3 -2 -6 -4 -8c-104 -78 -173 -278 -173 -438v-84c0 -160 69 -360 173 -438c2 -2 4 -5 4 -8Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-39" d="M457 329c0 -215 -122 -351 -251 -351c-85 0 -139 41 -139 108c0 39 30 48 46 48c22 0 46 -15 46 -46c0 -17 -8 -46 -52 -46c27 -34 81 -36 98 -36c58 0 162 46 162 280v32c-23 -58 -64 -100 -125 -100c-112 0 -200 98 -200 223c0 75 23 117 64 162c43 45 92 63 147 63 c89 0 204 -68 204 -337zM365 421c0 46 -4 109 -16 141c-17 45 -50 79 -96 79c-35 0 -73 -13 -100 -63c-21 -37 -21 -84 -21 -138c0 -49 0 -99 18 -136c31 -63 77 -63 93 -63c88 0 122 97 122 180Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2C" d="M203 1c0 -117 -80 -194 -91 -194c-5 0 -10 4 -10 11c0 3 0 5 11 16c33 33 68 93 68 167c0 14 -2 15 -2 15s-2 -1 -5 -3c-10 -9 -23 -13 -35 -13c-33 0 -53 26 -53 53c0 28 20 53 53 53c39 0 64 -39 64 -105Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-32" d="M449 174l-28 -174h-371c0 24 0 26 11 37l192 214c55 62 105 141 105 221c0 82 -43 163 -134 163c-58 0 -112 -37 -135 -102c3 1 5 1 13 1c35 0 53 -26 53 -52c0 -41 -35 -53 -52 -53c-3 0 -53 0 -53 56c0 89 74 181 187 181c122 0 212 -80 212 -194 c0 -100 -60 -154 -216 -292l-106 -103h180c22 0 88 0 95 8c10 15 17 59 22 89h25Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-29" d="M288 208c0 -171 -105 -371 -215 -454c-2 -1 -4 -2 -6 -2c-5 0 -10 5 -10 10c0 3 2 6 4 8c104 78 173 278 173 438v84c0 160 -69 360 -173 438c-2 2 -4 5 -4 8c0 5 5 10 10 10c2 0 4 -1 6 -2c110 -83 215 -283 215 -454v-84Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-39" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="2169" y="0"></use>
<g transform="translate(2614,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1279" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-2C" x="4394" y="0"></use>
<g transform="translate(4839,0)">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-30" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-32" x="1279" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1780" y="0"></use>
</g>
 <use xlink:href="#E1-LATINMODERNMAIN-29" x="7120" y="0"></use>
</g>
</svg> as well as that color with all components divided by
two.  With the original color, we see a wide range of the higher
wavelengths are near&nbsp;1 and that the lower wavelengths have more energy than
expected.  If that color is divided by two, the resulting spectrum is
better behaved, though note that its magnitude exceeds the original red
value of <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.297ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2280.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">0.475</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-LATINMODERNMAIN-30" d="M460 320c0 -79 -5 -157 -37 -226c-44 -95 -120 -116 -174 -116c-49 0 -122 20 -165 101c-41 76 -45 166 -45 241c0 80 5 158 37 227c41 93 114 119 174 119c42 0 124 -16 170 -112c35 -74 40 -154 40 -234zM377 332c0 63 0 139 -10 195c-19 99 -85 117 -118 117 c-25 0 -100 -9 -119 -128c-8 -54 -8 -120 -8 -184c0 -59 0 -151 11 -211c18 -96 77 -121 116 -121c45 0 102 30 117 125c11 64 11 132 11 207Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-2E" d="M192 53c0 -29 -24 -53 -53 -53s-53 24 -53 53s24 53 53 53s53 -24 53 -53Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-34" d="M471 165h-100v-87c0 -36 2 -47 76 -47h21v-31c-41 3 -94 3 -136 3s-94 0 -135 -3v31h21c74 0 76 11 76 47v87h-266v31l307 469c8 12 11 12 20 12c16 0 16 -6 16 -26v-455h100v-31zM300 196v373l-244 -373h244Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-37" d="M485 644c0 -21 0 -23 -9 -35l-135 -190c-44 -62 -58 -148 -62 -171c-8 -54 -11 -109 -11 -164v-51c0 -10 0 -55 -46 -55s-46 45 -46 55c0 102 33 241 123 376l112 158h-207c-13 0 -91 0 -98 -6c-13 -12 -22 -75 -25 -91h-25l33 206h25c4 -19 6 -32 128 -32h243Z"></path>
<path stroke-width="1" id="E1-LATINMODERNMAIN-35" d="M449 201c0 -127 -102 -223 -218 -223c-112 0 -181 97 -181 183c0 46 35 53 49 53c33 0 50 -25 50 -49s-17 -49 -50 -49c-11 0 -14 1 -17 2c17 -59 74 -112 147 -112c46 0 83 26 107 65c24 42 24 102 24 137c0 50 -2 89 -18 126c-8 18 -33 64 -85 64 c-81 0 -118 -54 -129 -70c-4 -6 -6 -9 -13 -9c-14 0 -14 8 -14 26v296c0 16 0 24 10 24c0 0 4 0 12 -3c47 -21 93 -28 133 -28c67 0 116 20 136 29c5 3 8 3 8 3c7 0 10 -5 10 -11c0 -13 -70 -104 -193 -104c-32 0 -65 7 -85 13v-195c36 35 79 51 127 51 c108 0 190 -100 190 -219Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-LATINMODERNMAIN-30"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-34" x="779" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#E1-LATINMODERNMAIN-35" x="1780" y="0"></use>
</g>
</svg> in the higher wavelengths.</span>
</figcaption><p>


</p>
</div></div><p>


</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-5"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-4"><span class="fa fa-caret-up"></span></a>&nbsp;<a href="#fragment-SpectrumMethodDefinitions-6"><span class="fa fa-caret-down"></span></a></div>
<div class="fragmentcode">RGBUnboundedSpectrum::RGBUnboundedSpectrum(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs,
                                           <a href="#RGB" class="code">RGB</a> rgb) {
    Float m = std::max({rgb.r, rgb.g, rgb.b});
    <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> = 2 * m;
    <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a> = cs.<a href="#RGBColorSpace::ToRGBCoeffs" class="code">ToRGBCoeffs</a>(<a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> ? rgb / <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> : <a href="#RGB" class="code">RGB</a>(0, 0, 0));
}</div><p>


</p>
<p></p>
<span class="anchor" id="fragment-RGBUnboundedSpectrumPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;RGBUnboundedSpectrum Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="RGBUnboundedSpectrum::scale"></span>scale = 1;
RGBSigmoidPolynomial <span class="anchor" id="RGBUnboundedSpectrum::rsp"></span>rsp;</div><p>


</p>
<p>In comparison to the <a href="#RGBAlbedoSpectrum"><tt>RGBAlbedoSpectrum</tt></a> implementation, the wavelength
evaluation and <tt>MaxValue()</tt> methods here are just augmented with a
multiplication by the scale factor.  The
<tt>Sample()</tt><span class="anchor" id="RGBUnboundedSpectrum::Sample"></span> method has been
updated similarly, but is not included here.

</p>
<p></p>
<span class="anchor" id="fragment-RGBUnboundedSpectrumPublicMethods-0"></span><div class="fragmentname">&lt;&lt;RGBUnboundedSpectrum Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float operator()(Float lambda) const { return <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> * <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a>(lambda); }
Float <span class="anchor" id="RGBUnboundedSpectrum::MaxValue"></span><a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>() const { return <a href="#RGBUnboundedSpectrum::scale" class="code">scale</a> * <a href="#RGBUnboundedSpectrum::rsp" class="code">rsp</a>.<a href="#RGBSigmoidPolynomial::MaxValue" class="code">MaxValue</a>(); }</div><p>


</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

<div class="row">
<div class="col-md-1 col-lg-2 leftcolumn">
<a href="#x6-RGBIlluminants"><i class="fas fa-link h3h4marginlink"></i></a>
</div>
<div class="col-md-10 col-lg-8">
<span id="x6-RGBIlluminants"></span><h4>RGB Illuminants</h4><p>


</p>
<p>As illustrated in the plots of illuminant spectra in
Section&nbsp;<a href="../Radiometry,_Spectra,_and_Color/Light_Emission.html#sec:standard-illuminants">4.4.2</a>, real-world illuminants often have
complex spectral distributions.  Given a light source specified using RGB
color, we do not attempt to infer a complex spectral distribution but will
stick with a smooth spectrum, scaled appropriately.  The details are
handled by the <tt>RGBIlluminantSpectrum</tt> class.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumDefinitions-6"></span><div class="fragmentname">&lt;&lt;Spectrum Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumDefinitions-5"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">class <span class="anchor" id="RGBIlluminantSpectrum"></span>RGBIlluminantSpectrum {
  public:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBIlluminantSpectrumPublicMethods-0">RGBIlluminantSpectrum Public Methods</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-194" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-194"><i></i></a><div id="fragbit-194" class="collapse"><div class="fragmentcode">       RGBIlluminantSpectrum() = default;
       RGBIlluminantSpectrum(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs, <a href="#RGB" class="code">RGB</a> rgb);
       Float operator()(Float lambda) const {
           if (!<a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>) return 0;
           return <a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> * <a href="#RGBIlluminantSpectrum::rsp" class="code">rsp</a>(lambda) * (*<a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>)(lambda);
       }
       Float <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::MaxValue" class="code">MaxValue</a>() const {
           if (!<a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>) return 0;
           return <a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> * <a href="#RGBIlluminantSpectrum::rsp" class="code">rsp</a>.<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::MaxValue" class="code">MaxValue</a>() * <a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>-&gt;<a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum::MaxValue" class="code">MaxValue</a>();
       }
       const DenselySampledSpectrum *Illuminant() const {
           return <a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>;
       }
       PBRT_CPU_GPU
       <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> Sample(const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledWavelengths" class="code">SampledWavelengths</a> &amp;lambda) const {
           if (!<a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>) return <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a>(0);
           <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#SampledSpectrum" class="code">SampledSpectrum</a> s;
           for (int i = 0; i &lt; NSpectrumSamples; ++i)
               s[i] = <a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> * <a href="#RGBIlluminantSpectrum::rsp" class="code">rsp</a>(lambda[i]);
           return s * <a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>-&gt;Sample(lambda);
       }
       
       std::string ToString() const;</div></div>
  private:
    &lt;&lt;<span class="fragmentname"><a href="#fragment-RGBIlluminantSpectrumPrivateMembers-0">RGBIlluminantSpectrum Private Members</a></span>&gt;&gt;&nbsp;<a data-toggle="collapse" href="#fragbit-195" role="button" class="fa codecarat collapsed" aria-expanded="false" aria-controls="fragbit-195"><i></i></a><div id="fragbit-195" class="collapse"><div class="fragmentcode">       Float scale;
       RGBSigmoidPolynomial rsp;
       const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#DenselySampledSpectrum" class="code">DenselySampledSpectrum</a> *illuminant;</div></div>
};</div><p>


</p>
<p>

</p>
<p>Beyond a scale factor that is equivalent to the one used in
<a href="#RGBUnboundedSpectrum"><tt>RGBUnboundedSpectrum</tt></a> to allow an arbitrary maximum RGB value, the
<tt>RGBIlluminantSpectrum</tt> also multiplies the value returned at the given
wavelength by the value of the color space&rsquo;s standard illuminant at that
wavelength. A non-intuitive aspect of spectral modeling of illuminants is that
uniform spectra generally do not map to neutral white colors following
conversion to RGB. Color spaces always assume that the viewer is adapted to
some type of environmental illumination that influences color perception and
the notion of a neutral color. For example, the commonly used D65 whitepoint
averages typical daylight illumination conditions. To reproduce illuminants
with a desired color, we therefore use a crude but effective solution, which is
to multiply the whitepoint with a suitable reflectance spectra. Conceptually,
this resembles viewing a white reference light source through a colored film.
It also ensures that white objects lit by white lights lead to white pixel
values in the rendered image.

</p>
<p></p>
<span class="anchor" id="fragment-SpectrumMethodDefinitions-6"></span><div class="fragmentname">&lt;&lt;Spectrum Method Definitions&gt;&gt;+=&nbsp;<a href="#fragment-SpectrumMethodDefinitions-5"><span class="fa fa-caret-up"></span></a></div>
<div class="fragmentcode">RGBIlluminantSpectrum::RGBIlluminantSpectrum(const <a href="#RGBColorSpace" class="code">RGBColorSpace</a> &amp;cs,
                                             <a href="#RGB" class="code">RGB</a> rgb)
    : <a href="#RGBColorSpace::illuminant" class="code">illuminant</a>(&amp;cs.<a href="#RGBColorSpace::illuminant" class="code">illuminant</a>) {
    Float m = std::max({rgb.r, rgb.g, rgb.b});
    <a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> = 2 * m;
    <a href="#RGBIlluminantSpectrum::rsp" class="code">rsp</a> = cs.<a href="#RGBColorSpace::ToRGBCoeffs" class="code">ToRGBCoeffs</a>(<a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> ? rgb / <a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> : <a href="#RGB" class="code">RGB</a>(0, 0, 0));
}</div><p>


</p>
<p>Thus, a pointer to the illuminant is held in a member variable.

</p>
<p></p>
<span class="anchor" id="fragment-RGBIlluminantSpectrumPrivateMembers-0"></span><div class="fragmentname">&lt;&lt;RGBIlluminantSpectrum Private Members&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="RGBIlluminantSpectrum::scale"></span>scale;
RGBSigmoidPolynomial <span class="anchor" id="RGBIlluminantSpectrum::rsp"></span>rsp;
const <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#DenselySampledSpectrum" class="code">DenselySampledSpectrum</a> *<span class="anchor" id="RGBIlluminantSpectrum::illuminant"></span>illuminant;</div><p>


</p>
<p>Implementations of the various <a href="../Radiometry,_Spectra,_and_Color/Representing_Spectral_Distributions.html#Spectrum"><tt>Spectrum</tt></a> interface methods follow;
here is the one that evaluates the spectral distribution at a single
wavelength.  One detail is that it must handle the case of a <tt>nullptr</tt>
<tt>illuminant</tt>, as will happen if an <tt>RGBIlluminantSpectrum</tt> is
default-initialized.  In that case, a zero-valued spectrum should be the
result.

</p>
<p></p>
<span class="anchor" id="fragment-RGBIlluminantSpectrumPublicMethods-0"></span><div class="fragmentname">&lt;&lt;RGBIlluminantSpectrum Public Methods&gt;&gt;=&nbsp;</div>
<div class="fragmentcode">Float <span class="anchor" id="RGBIlluminantSpectrum::operator"></span>operator()(Float lambda) const {
    if (!<a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>) return 0;
    return <a href="#RGBIlluminantSpectrum::scale" class="code">scale</a> * <a href="#RGBIlluminantSpectrum::rsp" class="code">rsp</a>(lambda) * (*<a href="#RGBIlluminantSpectrum::illuminant" class="code">illuminant</a>)(lambda);
}</div><p>


</p>
<p>We will not include the implementations of the
<tt>Sample()</tt><span class="anchor" id="RGBIlluminantSpectrum::Sample"></span> or
<tt>MaxValue()</tt><span class="anchor" id="RGBIlluminantSpectrum::MaxValue"></span> methods
here, as their implementations are as would be expected.

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p>

</p>
<p></p>

</div> <!-- col-md-10 col-lg-8 -->
<div class="col-md-1 col-lg-2">

</div> <!-- col-md-1 col-lg-2 -->
</div>  <!-- row -->

</div>  <!-- container-fluid -->
</div>  <!-- maincontainer -->

<nav class="navbar navbar-expand-md bg-light navbar-light">
<div class="container-fluid">
  <span class="navbar-text"><i>Physically Based Rendering: From Theory To Implementation</i>,<br>
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">&copy; 2004-2023</a> Matt Pharr, Wenzel Jakob, and Greg Humphreys.
<a href="https://github.com/mmp/pbr-book-website/"><span class="fab fa-github"></span></a><br>
Purchase a printed copy: <a href="https://www.amazon.com/Physically-Based-Rendering-fourth-Implementation/dp/0262048027?keywords=physically+based+rendering+4th+edition&qid=1671730412&sprefix=physically+based%!C(MISSING)aps%!C(MISSING)145&sr=8-1&linkCode=ll1&tag=pharr-20&linkId=81a816d90f0c7e872617f1f930a51fd6&language=en_US&ref_=as_li_ss_tl"><span class="fab fa-amazon"></span></a>
<a href="https://mitpress.mit.edu/9780262048026/physically-based-rendering/"><img src="/mitpress.png" width=10 height=16></a>
</span>
</div>
  <div class="container">
    <ul class="nav navbar-nav ml-auto">
      <li class="nav-item">Next: <a href="../Radiometry,_Spectra,_and_Color/Further_Reading.html">Radiometry, Spectra, and Color / Further Reading</a></li>
    </ul>
  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script>
  $(function () {
    $('[data-toggle="popover"]').popover()
    $('[data-toggle="tooltip"]').tooltip()
   })
</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
// https://stackoverflow.com/a/17535094
// The function actually applying the offset
function offsetAnchor() {
  if (location.hash.length !== 0) {
    window.scrollTo(window.scrollX, window.scrollY - window.innerHeight / 8);
  }
}

// Captures click events of all <a> elements with href starting with #
$(document).on('click', 'a[href^="#"]', function(event) {
  // Click events are captured before hashchanges. Timeout
  // causes offsetAnchor to be called after the page jump.
  window.setTimeout(function() {
    offsetAnchor();
  }, 500);
});

// Set the offset when entering page with hash present in the url
window.setTimeout(offsetAnchor, 1500);
</script>

</body>
</html>
